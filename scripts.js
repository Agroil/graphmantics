/*! jQuery v3.3.1 | (c) JS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var n=[],r=e.document,i=Object.getPrototypeOf,o=n.slice,a=n.concat,s=n.push,u=n.indexOf,l={},c=l.toString,f=l.hasOwnProperty,p=f.toString,d=p.call(Object),h={},g=function e(t){return"function"==typeof t&&"number"!=typeof t.nodeType},y=function e(t){return null!=t&&t===t.window},v={type:!0,src:!0,noModule:!0};function m(e,t,n){var i,o=(t=t||r).createElement("script");if(o.text=e,n)for(i in v)n[i]&&(o[i]=n[i]);t.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e}var b="3.3.1",w=function(e,t){return new w.fn.init(e,t)},T=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.fn=w.prototype={jquery:"3.3.1",constructor:w,length:0,toArray:function(){return o.call(this)},get:function(e){return null==e?o.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||g(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(r=e[t])&&(l&&r&&(w.isPlainObject(r)||(i=Array.isArray(r)))?(i?(i=!1,o=n&&Array.isArray(n)?n:[]):o=n&&w.isPlainObject(n)?n:{},a[t]=w.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},w.extend({expando:"jQuery"+("3.3.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==c.call(e))&&(!(t=i(e))||"function"==typeof(n=f.call(t,"constructor")&&t.constructor)&&p.call(n)===d)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e){m(e)},each:function(e,t){var n,r=0;if(C(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},trim:function(e){return null==e?"":(e+"").replace(T,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(C(Object(e))?w.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:u.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r,i=[],o=0,a=e.length,s=!n;o<a;o++)(r=!t(e[o],o))!==s&&i.push(e[o]);return i},map:function(e,t,n){var r,i,o=0,s=[];if(C(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&s.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&s.push(i);return a.apply([],s)},guid:1,support:h}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()});function C(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!g(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}var E=function(e){var t,n,r,i,o,a,s,u,l,c,f,p,d,h,g,y,v,m,x,b="sizzle"+1*new Date,w=e.document,T=0,C=0,E=ae(),k=ae(),S=ae(),D=function(e,t){return e===t&&(f=!0),0},N={}.hasOwnProperty,A=[],j=A.pop,q=A.push,L=A.push,H=A.slice,O=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},P="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",I="\\["+M+"*("+R+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+R+"))|)"+M+"*\\]",W=":("+R+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+I+")*)|.*)\\)|)",$=new RegExp(M+"+","g"),B=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),F=new RegExp("^"+M+"*,"+M+"*"),_=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),z=new RegExp("="+M+"*([^\\]'\"]*?)"+M+"*\\]","g"),X=new RegExp(W),U=new RegExp("^"+R+"$"),V={ID:new RegExp("^#("+R+")"),CLASS:new RegExp("^\\.("+R+")"),TAG:new RegExp("^("+R+"|[*])"),ATTR:new RegExp("^"+I),PSEUDO:new RegExp("^"+W),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+P+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},G=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,K=/[+~]/,Z=new RegExp("\\\\([\\da-f]{1,6}"+M+"?|("+M+")|.)","ig"),ee=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},te=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ne=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},re=function(){p()},ie=me(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{L.apply(A=H.call(w.childNodes),w.childNodes),A[w.childNodes.length].nodeType}catch(e){L={apply:A.length?function(e,t){q.apply(e,H.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function oe(e,t,r,i){var o,s,l,c,f,h,v,m=t&&t.ownerDocument,T=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==T&&9!==T&&11!==T)return r;if(!i&&((t?t.ownerDocument||t:w)!==d&&p(t),t=t||d,g)){if(11!==T&&(f=J.exec(e)))if(o=f[1]){if(9===T){if(!(l=t.getElementById(o)))return r;if(l.id===o)return r.push(l),r}else if(m&&(l=m.getElementById(o))&&x(t,l)&&l.id===o)return r.push(l),r}else{if(f[2])return L.apply(r,t.getElementsByTagName(e)),r;if((o=f[3])&&n.getElementsByClassName&&t.getElementsByClassName)return L.apply(r,t.getElementsByClassName(o)),r}if(n.qsa&&!S[e+" "]&&(!y||!y.test(e))){if(1!==T)m=t,v=e;else if("object"!==t.nodeName.toLowerCase()){(c=t.getAttribute("id"))?c=c.replace(te,ne):t.setAttribute("id",c=b),s=(h=a(e)).length;while(s--)h[s]="#"+c+" "+ve(h[s]);v=h.join(","),m=K.test(e)&&ge(t.parentNode)||t}if(v)try{return L.apply(r,m.querySelectorAll(v)),r}catch(e){}finally{c===b&&t.removeAttribute("id")}}}return u(e.replace(B,"$1"),t,r,i)}function ae(){var e=[];function t(n,i){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=i}return t}function se(e){return e[b]=!0,e}function ue(e){var t=d.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function le(e,t){var n=e.split("|"),i=n.length;while(i--)r.attrHandle[n[i]]=t}function ce(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function fe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function pe(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function de(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&ie(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function he(e){return se(function(t){return t=+t,se(function(n,r){var i,o=e([],n.length,t),a=o.length;while(a--)n[i=o[a]]&&(n[i]=!(r[i]=n[i]))})})}function ge(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}n=oe.support={},o=oe.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},p=oe.setDocument=function(e){var t,i,a=e?e.ownerDocument||e:w;return a!==d&&9===a.nodeType&&a.documentElement?(d=a,h=d.documentElement,g=!o(d),w!==d&&(i=d.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",re,!1):i.attachEvent&&i.attachEvent("onunload",re)),n.attributes=ue(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=ue(function(e){return e.appendChild(d.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Q.test(d.getElementsByClassName),n.getById=ue(function(e){return h.appendChild(e).id=b,!d.getElementsByName||!d.getElementsByName(b).length}),n.getById?(r.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&g){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(Z,ee);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&g){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},r.find.CLASS=n.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&g)return t.getElementsByClassName(e)},v=[],y=[],(n.qsa=Q.test(d.querySelectorAll))&&(ue(function(e){h.appendChild(e).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&y.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||y.push("\\["+M+"*(?:value|"+P+")"),e.querySelectorAll("[id~="+b+"-]").length||y.push("~="),e.querySelectorAll(":checked").length||y.push(":checked"),e.querySelectorAll("a#"+b+"+*").length||y.push(".#.+[+~]")}),ue(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=d.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&y.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&y.push(":enabled",":disabled"),h.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&y.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),y.push(",.*:")})),(n.matchesSelector=Q.test(m=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ue(function(e){n.disconnectedMatch=m.call(e,"*"),m.call(e,"[s!='']:x"),v.push("!=",W)}),y=y.length&&new RegExp(y.join("|")),v=v.length&&new RegExp(v.join("|")),t=Q.test(h.compareDocumentPosition),x=t||Q.test(h.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},D=t?function(e,t){if(e===t)return f=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e===d||e.ownerDocument===w&&x(w,e)?-1:t===d||t.ownerDocument===w&&x(w,t)?1:c?O(c,e)-O(c,t):0:4&r?-1:1)}:function(e,t){if(e===t)return f=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e===d?-1:t===d?1:i?-1:o?1:c?O(c,e)-O(c,t):0;if(i===o)return ce(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?ce(a[r],s[r]):a[r]===w?-1:s[r]===w?1:0},d):d},oe.matches=function(e,t){return oe(e,null,null,t)},oe.matchesSelector=function(e,t){if((e.ownerDocument||e)!==d&&p(e),t=t.replace(z,"='$1']"),n.matchesSelector&&g&&!S[t+" "]&&(!v||!v.test(t))&&(!y||!y.test(t)))try{var r=m.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return oe(t,d,null,[e]).length>0},oe.contains=function(e,t){return(e.ownerDocument||e)!==d&&p(e),x(e,t)},oe.attr=function(e,t){(e.ownerDocument||e)!==d&&p(e);var i=r.attrHandle[t.toLowerCase()],o=i&&N.call(r.attrHandle,t.toLowerCase())?i(e,t,!g):void 0;return void 0!==o?o:n.attributes||!g?e.getAttribute(t):(o=e.getAttributeNode(t))&&o.specified?o.value:null},oe.escape=function(e){return(e+"").replace(te,ne)},oe.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},oe.uniqueSort=function(e){var t,r=[],i=0,o=0;if(f=!n.detectDuplicates,c=!n.sortStable&&e.slice(0),e.sort(D),f){while(t=e[o++])t===e[o]&&(i=r.push(o));while(i--)e.splice(r[i],1)}return c=null,e},i=oe.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=i(e)}else if(3===o||4===o)return e.nodeValue}else while(t=e[r++])n+=i(t);return n},(r=oe.selectors={cacheLength:50,createPseudo:se,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Z,ee),e[3]=(e[3]||e[4]||e[5]||"").replace(Z,ee),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||oe.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&oe.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return V.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=a(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Z,ee).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=E[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&E(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=oe.attr(r,e);return null==i?"!="===t:!t||(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i.replace($," ")+" ").indexOf(n)>-1:"|="===t&&(i===n||i.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,u){var l,c,f,p,d,h,g=o!==a?"nextSibling":"previousSibling",y=t.parentNode,v=s&&t.nodeName.toLowerCase(),m=!u&&!s,x=!1;if(y){if(o){while(g){p=t;while(p=p[g])if(s?p.nodeName.toLowerCase()===v:1===p.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?y.firstChild:y.lastChild],a&&m){x=(d=(l=(c=(f=(p=y)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1])&&l[2],p=d&&y.childNodes[d];while(p=++d&&p&&p[g]||(x=d=0)||h.pop())if(1===p.nodeType&&++x&&p===t){c[e]=[T,d,x];break}}else if(m&&(x=d=(l=(c=(f=(p=t)[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]||[])[0]===T&&l[1]),!1===x)while(p=++d&&p&&p[g]||(x=d=0)||h.pop())if((s?p.nodeName.toLowerCase()===v:1===p.nodeType)&&++x&&(m&&((c=(f=p[b]||(p[b]={}))[p.uniqueID]||(f[p.uniqueID]={}))[e]=[T,x]),p===t))break;return(x-=i)===r||x%r==0&&x/r>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||oe.error("unsupported pseudo: "+e);return i[b]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?se(function(e,n){var r,o=i(e,t),a=o.length;while(a--)e[r=O(e,o[a])]=!(n[r]=o[a])}):function(e){return i(e,0,n)}):i}},pseudos:{not:se(function(e){var t=[],n=[],r=s(e.replace(B,"$1"));return r[b]?se(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;while(s--)(o=a[s])&&(e[s]=!(t[s]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:se(function(e){return function(t){return oe(e,t).length>0}}),contains:se(function(e){return e=e.replace(Z,ee),function(t){return(t.textContent||t.innerText||i(t)).indexOf(e)>-1}}),lang:se(function(e){return U.test(e||"")||oe.error("unsupported lang: "+e),e=e.replace(Z,ee).toLowerCase(),function(t){var n;do{if(n=g?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:de(!1),disabled:de(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return Y.test(e.nodeName)},input:function(e){return G.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:he(function(){return[0]}),last:he(function(e,t){return[t-1]}),eq:he(function(e,t,n){return[n<0?n+t:n]}),even:he(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:he(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:he(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:he(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq;for(t in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=fe(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=pe(t);function ye(){}ye.prototype=r.filters=r.pseudos,r.setFilters=new ye,a=oe.tokenize=function(e,t){var n,i,o,a,s,u,l,c=k[e+" "];if(c)return t?0:c.slice(0);s=e,u=[],l=r.preFilter;while(s){n&&!(i=F.exec(s))||(i&&(s=s.slice(i[0].length)||s),u.push(o=[])),n=!1,(i=_.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(B," ")}),s=s.slice(n.length));for(a in r.filter)!(i=V[a].exec(s))||l[a]&&!(i=l[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length));if(!n)break}return t?s.length:s?oe.error(e):k(e,u).slice(0)};function ve(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function me(e,t,n){var r=t.dir,i=t.next,o=i||r,a=n&&"parentNode"===o,s=C++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||a)return e(t,n,i);return!1}:function(t,n,u){var l,c,f,p=[T,s];if(u){while(t=t[r])if((1===t.nodeType||a)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||a)if(f=t[b]||(t[b]={}),c=f[t.uniqueID]||(f[t.uniqueID]={}),i&&i===t.nodeName.toLowerCase())t=t[r]||t;else{if((l=c[o])&&l[0]===T&&l[1]===s)return p[2]=l[2];if(c[o]=p,p[2]=e(t,n,u))return!0}return!1}}function xe(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function be(e,t,n){for(var r=0,i=t.length;r<i;r++)oe(e,t[r],n);return n}function we(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Te(e,t,n,r,i,o){return r&&!r[b]&&(r=Te(r)),i&&!i[b]&&(i=Te(i,o)),se(function(o,a,s,u){var l,c,f,p=[],d=[],h=a.length,g=o||be(t||"*",s.nodeType?[s]:s,[]),y=!e||!o&&t?g:we(g,p,e,s,u),v=n?i||(o?e:h||r)?[]:a:y;if(n&&n(y,v,s,u),r){l=we(v,d),r(l,[],s,u),c=l.length;while(c--)(f=l[c])&&(v[d[c]]=!(y[d[c]]=f))}if(o){if(i||e){if(i){l=[],c=v.length;while(c--)(f=v[c])&&l.push(y[c]=f);i(null,v=[],l,u)}c=v.length;while(c--)(f=v[c])&&(l=i?O(o,f):p[c])>-1&&(o[l]=!(a[l]=f))}}else v=we(v===a?v.splice(h,v.length):v),i?i(null,a,v,u):L.apply(a,v)})}function Ce(e){for(var t,n,i,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],u=a?1:0,c=me(function(e){return e===t},s,!0),f=me(function(e){return O(t,e)>-1},s,!0),p=[function(e,n,r){var i=!a&&(r||n!==l)||((t=n).nodeType?c(e,n,r):f(e,n,r));return t=null,i}];u<o;u++)if(n=r.relative[e[u].type])p=[me(xe(p),n)];else{if((n=r.filter[e[u].type].apply(null,e[u].matches))[b]){for(i=++u;i<o;i++)if(r.relative[e[i].type])break;return Te(u>1&&xe(p),u>1&&ve(e.slice(0,u-1).concat({value:" "===e[u-2].type?"*":""})).replace(B,"$1"),n,u<i&&Ce(e.slice(u,i)),i<o&&Ce(e=e.slice(i)),i<o&&ve(e))}p.push(n)}return xe(p)}function Ee(e,t){var n=t.length>0,i=e.length>0,o=function(o,a,s,u,c){var f,h,y,v=0,m="0",x=o&&[],b=[],w=l,C=o||i&&r.find.TAG("*",c),E=T+=null==w?1:Math.random()||.1,k=C.length;for(c&&(l=a===d||a||c);m!==k&&null!=(f=C[m]);m++){if(i&&f){h=0,a||f.ownerDocument===d||(p(f),s=!g);while(y=e[h++])if(y(f,a||d,s)){u.push(f);break}c&&(T=E)}n&&((f=!y&&f)&&v--,o&&x.push(f))}if(v+=m,n&&m!==v){h=0;while(y=t[h++])y(x,b,a,s);if(o){if(v>0)while(m--)x[m]||b[m]||(b[m]=j.call(u));b=we(b)}L.apply(u,b),c&&!o&&b.length>0&&v+t.length>1&&oe.uniqueSort(u)}return c&&(T=E,l=w),x};return n?se(o):o}return s=oe.compile=function(e,t){var n,r=[],i=[],o=S[e+" "];if(!o){t||(t=a(e)),n=t.length;while(n--)(o=Ce(t[n]))[b]?r.push(o):i.push(o);(o=S(e,Ee(i,r))).selector=e}return o},u=oe.select=function(e,t,n,i){var o,u,l,c,f,p="function"==typeof e&&e,d=!i&&a(e=p.selector||e);if(n=n||[],1===d.length){if((u=d[0]=d[0].slice(0)).length>2&&"ID"===(l=u[0]).type&&9===t.nodeType&&g&&r.relative[u[1].type]){if(!(t=(r.find.ID(l.matches[0].replace(Z,ee),t)||[])[0]))return n;p&&(t=t.parentNode),e=e.slice(u.shift().value.length)}o=V.needsContext.test(e)?0:u.length;while(o--){if(l=u[o],r.relative[c=l.type])break;if((f=r.find[c])&&(i=f(l.matches[0].replace(Z,ee),K.test(u[0].type)&&ge(t.parentNode)||t))){if(u.splice(o,1),!(e=i.length&&ve(u)))return L.apply(n,i),n;break}}}return(p||s(e,d))(i,t,!g,n,!t||K.test(e)&&ge(t.parentNode)||t),n},n.sortStable=b.split("").sort(D).join("")===b,n.detectDuplicates=!!f,p(),n.sortDetached=ue(function(e){return 1&e.compareDocumentPosition(d.createElement("fieldset"))}),ue(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||le("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&ue(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||le("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ue(function(e){return null==e.getAttribute("disabled")})||le(P,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),oe}(e);w.find=E,w.expr=E.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=E.uniqueSort,w.text=E.getText,w.isXMLDoc=E.isXML,w.contains=E.contains,w.escapeSelector=E.escape;var k=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&w(e).is(n))break;r.push(e)}return r},S=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},D=w.expr.match.needsContext;function N(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,t,n){return g(t)?w.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?w.grep(e,function(e){return e===t!==n}):"string"!=typeof t?w.grep(e,function(e){return u.call(t,e)>-1!==n}):w.filter(t,e,n)}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<r;t++)if(w.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)w.find(e,i[t],n);return r>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&D.test(e)?w(e):e||[],!1).length}});var q,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var i,o;if(!e)return this;if(n=n||q,"string"==typeof e){if(!(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:L.exec(e))||!i[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:r,!0)),A.test(i[1])&&w.isPlainObject(t))for(i in t)g(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return(o=r.getElementById(i[2]))&&(this[0]=o,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):g(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,q=w(r);var H=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&w(e);if(!D.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?w.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?u.call(w(e),this[0]):u.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}});function P(e,t){while((e=e[t])&&1!==e.nodeType);return e}w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return k(e,"parentNode")},parentsUntil:function(e,t,n){return k(e,"parentNode",n)},next:function(e){return P(e,"nextSibling")},prev:function(e){return P(e,"previousSibling")},nextAll:function(e){return k(e,"nextSibling")},prevAll:function(e){return k(e,"previousSibling")},nextUntil:function(e,t,n){return k(e,"nextSibling",n)},prevUntil:function(e,t,n){return k(e,"previousSibling",n)},siblings:function(e){return S((e.parentNode||{}).firstChild,e)},children:function(e){return S(e.firstChild)},contents:function(e){return N(e,"iframe")?e.contentDocument:(N(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(O[e]||w.uniqueSort(i),H.test(e)&&i.reverse()),this.pushStack(i)}});var M=/[^\x20\t\r\n\f]+/g;function R(e){var t={};return w.each(e.match(M)||[],function(e,n){t[n]=!0}),t}w.Callbacks=function(e){e="string"==typeof e?R(e):w.extend({},e);var t,n,r,i,o=[],a=[],s=-1,u=function(){for(i=i||e.once,r=t=!0;a.length;s=-1){n=a.shift();while(++s<o.length)!1===o[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=o.length,n=!1)}e.memory||(n=!1),t=!1,i&&(o=n?[]:"")},l={add:function(){return o&&(n&&!t&&(s=o.length-1,a.push(n)),function t(n){w.each(n,function(n,r){g(r)?e.unique&&l.has(r)||o.push(r):r&&r.length&&"string"!==x(r)&&t(r)})}(arguments),n&&!t&&u()),this},remove:function(){return w.each(arguments,function(e,t){var n;while((n=w.inArray(t,o,n))>-1)o.splice(n,1),n<=s&&s--}),this},has:function(e){return e?w.inArray(e,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return i=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return i=a=[],n||t||(o=n=""),this},locked:function(){return!!i},fireWith:function(e,n){return i||(n=[e,(n=n||[]).slice?n.slice():n],a.push(n),t||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!r}};return l};function I(e){return e}function W(e){throw e}function $(e,t,n,r){var i;try{e&&g(i=e.promise)?i.call(e).done(t).fail(n):e&&g(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return o.done(arguments).fail(arguments),this},"catch":function(e){return i.then(null,e)},pipe:function(){var e=arguments;return w.Deferred(function(t){w.each(n,function(n,r){var i=g(e[r[4]])&&e[r[4]];o[r[1]](function(){var e=i&&i.apply(this,arguments);e&&g(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,i?[e]:arguments)})}),e=null}).promise()},then:function(t,r,i){var o=0;function a(t,n,r,i){return function(){var s=this,u=arguments,l=function(){var e,l;if(!(t<o)){if((e=r.apply(s,u))===n.promise())throw new TypeError("Thenable self-resolution");l=e&&("object"==typeof e||"function"==typeof e)&&e.then,g(l)?i?l.call(e,a(o,n,I,i),a(o,n,W,i)):(o++,l.call(e,a(o,n,I,i),a(o,n,W,i),a(o,n,I,n.notifyWith))):(r!==I&&(s=void 0,u=[e]),(i||n.resolveWith)(s,u))}},c=i?l:function(){try{l()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,c.stackTrace),t+1>=o&&(r!==W&&(s=void 0,u=[e]),n.rejectWith(s,u))}};t?c():(w.Deferred.getStackHook&&(c.stackTrace=w.Deferred.getStackHook()),e.setTimeout(c))}}return w.Deferred(function(e){n[0][3].add(a(0,e,g(i)?i:I,e.notifyWith)),n[1][3].add(a(0,e,g(t)?t:I)),n[2][3].add(a(0,e,g(r)?r:W))}).promise()},promise:function(e){return null!=e?w.extend(e,i):i}},o={};return w.each(n,function(e,t){var a=t[2],s=t[5];i[t[1]]=a.add,s&&a.add(function(){r=s},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),a.add(t[3].fire),o[t[0]]=function(){return o[t[0]+"With"](this===o?void 0:this,arguments),this},o[t[0]+"With"]=a.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(e){var t=arguments.length,n=t,r=Array(n),i=o.call(arguments),a=w.Deferred(),s=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?o.call(arguments):n,--t||a.resolveWith(r,i)}};if(t<=1&&($(e,a.done(s(n)).resolve,a.reject,!t),"pending"===a.state()||g(i[n]&&i[n].then)))return a.then();while(n--)$(i[n],s(n),a.reject);return a.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&B.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout(function(){throw t})};var F=w.Deferred();w.fn.ready=function(e){return F.then(e)["catch"](function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||F.resolveWith(r,[w]))}}),w.ready.then=F.then;function _(){r.removeEventListener("DOMContentLoaded",_),e.removeEventListener("load",_),w.ready()}"complete"===r.readyState||"loading"!==r.readyState&&!r.documentElement.doScroll?e.setTimeout(w.ready):(r.addEventListener("DOMContentLoaded",_),e.addEventListener("load",_));var z=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n)){i=!0;for(s in n)z(e,t,s,n[s],!0,o,a)}else if(void 0!==r&&(i=!0,g(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(w(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},X=/^-ms-/,U=/-([a-z])/g;function V(e,t){return t.toUpperCase()}function G(e){return e.replace(X,"ms-").replace(U,V)}var Y=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function Q(){this.expando=w.expando+Q.uid++}Q.uid=1,Q.prototype={cache:function(e){var t=e[this.expando];return t||(t={},Y(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[G(t)]=n;else for(r in t)i[G(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][G(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(G):(t=G(t))in r?[t]:t.match(M)||[]).length;while(n--)delete r[t[n]]}(void 0===t||w.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var J=new Q,K=new Q,Z=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ee=/[A-Z]/g;function te(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:Z.test(e)?JSON.parse(e):e)}function ne(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(ee,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=te(n)}catch(e){}K.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return K.hasData(e)||J.hasData(e)},data:function(e,t,n){return K.access(e,t,n)},removeData:function(e,t){K.remove(e,t)},_data:function(e,t,n){return J.access(e,t,n)},_removeData:function(e,t){J.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,r,i,o=this[0],a=o&&o.attributes;if(void 0===e){if(this.length&&(i=K.get(o),1===o.nodeType&&!J.get(o,"hasDataAttrs"))){n=a.length;while(n--)a[n]&&0===(r=a[n].name).indexOf("data-")&&(r=G(r.slice(5)),ne(o,r,i[r]));J.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof e?this.each(function(){K.set(this,e)}):z(this,function(t){var n;if(o&&void 0===t){if(void 0!==(n=K.get(o,e)))return n;if(void 0!==(n=ne(o,e)))return n}else this.each(function(){K.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){K.remove(this,e)})}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=J.get(e,t),n&&(!r||Array.isArray(n)?r=J.access(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),o=w._queueHooks(e,t),a=function(){w.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return J.get(e,n)||J.access(e,n,{empty:w.Callbacks("once memory").add(function(){J.remove(e,[t+"queue",n])})})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each(function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=w.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=J.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var re=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ie=new RegExp("^(?:([+-])=|)("+re+")([a-z%]*)$","i"),oe=["Top","Right","Bottom","Left"],ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&w.contains(e.ownerDocument,e)&&"none"===w.css(e,"display")},se=function(e,t,n,r){var i,o,a={};for(o in t)a[o]=e.style[o],e.style[o]=t[o];i=n.apply(e,r||[]);for(o in t)e.style[o]=a[o];return i};function ue(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return w.css(e,t,"")},u=s(),l=n&&n[3]||(w.cssNumber[t]?"":"px"),c=(w.cssNumber[t]||"px"!==l&&+u)&&ie.exec(w.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)w.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,w.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var le={};function ce(e){var t,n=e.ownerDocument,r=e.nodeName,i=le[r];return i||(t=n.body.appendChild(n.createElement(r)),i=w.css(t,"display"),t.parentNode.removeChild(t),"none"===i&&(i="block"),le[r]=i,i)}function fe(e,t){for(var n,r,i=[],o=0,a=e.length;o<a;o++)(r=e[o]).style&&(n=r.style.display,t?("none"===n&&(i[o]=J.get(r,"display")||null,i[o]||(r.style.display="")),""===r.style.display&&ae(r)&&(i[o]=ce(r))):"none"!==n&&(i[o]="none",J.set(r,"display",n)));for(o=0;o<a;o++)null!=i[o]&&(e[o].style.display=i[o]);return e}w.fn.extend({show:function(){return fe(this,!0)},hide:function(){return fe(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?w(this).show():w(this).hide()})}});var pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,he=/^$|^module$|\/(?:java|ecma)script/i,ge={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ge.optgroup=ge.option,ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td;function ye(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&N(e,t)?w.merge([e],n):n}function ve(e,t){for(var n=0,r=e.length;n<r;n++)J.set(e[n],"globalEval",!t||J.get(t[n],"globalEval"))}var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))w.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+w.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;w.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&w.inArray(o,r)>-1)i&&i.push(o);else if(l=w.contains(o.ownerDocument,o),a=ye(f.appendChild(o),"script"),l&&ve(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}!function(){var e=r.createDocumentFragment().appendChild(r.createElement("div")),t=r.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),h.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",h.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var be=r.documentElement,we=/^key/,Te=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Ce=/^([^.]*)(?:\.(.+)|)/;function Ee(){return!0}function ke(){return!1}function Se(){try{return r.activeElement}catch(e){}}function De(e,t,n,r,i,o){var a,s;if("object"==typeof t){"string"!=typeof n&&(r=r||n,n=void 0);for(s in t)De(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=ke;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return w().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=w.guid++)),e.each(function(){w.event.add(this,t,i,r,n)})}w.event={global:{},add:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=J.get(e);if(y){n.handler&&(n=(o=n).handler,i=o.selector),i&&w.find.matchesSelector(be,i),n.guid||(n.guid=w.guid++),(u=y.events)||(u=y.events={}),(a=y.handle)||(a=y.handle=function(t){return"undefined"!=typeof w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),l=(t=(t||"").match(M)||[""]).length;while(l--)d=g=(s=Ce.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=w.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=w.event.special[d]||{},c=w.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&w.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(e,r,h,a)||e.addEventListener&&e.addEventListener(d,a)),f.add&&(f.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),w.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,y=J.hasData(e)&&J.get(e);if(y&&(u=y.events)){l=(t=(t||"").match(M)||[""]).length;while(l--)if(s=Ce.exec(t[l])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){f=w.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,y.handle)||w.removeEvent(e,d,y.handle),delete u[d])}else for(d in u)w.event.remove(e,d+t[l],n,r,!0);w.isEmptyObject(u)&&J.remove(e,"handle events")}},dispatch:function(e){var t=w.event.fix(e),n,r,i,o,a,s,u=new Array(arguments.length),l=(J.get(this,"events")||{})[t.type]||[],c=w.event.special[t.type]||{};for(u[0]=t,n=1;n<arguments.length;n++)u[n]=arguments[n];if(t.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,t)){s=w.event.handlers.call(this,t,l),n=0;while((o=s[n++])&&!t.isPropagationStopped()){t.currentTarget=o.elem,r=0;while((a=o.handlers[r++])&&!t.isImmediatePropagationStopped())t.rnamespace&&!t.rnamespace.test(a.namespace)||(t.handleObj=a,t.data=a.data,void 0!==(i=((w.event.special[a.origType]||{}).handle||a.handler).apply(o.elem,u))&&!1===(t.result=i)&&(t.preventDefault(),t.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&e.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?w(i,this).index(l)>-1:w.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:g(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==Se()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===Se()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&N(this,"input"))return this.click(),!1},_default:function(e){return N(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ee:ke,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:ke,isPropagationStopped:ke,isImmediatePropagationStopped:ke,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ee,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ee,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ee,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&we.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Te.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},w.event.addProp),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;return i&&(i===r||w.contains(r,i))||(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),w.fn.extend({on:function(e,t,n,r){return De(this,e,t,n,r)},one:function(e,t,n,r){return De(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ke),this.each(function(){w.event.remove(this,e,n,t)})}});var Ne=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Ae=/<script|<style|<link/i,je=/checked\s*(?:[^=]|=\s*.checked.)/i,qe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Le(e,t){return N(e,"table")&&N(11!==t.nodeType?t:t.firstChild,"tr")?w(e).children("tbody")[0]||e:e}function He(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Oe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Pe(e,t){var n,r,i,o,a,s,u,l;if(1===t.nodeType){if(J.hasData(e)&&(o=J.access(e),a=J.set(t,o),l=o.events)){delete a.handle,a.events={};for(i in l)for(n=0,r=l[i].length;n<r;n++)w.event.add(t,i,l[i][n])}K.hasData(e)&&(s=K.access(e),u=w.extend({},s),K.set(t,u))}}function Me(e,t){var n=t.nodeName.toLowerCase();"input"===n&&pe.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function Re(e,t,n,r){t=a.apply([],t);var i,o,s,u,l,c,f=0,p=e.length,d=p-1,y=t[0],v=g(y);if(v||p>1&&"string"==typeof y&&!h.checkClone&&je.test(y))return e.each(function(i){var o=e.eq(i);v&&(t[0]=y.call(this,i,o.html())),Re(o,t,n,r)});if(p&&(i=xe(t,e[0].ownerDocument,!1,e,r),o=i.firstChild,1===i.childNodes.length&&(i=o),o||r)){for(u=(s=w.map(ye(i,"script"),He)).length;f<p;f++)l=i,f!==d&&(l=w.clone(l,!0,!0),u&&w.merge(s,ye(l,"script"))),n.call(e[f],l,f);if(u)for(c=s[s.length-1].ownerDocument,w.map(s,Oe),f=0;f<u;f++)l=s[f],he.test(l.type||"")&&!J.access(l,"globalEval")&&w.contains(c,l)&&(l.src&&"module"!==(l.type||"").toLowerCase()?w._evalUrl&&w._evalUrl(l.src):m(l.textContent.replace(qe,""),c,l))}return e}function Ie(e,t,n){for(var r,i=t?w.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||w.cleanData(ye(r)),r.parentNode&&(n&&w.contains(r.ownerDocument,r)&&ve(ye(r,"script")),r.parentNode.removeChild(r));return e}w.extend({htmlPrefilter:function(e){return e.replace(Ne,"<$1></$2>")},clone:function(e,t,n){var r,i,o,a,s=e.cloneNode(!0),u=w.contains(e.ownerDocument,e);if(!(h.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(a=ye(s),r=0,i=(o=ye(e)).length;r<i;r++)Me(o[r],a[r]);if(t)if(n)for(o=o||ye(e),a=a||ye(s),r=0,i=o.length;r<i;r++)Pe(o[r],a[r]);else Pe(e,s);return(a=ye(s,"script")).length>0&&ve(a,!u&&ye(e,"script")),s},cleanData:function(e){for(var t,n,r,i=w.event.special,o=0;void 0!==(n=e[o]);o++)if(Y(n)){if(t=n[J.expando]){if(t.events)for(r in t.events)i[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);n[J.expando]=void 0}n[K.expando]&&(n[K.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Ie(this,e,!0)},remove:function(e){return Ie(this,e)},text:function(e){return z(this,function(e){return void 0===e?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return Re(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Le(this,e).appendChild(e)})},prepend:function(){return Re(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Le(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return Re(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return Re(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(ye(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return z(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ae.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(ye(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return Re(this,arguments,function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(ye(this)),n&&n.replaceChild(t,this))},e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){for(var n,r=[],i=w(e),o=i.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),w(i[a])[t](n),s.apply(r,n.get());return this.pushStack(r)}});var We=new RegExp("^("+re+")(?!px)[a-z%]+$","i"),$e=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Be=new RegExp(oe.join("|"),"i");!function(){function t(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",be.appendChild(l).appendChild(c);var t=e.getComputedStyle(c);i="1%"!==t.top,u=12===n(t.marginLeft),c.style.right="60%",s=36===n(t.right),o=36===n(t.width),c.style.position="absolute",a=36===c.offsetWidth||"absolute",be.removeChild(l),c=null}}function n(e){return Math.round(parseFloat(e))}var i,o,a,s,u,l=r.createElement("div"),c=r.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",h.clearCloneStyle="content-box"===c.style.backgroundClip,w.extend(h,{boxSizingReliable:function(){return t(),o},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),u},scrollboxSize:function(){return t(),a}}))}();function Fe(e,t,n){var r,i,o,a,s=e.style;return(n=n||$e(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||w.contains(e.ownerDocument,e)||(a=w.style(e,t)),!h.pixelBoxStyles()&&We.test(a)&&Be.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function _e(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}var ze=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ue={position:"absolute",visibility:"hidden",display:"block"},Ve={letterSpacing:"0",fontWeight:"400"},Ge=["Webkit","Moz","ms"],Ye=r.createElement("div").style;function Qe(e){if(e in Ye)return e;var t=e[0].toUpperCase()+e.slice(1),n=Ge.length;while(n--)if((e=Ge[n]+t)in Ye)return e}function Je(e){var t=w.cssProps[e];return t||(t=w.cssProps[e]=Qe(e)||e),t}function Ke(e,t,n){var r=ie.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ze(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=w.css(e,n+oe[a],!0,i)),r?("content"===n&&(u-=w.css(e,"padding"+oe[a],!0,i)),"margin"!==n&&(u-=w.css(e,"border"+oe[a]+"Width",!0,i))):(u+=w.css(e,"padding"+oe[a],!0,i),"padding"!==n?u+=w.css(e,"border"+oe[a]+"Width",!0,i):s+=w.css(e,"border"+oe[a]+"Width",!0,i));return!r&&o>=0&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))),u}function et(e,t,n){var r=$e(e),i=Fe(e,t,r),o="border-box"===w.css(e,"boxSizing",!1,r),a=o;if(We.test(i)){if(!n)return i;i="auto"}return a=a&&(h.boxSizingReliable()||i===e.style[t]),("auto"===i||!parseFloat(i)&&"inline"===w.css(e,"display",!1,r))&&(i=e["offset"+t[0].toUpperCase()+t.slice(1)],a=!0),(i=parseFloat(i)||0)+Ze(e,t,n||(o?"border":"content"),a,r,i)+"px"}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Fe(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=G(t),u=Xe.test(t),l=e.style;if(u||(t=Je(s)),a=w.cssHooks[t]||w.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"==(o=typeof n)&&(i=ie.exec(n))&&i[1]&&(n=ue(e,t,i),o="number"),null!=n&&n===n&&("number"===o&&(n+=i&&i[3]||(w.cssNumber[s]?"":"px")),h.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=G(t);return Xe.test(t)||(t=Je(s)),(a=w.cssHooks[t]||w.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Fe(e,t,r)),"normal"===i&&t in Ve&&(i=Ve[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),w.each(["height","width"],function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return!ze.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?et(e,t,r):se(e,Ue,function(){return et(e,t,r)})},set:function(e,n,r){var i,o=$e(e),a="border-box"===w.css(e,"boxSizing",!1,o),s=r&&Ze(e,t,r,a,o);return a&&h.scrollboxSize()===o.position&&(s-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(o[t])-Ze(e,t,"border",!1,o)-.5)),s&&(i=ie.exec(n))&&"px"!==(i[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Ke(e,n,s)}}}),w.cssHooks.marginLeft=_e(h.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Fe(e,"marginLeft"))||e.getBoundingClientRect().left-se(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];r<4;r++)i[e+oe[r]+t]=o[r]||o[r-2]||o[0];return i}},"margin"!==e&&(w.cssHooks[e+t].set=Ke)}),w.fn.extend({css:function(e,t){return z(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=$e(e),i=t.length;a<i;a++)o[t[a]]=w.css(e,t[a],!1,r);return o}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,arguments.length>1)}});function tt(e,t,n,r,i){return new tt.prototype.init(e,t,n,r,i)}w.Tween=tt,tt.prototype={constructor:tt,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(w.cssNumber[n]?"":"px")},cur:function(){var e=tt.propHooks[this.prop];return e&&e.get?e.get(this):tt.propHooks._default.get(this)},run:function(e){var t,n=tt.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):tt.propHooks._default.set(this),this}},tt.prototype.init.prototype=tt.prototype,tt.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||null==e.elem.style[w.cssProps[e.prop]]&&!w.cssHooks[e.prop]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},tt.propHooks.scrollTop=tt.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=tt.prototype.init,w.fx.step={};var nt,rt,it=/^(?:toggle|show|hide)$/,ot=/queueHooks$/;function at(){rt&&(!1===r.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(at):e.setTimeout(at,w.fx.interval),w.fx.tick())}function st(){return e.setTimeout(function(){nt=void 0}),nt=Date.now()}function ut(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=oe[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function lt(e,t,n){for(var r,i=(pt.tweeners[t]||[]).concat(pt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function ct(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),y=J.get(e,"fxshow");n.queue||(null==(a=w._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,w.queue(e,"fx").length||a.empty.fire()})}));for(r in t)if(i=t[r],it.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!y||void 0===y[r])continue;g=!0}d[r]=y&&y[r]||w.style(e,r)}if((u=!w.isEmptyObject(t))||!w.isEmptyObject(d)){f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=y&&y.display)&&(l=J.get(e,"display")),"none"===(c=w.css(e,"display"))&&(l?c=l:(fe([e],!0),l=e.style.display||l,c=w.css(e,"display"),fe([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===w.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1;for(r in d)u||(y?"hidden"in y&&(g=y.hidden):y=J.access(e,"fxshow",{display:l}),o&&(y.hidden=!g),g&&fe([e],!0),p.done(function(){g||fe([e]),J.remove(e,"fxshow");for(r in d)w.style(e,r,d[r])})),u=lt(g?y[r]:0,r,p),r in y||(y[r]=u.start,g&&(u.end=u.start,u.start=0))}}function ft(e,t){var n,r,i,o,a;for(n in e)if(r=G(n),i=t[r],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=w.cssHooks[r])&&"expand"in a){o=a.expand(o),delete e[r];for(n in o)n in e||(e[n]=o[n],t[n]=i)}else t[r]=i}function pt(e,t,n){var r,i,o=0,a=pt.prefilters.length,s=w.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var t=nt||st(),n=Math.max(0,l.startTime+l.duration-t),r=1-(n/l.duration||0),o=0,a=l.tweens.length;o<a;o++)l.tweens[o].run(r);return s.notifyWith(e,[l,r,n]),r<1&&a?n:(a||s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l]),!1)},l=s.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:nt||st(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,l.opts,t,n,l.opts.specialEasing[t]||l.opts.easing);return l.tweens.push(r),r},stop:function(t){var n=0,r=t?l.tweens.length:0;if(i)return this;for(i=!0;n<r;n++)l.tweens[n].run(1);return t?(s.notifyWith(e,[l,1,0]),s.resolveWith(e,[l,t])):s.rejectWith(e,[l,t]),this}}),c=l.props;for(ft(c,l.opts.specialEasing);o<a;o++)if(r=pt.prefilters[o].call(l,e,c,l.opts))return g(r.stop)&&(w._queueHooks(l.elem,l.opts.queue).stop=r.stop.bind(r)),r;return w.map(c,lt,l),g(l.opts.start)&&l.opts.start.call(e,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),w.fx.timer(w.extend(u,{elem:e,anim:l,queue:l.opts.queue})),l}w.Animation=w.extend(pt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return ue(n.elem,e,ie.exec(t),n),n}]},tweener:function(e,t){g(e)?(t=e,e=["*"]):e=e.match(M);for(var n,r=0,i=e.length;r<i;r++)n=e[r],pt.tweeners[n]=pt.tweeners[n]||[],pt.tweeners[n].unshift(t)},prefilters:[ct],prefilter:function(e,t){t?pt.prefilters.unshift(e):pt.prefilters.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||g(e)&&e,duration:e,easing:n&&t||t&&!g(t)&&t};return w.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in w.fx.speeds?r.duration=w.fx.speeds[r.duration]:r.duration=w.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){g(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),o=w.speed(t,n,r),a=function(){var t=pt(this,w.extend({},e),o);(i||J.get(this,"finish"))&&t.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",o=w.timers,a=J.get(this);if(i)a[i]&&a[i].stop&&r(a[i]);else for(i in a)a[i]&&a[i].stop&&ot.test(i)&&r(a[i]);for(i=o.length;i--;)o[i].elem!==this||null!=e&&o[i].queue!==e||(o[i].anim.stop(n),t=!1,o.splice(i,1));!t&&n||w.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=J.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=w.timers,a=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;t<a;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ut(t,!0),e,r,i)}}),w.each({slideDown:ut("show"),slideUp:ut("hide"),slideToggle:ut("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(nt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),nt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){rt||(rt=!0,at())},w.fx.stop=function(){rt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx?w.fx.speeds[t]||t:t,n=n||"fx",this.queue(n,function(n,r){var i=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(i)}})},function(){var e=r.createElement("input"),t=r.createElement("select").appendChild(r.createElement("option"));e.type="checkbox",h.checkOn=""!==e.value,h.optSelected=t.selected,(e=r.createElement("input")).value="t",e.type="radio",h.radioValue="t"===e.value}();var dt,ht=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return z(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?w.prop(e,t,n):(1===o&&w.isXMLDoc(e)||(i=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?dt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!h.radioValue&&"radio"===t&&N(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(M);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),dt={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ht[t]||w.find.attr;ht[t]=function(e,t,r){var i,o,a=t.toLowerCase();return r||(o=ht[a],ht[a]=i,i=null!=n(e,t,r)?a:null,ht[a]=o),i}});var gt=/^(?:input|select|textarea|button)$/i,yt=/^(?:a|area)$/i;w.fn.extend({prop:function(e,t){return z(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&w.isXMLDoc(e)||(t=w.propFix[t]||t,i=w.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):gt.test(e.nodeName)||yt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),h.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this});function vt(e){return(e.match(M)||[]).join(" ")}function mt(e){return e.getAttribute&&e.getAttribute("class")||""}function xt(e){return Array.isArray(e)?e:"string"==typeof e?e.match(M)||[]:[]}w.fn.extend({addClass:function(e){var t,n,r,i,o,a,s,u=0;if(g(e))return this.each(function(t){w(this).addClass(e.call(this,t,mt(this)))});if((t=xt(e)).length)while(n=this[u++])if(i=mt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=t[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,i,o,a,s,u=0;if(g(e))return this.each(function(t){w(this).removeClass(e.call(this,t,mt(this)))});if(!arguments.length)return this.attr("class","");if((t=xt(e)).length)while(n=this[u++])if(i=mt(n),r=1===n.nodeType&&" "+vt(i)+" "){a=0;while(o=t[a++])while(r.indexOf(" "+o+" ")>-1)r=r.replace(" "+o+" "," ");i!==(s=vt(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=typeof e,r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):g(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,mt(this),t),t)}):this.each(function(){var t,i,o,a;if(r){i=0,o=w(this),a=xt(e);while(t=a[i++])o.hasClass(t)?o.removeClass(t):o.addClass(t)}else void 0!==e&&"boolean"!==n||((t=mt(this))&&J.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":J.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&(" "+vt(mt(n))+" ").indexOf(t)>-1)return!0;return!1}});var bt=/\r/g;w.fn.extend({val:function(e){var t,n,r,i=this[0];{if(arguments.length)return r=g(e),this.each(function(n){var i;1===this.nodeType&&(null==(i=r?e.call(this,n,w(this).val()):e)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=w.map(i,function(e){return null==e?"":e+""})),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,i,"value")||(this.value=i))});if(i)return(t=w.valHooks[i.type]||w.valHooks[i.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(i,"value"))?n:"string"==typeof(n=i.value)?n.replace(bt,""):null==n?"":n}}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:vt(w.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!N(n.parentNode,"optgroup"))){if(t=w(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=w.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=w.inArray(w.valHooks.option.get(r),o)>-1)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},h.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),h.focusin="onfocusin"in e;var wt=/^(?:focusinfocus|focusoutblur)$/,Tt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,i,o){var a,s,u,l,c,p,d,h,v=[i||r],m=f.call(t,"type")?t.type:t,x=f.call(t,"namespace")?t.namespace.split("."):[];if(s=h=u=i=i||r,3!==i.nodeType&&8!==i.nodeType&&!wt.test(m+w.event.triggered)&&(m.indexOf(".")>-1&&(m=(x=m.split(".")).shift(),x.sort()),c=m.indexOf(":")<0&&"on"+m,t=t[w.expando]?t:new w.Event(m,"object"==typeof t&&t),t.isTrigger=o?2:3,t.namespace=x.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+x.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:w.makeArray(n,[t]),d=w.event.special[m]||{},o||!d.trigger||!1!==d.trigger.apply(i,n))){if(!o&&!d.noBubble&&!y(i)){for(l=d.delegateType||m,wt.test(l+m)||(s=s.parentNode);s;s=s.parentNode)v.push(s),u=s;u===(i.ownerDocument||r)&&v.push(u.defaultView||u.parentWindow||e)}a=0;while((s=v[a++])&&!t.isPropagationStopped())h=s,t.type=a>1?l:d.bindType||m,(p=(J.get(s,"events")||{})[t.type]&&J.get(s,"handle"))&&p.apply(s,n),(p=c&&s[c])&&p.apply&&Y(s)&&(t.result=p.apply(s,n),!1===t.result&&t.preventDefault());return t.type=m,o||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(v.pop(),n)||!Y(i)||c&&g(i[m])&&!y(i)&&((u=i[c])&&(i[c]=null),w.event.triggered=m,t.isPropagationStopped()&&h.addEventListener(m,Tt),i[m](),t.isPropagationStopped()&&h.removeEventListener(m,Tt),w.event.triggered=void 0,u&&(i[c]=u)),t.result}},simulate:function(e,t,n){var r=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(r,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),h.focusin||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var r=this.ownerDocument||this,i=J.access(r,t);i||r.addEventListener(e,n,!0),J.access(r,t,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=J.access(r,t)-1;i?J.access(r,t,i):(r.removeEventListener(e,n,!0),J.remove(r,t))}}});var Ct=e.location,Et=Date.now(),kt=/\?/;w.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+t),n};var St=/\[\]$/,Dt=/\r?\n/g,Nt=/^(?:submit|button|image|reset|file)$/i,At=/^(?:input|select|textarea|keygen)/i;function jt(e,t,n,r){var i;if(Array.isArray(t))w.each(t,function(t,i){n||St.test(e)?r(e,i):jt(e+"["+("object"==typeof i&&null!=i?t:"")+"]",i,n,r)});else if(n||"object"!==x(t))r(e,t);else for(i in t)jt(e+"["+i+"]",t[i],n,r)}w.param=function(e,t){var n,r=[],i=function(e,t){var n=g(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){i(this.name,this.value)});else for(n in e)jt(n,e[n],t,i);return r.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&At.test(this.nodeName)&&!Nt.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:n.replace(Dt,"\r\n")}}).get()}});var qt=/%20/g,Lt=/#.*$/,Ht=/([?&])_=[^&]*/,Ot=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Mt=/^(?:GET|HEAD)$/,Rt=/^\/\//,It={},Wt={},$t="*/".concat("*"),Bt=r.createElement("a");Bt.href=Ct.href;function Ft(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(M)||[];if(g(n))while(r=o[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function _t(e,t,n,r){var i={},o=e===Wt;function a(s){var u;return i[s]=!0,w.each(e[s]||[],function(e,s){var l=s(t,n,r);return"string"!=typeof l||o||i[l]?o?!(u=l):void 0:(t.dataTypes.unshift(l),a(l),!1)}),u}return a(t.dataTypes[0])||!i["*"]&&a("*")}function zt(e,t){var n,r,i=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&w.extend(!0,e,r),e}function Xt(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}function Ut(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ct.href,type:"GET",isLocal:Pt.test(Ct.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$t,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?zt(zt(e,w.ajaxSettings),t):zt(w.ajaxSettings,e)},ajaxPrefilter:Ft(It),ajaxTransport:Ft(Wt),ajax:function(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,o,a,s,u,l,c,f,p,d,h=w.ajaxSetup({},n),g=h.context||h,y=h.context&&(g.nodeType||g.jquery)?w(g):w.event,v=w.Deferred(),m=w.Callbacks("once memory"),x=h.statusCode||{},b={},T={},C="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(c){if(!s){s={};while(t=Ot.exec(a))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return c?a:null},setRequestHeader:function(e,t){return null==c&&(e=T[e.toLowerCase()]=T[e.toLowerCase()]||e,b[e]=t),this},overrideMimeType:function(e){return null==c&&(h.mimeType=e),this},statusCode:function(e){var t;if(e)if(c)E.always(e[E.status]);else for(t in e)x[t]=[x[t],e[t]];return this},abort:function(e){var t=e||C;return i&&i.abort(t),k(0,t),this}};if(v.promise(E),h.url=((t||h.url||Ct.href)+"").replace(Rt,Ct.protocol+"//"),h.type=n.method||n.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(M)||[""],null==h.crossDomain){l=r.createElement("a");try{l.href=h.url,l.href=l.href,h.crossDomain=Bt.protocol+"//"+Bt.host!=l.protocol+"//"+l.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=w.param(h.data,h.traditional)),_t(It,h,n,E),c)return E;(f=w.event&&h.global)&&0==w.active++&&w.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!Mt.test(h.type),o=h.url.replace(Lt,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(qt,"+")):(d=h.url.slice(o.length),h.data&&(h.processData||"string"==typeof h.data)&&(o+=(kt.test(o)?"&":"?")+h.data,delete h.data),!1===h.cache&&(o=o.replace(Ht,"$1"),d=(kt.test(o)?"&":"?")+"_="+Et+++d),h.url=o+d),h.ifModified&&(w.lastModified[o]&&E.setRequestHeader("If-Modified-Since",w.lastModified[o]),w.etag[o]&&E.setRequestHeader("If-None-Match",w.etag[o])),(h.data&&h.hasContent&&!1!==h.contentType||n.contentType)&&E.setRequestHeader("Content-Type",h.contentType),E.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+$t+"; q=0.01":""):h.accepts["*"]);for(p in h.headers)E.setRequestHeader(p,h.headers[p]);if(h.beforeSend&&(!1===h.beforeSend.call(g,E,h)||c))return E.abort();if(C="abort",m.add(h.complete),E.done(h.success),E.fail(h.error),i=_t(Wt,h,n,E)){if(E.readyState=1,f&&y.trigger("ajaxSend",[E,h]),c)return E;h.async&&h.timeout>0&&(u=e.setTimeout(function(){E.abort("timeout")},h.timeout));try{c=!1,i.send(b,k)}catch(e){if(c)throw e;k(-1,e)}}else k(-1,"No Transport");function k(t,n,r,s){var l,p,d,b,T,C=n;c||(c=!0,u&&e.clearTimeout(u),i=void 0,a=s||"",E.readyState=t>0?4:0,l=t>=200&&t<300||304===t,r&&(b=Xt(h,E,r)),b=Ut(h,b,E,l),l?(h.ifModified&&((T=E.getResponseHeader("Last-Modified"))&&(w.lastModified[o]=T),(T=E.getResponseHeader("etag"))&&(w.etag[o]=T)),204===t||"HEAD"===h.type?C="nocontent":304===t?C="notmodified":(C=b.state,p=b.data,l=!(d=b.error))):(d=C,!t&&C||(C="error",t<0&&(t=0))),E.status=t,E.statusText=(n||C)+"",l?v.resolveWith(g,[p,C,E]):v.rejectWith(g,[E,C,d]),E.statusCode(x),x=void 0,f&&y.trigger(l?"ajaxSuccess":"ajaxError",[E,h,l?p:d]),m.fireWith(g,[E,C]),f&&(y.trigger("ajaxComplete",[E,h]),--w.active||w.event.trigger("ajaxStop")))}return E},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,t){w[t]=function(e,n,r,i){return g(n)&&(i=i||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:i,data:n,success:r},w.isPlainObject(e)&&e))}}),w._evalUrl=function(e){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,"throws":!0})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(g(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return g(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=g(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Vt={0:200,1223:204},Gt=w.ajaxSettings.xhr();h.cors=!!Gt&&"withCredentials"in Gt,h.ajax=Gt=!!Gt,w.ajaxTransport(function(t){var n,r;if(h.cors||Gt&&!t.crossDomain)return{send:function(i,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(a in i)s.setRequestHeader(a,i[a]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(Vt[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),w.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,o){t=w("<script>").prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)}),r.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Yt=[],Qt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Yt.pop()||w.expando+"_"+Et++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(t,n,r){var i,o,a,s=!1!==t.jsonp&&(Qt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Qt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return i=t.jsonpCallback=g(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Qt,"$1"+i):!1!==t.jsonp&&(t.url+=(kt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return a||w.error(i+" was not called"),a[0]},t.dataTypes[0]="json",o=e[i],e[i]=function(){a=arguments},r.always(function(){void 0===o?w(e).removeProp(i):e[i]=o,t[i]&&(t.jsonpCallback=n.jsonpCallback,Yt.push(i)),a&&g(o)&&o(a[0]),a=o=void 0}),"script"}),h.createHTMLDocument=function(){var e=r.implementation.createHTMLDocument("").body;return e.innerHTML="<form></form><form></form>",2===e.childNodes.length}(),w.parseHTML=function(e,t,n){if("string"!=typeof e)return[];"boolean"==typeof t&&(n=t,t=!1);var i,o,a;return t||(h.createHTMLDocument?((i=(t=r.implementation.createHTMLDocument("")).createElement("base")).href=r.location.href,t.head.appendChild(i)):t=r),o=A.exec(e),a=!n&&[],o?[t.createElement(o[1])]:(o=xe([e],t,a),a&&a.length&&w(a).remove(),w.merge([],o.childNodes))},w.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return s>-1&&(r=vt(e.slice(s)),e=e.slice(0,s)),g(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),a.length>0&&w.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.expr.pseudos.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length},w.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l,c=w.css(e,"position"),f=w(e),p={};"static"===c&&(e.style.position="relative"),s=f.offset(),o=w.css(e,"top"),u=w.css(e,"left"),(l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1)?(a=(r=f.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),g(t)&&(t=t.call(e,n,w.extend({},s))),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+i),"using"in t?t.using.call(e,p):f.css(p)}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){w.offset.setOffset(this,e,t)});var t,n,r=this[0];if(r)return r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===w.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),i.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-w.css(r,"marginTop",!0),left:t.left-i.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===w.css(e,"position"))e=e.offsetParent;return e||be})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;w.fn[e]=function(r){return z(this,function(e,r,i){var o;if(y(e)?o=e:9===e.nodeType&&(o=e.defaultView),void 0===i)return o?o[t]:e[r];o?o.scrollTo(n?o.pageXOffset:i,n?i:o.pageYOffset):e[r]=i},e,r,arguments.length)}}),w.each(["top","left"],function(e,t){w.cssHooks[t]=_e(h.pixelPosition,function(e,n){if(n)return n=Fe(e,t),We.test(n)?w(e).position()[t]+"px":n})}),w.each({Height:"height",Width:"width"},function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){w.fn[r]=function(i,o){var a=arguments.length&&(n||"boolean"!=typeof i),s=n||(!0===i||!0===o?"margin":"border");return z(this,function(t,n,i){var o;return y(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?w.css(t,n,s):w.style(t,n,i,s)},t,a?i:void 0,a)}})}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}}),w.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),g(e))return r=o.call(arguments,2),i=function(){return e.apply(t||this,r.concat(o.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=N,w.isFunction=g,w.isWindow=y,w.camelCase=G,w.type=x,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},"function"==typeof define&&define.amd&&define("jquery",[],function(){return w});var Jt=e.jQuery,Kt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=Kt),t&&e.jQuery===w&&(e.jQuery=Jt),w},t||(e.jQuery=e.$=w),w});

;// https://d3js.org v5.9.1 Copyright 2019 Mike Bostock
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.d3=t.d3||{})}(this,function(t){"use strict";function n(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function e(t){var e;return 1===t.length&&(e=t,t=function(t,r){return n(e(t),r)}),{left:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)<0?r=o+1:i=o}return r},right:function(n,e,r,i){for(null==r&&(r=0),null==i&&(i=n.length);r<i;){var o=r+i>>>1;t(n[o],e)>0?i=o:r=o+1}return r}}}var r=e(n),i=r.right,o=r.left;function a(t,n){return[t,n]}function u(t){return null===t?NaN:+t}function c(t,n){var e,r,i=t.length,o=0,a=-1,c=0,f=0;if(null==n)for(;++a<i;)isNaN(e=u(t[a]))||(f+=(r=e-c)*(e-(c+=r/++o)));else for(;++a<i;)isNaN(e=u(n(t[a],a,t)))||(f+=(r=e-c)*(e-(c+=r/++o)));if(o>1)return f/(o-1)}function f(t,n){var e=c(t,n);return e?Math.sqrt(e):e}function s(t,n){var e,r,i,o=t.length,a=-1;if(null==n){for(;++a<o;)if(null!=(e=t[a])&&e>=e)for(r=i=e;++a<o;)null!=(e=t[a])&&(r>e&&(r=e),i<e&&(i=e))}else for(;++a<o;)if(null!=(e=n(t[a],a,t))&&e>=e)for(r=i=e;++a<o;)null!=(e=n(t[a],a,t))&&(r>e&&(r=e),i<e&&(i=e));return[r,i]}var l=Array.prototype,h=l.slice,d=l.map;function p(t){return function(){return t}}function v(t){return t}function g(t,n,e){t=+t,n=+n,e=(i=arguments.length)<2?(n=t,t=0,1):i<3?1:+e;for(var r=-1,i=0|Math.max(0,Math.ceil((n-t)/e)),o=new Array(i);++r<i;)o[r]=t+r*e;return o}var y=Math.sqrt(50),_=Math.sqrt(10),b=Math.sqrt(2);function m(t,n,e){var r,i,o,a,u=-1;if(e=+e,(t=+t)===(n=+n)&&e>0)return[t];if((r=n<t)&&(i=t,t=n,n=i),0===(a=x(t,n,e))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),n=Math.floor(n/a),o=new Array(i=Math.ceil(n-t+1));++u<i;)o[u]=(t+u)*a;else for(t=Math.floor(t*a),n=Math.ceil(n*a),o=new Array(i=Math.ceil(t-n+1));++u<i;)o[u]=(t-u)/a;return r&&o.reverse(),o}function x(t,n,e){var r=(n-t)/Math.max(0,e),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=y?10:o>=_?5:o>=b?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=y?10:o>=_?5:o>=b?2:1)}function w(t,n,e){var r=Math.abs(n-t)/Math.max(0,e),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=y?i*=10:o>=_?i*=5:o>=b&&(i*=2),n<t?-i:i}function M(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function N(t,n,e){if(null==e&&(e=u),r=t.length){if((n=+n)<=0||r<2)return+e(t[0],0,t);if(n>=1)return+e(t[r-1],r-1,t);var r,i=(r-1)*n,o=Math.floor(i),a=+e(t[o],o,t);return a+(+e(t[o+1],o+1,t)-a)*(i-o)}}function A(t,n){var e,r,i=t.length,o=-1;if(null==n){for(;++o<i;)if(null!=(e=t[o])&&e>=e)for(r=e;++o<i;)null!=(e=t[o])&&e>r&&(r=e)}else for(;++o<i;)if(null!=(e=n(t[o],o,t))&&e>=e)for(r=e;++o<i;)null!=(e=n(t[o],o,t))&&e>r&&(r=e);return r}function T(t){for(var n,e,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(e=new Array(a);--i>=0;)for(n=(r=t[i]).length;--n>=0;)e[--a]=r[n];return e}function S(t,n){var e,r,i=t.length,o=-1;if(null==n){for(;++o<i;)if(null!=(e=t[o])&&e>=e)for(r=e;++o<i;)null!=(e=t[o])&&r>e&&(r=e)}else for(;++o<i;)if(null!=(e=n(t[o],o,t))&&e>=e)for(r=e;++o<i;)null!=(e=n(t[o],o,t))&&r>e&&(r=e);return r}function k(t){if(!(i=t.length))return[];for(var n=-1,e=S(t,E),r=new Array(e);++n<e;)for(var i,o=-1,a=r[n]=new Array(i);++o<i;)a[o]=t[o][n];return r}function E(t){return t.length}var C=Array.prototype.slice;function P(t){return t}var z=1,R=2,D=3,q=4,L=1e-6;function U(t){return"translate("+(t+.5)+",0)"}function O(t){return"translate(0,"+(t+.5)+")"}function B(){return!this.__axis}function Y(t,n){var e=[],r=null,i=null,o=6,a=6,u=3,c=t===z||t===q?-1:1,f=t===q||t===R?"x":"y",s=t===z||t===D?U:O;function l(l){var h=null==r?n.ticks?n.ticks.apply(n,e):n.domain():r,d=null==i?n.tickFormat?n.tickFormat.apply(n,e):P:i,p=Math.max(o,0)+u,v=n.range(),g=+v[0]+.5,y=+v[v.length-1]+.5,_=(n.bandwidth?function(t){var n=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(n=Math.round(n)),function(e){return+t(e)+n}}:function(t){return function(n){return+t(n)}})(n.copy()),b=l.selection?l.selection():l,m=b.selectAll(".domain").data([null]),x=b.selectAll(".tick").data(h,n).order(),w=x.exit(),M=x.enter().append("g").attr("class","tick"),N=x.select("line"),A=x.select("text");m=m.merge(m.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(M),N=N.merge(M.append("line").attr("stroke","currentColor").attr(f+"2",c*o)),A=A.merge(M.append("text").attr("fill","currentColor").attr(f,c*p).attr("dy",t===z?"0em":t===D?"0.71em":"0.32em")),l!==b&&(m=m.transition(l),x=x.transition(l),N=N.transition(l),A=A.transition(l),w=w.transition(l).attr("opacity",L).attr("transform",function(t){return isFinite(t=_(t))?s(t):this.getAttribute("transform")}),M.attr("opacity",L).attr("transform",function(t){var n=this.parentNode.__axis;return s(n&&isFinite(n=n(t))?n:_(t))})),w.remove(),m.attr("d",t===q||t==R?a?"M"+c*a+","+g+"H0.5V"+y+"H"+c*a:"M0.5,"+g+"V"+y:a?"M"+g+","+c*a+"V0.5H"+y+"V"+c*a:"M"+g+",0.5H"+y),x.attr("opacity",1).attr("transform",function(t){return s(_(t))}),N.attr(f+"2",c*o),A.attr(f,c*p).text(d),b.filter(B).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===R?"start":t===q?"end":"middle"),b.each(function(){this.__axis=_})}return l.scale=function(t){return arguments.length?(n=t,l):n},l.ticks=function(){return e=C.call(arguments),l},l.tickArguments=function(t){return arguments.length?(e=null==t?[]:C.call(t),l):e.slice()},l.tickValues=function(t){return arguments.length?(r=null==t?null:C.call(t),l):r&&r.slice()},l.tickFormat=function(t){return arguments.length?(i=t,l):i},l.tickSize=function(t){return arguments.length?(o=a=+t,l):o},l.tickSizeInner=function(t){return arguments.length?(o=+t,l):o},l.tickSizeOuter=function(t){return arguments.length?(a=+t,l):a},l.tickPadding=function(t){return arguments.length?(u=+t,l):u},l}var F={value:function(){}};function I(){for(var t,n=0,e=arguments.length,r={};n<e;++n){if(!(t=arguments[n]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new j(r)}function j(t){this._=t}function H(t,n){for(var e,r=0,i=t.length;r<i;++r)if((e=t[r]).name===n)return e.value}function X(t,n,e){for(var r=0,i=t.length;r<i;++r)if(t[r].name===n){t[r]=F,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=e&&t.push({name:n,value:e}),t}j.prototype=I.prototype={constructor:j,on:function(t,n){var e,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var n="",e=t.indexOf(".");if(e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})),a=-1,u=o.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++a<u;)if(e=(t=o[a]).type)i[e]=X(i[e],t.name,n);else if(null==n)for(e in i)i[e]=X(i[e],t.name,null);return this}for(;++a<u;)if((e=(t=o[a]).type)&&(e=H(i[e],t.name)))return e},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new j(t)},call:function(t,n){if((e=arguments.length-2)>0)for(var e,r,i=new Array(e),o=0;o<e;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,e=(r=this._[t]).length;o<e;++o)r[o].value.apply(n,i)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(n,e)}};var G="http://www.w3.org/1999/xhtml",V={svg:"http://www.w3.org/2000/svg",xhtml:G,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function $(t){var n=t+="",e=n.indexOf(":");return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),V.hasOwnProperty(n)?{space:V[n],local:t}:t}function W(t){var n=$(t);return(n.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===G&&n.documentElement.namespaceURI===G?n.createElement(t):n.createElementNS(e,t)}})(n)}function Z(){}function Q(t){return null==t?Z:function(){return this.querySelector(t)}}function J(){return[]}function K(t){return null==t?J:function(){return this.querySelectorAll(t)}}function tt(t){return function(){return this.matches(t)}}function nt(t){return new Array(t.length)}function et(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}et.prototype={constructor:et,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var rt="$";function it(t,n,e,r,i,o){for(var a,u=0,c=n.length,f=o.length;u<f;++u)(a=n[u])?(a.__data__=o[u],r[u]=a):e[u]=new et(t,o[u]);for(;u<c;++u)(a=n[u])&&(i[u]=a)}function ot(t,n,e,r,i,o,a){var u,c,f,s={},l=n.length,h=o.length,d=new Array(l);for(u=0;u<l;++u)(c=n[u])&&(d[u]=f=rt+a.call(c,c.__data__,u,n),f in s?i[u]=c:s[f]=c);for(u=0;u<h;++u)(c=s[f=rt+a.call(t,o[u],u,o)])?(r[u]=c,c.__data__=o[u],s[f]=null):e[u]=new et(t,o[u]);for(u=0;u<l;++u)(c=n[u])&&s[d[u]]===c&&(i[u]=c)}function at(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function ut(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ct(t,n){return t.style.getPropertyValue(n)||ut(t).getComputedStyle(t,null).getPropertyValue(n)}function ft(t){return t.trim().split(/^|\s+/)}function st(t){return t.classList||new lt(t)}function lt(t){this._node=t,this._names=ft(t.getAttribute("class")||"")}function ht(t,n){for(var e=st(t),r=-1,i=n.length;++r<i;)e.add(n[r])}function dt(t,n){for(var e=st(t),r=-1,i=n.length;++r<i;)e.remove(n[r])}function pt(){this.textContent=""}function vt(){this.innerHTML=""}function gt(){this.nextSibling&&this.parentNode.appendChild(this)}function yt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function _t(){return null}function bt(){var t=this.parentNode;t&&t.removeChild(this)}function mt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function xt(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}lt.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var wt={};(t.event=null,"undefined"!=typeof document)&&("onmouseenter"in document.documentElement||(wt={mouseenter:"mouseover",mouseleave:"mouseout"}));function Mt(t,n,e){return t=Nt(t,n,e),function(n){var e=n.relatedTarget;e&&(e===this||8&e.compareDocumentPosition(this))||t.call(this,n)}}function Nt(n,e,r){return function(i){var o=t.event;t.event=i;try{n.call(this,this.__data__,e,r)}finally{t.event=o}}}function At(t){return function(){var n=this.__on;if(n){for(var e,r=0,i=-1,o=n.length;r<o;++r)e=n[r],t.type&&e.type!==t.type||e.name!==t.name?n[++i]=e:this.removeEventListener(e.type,e.listener,e.capture);++i?n.length=i:delete this.__on}}}function Tt(t,n,e){var r=wt.hasOwnProperty(t.type)?Mt:Nt;return function(i,o,a){var u,c=this.__on,f=r(n,o,a);if(c)for(var s=0,l=c.length;s<l;++s)if((u=c[s]).type===t.type&&u.name===t.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=f,u.capture=e),void(u.value=n);this.addEventListener(t.type,f,e),u={type:t.type,name:t.name,value:n,listener:f,capture:e},c?c.push(u):this.__on=[u]}}function St(n,e,r,i){var o=t.event;n.sourceEvent=t.event,t.event=n;try{return e.apply(r,i)}finally{t.event=o}}function kt(t,n,e){var r=ut(t),i=r.CustomEvent;"function"==typeof i?i=new i(n,e):(i=r.document.createEvent("Event"),e?(i.initEvent(n,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(n,!1,!1)),t.dispatchEvent(i)}var Et=[null];function Ct(t,n){this._groups=t,this._parents=n}function Pt(){return new Ct([[document.documentElement]],Et)}function zt(t){return"string"==typeof t?new Ct([[document.querySelector(t)]],[document.documentElement]):new Ct([[t]],Et)}Ct.prototype=Pt.prototype={constructor:Ct,select:function(t){"function"!=typeof t&&(t=Q(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a,u=n[i],c=u.length,f=r[i]=new Array(c),s=0;s<c;++s)(o=u[s])&&(a=t.call(o,o.__data__,s,u))&&("__data__"in o&&(a.__data__=o.__data__),f[s]=a);return new Ct(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=K(t));for(var n=this._groups,e=n.length,r=[],i=[],o=0;o<e;++o)for(var a,u=n[o],c=u.length,f=0;f<c;++f)(a=u[f])&&(r.push(t.call(a,a.__data__,f,u)),i.push(a));return new Ct(r,i)},filter:function(t){"function"!=typeof t&&(t=tt(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],f=0;f<u;++f)(o=a[f])&&t.call(o,o.__data__,f,a)&&c.push(o);return new Ct(r,this._parents)},data:function(t,n){if(!t)return p=new Array(this.size()),s=-1,this.each(function(t){p[++s]=t}),p;var e,r=n?ot:it,i=this._parents,o=this._groups;"function"!=typeof t&&(e=t,t=function(){return e});for(var a=o.length,u=new Array(a),c=new Array(a),f=new Array(a),s=0;s<a;++s){var l=i[s],h=o[s],d=h.length,p=t.call(l,l&&l.__data__,s,i),v=p.length,g=c[s]=new Array(v),y=u[s]=new Array(v);r(l,h,g,y,f[s]=new Array(d),p,n);for(var _,b,m=0,x=0;m<v;++m)if(_=g[m]){for(m>=x&&(x=m+1);!(b=y[x])&&++x<v;);_._next=b||null}}return(u=new Ct(u,i))._enter=c,u._exit=f,u},enter:function(){return new Ct(this._enter||this._groups.map(nt),this._parents)},exit:function(){return new Ct(this._exit||this._groups.map(nt),this._parents)},join:function(t,n,e){var r=this.enter(),i=this,o=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=n&&(i=n(i)),null==e?o.remove():e(o),r&&i?r.merge(i).order():i},merge:function(t){for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var c,f=n[u],s=e[u],l=f.length,h=a[u]=new Array(l),d=0;d<l;++d)(c=f[d]||s[d])&&(h[d]=c);for(;u<r;++u)a[u]=n[u];return new Ct(a,this._parents)},order:function(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var r,i=t[n],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&4^r.compareDocumentPosition(a)&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function n(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}t||(t=at);for(var e=this._groups,r=e.length,i=new Array(r),o=0;o<r;++o){for(var a,u=e[o],c=u.length,f=i[o]=new Array(c),s=0;s<c;++s)(a=u[s])&&(f[s]=a);f.sort(n)}return new Ct(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),n=-1;return this.each(function(){t[++n]=this}),t},node:function(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var r=t[n],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var n=this._groups,e=0,r=n.length;e<r;++e)for(var i,o=n[e],a=0,u=o.length;a<u;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,n){var e=$(t);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((null==n?e.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof n?e.local?function(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}:function(t,n){return function(){var e=n.apply(this,arguments);null==e?this.removeAttribute(t):this.setAttribute(t,e)}}:e.local?function(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}:function(t,n){return function(){this.setAttribute(t,n)}})(e,n))},style:function(t,n,e){return arguments.length>1?this.each((null==n?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof n?function(t,n,e){return function(){var r=n.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,e)}}:function(t,n,e){return function(){this.style.setProperty(t,n,e)}})(t,n,null==e?"":e)):ct(this.node(),t)},property:function(t,n){return arguments.length>1?this.each((null==n?function(t){return function(){delete this[t]}}:"function"==typeof n?function(t,n){return function(){var e=n.apply(this,arguments);null==e?delete this[t]:this[t]=e}}:function(t,n){return function(){this[t]=n}})(t,n)):this.node()[t]},classed:function(t,n){var e=ft(t+"");if(arguments.length<2){for(var r=st(this.node()),i=-1,o=e.length;++i<o;)if(!r.contains(e[i]))return!1;return!0}return this.each(("function"==typeof n?function(t,n){return function(){(n.apply(this,arguments)?ht:dt)(this,t)}}:n?function(t){return function(){ht(this,t)}}:function(t){return function(){dt(this,t)}})(e,n))},text:function(t){return arguments.length?this.each(null==t?pt:("function"==typeof t?function(t){return function(){var n=t.apply(this,arguments);this.textContent=null==n?"":n}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?vt:("function"==typeof t?function(t){return function(){var n=t.apply(this,arguments);this.innerHTML=null==n?"":n}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(gt)},lower:function(){return this.each(yt)},append:function(t){var n="function"==typeof t?t:W(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function(t,n){var e="function"==typeof t?t:W(t),r=null==n?_t:"function"==typeof n?n:Q(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(bt)},clone:function(t){return this.select(t?xt:mt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,n,e){var r,i,o=function(t){return t.trim().split(/^|\s+/).map(function(t){var n="",e=t.indexOf(".");return e>=0&&(n=t.slice(e+1),t=t.slice(0,e)),{type:t,name:n}})}(t+""),a=o.length;if(!(arguments.length<2)){for(u=n?Tt:At,null==e&&(e=!1),r=0;r<a;++r)this.each(u(o[r],n,e));return this}var u=this.node().__on;if(u)for(var c,f=0,s=u.length;f<s;++f)for(r=0,c=u[f];r<a;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(t,n){return this.each(("function"==typeof n?function(t,n){return function(){return kt(this,t,n.apply(this,arguments))}}:function(t,n){return function(){return kt(this,t,n)}})(t,n))}};var Rt=0;function Dt(){return new qt}function qt(){this._="@"+(++Rt).toString(36)}function Lt(){for(var n,e=t.event;n=e.sourceEvent;)e=n;return e}function Ut(t,n){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=n.clientX,r.y=n.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[n.clientX-i.left-t.clientLeft,n.clientY-i.top-t.clientTop]}function Ot(t){var n=Lt();return n.changedTouches&&(n=n.changedTouches[0]),Ut(t,n)}function Bt(t,n,e){arguments.length<3&&(e=n,n=Lt().changedTouches);for(var r,i=0,o=n?n.length:0;i<o;++i)if((r=n[i]).identifier===e)return Ut(t,r);return null}function Yt(){t.event.stopImmediatePropagation()}function Ft(){t.event.preventDefault(),t.event.stopImmediatePropagation()}function It(t){var n=t.document.documentElement,e=zt(t).on("dragstart.drag",Ft,!0);"onselectstart"in n?e.on("selectstart.drag",Ft,!0):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function jt(t,n){var e=t.document.documentElement,r=zt(t).on("dragstart.drag",null);n&&(r.on("click.drag",Ft,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}function Ht(t){return function(){return t}}function Xt(t,n,e,r,i,o,a,u,c,f){this.target=t,this.type=n,this.subject=e,this.identifier=r,this.active=i,this.x=o,this.y=a,this.dx=u,this.dy=c,this._=f}function Gt(){return!t.event.button}function Vt(){return this.parentNode}function $t(n){return null==n?{x:t.event.x,y:t.event.y}:n}function Wt(){return"ontouchstart"in this}function Zt(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Qt(t,n){var e=Object.create(t.prototype);for(var r in n)e[r]=n[r];return e}function Jt(){}qt.prototype=Dt.prototype={constructor:qt,get:function(t){for(var n=this._;!(n in t);)if(!(t=t.parentNode))return;return t[n]},set:function(t,n){return t[this._]=n},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}},Xt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Kt="\\s*([+-]?\\d+)\\s*",tn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",nn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",en=/^#([0-9a-f]{3})$/,rn=/^#([0-9a-f]{6})$/,on=new RegExp("^rgb\\("+[Kt,Kt,Kt]+"\\)$"),an=new RegExp("^rgb\\("+[nn,nn,nn]+"\\)$"),un=new RegExp("^rgba\\("+[Kt,Kt,Kt,tn]+"\\)$"),cn=new RegExp("^rgba\\("+[nn,nn,nn,tn]+"\\)$"),fn=new RegExp("^hsl\\("+[tn,nn,nn]+"\\)$"),sn=new RegExp("^hsla\\("+[tn,nn,nn,tn]+"\\)$"),ln={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function hn(t){var n;return t=(t+"").trim().toLowerCase(),(n=en.exec(t))?new yn((n=parseInt(n[1],16))>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):(n=rn.exec(t))?dn(parseInt(n[1],16)):(n=on.exec(t))?new yn(n[1],n[2],n[3],1):(n=an.exec(t))?new yn(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=un.exec(t))?pn(n[1],n[2],n[3],n[4]):(n=cn.exec(t))?pn(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=fn.exec(t))?bn(n[1],n[2]/100,n[3]/100,1):(n=sn.exec(t))?bn(n[1],n[2]/100,n[3]/100,n[4]):ln.hasOwnProperty(t)?dn(ln[t]):"transparent"===t?new yn(NaN,NaN,NaN,0):null}function dn(t){return new yn(t>>16&255,t>>8&255,255&t,1)}function pn(t,n,e,r){return r<=0&&(t=n=e=NaN),new yn(t,n,e,r)}function vn(t){return t instanceof Jt||(t=hn(t)),t?new yn((t=t.rgb()).r,t.g,t.b,t.opacity):new yn}function gn(t,n,e,r){return 1===arguments.length?vn(t):new yn(t,n,e,null==r?1:r)}function yn(t,n,e,r){this.r=+t,this.g=+n,this.b=+e,this.opacity=+r}function _n(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function bn(t,n,e,r){return r<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new xn(t,n,e,r)}function mn(t,n,e,r){return 1===arguments.length?function(t){if(t instanceof xn)return new xn(t.h,t.s,t.l,t.opacity);if(t instanceof Jt||(t=hn(t)),!t)return new xn;if(t instanceof xn)return t;var n=(t=t.rgb()).r/255,e=t.g/255,r=t.b/255,i=Math.min(n,e,r),o=Math.max(n,e,r),a=NaN,u=o-i,c=(o+i)/2;return u?(a=n===o?(e-r)/u+6*(e<r):e===o?(r-n)/u+2:(n-e)/u+4,u/=c<.5?o+i:2-o-i,a*=60):u=c>0&&c<1?0:a,new xn(a,u,c,t.opacity)}(t):new xn(t,n,e,null==r?1:r)}function xn(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function wn(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}Zt(Jt,hn,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),Zt(yn,gn,Qt(Jt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new yn(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new yn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+_n(this.r)+_n(this.g)+_n(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),Zt(xn,mn,Qt(Jt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new xn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new xn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*n,i=2*e-r;return new yn(wn(t>=240?t-240:t+120,i,r),wn(t,i,r),wn(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Mn=Math.PI/180,Nn=180/Math.PI,An=.96422,Tn=1,Sn=.82521,kn=4/29,En=6/29,Cn=3*En*En,Pn=En*En*En;function zn(t){if(t instanceof Dn)return new Dn(t.l,t.a,t.b,t.opacity);if(t instanceof Fn){if(isNaN(t.h))return new Dn(t.l,0,0,t.opacity);var n=t.h*Mn;return new Dn(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)}t instanceof yn||(t=vn(t));var e,r,i=On(t.r),o=On(t.g),a=On(t.b),u=qn((.2225045*i+.7168786*o+.0606169*a)/Tn);return i===o&&o===a?e=r=u:(e=qn((.4360747*i+.3850649*o+.1430804*a)/An),r=qn((.0139322*i+.0971045*o+.7141733*a)/Sn)),new Dn(116*u-16,500*(e-u),200*(u-r),t.opacity)}function Rn(t,n,e,r){return 1===arguments.length?zn(t):new Dn(t,n,e,null==r?1:r)}function Dn(t,n,e,r){this.l=+t,this.a=+n,this.b=+e,this.opacity=+r}function qn(t){return t>Pn?Math.pow(t,1/3):t/Cn+kn}function Ln(t){return t>En?t*t*t:Cn*(t-kn)}function Un(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function On(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Bn(t){if(t instanceof Fn)return new Fn(t.h,t.c,t.l,t.opacity);if(t instanceof Dn||(t=zn(t)),0===t.a&&0===t.b)return new Fn(NaN,0,t.l,t.opacity);var n=Math.atan2(t.b,t.a)*Nn;return new Fn(n<0?n+360:n,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Yn(t,n,e,r){return 1===arguments.length?Bn(t):new Fn(t,n,e,null==r?1:r)}function Fn(t,n,e,r){this.h=+t,this.c=+n,this.l=+e,this.opacity=+r}Zt(Dn,Rn,Qt(Jt,{brighter:function(t){return new Dn(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Dn(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,e=isNaN(this.b)?t:t-this.b/200;return new yn(Un(3.1338561*(n=An*Ln(n))-1.6168667*(t=Tn*Ln(t))-.4906146*(e=Sn*Ln(e))),Un(-.9787684*n+1.9161415*t+.033454*e),Un(.0719453*n-.2289914*t+1.4052427*e),this.opacity)}})),Zt(Fn,Yn,Qt(Jt,{brighter:function(t){return new Fn(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Fn(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return zn(this).rgb()}}));var In=-.14861,jn=1.78277,Hn=-.29227,Xn=-.90649,Gn=1.97294,Vn=Gn*Xn,$n=Gn*jn,Wn=jn*Hn-Xn*In;function Zn(t,n,e,r){return 1===arguments.length?function(t){if(t instanceof Qn)return new Qn(t.h,t.s,t.l,t.opacity);t instanceof yn||(t=vn(t));var n=t.r/255,e=t.g/255,r=t.b/255,i=(Wn*r+Vn*n-$n*e)/(Wn+Vn-$n),o=r-i,a=(Gn*(e-i)-Hn*o)/Xn,u=Math.sqrt(a*a+o*o)/(Gn*i*(1-i)),c=u?Math.atan2(a,o)*Nn-120:NaN;return new Qn(c<0?c+360:c,u,i,t.opacity)}(t):new Qn(t,n,e,null==r?1:r)}function Qn(t,n,e,r){this.h=+t,this.s=+n,this.l=+e,this.opacity=+r}function Jn(t,n,e,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*n+(4-6*o+3*a)*e+(1+3*t+3*o-3*a)*r+a*i)/6}function Kn(t){var n=t.length-1;return function(e){var r=e<=0?e=0:e>=1?(e=1,n-1):Math.floor(e*n),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,u=r<n-1?t[r+2]:2*o-i;return Jn((e-r/n)*n,a,i,o,u)}}function te(t){var n=t.length;return function(e){var r=Math.floor(((e%=1)<0?++e:e)*n),i=t[(r+n-1)%n],o=t[r%n],a=t[(r+1)%n],u=t[(r+2)%n];return Jn((e-r/n)*n,i,o,a,u)}}function ne(t){return function(){return t}}function ee(t,n){return function(e){return t+e*n}}function re(t,n){var e=n-t;return e?ee(t,e>180||e<-180?e-360*Math.round(e/360):e):ne(isNaN(t)?n:t)}function ie(t){return 1==(t=+t)?oe:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(r){return Math.pow(t+r*n,e)}}(n,e,t):ne(isNaN(n)?e:n)}}function oe(t,n){var e=n-t;return e?ee(t,e):ne(isNaN(t)?n:t)}Zt(Qn,Zn,Qt(Jt,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Qn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Qn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Mn,n=+this.l,e=isNaN(this.s)?0:this.s*n*(1-n),r=Math.cos(t),i=Math.sin(t);return new yn(255*(n+e*(In*r+jn*i)),255*(n+e*(Hn*r+Xn*i)),255*(n+e*(Gn*r)),this.opacity)}}));var ae=function t(n){var e=ie(n);function r(t,n){var r=e((t=gn(t)).r,(n=gn(n)).r),i=e(t.g,n.g),o=e(t.b,n.b),a=oe(t.opacity,n.opacity);return function(n){return t.r=r(n),t.g=i(n),t.b=o(n),t.opacity=a(n),t+""}}return r.gamma=t,r}(1);function ue(t){return function(n){var e,r,i=n.length,o=new Array(i),a=new Array(i),u=new Array(i);for(e=0;e<i;++e)r=gn(n[e]),o[e]=r.r||0,a[e]=r.g||0,u[e]=r.b||0;return o=t(o),a=t(a),u=t(u),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=u(t),r+""}}}var ce=ue(Kn),fe=ue(te);function se(t,n){var e,r=n?n.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(e=0;e<i;++e)o[e]=ye(t[e],n[e]);for(;e<r;++e)a[e]=n[e];return function(t){for(e=0;e<i;++e)a[e]=o[e](t);return a}}function le(t,n){var e=new Date;return n-=t=+t,function(r){return e.setTime(t+n*r),e}}function he(t,n){return n-=t=+t,function(e){return t+n*e}}function de(t,n){var e,r={},i={};for(e in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)e in t?r[e]=ye(t[e],n[e]):i[e]=n[e];return function(t){for(e in r)i[e]=r[e](t);return i}}var pe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ve=new RegExp(pe.source,"g");function ge(t,n){var e,r,i,o=pe.lastIndex=ve.lastIndex=0,a=-1,u=[],c=[];for(t+="",n+="";(e=pe.exec(t))&&(r=ve.exec(n));)(i=r.index)>o&&(i=n.slice(o,i),u[a]?u[a]+=i:u[++a]=i),(e=e[0])===(r=r[0])?u[a]?u[a]+=r:u[++a]=r:(u[++a]=null,c.push({i:a,x:he(e,r)})),o=ve.lastIndex;return o<n.length&&(i=n.slice(o),u[a]?u[a]+=i:u[++a]=i),u.length<2?c[0]?function(t){return function(n){return t(n)+""}}(c[0].x):function(t){return function(){return t}}(n):(n=c.length,function(t){for(var e,r=0;r<n;++r)u[(e=c[r]).i]=e.x(t);return u.join("")})}function ye(t,n){var e,r=typeof n;return null==n||"boolean"===r?ne(n):("number"===r?he:"string"===r?(e=hn(n))?(n=e,ae):ge:n instanceof hn?ae:n instanceof Date?le:Array.isArray(n)?se:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?de:he)(t,n)}function _e(t,n){return n-=t=+t,function(e){return Math.round(t+n*e)}}var be,me,xe,we,Me=180/Math.PI,Ne={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ae(t,n,e,r,i,o){var a,u,c;return(a=Math.sqrt(t*t+n*n))&&(t/=a,n/=a),(c=t*e+n*r)&&(e-=t*c,r-=n*c),(u=Math.sqrt(e*e+r*r))&&(e/=u,r/=u,c/=u),t*r<n*e&&(t=-t,n=-n,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(n,t)*Me,skewX:Math.atan(c)*Me,scaleX:a,scaleY:u}}function Te(t,n,e,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var u=[],c=[];return o=t(o),a=t(a),function(t,r,i,o,a,u){if(t!==i||r!==o){var c=a.push("translate(",null,n,null,e);u.push({i:c-4,x:he(t,i)},{i:c-2,x:he(r,o)})}else(i||o)&&a.push("translate("+i+n+o+e)}(o.translateX,o.translateY,a.translateX,a.translateY,u,c),function(t,n,e,o){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),o.push({i:e.push(i(e)+"rotate(",null,r)-2,x:he(t,n)})):n&&e.push(i(e)+"rotate("+n+r)}(o.rotate,a.rotate,u,c),function(t,n,e,o){t!==n?o.push({i:e.push(i(e)+"skewX(",null,r)-2,x:he(t,n)}):n&&e.push(i(e)+"skewX("+n+r)}(o.skewX,a.skewX,u,c),function(t,n,e,r,o,a){if(t!==e||n!==r){var u=o.push(i(o)+"scale(",null,",",null,")");a.push({i:u-4,x:he(t,e)},{i:u-2,x:he(n,r)})}else 1===e&&1===r||o.push(i(o)+"scale("+e+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,u,c),o=a=null,function(t){for(var n,e=-1,r=c.length;++e<r;)u[(n=c[e]).i]=n.x(t);return u.join("")}}}var Se=Te(function(t){return"none"===t?Ne:(be||(be=document.createElement("DIV"),me=document.documentElement,xe=document.defaultView),be.style.transform=t,t=xe.getComputedStyle(me.appendChild(be),null).getPropertyValue("transform"),me.removeChild(be),Ae(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),ke=Te(function(t){return null==t?Ne:(we||(we=document.createElementNS("http://www.w3.org/2000/svg","g")),we.setAttribute("transform",t),(t=we.transform.baseVal.consolidate())?Ae((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Ne)},", ",")",")"),Ee=Math.SQRT2,Ce=2,Pe=4,ze=1e-12;function Re(t){return((t=Math.exp(t))+1/t)/2}function De(t,n){var e,r,i=t[0],o=t[1],a=t[2],u=n[0],c=n[1],f=n[2],s=u-i,l=c-o,h=s*s+l*l;if(h<ze)r=Math.log(f/a)/Ee,e=function(t){return[i+t*s,o+t*l,a*Math.exp(Ee*t*r)]};else{var d=Math.sqrt(h),p=(f*f-a*a+Pe*h)/(2*a*Ce*d),v=(f*f-a*a-Pe*h)/(2*f*Ce*d),g=Math.log(Math.sqrt(p*p+1)-p),y=Math.log(Math.sqrt(v*v+1)-v);r=(y-g)/Ee,e=function(t){var n,e=t*r,u=Re(g),c=a/(Ce*d)*(u*(n=Ee*e+g,((n=Math.exp(2*n))-1)/(n+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+c*s,o+c*l,a*u/Re(Ee*e+g)]}}return e.duration=1e3*r,e}function qe(t){return function(n,e){var r=t((n=mn(n)).h,(e=mn(e)).h),i=oe(n.s,e.s),o=oe(n.l,e.l),a=oe(n.opacity,e.opacity);return function(t){return n.h=r(t),n.s=i(t),n.l=o(t),n.opacity=a(t),n+""}}}var Le=qe(re),Ue=qe(oe);function Oe(t){return function(n,e){var r=t((n=Yn(n)).h,(e=Yn(e)).h),i=oe(n.c,e.c),o=oe(n.l,e.l),a=oe(n.opacity,e.opacity);return function(t){return n.h=r(t),n.c=i(t),n.l=o(t),n.opacity=a(t),n+""}}}var Be=Oe(re),Ye=Oe(oe);function Fe(t){return function n(e){function r(n,r){var i=t((n=Zn(n)).h,(r=Zn(r)).h),o=oe(n.s,r.s),a=oe(n.l,r.l),u=oe(n.opacity,r.opacity);return function(t){return n.h=i(t),n.s=o(t),n.l=a(Math.pow(t,e)),n.opacity=u(t),n+""}}return e=+e,r.gamma=n,r}(1)}var Ie=Fe(re),je=Fe(oe);var He,Xe,Ge=0,Ve=0,$e=0,We=1e3,Ze=0,Qe=0,Je=0,Ke="object"==typeof performance&&performance.now?performance:Date,tr="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function nr(){return Qe||(tr(er),Qe=Ke.now()+Je)}function er(){Qe=0}function rr(){this._call=this._time=this._next=null}function ir(t,n,e){var r=new rr;return r.restart(t,n,e),r}function or(){nr(),++Ge;for(var t,n=He;n;)(t=Qe-n._time)>=0&&n._call.call(null,t),n=n._next;--Ge}function ar(){Qe=(Ze=Ke.now())+Je,Ge=Ve=0;try{or()}finally{Ge=0,function(){var t,n,e=He,r=1/0;for(;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:He=n);Xe=t,cr(r)}(),Qe=0}}function ur(){var t=Ke.now(),n=t-Ze;n>We&&(Je-=n,Ze=t)}function cr(t){Ge||(Ve&&(Ve=clearTimeout(Ve)),t-Qe>24?(t<1/0&&(Ve=setTimeout(ar,t-Ke.now()-Je)),$e&&($e=clearInterval($e))):($e||(Ze=Ke.now(),$e=setInterval(ur,We)),Ge=1,tr(ar)))}function fr(t,n,e){var r=new rr;return n=null==n?0:+n,r.restart(function(e){r.stop(),t(e+n)},n,e),r}rr.prototype=ir.prototype={constructor:rr,restart:function(t,n,e){if("function"!=typeof t)throw new TypeError("callback is not a function");e=(null==e?nr():+e)+(null==n?0:+n),this._next||Xe===this||(Xe?Xe._next=this:He=this,Xe=this),this._call=t,this._time=e,cr()},stop:function(){this._call&&(this._call=null,this._time=1/0,cr())}};var sr=I("start","end","cancel","interrupt"),lr=[],hr=0,dr=1,pr=2,vr=3,gr=4,yr=5,_r=6;function br(t,n,e,r,i,o){var a=t.__transition;if(a){if(e in a)return}else t.__transition={};!function(t,n,e){var r,i=t.__transition;function o(c){var f,s,l,h;if(e.state!==dr)return u();for(f in i)if((h=i[f]).name===e.name){if(h.state===vr)return fr(o);h.state===gr?(h.state=_r,h.timer.stop(),h.on.call("interrupt",t,t.__data__,h.index,h.group),delete i[f]):+f<n&&(h.state=_r,h.timer.stop(),h.on.call("cancel",t,t.__data__,h.index,h.group),delete i[f])}if(fr(function(){e.state===vr&&(e.state=gr,e.timer.restart(a,e.delay,e.time),a(c))}),e.state=pr,e.on.call("start",t,t.__data__,e.index,e.group),e.state===pr){for(e.state=vr,r=new Array(l=e.tween.length),f=0,s=-1;f<l;++f)(h=e.tween[f].value.call(t,t.__data__,e.index,e.group))&&(r[++s]=h);r.length=s+1}}function a(n){for(var i=n<e.duration?e.ease.call(null,n/e.duration):(e.timer.restart(u),e.state=yr,1),o=-1,a=r.length;++o<a;)r[o].call(t,i);e.state===yr&&(e.on.call("end",t,t.__data__,e.index,e.group),u())}function u(){for(var r in e.state=_r,e.timer.stop(),delete i[n],i)return;delete t.__transition}i[n]=e,e.timer=ir(function(t){e.state=dr,e.timer.restart(o,e.delay,e.time),e.delay<=t&&o(t-e.delay)},0,e.time)}(t,e,{name:n,index:r,group:i,on:sr,tween:lr,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:hr})}function mr(t,n){var e=wr(t,n);if(e.state>hr)throw new Error("too late; already scheduled");return e}function xr(t,n){var e=wr(t,n);if(e.state>vr)throw new Error("too late; already running");return e}function wr(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function Mr(t,n){var e,r,i,o=t.__transition,a=!0;if(o){for(i in n=null==n?null:n+"",o)(e=o[i]).name===n?(r=e.state>pr&&e.state<yr,e.state=_r,e.timer.stop(),e.on.call(r?"interrupt":"cancel",t,t.__data__,e.index,e.group),delete o[i]):a=!1;a&&delete t.__transition}}function Nr(t,n,e){var r=t._id;return t.each(function(){var t=xr(this,r);(t.value||(t.value={}))[n]=e.apply(this,arguments)}),function(t){return wr(t,r).value[n]}}function Ar(t,n){var e;return("number"==typeof n?he:n instanceof hn?ae:(e=hn(n))?(n=e,ae):ge)(t,n)}var Tr=Pt.prototype.constructor;function Sr(t){return function(){this.style.removeProperty(t)}}var kr=0;function Er(t,n,e,r){this._groups=t,this._parents=n,this._name=e,this._id=r}function Cr(t){return Pt().transition(t)}function Pr(){return++kr}var zr=Pt.prototype;function Rr(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function Dr(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Er.prototype=Cr.prototype={constructor:Er,select:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=Q(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var u,c,f=r[a],s=f.length,l=o[a]=new Array(s),h=0;h<s;++h)(u=f[h])&&(c=t.call(u,u.__data__,h,f))&&("__data__"in u&&(c.__data__=u.__data__),l[h]=c,br(l[h],n,e,h,l,wr(u,e)));return new Er(o,this._parents,n,e)},selectAll:function(t){var n=this._name,e=this._id;"function"!=typeof t&&(t=K(t));for(var r=this._groups,i=r.length,o=[],a=[],u=0;u<i;++u)for(var c,f=r[u],s=f.length,l=0;l<s;++l)if(c=f[l]){for(var h,d=t.call(c,c.__data__,l,f),p=wr(c,e),v=0,g=d.length;v<g;++v)(h=d[v])&&br(h,n,e,v,d,p);o.push(d),a.push(c)}return new Er(o,a,n,e)},filter:function(t){"function"!=typeof t&&(t=tt(t));for(var n=this._groups,e=n.length,r=new Array(e),i=0;i<e;++i)for(var o,a=n[i],u=a.length,c=r[i]=[],f=0;f<u;++f)(o=a[f])&&t.call(o,o.__data__,f,a)&&c.push(o);return new Er(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,r=n.length,i=e.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var c,f=n[u],s=e[u],l=f.length,h=a[u]=new Array(l),d=0;d<l;++d)(c=f[d]||s[d])&&(h[d]=c);for(;u<r;++u)a[u]=n[u];return new Er(a,this._parents,this._name,this._id)},selection:function(){return new Tr(this._groups,this._parents)},transition:function(){for(var t=this._name,n=this._id,e=Pr(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],c=u.length,f=0;f<c;++f)if(a=u[f]){var s=wr(a,n);br(a,t,e,f,u,{time:s.time+s.delay+s.duration,delay:0,duration:s.duration,ease:s.ease})}return new Er(r,this._parents,t,e)},call:zr.call,nodes:zr.nodes,node:zr.node,size:zr.size,empty:zr.empty,each:zr.each,on:function(t,n){var e=this._id;return arguments.length<2?wr(this.node(),e).on.on(t):this.each(function(t,n,e){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||"start"===t})}(n)?mr:xr;return function(){var a=o(this,t),u=a.on;u!==r&&(i=(r=u).copy()).on(n,e),a.on=i}}(e,t,n))},attr:function(t,n){var e=$(t),r="transform"===e?ke:Ar;return this.attrTween(t,"function"==typeof n?(e.local?function(t,n,e){var r,i,o;return function(){var a,u,c=e(this);if(null!=c)return(a=this.getAttributeNS(t.space,t.local))===(u=c+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,c));this.removeAttributeNS(t.space,t.local)}}:function(t,n,e){var r,i,o;return function(){var a,u,c=e(this);if(null!=c)return(a=this.getAttribute(t))===(u=c+"")?null:a===r&&u===i?o:(i=u,o=n(r=a,c));this.removeAttribute(t)}})(e,r,Nr(this,"attr."+t,n)):null==n?(e.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(e):(e.local?function(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===r?i:i=n(r=a,e)}}:function(t,n,e){var r,i,o=e+"";return function(){var a=this.getAttribute(t);return a===o?null:a===r?i:i=n(r=a,e)}})(e,r,n))},attrTween:function(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(null==n)return this.tween(e,null);if("function"!=typeof n)throw new Error;var r=$(t);return this.tween(e,(r.local?function(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&function(t,n){return function(e){this.setAttributeNS(t.space,t.local,n(e))}}(t,i)),e}return i._value=n,i}:function(t,n){var e,r;function i(){var i=n.apply(this,arguments);return i!==r&&(e=(r=i)&&function(t,n){return function(e){this.setAttribute(t,n(e))}}(t,i)),e}return i._value=n,i})(r,n))},style:function(t,n,e){var r="transform"==(t+="")?Se:Ar;return null==n?this.styleTween(t,function(t,n){var e,r,i;return function(){var o=ct(this,t),a=(this.style.removeProperty(t),ct(this,t));return o===a?null:o===e&&a===r?i:i=n(e=o,r=a)}}(t,r)).on("end.style."+t,Sr(t)):"function"==typeof n?this.styleTween(t,function(t,n,e){var r,i,o;return function(){var a=ct(this,t),u=e(this),c=u+"";return null==u&&(this.style.removeProperty(t),c=u=ct(this,t)),a===c?null:a===r&&c===i?o:(i=c,o=n(r=a,u))}}(t,r,Nr(this,"style."+t,n))).each(function(t,n){var e,r,i,o,a="style."+n,u="end."+a;return function(){var c=xr(this,t),f=c.on,s=null==c.value[a]?o||(o=Sr(n)):void 0;f===e&&i===s||(r=(e=f).copy()).on(u,i=s),c.on=r}}(this._id,t)):this.styleTween(t,function(t,n,e){var r,i,o=e+"";return function(){var a=ct(this,t);return a===o?null:a===r?i:i=n(r=a,e)}}(t,r,n),e).on("end.style."+t,null)},styleTween:function(t,n,e){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==n)return this.tween(r,null);if("function"!=typeof n)throw new Error;return this.tween(r,function(t,n,e){var r,i;function o(){var o=n.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,n,e){return function(r){this.style.setProperty(t,n(r),e)}}(t,o,e)),r}return o._value=n,o}(t,n,null==e?"":e))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var n=t(this);this.textContent=null==n?"":n}}(Nr(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},remove:function(){return this.on("end.remove",(t=this._id,function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}));var t},tween:function(t,n){var e=this._id;if(t+="",arguments.length<2){for(var r,i=wr(this.node(),e).tween,o=0,a=i.length;o<a;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==n?function(t,n){var e,r;return function(){var i=xr(this,t),o=i.tween;if(o!==e)for(var a=0,u=(r=e=o).length;a<u;++a)if(r[a].name===n){(r=r.slice()).splice(a,1);break}i.tween=r}}:function(t,n,e){var r,i;if("function"!=typeof e)throw new Error;return function(){var o=xr(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var u={name:n,value:e},c=0,f=i.length;c<f;++c)if(i[c].name===n){i[c]=u;break}c===f&&i.push(u)}o.tween=i}})(e,t,n))},delay:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){mr(this,t).delay=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){mr(this,t).delay=n}})(n,t)):wr(this.node(),n).delay},duration:function(t){var n=this._id;return arguments.length?this.each(("function"==typeof t?function(t,n){return function(){xr(this,t).duration=+n.apply(this,arguments)}}:function(t,n){return n=+n,function(){xr(this,t).duration=n}})(n,t)):wr(this.node(),n).duration},ease:function(t){var n=this._id;return arguments.length?this.each(function(t,n){if("function"!=typeof n)throw new Error;return function(){xr(this,t).ease=n}}(n,t)):wr(this.node(),n).ease},end:function(){var t,n,e=this,r=e._id,i=e.size();return new Promise(function(o,a){var u={value:a},c={value:function(){0==--i&&o()}};e.each(function(){var e=xr(this,r),i=e.on;i!==t&&((n=(t=i).copy())._.cancel.push(u),n._.interrupt.push(u),n._.end.push(c)),e.on=n})})}};var qr=function t(n){function e(t){return Math.pow(t,n)}return n=+n,e.exponent=t,e}(3),Lr=function t(n){function e(t){return 1-Math.pow(1-t,n)}return n=+n,e.exponent=t,e}(3),Ur=function t(n){function e(t){return((t*=2)<=1?Math.pow(t,n):2-Math.pow(2-t,n))/2}return n=+n,e.exponent=t,e}(3),Or=Math.PI,Br=Or/2;function Yr(t){return(1-Math.cos(Or*t))/2}function Fr(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function Ir(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var jr=4/11,Hr=6/11,Xr=8/11,Gr=.75,Vr=9/11,$r=10/11,Wr=.9375,Zr=21/22,Qr=63/64,Jr=1/jr/jr;function Kr(t){return(t=+t)<jr?Jr*t*t:t<Xr?Jr*(t-=Hr)*t+Gr:t<$r?Jr*(t-=Vr)*t+Wr:Jr*(t-=Zr)*t+Qr}var ti=function t(n){function e(t){return t*t*((n+1)*t-n)}return n=+n,e.overshoot=t,e}(1.70158),ni=function t(n){function e(t){return--t*t*((n+1)*t+n)+1}return n=+n,e.overshoot=t,e}(1.70158),ei=function t(n){function e(t){return((t*=2)<1?t*t*((n+1)*t-n):(t-=2)*t*((n+1)*t+n)+2)/2}return n=+n,e.overshoot=t,e}(1.70158),ri=2*Math.PI,ii=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=ri);function i(t){return n*Math.pow(2,10*--t)*Math.sin((r-t)/e)}return i.amplitude=function(n){return t(n,e*ri)},i.period=function(e){return t(n,e)},i}(1,.3),oi=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=ri);function i(t){return 1-n*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/e)}return i.amplitude=function(n){return t(n,e*ri)},i.period=function(e){return t(n,e)},i}(1,.3),ai=function t(n,e){var r=Math.asin(1/(n=Math.max(1,n)))*(e/=ri);function i(t){return((t=2*t-1)<0?n*Math.pow(2,10*t)*Math.sin((r-t)/e):2-n*Math.pow(2,-10*t)*Math.sin((r+t)/e))/2}return i.amplitude=function(n){return t(n,e*ri)},i.period=function(e){return t(n,e)},i}(1,.3),ui={time:null,delay:0,duration:250,ease:Dr};function ci(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))return ui.time=nr(),ui;return e}Pt.prototype.interrupt=function(t){return this.each(function(){Mr(this,t)})},Pt.prototype.transition=function(t){var n,e;t instanceof Er?(n=t._id,t=t._name):(n=Pr(),(e=ui).time=nr(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a,u=r[o],c=u.length,f=0;f<c;++f)(a=u[f])&&br(a,t,n,f,u,e||ci(a,n));return new Er(r,this._parents,t,n)};var fi=[null];function si(t){return function(){return t}}function li(t,n,e){this.target=t,this.type=n,this.selection=e}function hi(){t.event.stopImmediatePropagation()}function di(){t.event.preventDefault(),t.event.stopImmediatePropagation()}var pi={name:"drag"},vi={name:"space"},gi={name:"handle"},yi={name:"center"},_i={name:"x",handles:["e","w"].map(Ti),input:function(t,n){return t&&[[t[0],n[0][1]],[t[1],n[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},bi={name:"y",handles:["n","s"].map(Ti),input:function(t,n){return t&&[[n[0][0],t[0]],[n[1][0],t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},mi={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(Ti),input:function(t){return t},output:function(t){return t}},xi={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},wi={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Mi={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Ni={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Ai={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Ti(t){return{type:t}}function Si(){return!t.event.button}function ki(){var t=this.ownerSVGElement||this;return[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Ei(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Ci(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function Pi(n){var e,r=ki,i=Si,o=I(u,"start","brush","end"),a=6;function u(t){var e=t.property("__brush",h).selectAll(".overlay").data([Ti("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",xi.overlay).merge(e).each(function(){var t=Ei(this).extent;zt(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([Ti("selection")]).enter().append("rect").attr("class","selection").attr("cursor",xi.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=t.selectAll(".handle").data(n.handles,function(t){return t.type});r.exit().remove(),r.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return xi[t.type]}),t.each(c).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",l)}function c(){var t=zt(this),n=Ei(this).selection;n?(t.selectAll(".selection").style("display",null).attr("x",n[0][0]).attr("y",n[0][1]).attr("width",n[1][0]-n[0][0]).attr("height",n[1][1]-n[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?n[1][0]-a/2:n[0][0]-a/2}).attr("y",function(t){return"s"===t.type[0]?n[1][1]-a/2:n[0][1]-a/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?n[1][0]-n[0][0]+a:a}).attr("height",function(t){return"e"===t.type||"w"===t.type?n[1][1]-n[0][1]+a:a})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function f(t,n){return t.__brush.emitter||new s(t,n)}function s(t,n){this.that=t,this.args=n,this.state=t.__brush,this.active=0}function l(){if(t.event.touches){if(t.event.changedTouches.length<t.event.touches.length)return di()}else if(e)return;if(i.apply(this,arguments)){var r,o,a,u,s,l,h,d,p,v,g,y,_,b=this,m=t.event.target.__data__.type,x="selection"===(t.event.metaKey?m="overlay":m)?pi:t.event.altKey?yi:gi,w=n===bi?null:Ni[m],M=n===_i?null:Ai[m],N=Ei(b),A=N.extent,T=N.selection,S=A[0][0],k=A[0][1],E=A[1][0],C=A[1][1],P=w&&M&&t.event.shiftKey,z=Ot(b),R=z,D=f(b,arguments).beforestart();"overlay"===m?N.selection=T=[[r=n===bi?S:z[0],a=n===_i?k:z[1]],[s=n===bi?E:r,h=n===_i?C:a]]:(r=T[0][0],a=T[0][1],s=T[1][0],h=T[1][1]),o=r,u=a,l=s,d=h;var q=zt(b).attr("pointer-events","none"),L=q.selectAll(".overlay").attr("cursor",xi[m]);if(t.event.touches)q.on("touchmove.brush",O,!0).on("touchend.brush touchcancel.brush",Y,!0);else{var U=zt(t.event.view).on("keydown.brush",function(){switch(t.event.keyCode){case 16:P=w&&M;break;case 18:x===gi&&(w&&(s=l-p*w,r=o+p*w),M&&(h=d-v*M,a=u+v*M),x=yi,B());break;case 32:x!==gi&&x!==yi||(w<0?s=l-p:w>0&&(r=o-p),M<0?h=d-v:M>0&&(a=u-v),x=vi,L.attr("cursor",xi.selection),B());break;default:return}di()},!0).on("keyup.brush",function(){switch(t.event.keyCode){case 16:P&&(y=_=P=!1,B());break;case 18:x===yi&&(w<0?s=l:w>0&&(r=o),M<0?h=d:M>0&&(a=u),x=gi,B());break;case 32:x===vi&&(t.event.altKey?(w&&(s=l-p*w,r=o+p*w),M&&(h=d-v*M,a=u+v*M),x=yi):(w<0?s=l:w>0&&(r=o),M<0?h=d:M>0&&(a=u),x=gi),L.attr("cursor",xi[m]),B());break;default:return}di()},!0).on("mousemove.brush",O,!0).on("mouseup.brush",Y,!0);It(t.event.view)}hi(),Mr(b),c.call(b),D.start()}function O(){var t=Ot(b);!P||y||_||(Math.abs(t[0]-R[0])>Math.abs(t[1]-R[1])?_=!0:y=!0),R=t,g=!0,di(),B()}function B(){var t;switch(p=R[0]-z[0],v=R[1]-z[1],x){case vi:case pi:w&&(p=Math.max(S-r,Math.min(E-s,p)),o=r+p,l=s+p),M&&(v=Math.max(k-a,Math.min(C-h,v)),u=a+v,d=h+v);break;case gi:w<0?(p=Math.max(S-r,Math.min(E-r,p)),o=r+p,l=s):w>0&&(p=Math.max(S-s,Math.min(E-s,p)),o=r,l=s+p),M<0?(v=Math.max(k-a,Math.min(C-a,v)),u=a+v,d=h):M>0&&(v=Math.max(k-h,Math.min(C-h,v)),u=a,d=h+v);break;case yi:w&&(o=Math.max(S,Math.min(E,r-p*w)),l=Math.max(S,Math.min(E,s+p*w))),M&&(u=Math.max(k,Math.min(C,a-v*M)),d=Math.max(k,Math.min(C,h+v*M)))}l<o&&(w*=-1,t=r,r=s,s=t,t=o,o=l,l=t,m in wi&&L.attr("cursor",xi[m=wi[m]])),d<u&&(M*=-1,t=a,a=h,h=t,t=u,u=d,d=t,m in Mi&&L.attr("cursor",xi[m=Mi[m]])),N.selection&&(T=N.selection),y&&(o=T[0][0],l=T[1][0]),_&&(u=T[0][1],d=T[1][1]),T[0][0]===o&&T[0][1]===u&&T[1][0]===l&&T[1][1]===d||(N.selection=[[o,u],[l,d]],c.call(b),D.brush())}function Y(){if(hi(),t.event.touches){if(t.event.touches.length)return;e&&clearTimeout(e),e=setTimeout(function(){e=null},500),q.on("touchmove.brush touchend.brush touchcancel.brush",null)}else jt(t.event.view,g),U.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);q.attr("pointer-events","all"),L.attr("cursor",xi.overlay),N.selection&&(T=N.selection),Ci(T)&&(N.selection=null,c.call(b)),D.end()}}function h(){var t=this.__brush||{selection:null};return t.extent=r.apply(this,arguments),t.dim=n,t}return u.move=function(t,e){t.selection?t.on("start.brush",function(){f(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){f(this,arguments).end()}).tween("brush",function(){var t=this,r=t.__brush,i=f(t,arguments),o=r.selection,a=n.input("function"==typeof e?e.apply(this,arguments):e,r.extent),u=ye(o,a);function s(n){r.selection=1===n&&Ci(a)?null:u(n),c.call(t),i.brush()}return o&&a?s:s(1)}):t.each(function(){var t=arguments,r=this.__brush,i=n.input("function"==typeof e?e.apply(this,t):e,r.extent),o=f(this,t).beforestart();Mr(this),r.selection=null==i||Ci(i)?null:i,c.call(this),o.start().brush().end()})},s.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(t){St(new li(u,t,n.output(this.state.selection)),o.apply,o,[t,this.that,this.args])}},u.extent=function(t){return arguments.length?(r="function"==typeof t?t:si([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),u):r},u.filter=function(t){return arguments.length?(i="function"==typeof t?t:si(!!t),u):i},u.handleSize=function(t){return arguments.length?(a=+t,u):a},u.on=function(){var t=o.on.apply(o,arguments);return t===o?u:t},u}var zi=Math.cos,Ri=Math.sin,Di=Math.PI,qi=Di/2,Li=2*Di,Ui=Math.max;var Oi=Array.prototype.slice;function Bi(t){return function(){return t}}var Yi=Math.PI,Fi=2*Yi,Ii=Fi-1e-6;function ji(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Hi(){return new ji}function Xi(t){return t.source}function Gi(t){return t.target}function Vi(t){return t.radius}function $i(t){return t.startAngle}function Wi(t){return t.endAngle}ji.prototype=Hi.prototype={constructor:ji,moveTo:function(t,n){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,n){this._+="L"+(this._x1=+t)+","+(this._y1=+n)},quadraticCurveTo:function(t,n,e,r){this._+="Q"+ +t+","+ +n+","+(this._x1=+e)+","+(this._y1=+r)},bezierCurveTo:function(t,n,e,r,i,o){this._+="C"+ +t+","+ +n+","+ +e+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,n,e,r,i){t=+t,n=+n,e=+e,r=+r,i=+i;var o=this._x1,a=this._y1,u=e-t,c=r-n,f=o-t,s=a-n,l=f*f+s*s;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=n);else if(l>1e-6)if(Math.abs(s*u-c*f)>1e-6&&i){var h=e-o,d=r-a,p=u*u+c*c,v=h*h+d*d,g=Math.sqrt(p),y=Math.sqrt(l),_=i*Math.tan((Yi-Math.acos((p+l-v)/(2*g*y)))/2),b=_/y,m=_/g;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*f)+","+(n+b*s)),this._+="A"+i+","+i+",0,0,"+ +(s*h>f*d)+","+(this._x1=t+m*u)+","+(this._y1=n+m*c)}else this._+="L"+(this._x1=t)+","+(this._y1=n);else;},arc:function(t,n,e,r,i,o){t=+t,n=+n;var a=(e=+e)*Math.cos(r),u=e*Math.sin(r),c=t+a,f=n+u,s=1^o,l=o?r-i:i-r;if(e<0)throw new Error("negative radius: "+e);null===this._x1?this._+="M"+c+","+f:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-f)>1e-6)&&(this._+="L"+c+","+f),e&&(l<0&&(l=l%Fi+Fi),l>Ii?this._+="A"+e+","+e+",0,1,"+s+","+(t-a)+","+(n-u)+"A"+e+","+e+",0,1,"+s+","+(this._x1=c)+","+(this._y1=f):l>1e-6&&(this._+="A"+e+","+e+",0,"+ +(l>=Yi)+","+s+","+(this._x1=t+e*Math.cos(i))+","+(this._y1=n+e*Math.sin(i))))},rect:function(t,n,e,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+n)+"h"+ +e+"v"+ +r+"h"+-e+"Z"},toString:function(){return this._}};function Zi(){}function Qi(t,n){var e=new Zi;if(t instanceof Zi)t.each(function(t,n){e.set(n,t)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==n)for(;++i<o;)e.set(i,t[i]);else for(;++i<o;)e.set(n(r=t[i],i,t),r)}else if(t)for(var a in t)e.set(a,t[a]);return e}function Ji(){return{}}function Ki(t,n,e){t[n]=e}function to(){return Qi()}function no(t,n,e){t.set(n,e)}function eo(){}Zi.prototype=Qi.prototype={constructor:Zi,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,n){return this["$"+t]=n,this},remove:function(t){var n="$"+t;return n in this&&delete this[n]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(n.slice(1));return t},values:function(){var t=[];for(var n in this)"$"===n[0]&&t.push(this[n]);return t},entries:function(){var t=[];for(var n in this)"$"===n[0]&&t.push({key:n.slice(1),value:this[n]});return t},size:function(){var t=0;for(var n in this)"$"===n[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var n in this)"$"===n[0]&&t(this[n],n.slice(1),this)}};var ro=Qi.prototype;function io(t,n){var e=new eo;if(t instanceof eo)t.each(function(t){e.add(t)});else if(t){var r=-1,i=t.length;if(null==n)for(;++r<i;)e.add(t[r]);else for(;++r<i;)e.add(n(t[r],r,t))}return e}eo.prototype=io.prototype={constructor:eo,has:ro.has,add:function(t){return this["$"+(t+="")]=t,this},remove:ro.remove,clear:ro.clear,values:ro.keys,size:ro.size,empty:ro.empty,each:ro.each};var oo=Array.prototype.slice;function ao(t,n){return t-n}function uo(t){return function(){return t}}function co(t,n){for(var e,r=-1,i=n.length;++r<i;)if(e=fo(t,n[r]))return e;return 0}function fo(t,n){for(var e=n[0],r=n[1],i=-1,o=0,a=t.length,u=a-1;o<a;u=o++){var c=t[o],f=c[0],s=c[1],l=t[u],h=l[0],d=l[1];if(so(c,l,n))return 0;s>r!=d>r&&e<(h-f)*(r-s)/(d-s)+f&&(i=-i)}return i}function so(t,n,e){var r,i,o,a;return function(t,n,e){return(n[0]-t[0])*(e[1]-t[1])==(e[0]-t[0])*(n[1]-t[1])}(t,n,e)&&(i=t[r=+(t[0]===n[0])],o=e[r],a=n[r],i<=o&&o<=a||a<=o&&o<=i)}function lo(){}var ho=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function po(){var t=1,n=1,e=M,r=u;function i(t){var n=e(t);if(Array.isArray(n))n=n.slice().sort(ao);else{var r=s(t),i=r[0],a=r[1];n=w(i,a,n),n=g(Math.floor(i/n)*n,Math.floor(a/n)*n,n)}return n.map(function(n){return o(t,n)})}function o(e,i){var o=[],u=[];return function(e,r,i){var o,u,c,f,s,l,h=new Array,d=new Array;o=u=-1,f=e[0]>=r,ho[f<<1].forEach(p);for(;++o<t-1;)c=f,f=e[o+1]>=r,ho[c|f<<1].forEach(p);ho[f<<0].forEach(p);for(;++u<n-1;){for(o=-1,f=e[u*t+t]>=r,s=e[u*t]>=r,ho[f<<1|s<<2].forEach(p);++o<t-1;)c=f,f=e[u*t+t+o+1]>=r,l=s,s=e[u*t+o+1]>=r,ho[c|f<<1|s<<2|l<<3].forEach(p);ho[f|s<<3].forEach(p)}o=-1,s=e[u*t]>=r,ho[s<<2].forEach(p);for(;++o<t-1;)l=s,s=e[u*t+o+1]>=r,ho[s<<2|l<<3].forEach(p);function p(t){var n,e,r=[t[0][0]+o,t[0][1]+u],c=[t[1][0]+o,t[1][1]+u],f=a(r),s=a(c);(n=d[f])?(e=h[s])?(delete d[n.end],delete h[e.start],n===e?(n.ring.push(c),i(n.ring)):h[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete d[n.end],n.ring.push(c),d[n.end=s]=n):(n=h[s])?(e=d[f])?(delete h[n.start],delete d[e.end],n===e?(n.ring.push(c),i(n.ring)):h[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete h[n.start],n.ring.unshift(r),h[n.start=f]=n):h[f]=d[s]={start:f,end:s,ring:[r,c]}}ho[s<<3].forEach(p)}(e,i,function(t){r(t,e,i),function(t){for(var n=0,e=t.length,r=t[e-1][1]*t[0][0]-t[e-1][0]*t[0][1];++n<e;)r+=t[n-1][1]*t[n][0]-t[n-1][0]*t[n][1];return r}(t)>0?o.push([t]):u.push(t)}),u.forEach(function(t){for(var n,e=0,r=o.length;e<r;++e)if(-1!==co((n=o[e])[0],t))return void n.push(t)}),{type:"MultiPolygon",value:i,coordinates:o}}function a(n){return 2*n[0]+n[1]*(t+1)*4}function u(e,r,i){e.forEach(function(e){var o,a=e[0],u=e[1],c=0|a,f=0|u,s=r[f*t+c];a>0&&a<t&&c===a&&(o=r[f*t+c-1],e[0]=a+(i-o)/(s-o)-.5),u>0&&u<n&&f===u&&(o=r[(f-1)*t+c],e[1]=u+(i-o)/(s-o)-.5)})}return i.contour=o,i.size=function(e){if(!arguments.length)return[t,n];var r=Math.ceil(e[0]),o=Math.ceil(e[1]);if(!(r>0&&o>0))throw new Error("invalid size");return t=r,n=o,i},i.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?uo(oo.call(t)):uo(t),i):e},i.smooth=function(t){return arguments.length?(r=t?u:lo,i):r===u},i}function vo(t,n,e){for(var r=t.width,i=t.height,o=1+(e<<1),a=0;a<i;++a)for(var u=0,c=0;u<r+e;++u)u<r&&(c+=t.data[u+a*r]),u>=e&&(u>=o&&(c-=t.data[u-o+a*r]),n.data[u-e+a*r]=c/Math.min(u+1,r-1+o-u,o))}function go(t,n,e){for(var r=t.width,i=t.height,o=1+(e<<1),a=0;a<r;++a)for(var u=0,c=0;u<i+e;++u)u<i&&(c+=t.data[a+u*r]),u>=e&&(u>=o&&(c-=t.data[a+(u-o)*r]),n.data[a+(u-e)*r]=c/Math.min(u+1,i-1+o-u,o))}function yo(t){return t[0]}function _o(t){return t[1]}function bo(){return 1}var mo={},xo={},wo=34,Mo=10,No=13;function Ao(t){return new Function("d","return {"+t.map(function(t,n){return JSON.stringify(t)+": d["+n+"]"}).join(",")+"}")}function To(t){var n=Object.create(null),e=[];return t.forEach(function(t){for(var r in t)r in n||e.push(n[r]=r)}),e}function So(t,n){var e=t+"",r=e.length;return r<n?new Array(n-r+1).join(0)+e:e}function ko(t){var n,e=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((n=t.getUTCFullYear())<0?"-"+So(-n,6):n>9999?"+"+So(n,6):So(n,4))+"-"+So(t.getUTCMonth()+1,2)+"-"+So(t.getUTCDate(),2)+(o?"T"+So(e,2)+":"+So(r,2)+":"+So(i,2)+"."+So(o,3)+"Z":i?"T"+So(e,2)+":"+So(r,2)+":"+So(i,2)+"Z":r||e?"T"+So(e,2)+":"+So(r,2)+"Z":"")}function Eo(t){var n=new RegExp('["'+t+"\n\r]"),e=t.charCodeAt(0);function r(t,n){var r,i=[],o=t.length,a=0,u=0,c=o<=0,f=!1;function s(){if(c)return xo;if(f)return f=!1,mo;var n,r,i=a;if(t.charCodeAt(i)===wo){for(;a++<o&&t.charCodeAt(a)!==wo||t.charCodeAt(++a)===wo;);return(n=a)>=o?c=!0:(r=t.charCodeAt(a++))===Mo?f=!0:r===No&&(f=!0,t.charCodeAt(a)===Mo&&++a),t.slice(i+1,n-1).replace(/""/g,'"')}for(;a<o;){if((r=t.charCodeAt(n=a++))===Mo)f=!0;else if(r===No)f=!0,t.charCodeAt(a)===Mo&&++a;else if(r!==e)continue;return t.slice(i,n)}return c=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===Mo&&--o,t.charCodeAt(o-1)===No&&--o;(r=s())!==xo;){for(var l=[];r!==mo&&r!==xo;)l.push(r),r=s();n&&null==(l=n(l,u++))||i.push(l)}return i}function i(n,e){return n.map(function(n){return e.map(function(t){return a(n[t])}).join(t)})}function o(n){return n.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?ko(t):n.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,n){var e,i,o=r(t,function(t,r){if(e)return e(t,r-1);i=t,e=n?function(t,n){var e=Ao(t);return function(r,i){return n(e(r),i,t)}}(t,n):Ao(t)});return o.columns=i||[],o},parseRows:r,format:function(n,e){return null==e&&(e=To(n)),[e.map(a).join(t)].concat(i(n,e)).join("\n")},formatBody:function(t,n){return null==n&&(n=To(t)),i(t,n).join("\n")},formatRows:function(t){return t.map(o).join("\n")}}}var Co=Eo(","),Po=Co.parse,zo=Co.parseRows,Ro=Co.format,Do=Co.formatBody,qo=Co.formatRows,Lo=Eo("\t"),Uo=Lo.parse,Oo=Lo.parseRows,Bo=Lo.format,Yo=Lo.formatBody,Fo=Lo.formatRows;function Io(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function jo(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function Ho(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Xo(t,n){return fetch(t,n).then(Ho)}function Go(t){return function(n,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=void 0),Xo(n,e).then(function(n){return t(n,r)})}}var Vo=Go(Po),$o=Go(Uo);function Wo(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.json()}function Zo(t){return function(n,e){return Xo(n,e).then(function(n){return(new DOMParser).parseFromString(n,t)})}}var Qo=Zo("application/xml"),Jo=Zo("text/html"),Ko=Zo("image/svg+xml");function ta(t){return function(){return t}}function na(){return 1e-6*(Math.random()-.5)}function ea(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var i,o,a,u,c,f,s,l,h,d=t._root,p={data:r},v=t._x0,g=t._y0,y=t._x1,_=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((f=n>=(o=(v+y)/2))?v=o:y=o,(s=e>=(a=(g+_)/2))?g=a:_=a,i=d,!(d=d[l=s<<1|f]))return i[l]=p,t;if(u=+t._x.call(null,d.data),c=+t._y.call(null,d.data),n===u&&e===c)return p.next=d,i?i[l]=p:t._root=p,t;do{i=i?i[l]=new Array(4):t._root=new Array(4),(f=n>=(o=(v+y)/2))?v=o:y=o,(s=e>=(a=(g+_)/2))?g=a:_=a}while((l=s<<1|f)==(h=(c>=a)<<1|u>=o));return i[h]=d,i[l]=p,t}function ra(t,n,e,r,i){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=i}function ia(t){return t[0]}function oa(t){return t[1]}function aa(t,n,e){var r=new ua(null==n?ia:n,null==e?oa:e,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function ua(t,n,e,r,i,o){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function ca(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var fa=aa.prototype=ua.prototype;function sa(t){return t.x+t.vx}function la(t){return t.y+t.vy}function ha(t){return t.index}function da(t,n){var e=t.get(n);if(!e)throw new Error("missing: "+n);return e}function pa(t){return t.x}function va(t){return t.y}fa.copy=function(){var t,n,e=new ua(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return e;if(!r.length)return e._root=ca(r),e;for(t=[{source:r,target:e._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(n=r.source[i])&&(n.length?t.push({source:n,target:r.target[i]=new Array(4)}):r.target[i]=ca(n));return e},fa.add=function(t){var n=+this._x.call(null,t),e=+this._y.call(null,t);return ea(this.cover(n,e),n,e,t)},fa.addAll=function(t){var n,e,r,i,o=t.length,a=new Array(o),u=new Array(o),c=1/0,f=1/0,s=-1/0,l=-1/0;for(e=0;e<o;++e)isNaN(r=+this._x.call(null,n=t[e]))||isNaN(i=+this._y.call(null,n))||(a[e]=r,u[e]=i,r<c&&(c=r),r>s&&(s=r),i<f&&(f=i),i>l&&(l=i));if(c>s||f>l)return this;for(this.cover(c,f).cover(s,l),e=0;e<o;++e)ea(this,a[e],u[e],t[e]);return this},fa.cover=function(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(e))i=(e=Math.floor(t))+1,o=(r=Math.floor(n))+1;else{for(var a,u,c=i-e,f=this._root;e>t||t>=i||r>n||n>=o;)switch(u=(n<r)<<1|t<e,(a=new Array(4))[u]=f,f=a,c*=2,u){case 0:i=e+c,o=r+c;break;case 1:e=i-c,o=r+c;break;case 2:i=e+c,r=o-c;break;case 3:e=i-c,r=o-c}this._root&&this._root.length&&(this._root=f)}return this._x0=e,this._y0=r,this._x1=i,this._y1=o,this},fa.data=function(){var t=[];return this.visit(function(n){if(!n.length)do{t.push(n.data)}while(n=n.next)}),t},fa.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},fa.find=function(t,n,e){var r,i,o,a,u,c,f,s=this._x0,l=this._y0,h=this._x1,d=this._y1,p=[],v=this._root;for(v&&p.push(new ra(v,s,l,h,d)),null==e?e=1/0:(s=t-e,l=n-e,h=t+e,d=n+e,e*=e);c=p.pop();)if(!(!(v=c.node)||(i=c.x0)>h||(o=c.y0)>d||(a=c.x1)<s||(u=c.y1)<l))if(v.length){var g=(i+a)/2,y=(o+u)/2;p.push(new ra(v[3],g,y,a,u),new ra(v[2],i,y,g,u),new ra(v[1],g,o,a,y),new ra(v[0],i,o,g,y)),(f=(n>=y)<<1|t>=g)&&(c=p[p.length-1],p[p.length-1]=p[p.length-1-f],p[p.length-1-f]=c)}else{var _=t-+this._x.call(null,v.data),b=n-+this._y.call(null,v.data),m=_*_+b*b;if(m<e){var x=Math.sqrt(e=m);s=t-x,l=n-x,h=t+x,d=n+x,r=v.data}}return r},fa.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var n,e,r,i,o,a,u,c,f,s,l,h,d=this._root,p=this._x0,v=this._y0,g=this._x1,y=this._y1;if(!d)return this;if(d.length)for(;;){if((f=o>=(u=(p+g)/2))?p=u:g=u,(s=a>=(c=(v+y)/2))?v=c:y=c,n=d,!(d=d[l=s<<1|f]))return this;if(!d.length)break;(n[l+1&3]||n[l+2&3]||n[l+3&3])&&(e=n,h=l)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):n?(i?n[l]=i:delete n[l],(d=n[0]||n[1]||n[2]||n[3])&&d===(n[3]||n[2]||n[1]||n[0])&&!d.length&&(e?e[h]=d:this._root=d),this):(this._root=i,this)},fa.removeAll=function(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this},fa.root=function(){return this._root},fa.size=function(){var t=0;return this.visit(function(n){if(!n.length)do{++t}while(n=n.next)}),t},fa.visit=function(t){var n,e,r,i,o,a,u=[],c=this._root;for(c&&u.push(new ra(c,this._x0,this._y0,this._x1,this._y1));n=u.pop();)if(!t(c=n.node,r=n.x0,i=n.y0,o=n.x1,a=n.y1)&&c.length){var f=(r+o)/2,s=(i+a)/2;(e=c[3])&&u.push(new ra(e,f,s,o,a)),(e=c[2])&&u.push(new ra(e,r,s,f,a)),(e=c[1])&&u.push(new ra(e,f,i,o,s)),(e=c[0])&&u.push(new ra(e,r,i,f,s))}return this},fa.visitAfter=function(t){var n,e=[],r=[];for(this._root&&e.push(new ra(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var o,a=n.x0,u=n.y0,c=n.x1,f=n.y1,s=(a+c)/2,l=(u+f)/2;(o=i[0])&&e.push(new ra(o,a,u,s,l)),(o=i[1])&&e.push(new ra(o,s,u,c,l)),(o=i[2])&&e.push(new ra(o,a,l,s,f)),(o=i[3])&&e.push(new ra(o,s,l,c,f))}r.push(n)}for(;n=r.pop();)t(n.node,n.x0,n.y0,n.x1,n.y1);return this},fa.x=function(t){return arguments.length?(this._x=t,this):this._x},fa.y=function(t){return arguments.length?(this._y=t,this):this._y};var ga=10,ya=Math.PI*(3-Math.sqrt(5));function _a(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function ba(t){return(t=_a(Math.abs(t)))?t[1]:NaN}var ma,xa=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function wa(t){return new Ma(t)}function Ma(t){if(!(n=xa.exec(t)))throw new Error("invalid format: "+t);var n;this.fill=n[1]||" ",this.align=n[2]||">",this.sign=n[3]||"-",this.symbol=n[4]||"",this.zero=!!n[5],this.width=n[6]&&+n[6],this.comma=!!n[7],this.precision=n[8]&&+n[8].slice(1),this.trim=!!n[9],this.type=n[10]||""}function Na(t,n){var e=_a(t,n);if(!e)return t+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}wa.prototype=Ma.prototype,Ma.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Aa={"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return Na(100*t,n)},r:Na,s:function(t,n){var e=_a(t,n);if(!e)return t+"";var r=e[0],i=e[1],o=i-(ma=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+_a(t,Math.max(0,n+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function Ta(t){return t}var Sa,ka=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Ea(t){var n,e,r=t.grouping&&t.thousands?(n=t.grouping,e=t.thousands,function(t,r){for(var i=t.length,o=[],a=0,u=n[0],c=0;i>0&&u>0&&(c+u+1>r&&(u=Math.max(1,r-c)),o.push(t.substring(i-=u,i+u)),!((c+=u+1)>r));)u=n[a=(a+1)%n.length];return o.reverse().join(e)}):Ta,i=t.currency,o=t.decimal,a=t.numerals?function(t){return function(n){return n.replace(/[0-9]/g,function(n){return t[+n]})}}(t.numerals):Ta,u=t.percent||"%";function c(t){var n=(t=wa(t)).fill,e=t.align,c=t.sign,f=t.symbol,s=t.zero,l=t.width,h=t.comma,d=t.precision,p=t.trim,v=t.type;"n"===v?(h=!0,v="g"):Aa[v]||(null==d&&(d=12),p=!0,v="g"),(s||"0"===n&&"="===e)&&(s=!0,n="0",e="=");var g="$"===f?i[0]:"#"===f&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",y="$"===f?i[1]:/[%p]/.test(v)?u:"",_=Aa[v],b=/[defgprs%]/.test(v);function m(t){var i,u,f,m=g,x=y;if("c"===v)x=_(t)+x,t="";else{var w=(t=+t)<0;if(t=_(Math.abs(t),d),p&&(t=function(t){t:for(var n,e=t.length,r=1,i=-1;r<e;++r)switch(t[r]){case".":i=n=r;break;case"0":0===i&&(i=r),n=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(n+1):t}(t)),w&&0==+t&&(w=!1),m=(w?"("===c?c:"-":"-"===c||"("===c?"":c)+m,x=("s"===v?ka[8+ma/3]:"")+x+(w&&"("===c?")":""),b)for(i=-1,u=t.length;++i<u;)if(48>(f=t.charCodeAt(i))||f>57){x=(46===f?o+t.slice(i+1):t.slice(i))+x,t=t.slice(0,i);break}}h&&!s&&(t=r(t,1/0));var M=m.length+t.length+x.length,N=M<l?new Array(l-M+1).join(n):"";switch(h&&s&&(t=r(N+t,N.length?l-x.length:1/0),N=""),e){case"<":t=m+t+x+N;break;case"=":t=m+N+t+x;break;case"^":t=N.slice(0,M=N.length>>1)+m+t+x+N.slice(M);break;default:t=N+m+t+x}return a(t)}return d=null==d?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),m.toString=function(){return t+""},m}return{format:c,formatPrefix:function(t,n){var e=c(((t=wa(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(ba(n)/3))),i=Math.pow(10,-r),o=ka[8+r/3];return function(t){return e(i*t)+o}}}}function Ca(n){return Sa=Ea(n),t.format=Sa.format,t.formatPrefix=Sa.formatPrefix,Sa}function Pa(t){return Math.max(0,-ba(Math.abs(t)))}function za(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ba(n)/3)))-ba(Math.abs(t)))}function Ra(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,ba(n)-ba(t))+1}function Da(){return new qa}function qa(){this.reset()}Ca({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),qa.prototype={constructor:qa,reset:function(){this.s=this.t=0},add:function(t){Ua(La,t,this.t),Ua(this,La.s,this.s),this.s?this.t+=La.t:this.s=La.t},valueOf:function(){return this.s}};var La=new qa;function Ua(t,n,e){var r=t.s=n+e,i=r-n,o=r-i;t.t=n-o+(e-i)}var Oa=1e-6,Ba=1e-12,Ya=Math.PI,Fa=Ya/2,Ia=Ya/4,ja=2*Ya,Ha=180/Ya,Xa=Ya/180,Ga=Math.abs,Va=Math.atan,$a=Math.atan2,Wa=Math.cos,Za=Math.ceil,Qa=Math.exp,Ja=Math.log,Ka=Math.pow,tu=Math.sin,nu=Math.sign||function(t){return t>0?1:t<0?-1:0},eu=Math.sqrt,ru=Math.tan;function iu(t){return t>1?0:t<-1?Ya:Math.acos(t)}function ou(t){return t>1?Fa:t<-1?-Fa:Math.asin(t)}function au(t){return(t=tu(t/2))*t}function uu(){}function cu(t,n){t&&su.hasOwnProperty(t.type)&&su[t.type](t,n)}var fu={Feature:function(t,n){cu(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)cu(e[r].geometry,n)}},su={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){lu(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)lu(e[r],n,0)},Polygon:function(t,n){hu(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)hu(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)cu(e[r],n)}};function lu(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function hu(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)lu(t[e],n,1);n.polygonEnd()}function du(t,n){t&&fu.hasOwnProperty(t.type)?fu[t.type](t,n):cu(t,n)}var pu,vu,gu,yu,_u,bu=Da(),mu=Da(),xu={point:uu,lineStart:uu,lineEnd:uu,polygonStart:function(){bu.reset(),xu.lineStart=wu,xu.lineEnd=Mu},polygonEnd:function(){var t=+bu;mu.add(t<0?ja+t:t),this.lineStart=this.lineEnd=this.point=uu},sphere:function(){mu.add(ja)}};function wu(){xu.point=Nu}function Mu(){Au(pu,vu)}function Nu(t,n){xu.point=Au,pu=t,vu=n,gu=t*=Xa,yu=Wa(n=(n*=Xa)/2+Ia),_u=tu(n)}function Au(t,n){var e=(t*=Xa)-gu,r=e>=0?1:-1,i=r*e,o=Wa(n=(n*=Xa)/2+Ia),a=tu(n),u=_u*a,c=yu*o+u*Wa(i),f=u*r*tu(i);bu.add($a(f,c)),gu=t,yu=o,_u=a}function Tu(t){return[$a(t[1],t[0]),ou(t[2])]}function Su(t){var n=t[0],e=t[1],r=Wa(e);return[r*Wa(n),r*tu(n),tu(e)]}function ku(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function Eu(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function Cu(t,n){t[0]+=n[0],t[1]+=n[1],t[2]+=n[2]}function Pu(t,n){return[t[0]*n,t[1]*n,t[2]*n]}function zu(t){var n=eu(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}var Ru,Du,qu,Lu,Uu,Ou,Bu,Yu,Fu,Iu,ju,Hu,Xu,Gu,Vu,$u,Wu,Zu,Qu,Ju,Ku,tc,nc,ec,rc,ic,oc=Da(),ac={point:uc,lineStart:fc,lineEnd:sc,polygonStart:function(){ac.point=lc,ac.lineStart=hc,ac.lineEnd=dc,oc.reset(),xu.polygonStart()},polygonEnd:function(){xu.polygonEnd(),ac.point=uc,ac.lineStart=fc,ac.lineEnd=sc,bu<0?(Ru=-(qu=180),Du=-(Lu=90)):oc>Oa?Lu=90:oc<-Oa&&(Du=-90),Iu[0]=Ru,Iu[1]=qu}};function uc(t,n){Fu.push(Iu=[Ru=t,qu=t]),n<Du&&(Du=n),n>Lu&&(Lu=n)}function cc(t,n){var e=Su([t*Xa,n*Xa]);if(Yu){var r=Eu(Yu,e),i=Eu([r[1],-r[0],0],r);zu(i),i=Tu(i);var o,a=t-Uu,u=a>0?1:-1,c=i[0]*Ha*u,f=Ga(a)>180;f^(u*Uu<c&&c<u*t)?(o=i[1]*Ha)>Lu&&(Lu=o):f^(u*Uu<(c=(c+360)%360-180)&&c<u*t)?(o=-i[1]*Ha)<Du&&(Du=o):(n<Du&&(Du=n),n>Lu&&(Lu=n)),f?t<Uu?pc(Ru,t)>pc(Ru,qu)&&(qu=t):pc(t,qu)>pc(Ru,qu)&&(Ru=t):qu>=Ru?(t<Ru&&(Ru=t),t>qu&&(qu=t)):t>Uu?pc(Ru,t)>pc(Ru,qu)&&(qu=t):pc(t,qu)>pc(Ru,qu)&&(Ru=t)}else Fu.push(Iu=[Ru=t,qu=t]);n<Du&&(Du=n),n>Lu&&(Lu=n),Yu=e,Uu=t}function fc(){ac.point=cc}function sc(){Iu[0]=Ru,Iu[1]=qu,ac.point=uc,Yu=null}function lc(t,n){if(Yu){var e=t-Uu;oc.add(Ga(e)>180?e+(e>0?360:-360):e)}else Ou=t,Bu=n;xu.point(t,n),cc(t,n)}function hc(){xu.lineStart()}function dc(){lc(Ou,Bu),xu.lineEnd(),Ga(oc)>Oa&&(Ru=-(qu=180)),Iu[0]=Ru,Iu[1]=qu,Yu=null}function pc(t,n){return(n-=t)<0?n+360:n}function vc(t,n){return t[0]-n[0]}function gc(t,n){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var yc={sphere:uu,point:_c,lineStart:mc,lineEnd:Mc,polygonStart:function(){yc.lineStart=Nc,yc.lineEnd=Ac},polygonEnd:function(){yc.lineStart=mc,yc.lineEnd=Mc}};function _c(t,n){t*=Xa;var e=Wa(n*=Xa);bc(e*Wa(t),e*tu(t),tu(n))}function bc(t,n,e){Xu+=(t-Xu)/++ju,Gu+=(n-Gu)/ju,Vu+=(e-Vu)/ju}function mc(){yc.point=xc}function xc(t,n){t*=Xa;var e=Wa(n*=Xa);ec=e*Wa(t),rc=e*tu(t),ic=tu(n),yc.point=wc,bc(ec,rc,ic)}function wc(t,n){t*=Xa;var e=Wa(n*=Xa),r=e*Wa(t),i=e*tu(t),o=tu(n),a=$a(eu((a=rc*o-ic*i)*a+(a=ic*r-ec*o)*a+(a=ec*i-rc*r)*a),ec*r+rc*i+ic*o);Hu+=a,$u+=a*(ec+(ec=r)),Wu+=a*(rc+(rc=i)),Zu+=a*(ic+(ic=o)),bc(ec,rc,ic)}function Mc(){yc.point=_c}function Nc(){yc.point=Tc}function Ac(){Sc(tc,nc),yc.point=_c}function Tc(t,n){tc=t,nc=n,t*=Xa,n*=Xa,yc.point=Sc;var e=Wa(n);ec=e*Wa(t),rc=e*tu(t),ic=tu(n),bc(ec,rc,ic)}function Sc(t,n){t*=Xa;var e=Wa(n*=Xa),r=e*Wa(t),i=e*tu(t),o=tu(n),a=rc*o-ic*i,u=ic*r-ec*o,c=ec*i-rc*r,f=eu(a*a+u*u+c*c),s=ou(f),l=f&&-s/f;Qu+=l*a,Ju+=l*u,Ku+=l*c,Hu+=s,$u+=s*(ec+(ec=r)),Wu+=s*(rc+(rc=i)),Zu+=s*(ic+(ic=o)),bc(ec,rc,ic)}function kc(t){return function(){return t}}function Ec(t,n){function e(e,r){return e=t(e,r),n(e[0],e[1])}return t.invert&&n.invert&&(e.invert=function(e,r){return(e=n.invert(e,r))&&t.invert(e[0],e[1])}),e}function Cc(t,n){return[Ga(t)>Ya?t+Math.round(-t/ja)*ja:t,n]}function Pc(t,n,e){return(t%=ja)?n||e?Ec(Rc(t),Dc(n,e)):Rc(t):n||e?Dc(n,e):Cc}function zc(t){return function(n,e){return[(n+=t)>Ya?n-ja:n<-Ya?n+ja:n,e]}}function Rc(t){var n=zc(t);return n.invert=zc(-t),n}function Dc(t,n){var e=Wa(t),r=tu(t),i=Wa(n),o=tu(n);function a(t,n){var a=Wa(n),u=Wa(t)*a,c=tu(t)*a,f=tu(n),s=f*e+u*r;return[$a(c*i-s*o,u*e-f*r),ou(s*i+c*o)]}return a.invert=function(t,n){var a=Wa(n),u=Wa(t)*a,c=tu(t)*a,f=tu(n),s=f*i-c*o;return[$a(c*i+f*o,u*e+s*r),ou(s*e-u*r)]},a}function qc(t){function n(n){return(n=t(n[0]*Xa,n[1]*Xa))[0]*=Ha,n[1]*=Ha,n}return t=Pc(t[0]*Xa,t[1]*Xa,t.length>2?t[2]*Xa:0),n.invert=function(n){return(n=t.invert(n[0]*Xa,n[1]*Xa))[0]*=Ha,n[1]*=Ha,n},n}function Lc(t,n,e,r,i,o){if(e){var a=Wa(n),u=tu(n),c=r*e;null==i?(i=n+r*ja,o=n-c/2):(i=Uc(a,i),o=Uc(a,o),(r>0?i<o:i>o)&&(i+=r*ja));for(var f,s=i;r>0?s>o:s<o;s-=c)f=Tu([a,-u*Wa(s),-u*tu(s)]),t.point(f[0],f[1])}}function Uc(t,n){(n=Su(n))[0]-=t,zu(n);var e=iu(-n[1]);return((-n[2]<0?-e:e)+ja-Oa)%ja}function Oc(){var t,n=[];return{point:function(n,e){t.push([n,e])},lineStart:function(){n.push(t=[])},lineEnd:uu,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var e=n;return n=[],t=null,e}}}function Bc(t,n){return Ga(t[0]-n[0])<Oa&&Ga(t[1]-n[1])<Oa}function Yc(t,n,e,r){this.x=t,this.z=n,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Fc(t,n,e,r,i){var o,a,u=[],c=[];if(t.forEach(function(t){if(!((n=t.length-1)<=0)){var n,e,r=t[0],a=t[n];if(Bc(r,a)){for(i.lineStart(),o=0;o<n;++o)i.point((r=t[o])[0],r[1]);i.lineEnd()}else u.push(e=new Yc(r,t,null,!0)),c.push(e.o=new Yc(r,null,e,!1)),u.push(e=new Yc(a,t,null,!1)),c.push(e.o=new Yc(a,null,e,!0))}}),u.length){for(c.sort(n),Ic(u),Ic(c),o=0,a=c.length;o<a;++o)c[o].e=e=!e;for(var f,s,l=u[0];;){for(var h=l,d=!0;h.v;)if((h=h.n)===l)return;f=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,a=f.length;o<a;++o)i.point((s=f[o])[0],s[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(f=h.p.z,o=f.length-1;o>=0;--o)i.point((s=f[o])[0],s[1]);else r(h.x,h.p.x,-1,i);h=h.p}f=(h=h.o).z,d=!d}while(!h.v);i.lineEnd()}}}function Ic(t){if(n=t.length){for(var n,e,r=0,i=t[0];++r<n;)i.n=e=t[r],e.p=i,i=e;i.n=e=t[0],e.p=i}}Cc.invert=Cc;var jc=Da();function Hc(t,n){var e=n[0],r=n[1],i=tu(r),o=[tu(e),-Wa(e),0],a=0,u=0;jc.reset(),1===i?r=Fa+Oa:-1===i&&(r=-Fa-Oa);for(var c=0,f=t.length;c<f;++c)if(l=(s=t[c]).length)for(var s,l,h=s[l-1],d=h[0],p=h[1]/2+Ia,v=tu(p),g=Wa(p),y=0;y<l;++y,d=b,v=x,g=w,h=_){var _=s[y],b=_[0],m=_[1]/2+Ia,x=tu(m),w=Wa(m),M=b-d,N=M>=0?1:-1,A=N*M,T=A>Ya,S=v*x;if(jc.add($a(S*N*tu(A),g*w+S*Wa(A))),a+=T?M+N*ja:M,T^d>=e^b>=e){var k=Eu(Su(h),Su(_));zu(k);var E=Eu(o,k);zu(E);var C=(T^M>=0?-1:1)*ou(E[2]);(r>C||r===C&&(k[0]||k[1]))&&(u+=T^M>=0?1:-1)}}return(a<-Oa||a<Oa&&jc<-Oa)^1&u}function Xc(t,n,e,r){return function(i){var o,a,u,c=n(i),f=Oc(),s=n(f),l=!1,h={point:d,lineStart:v,lineEnd:g,polygonStart:function(){h.point=y,h.lineStart=_,h.lineEnd=b,a=[],o=[]},polygonEnd:function(){h.point=d,h.lineStart=v,h.lineEnd=g,a=T(a);var t=Hc(o,r);a.length?(l||(i.polygonStart(),l=!0),Fc(a,Vc,t,e,i)):t&&(l||(i.polygonStart(),l=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),l&&(i.polygonEnd(),l=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(n,e){t(n,e)&&i.point(n,e)}function p(t,n){c.point(t,n)}function v(){h.point=p,c.lineStart()}function g(){h.point=d,c.lineEnd()}function y(t,n){u.push([t,n]),s.point(t,n)}function _(){s.lineStart(),u=[]}function b(){y(u[0][0],u[0][1]),s.lineEnd();var t,n,e,r,c=s.clean(),h=f.result(),d=h.length;if(u.pop(),o.push(u),u=null,d)if(1&c){if((n=(e=h[0]).length-1)>0){for(l||(i.polygonStart(),l=!0),i.lineStart(),t=0;t<n;++t)i.point((r=e[t])[0],r[1]);i.lineEnd()}}else d>1&&2&c&&h.push(h.pop().concat(h.shift())),a.push(h.filter(Gc))}return h}}function Gc(t){return t.length>1}function Vc(t,n){return((t=t.x)[0]<0?t[1]-Fa-Oa:Fa-t[1])-((n=n.x)[0]<0?n[1]-Fa-Oa:Fa-n[1])}var $c=Xc(function(){return!0},function(t){var n,e=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),n=1},point:function(o,a){var u=o>0?Ya:-Ya,c=Ga(o-e);Ga(c-Ya)<Oa?(t.point(e,r=(r+a)/2>0?Fa:-Fa),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),t.point(o,r),n=0):i!==u&&c>=Ya&&(Ga(e-i)<Oa&&(e-=i*Oa),Ga(o-u)<Oa&&(o-=u*Oa),r=function(t,n,e,r){var i,o,a=tu(t-e);return Ga(a)>Oa?Va((tu(n)*(o=Wa(r))*tu(e)-tu(r)*(i=Wa(n))*tu(t))/(i*o*a)):(n+r)/2}(e,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(u,r),n=0),t.point(e=o,r=a),i=u},lineEnd:function(){t.lineEnd(),e=r=NaN},clean:function(){return 2-n}}},function(t,n,e,r){var i;if(null==t)i=e*Fa,r.point(-Ya,i),r.point(0,i),r.point(Ya,i),r.point(Ya,0),r.point(Ya,-i),r.point(0,-i),r.point(-Ya,-i),r.point(-Ya,0),r.point(-Ya,i);else if(Ga(t[0]-n[0])>Oa){var o=t[0]<n[0]?Ya:-Ya;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(n[0],n[1])},[-Ya,-Fa]);function Wc(t){var n=Wa(t),e=6*Xa,r=n>0,i=Ga(n)>Oa;function o(t,e){return Wa(t)*Wa(e)>n}function a(t,e,r){var i=[1,0,0],o=Eu(Su(t),Su(e)),a=ku(o,o),u=o[0],c=a-u*u;if(!c)return!r&&t;var f=n*a/c,s=-n*u/c,l=Eu(i,o),h=Pu(i,f);Cu(h,Pu(o,s));var d=l,p=ku(h,d),v=ku(d,d),g=p*p-v*(ku(h,h)-1);if(!(g<0)){var y=eu(g),_=Pu(d,(-p-y)/v);if(Cu(_,h),_=Tu(_),!r)return _;var b,m=t[0],x=e[0],w=t[1],M=e[1];x<m&&(b=m,m=x,x=b);var N=x-m,A=Ga(N-Ya)<Oa;if(!A&&M<w&&(b=w,w=M,M=b),A||N<Oa?A?w+M>0^_[1]<(Ga(_[0]-m)<Oa?w:M):w<=_[1]&&_[1]<=M:N>Ya^(m<=_[0]&&_[0]<=x)){var T=Pu(d,(-p+y)/v);return Cu(T,h),[_,Tu(T)]}}}function u(n,e){var i=r?t:Ya-t,o=0;return n<-i?o|=1:n>i&&(o|=2),e<-i?o|=4:e>i&&(o|=8),o}return Xc(o,function(t){var n,e,c,f,s;return{lineStart:function(){f=c=!1,s=1},point:function(l,h){var d,p=[l,h],v=o(l,h),g=r?v?0:u(l,h):v?u(l+(l<0?Ya:-Ya),h):0;if(!n&&(f=c=v)&&t.lineStart(),v!==c&&(!(d=a(n,p))||Bc(n,d)||Bc(p,d))&&(p[0]+=Oa,p[1]+=Oa,v=o(p[0],p[1])),v!==c)s=0,v?(t.lineStart(),d=a(p,n),t.point(d[0],d[1])):(d=a(n,p),t.point(d[0],d[1]),t.lineEnd()),n=d;else if(i&&n&&r^v){var y;g&e||!(y=a(p,n,!0))||(s=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!v||n&&Bc(n,p)||t.point(p[0],p[1]),n=p,c=v,e=g},lineEnd:function(){c&&t.lineEnd(),n=null},clean:function(){return s|(f&&c)<<1}}},function(n,r,i,o){Lc(o,t,e,i,n,r)},r?[0,-t]:[-Ya,t-Ya])}var Zc=1e9,Qc=-Zc;function Jc(t,n,e,r){function i(i,o){return t<=i&&i<=e&&n<=o&&o<=r}function o(i,o,u,f){var s=0,l=0;if(null==i||(s=a(i,u))!==(l=a(o,u))||c(i,o)<0^u>0)do{f.point(0===s||3===s?t:e,s>1?r:n)}while((s=(s+u+4)%4)!==l);else f.point(o[0],o[1])}function a(r,i){return Ga(r[0]-t)<Oa?i>0?0:3:Ga(r[0]-e)<Oa?i>0?2:1:Ga(r[1]-n)<Oa?i>0?1:0:i>0?3:2}function u(t,n){return c(t.x,n.x)}function c(t,n){var e=a(t,1),r=a(n,1);return e!==r?e-r:0===e?n[1]-t[1]:1===e?t[0]-n[0]:2===e?t[1]-n[1]:n[0]-t[0]}return function(a){var c,f,s,l,h,d,p,v,g,y,_,b=a,m=Oc(),x={point:w,lineStart:function(){x.point=M,f&&f.push(s=[]);y=!0,g=!1,p=v=NaN},lineEnd:function(){c&&(M(l,h),d&&g&&m.rejoin(),c.push(m.result()));x.point=w,g&&b.lineEnd()},polygonStart:function(){b=m,c=[],f=[],_=!0},polygonEnd:function(){var n=function(){for(var n=0,e=0,i=f.length;e<i;++e)for(var o,a,u=f[e],c=1,s=u.length,l=u[0],h=l[0],d=l[1];c<s;++c)o=h,a=d,l=u[c],h=l[0],d=l[1],a<=r?d>r&&(h-o)*(r-a)>(d-a)*(t-o)&&++n:d<=r&&(h-o)*(r-a)<(d-a)*(t-o)&&--n;return n}(),e=_&&n,i=(c=T(c)).length;(e||i)&&(a.polygonStart(),e&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&Fc(c,u,n,o,a),a.polygonEnd());b=a,c=f=s=null}};function w(t,n){i(t,n)&&b.point(t,n)}function M(o,a){var u=i(o,a);if(f&&s.push([o,a]),y)l=o,h=a,d=u,y=!1,u&&(b.lineStart(),b.point(o,a));else if(u&&g)b.point(o,a);else{var c=[p=Math.max(Qc,Math.min(Zc,p)),v=Math.max(Qc,Math.min(Zc,v))],m=[o=Math.max(Qc,Math.min(Zc,o)),a=Math.max(Qc,Math.min(Zc,a))];!function(t,n,e,r,i,o){var a,u=t[0],c=t[1],f=0,s=1,l=n[0]-u,h=n[1]-c;if(a=e-u,l||!(a>0)){if(a/=l,l<0){if(a<f)return;a<s&&(s=a)}else if(l>0){if(a>s)return;a>f&&(f=a)}if(a=i-u,l||!(a<0)){if(a/=l,l<0){if(a>s)return;a>f&&(f=a)}else if(l>0){if(a<f)return;a<s&&(s=a)}if(a=r-c,h||!(a>0)){if(a/=h,h<0){if(a<f)return;a<s&&(s=a)}else if(h>0){if(a>s)return;a>f&&(f=a)}if(a=o-c,h||!(a<0)){if(a/=h,h<0){if(a>s)return;a>f&&(f=a)}else if(h>0){if(a<f)return;a<s&&(s=a)}return f>0&&(t[0]=u+f*l,t[1]=c+f*h),s<1&&(n[0]=u+s*l,n[1]=c+s*h),!0}}}}}(c,m,t,n,e,r)?u&&(b.lineStart(),b.point(o,a),_=!1):(g||(b.lineStart(),b.point(c[0],c[1])),b.point(m[0],m[1]),u||b.lineEnd(),_=!1)}p=o,v=a,g=u}return x}}var Kc,tf,nf,ef=Da(),rf={sphere:uu,point:uu,lineStart:function(){rf.point=af,rf.lineEnd=of},lineEnd:uu,polygonStart:uu,polygonEnd:uu};function of(){rf.point=rf.lineEnd=uu}function af(t,n){Kc=t*=Xa,tf=tu(n*=Xa),nf=Wa(n),rf.point=uf}function uf(t,n){t*=Xa;var e=tu(n*=Xa),r=Wa(n),i=Ga(t-Kc),o=Wa(i),a=r*tu(i),u=nf*e-tf*r*o,c=tf*e+nf*r*o;ef.add($a(eu(a*a+u*u),c)),Kc=t,tf=e,nf=r}function cf(t){return ef.reset(),du(t,rf),+ef}var ff=[null,null],sf={type:"LineString",coordinates:ff};function lf(t,n){return ff[0]=t,ff[1]=n,cf(sf)}var hf={Feature:function(t,n){return pf(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)if(pf(e[r].geometry,n))return!0;return!1}},df={Sphere:function(){return!0},Point:function(t,n){return vf(t.coordinates,n)},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(vf(e[r],n))return!0;return!1},LineString:function(t,n){return gf(t.coordinates,n)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(gf(e[r],n))return!0;return!1},Polygon:function(t,n){return yf(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)if(yf(e[r],n))return!0;return!1},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)if(pf(e[r],n))return!0;return!1}};function pf(t,n){return!(!t||!df.hasOwnProperty(t.type))&&df[t.type](t,n)}function vf(t,n){return 0===lf(t,n)}function gf(t,n){var e=lf(t[0],t[1]);return lf(t[0],n)+lf(n,t[1])<=e+Oa}function yf(t,n){return!!Hc(t.map(_f),bf(n))}function _f(t){return(t=t.map(bf)).pop(),t}function bf(t){return[t[0]*Xa,t[1]*Xa]}function mf(t,n,e){var r=g(t,n-Oa,e).concat(n);return function(t){return r.map(function(n){return[t,n]})}}function xf(t,n,e){var r=g(t,n-Oa,e).concat(n);return function(t){return r.map(function(n){return[n,t]})}}function wf(){var t,n,e,r,i,o,a,u,c,f,s,l,h=10,d=h,p=90,v=360,y=2.5;function _(){return{type:"MultiLineString",coordinates:b()}}function b(){return g(Za(r/p)*p,e,p).map(s).concat(g(Za(u/v)*v,a,v).map(l)).concat(g(Za(n/h)*h,t,h).filter(function(t){return Ga(t%p)>Oa}).map(c)).concat(g(Za(o/d)*d,i,d).filter(function(t){return Ga(t%v)>Oa}).map(f))}return _.lines=function(){return b().map(function(t){return{type:"LineString",coordinates:t}})},_.outline=function(){return{type:"Polygon",coordinates:[s(r).concat(l(a).slice(1),s(e).reverse().slice(1),l(u).reverse().slice(1))]}},_.extent=function(t){return arguments.length?_.extentMajor(t).extentMinor(t):_.extentMinor()},_.extentMajor=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],u=+t[0][1],a=+t[1][1],r>e&&(t=r,r=e,e=t),u>a&&(t=u,u=a,a=t),_.precision(y)):[[r,u],[e,a]]},_.extentMinor=function(e){return arguments.length?(n=+e[0][0],t=+e[1][0],o=+e[0][1],i=+e[1][1],n>t&&(e=n,n=t,t=e),o>i&&(e=o,o=i,i=e),_.precision(y)):[[n,o],[t,i]]},_.step=function(t){return arguments.length?_.stepMajor(t).stepMinor(t):_.stepMinor()},_.stepMajor=function(t){return arguments.length?(p=+t[0],v=+t[1],_):[p,v]},_.stepMinor=function(t){return arguments.length?(h=+t[0],d=+t[1],_):[h,d]},_.precision=function(h){return arguments.length?(y=+h,c=mf(o,i,90),f=xf(n,t,y),s=mf(u,a,90),l=xf(r,e,y),_):y},_.extentMajor([[-180,-90+Oa],[180,90-Oa]]).extentMinor([[-180,-80-Oa],[180,80+Oa]])}function Mf(t){return t}var Nf,Af,Tf,Sf,kf=Da(),Ef=Da(),Cf={point:uu,lineStart:uu,lineEnd:uu,polygonStart:function(){Cf.lineStart=Pf,Cf.lineEnd=Df},polygonEnd:function(){Cf.lineStart=Cf.lineEnd=Cf.point=uu,kf.add(Ga(Ef)),Ef.reset()},result:function(){var t=kf/2;return kf.reset(),t}};function Pf(){Cf.point=zf}function zf(t,n){Cf.point=Rf,Nf=Tf=t,Af=Sf=n}function Rf(t,n){Ef.add(Sf*t-Tf*n),Tf=t,Sf=n}function Df(){Rf(Nf,Af)}var qf=1/0,Lf=qf,Uf=-qf,Of=Uf,Bf={point:function(t,n){t<qf&&(qf=t);t>Uf&&(Uf=t);n<Lf&&(Lf=n);n>Of&&(Of=n)},lineStart:uu,lineEnd:uu,polygonStart:uu,polygonEnd:uu,result:function(){var t=[[qf,Lf],[Uf,Of]];return Uf=Of=-(Lf=qf=1/0),t}};var Yf,Ff,If,jf,Hf=0,Xf=0,Gf=0,Vf=0,$f=0,Wf=0,Zf=0,Qf=0,Jf=0,Kf={point:ts,lineStart:ns,lineEnd:is,polygonStart:function(){Kf.lineStart=os,Kf.lineEnd=as},polygonEnd:function(){Kf.point=ts,Kf.lineStart=ns,Kf.lineEnd=is},result:function(){var t=Jf?[Zf/Jf,Qf/Jf]:Wf?[Vf/Wf,$f/Wf]:Gf?[Hf/Gf,Xf/Gf]:[NaN,NaN];return Hf=Xf=Gf=Vf=$f=Wf=Zf=Qf=Jf=0,t}};function ts(t,n){Hf+=t,Xf+=n,++Gf}function ns(){Kf.point=es}function es(t,n){Kf.point=rs,ts(If=t,jf=n)}function rs(t,n){var e=t-If,r=n-jf,i=eu(e*e+r*r);Vf+=i*(If+t)/2,$f+=i*(jf+n)/2,Wf+=i,ts(If=t,jf=n)}function is(){Kf.point=ts}function os(){Kf.point=us}function as(){cs(Yf,Ff)}function us(t,n){Kf.point=cs,ts(Yf=If=t,Ff=jf=n)}function cs(t,n){var e=t-If,r=n-jf,i=eu(e*e+r*r);Vf+=i*(If+t)/2,$f+=i*(jf+n)/2,Wf+=i,Zf+=(i=jf*t-If*n)*(If+t),Qf+=i*(jf+n),Jf+=3*i,ts(If=t,jf=n)}function fs(t){this._context=t}fs.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._context.moveTo(t,n),this._point=1;break;case 1:this._context.lineTo(t,n);break;default:this._context.moveTo(t+this._radius,n),this._context.arc(t,n,this._radius,0,ja)}},result:uu};var ss,ls,hs,ds,ps,vs=Da(),gs={point:uu,lineStart:function(){gs.point=ys},lineEnd:function(){ss&&_s(ls,hs),gs.point=uu},polygonStart:function(){ss=!0},polygonEnd:function(){ss=null},result:function(){var t=+vs;return vs.reset(),t}};function ys(t,n){gs.point=_s,ls=ds=t,hs=ps=n}function _s(t,n){ds-=t,ps-=n,vs.add(eu(ds*ds+ps*ps)),ds=t,ps=n}function bs(){this._string=[]}function ms(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function xs(t){return function(n){var e=new ws;for(var r in t)e[r]=t[r];return e.stream=n,e}}function ws(){}function Ms(t,n,e){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),du(e,t.stream(Bf)),n(Bf.result()),null!=r&&t.clipExtent(r),t}function Ns(t,n,e){return Ms(t,function(e){var r=n[1][0]-n[0][0],i=n[1][1]-n[0][1],o=Math.min(r/(e[1][0]-e[0][0]),i/(e[1][1]-e[0][1])),a=+n[0][0]+(r-o*(e[1][0]+e[0][0]))/2,u=+n[0][1]+(i-o*(e[1][1]+e[0][1]))/2;t.scale(150*o).translate([a,u])},e)}function As(t,n,e){return Ns(t,[[0,0],n],e)}function Ts(t,n,e){return Ms(t,function(e){var r=+n,i=r/(e[1][0]-e[0][0]),o=(r-i*(e[1][0]+e[0][0]))/2,a=-i*e[0][1];t.scale(150*i).translate([o,a])},e)}function Ss(t,n,e){return Ms(t,function(e){var r=+n,i=r/(e[1][1]-e[0][1]),o=-i*e[0][0],a=(r-i*(e[1][1]+e[0][1]))/2;t.scale(150*i).translate([o,a])},e)}bs.prototype={_radius:4.5,_circle:ms(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,n){switch(this._point){case 0:this._string.push("M",t,",",n),this._point=1;break;case 1:this._string.push("L",t,",",n);break;default:null==this._circle&&(this._circle=ms(this._radius)),this._string.push("M",t,",",n,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}},ws.prototype={constructor:ws,point:function(t,n){this.stream.point(t,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ks=16,Es=Wa(30*Xa);function Cs(t,n){return+n?function(t,n){function e(r,i,o,a,u,c,f,s,l,h,d,p,v,g){var y=f-r,_=s-i,b=y*y+_*_;if(b>4*n&&v--){var m=a+h,x=u+d,w=c+p,M=eu(m*m+x*x+w*w),N=ou(w/=M),A=Ga(Ga(w)-1)<Oa||Ga(o-l)<Oa?(o+l)/2:$a(x,m),T=t(A,N),S=T[0],k=T[1],E=S-r,C=k-i,P=_*E-y*C;(P*P/b>n||Ga((y*E+_*C)/b-.5)>.3||a*h+u*d+c*p<Es)&&(e(r,i,o,a,u,c,S,k,A,m/=M,x/=M,w,v,g),g.point(S,k),e(S,k,A,m,x,w,f,s,l,h,d,p,v,g))}}return function(n){var r,i,o,a,u,c,f,s,l,h,d,p,v={point:g,lineStart:y,lineEnd:b,polygonStart:function(){n.polygonStart(),v.lineStart=m},polygonEnd:function(){n.polygonEnd(),v.lineStart=y}};function g(e,r){e=t(e,r),n.point(e[0],e[1])}function y(){s=NaN,v.point=_,n.lineStart()}function _(r,i){var o=Su([r,i]),a=t(r,i);e(s,l,f,h,d,p,s=a[0],l=a[1],f=r,h=o[0],d=o[1],p=o[2],ks,n),n.point(s,l)}function b(){v.point=g,n.lineEnd()}function m(){y(),v.point=x,v.lineEnd=w}function x(t,n){_(r=t,n),i=s,o=l,a=h,u=d,c=p,v.point=_}function w(){e(s,l,f,h,d,p,i,o,r,a,u,c,ks,n),v.lineEnd=b,b()}return v}}(t,n):function(t){return xs({point:function(n,e){n=t(n,e),this.stream.point(n[0],n[1])}})}(t)}var Ps=xs({point:function(t,n){this.stream.point(t*Xa,n*Xa)}});function zs(t,n,e,r){var i=Wa(r),o=tu(r),a=i*t,u=o*t,c=i/t,f=o/t,s=(o*e-i*n)/t,l=(o*n+i*e)/t;function h(t,r){return[a*t-u*r+n,e-u*t-a*r]}return h.invert=function(t,n){return[c*t-f*n+s,l-f*t-c*n]},h}function Rs(t){return Ds(function(){return t})()}function Ds(t){var n,e,r,i,o,a,u,c,f,s,l=150,h=480,d=250,p=0,v=0,g=0,y=0,_=0,b=0,m=null,x=$c,w=null,M=Mf,N=.5;function A(t){return c(t[0]*Xa,t[1]*Xa)}function T(t){return(t=c.invert(t[0],t[1]))&&[t[0]*Ha,t[1]*Ha]}function S(){var t=zs(l,0,0,b).apply(null,n(p,v)),r=(b?zs:function(t,n,e){function r(r,i){return[n+t*r,e-t*i]}return r.invert=function(r,i){return[(r-n)/t,(e-i)/t]},r})(l,h-t[0],d-t[1],b);return e=Pc(g,y,_),u=Ec(n,r),c=Ec(e,u),a=Cs(u,N),k()}function k(){return f=s=null,A}return A.stream=function(t){return f&&s===t?f:f=Ps(function(t){return xs({point:function(n,e){var r=t(n,e);return this.stream.point(r[0],r[1])}})}(e)(x(a(M(s=t)))))},A.preclip=function(t){return arguments.length?(x=t,m=void 0,k()):x},A.postclip=function(t){return arguments.length?(M=t,w=r=i=o=null,k()):M},A.clipAngle=function(t){return arguments.length?(x=+t?Wc(m=t*Xa):(m=null,$c),k()):m*Ha},A.clipExtent=function(t){return arguments.length?(M=null==t?(w=r=i=o=null,Mf):Jc(w=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),k()):null==w?null:[[w,r],[i,o]]},A.scale=function(t){return arguments.length?(l=+t,S()):l},A.translate=function(t){return arguments.length?(h=+t[0],d=+t[1],S()):[h,d]},A.center=function(t){return arguments.length?(p=t[0]%360*Xa,v=t[1]%360*Xa,S()):[p*Ha,v*Ha]},A.rotate=function(t){return arguments.length?(g=t[0]%360*Xa,y=t[1]%360*Xa,_=t.length>2?t[2]%360*Xa:0,S()):[g*Ha,y*Ha,_*Ha]},A.angle=function(t){return arguments.length?(b=t%360*Xa,S()):b*Ha},A.precision=function(t){return arguments.length?(a=Cs(u,N=t*t),k()):eu(N)},A.fitExtent=function(t,n){return Ns(A,t,n)},A.fitSize=function(t,n){return As(A,t,n)},A.fitWidth=function(t,n){return Ts(A,t,n)},A.fitHeight=function(t,n){return Ss(A,t,n)},function(){return n=t.apply(this,arguments),A.invert=n.invert&&T,S()}}function qs(t){var n=0,e=Ya/3,r=Ds(t),i=r(n,e);return i.parallels=function(t){return arguments.length?r(n=t[0]*Xa,e=t[1]*Xa):[n*Ha,e*Ha]},i}function Ls(t,n){var e=tu(t),r=(e+tu(n))/2;if(Ga(r)<Oa)return function(t){var n=Wa(t);function e(t,e){return[t*n,tu(e)/n]}return e.invert=function(t,e){return[t/n,ou(e*n)]},e}(t);var i=1+e*(2*r-e),o=eu(i)/r;function a(t,n){var e=eu(i-2*r*tu(n))/r;return[e*tu(t*=r),o-e*Wa(t)]}return a.invert=function(t,n){var e=o-n;return[$a(t,Ga(e))/r*nu(e),ou((i-(t*t+e*e)*r*r)/(2*r))]},a}function Us(){return qs(Ls).scale(155.424).center([0,33.6442])}function Os(){return Us().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Bs(t){return function(n,e){var r=Wa(n),i=Wa(e),o=t(r*i);return[o*i*tu(n),o*tu(e)]}}function Ys(t){return function(n,e){var r=eu(n*n+e*e),i=t(r),o=tu(i),a=Wa(i);return[$a(n*o,r*a),ou(r&&e*o/r)]}}var Fs=Bs(function(t){return eu(2/(1+t))});Fs.invert=Ys(function(t){return 2*ou(t/2)});var Is=Bs(function(t){return(t=iu(t))&&t/tu(t)});function js(t,n){return[t,Ja(ru((Fa+n)/2))]}function Hs(t){var n,e,r,i=Rs(t),o=i.center,a=i.scale,u=i.translate,c=i.clipExtent,f=null;function s(){var o=Ya*a(),u=i(qc(i.rotate()).invert([0,0]));return c(null==f?[[u[0]-o,u[1]-o],[u[0]+o,u[1]+o]]:t===js?[[Math.max(u[0]-o,f),n],[Math.min(u[0]+o,e),r]]:[[f,Math.max(u[1]-o,n)],[e,Math.min(u[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),s()):a()},i.translate=function(t){return arguments.length?(u(t),s()):u()},i.center=function(t){return arguments.length?(o(t),s()):o()},i.clipExtent=function(t){return arguments.length?(null==t?f=n=e=r=null:(f=+t[0][0],n=+t[0][1],e=+t[1][0],r=+t[1][1]),s()):null==f?null:[[f,n],[e,r]]},s()}function Xs(t){return ru((Fa+t)/2)}function Gs(t,n){var e=Wa(t),r=t===n?tu(t):Ja(e/Wa(n))/Ja(Xs(n)/Xs(t)),i=e*Ka(Xs(t),r)/r;if(!r)return js;function o(t,n){i>0?n<-Fa+Oa&&(n=-Fa+Oa):n>Fa-Oa&&(n=Fa-Oa);var e=i/Ka(Xs(n),r);return[e*tu(r*t),i-e*Wa(r*t)]}return o.invert=function(t,n){var e=i-n,o=nu(r)*eu(t*t+e*e);return[$a(t,Ga(e))/r*nu(e),2*Va(Ka(i/o,1/r))-Fa]},o}function Vs(t,n){return[t,n]}function $s(t,n){var e=Wa(t),r=t===n?tu(t):(e-Wa(n))/(n-t),i=e/r+t;if(Ga(r)<Oa)return Vs;function o(t,n){var e=i-n,o=r*t;return[e*tu(o),i-e*Wa(o)]}return o.invert=function(t,n){var e=i-n;return[$a(t,Ga(e))/r*nu(e),i-nu(r)*eu(t*t+e*e)]},o}Is.invert=Ys(function(t){return t}),js.invert=function(t,n){return[t,2*Va(Qa(n))-Fa]},Vs.invert=Vs;var Ws=1.340264,Zs=-.081106,Qs=893e-6,Js=.003796,Ks=eu(3)/2;function tl(t,n){var e=ou(Ks*tu(n)),r=e*e,i=r*r*r;return[t*Wa(e)/(Ks*(Ws+3*Zs*r+i*(7*Qs+9*Js*r))),e*(Ws+Zs*r+i*(Qs+Js*r))]}function nl(t,n){var e=Wa(n),r=Wa(t)*e;return[e*tu(t)/r,tu(n)/r]}function el(t,n,e,r){return 1===t&&1===n&&0===e&&0===r?Mf:xs({point:function(i,o){this.stream.point(i*t+e,o*n+r)}})}function rl(t,n){var e=n*n,r=e*e;return[t*(.8707-.131979*e+r*(r*(.003971*e-.001529*r)-.013791)),n*(1.007226+e*(.015085+r*(.028874*e-.044475-.005916*r)))]}function il(t,n){return[Wa(n)*tu(t),tu(n)]}function ol(t,n){var e=Wa(n),r=1+Wa(t)*e;return[e*tu(t)/r,tu(n)/r]}function al(t,n){return[Ja(ru((Fa+n)/2)),-t]}function ul(t,n){return t.parent===n.parent?1:2}function cl(t,n){return t+n.x}function fl(t,n){return Math.max(t,n.y)}function sl(t){var n=0,e=t.children,r=e&&e.length;if(r)for(;--r>=0;)n+=e[r].value;else n=1;t.value=n}function ll(t,n){var e,r,i,o,a,u=new vl(t),c=+t.value&&(u.value=t.value),f=[u];for(null==n&&(n=hl);e=f.pop();)if(c&&(e.value=+e.data.value),(i=n(e.data))&&(a=i.length))for(e.children=new Array(a),o=a-1;o>=0;--o)f.push(r=e.children[o]=new vl(i[o])),r.parent=e,r.depth=e.depth+1;return u.eachBefore(pl)}function hl(t){return t.children}function dl(t){t.data=t.data.data}function pl(t){var n=0;do{t.height=n}while((t=t.parent)&&t.height<++n)}function vl(t){this.data=t,this.depth=this.height=0,this.parent=null}tl.invert=function(t,n){for(var e,r=n,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=e=(r*(Ws+Zs*i+o*(Qs+Js*i))-n)/(Ws+3*Zs*i+o*(7*Qs+9*Js*i)))*r)*i*i,!(Ga(e)<Ba));++a);return[Ks*t*(Ws+3*Zs*i+o*(7*Qs+9*Js*i))/Wa(r),ou(tu(r)/Ks)]},nl.invert=Ys(Va),rl.invert=function(t,n){var e,r=n,i=25;do{var o=r*r,a=o*o;r-=e=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-n)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(Ga(e)>Oa&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},il.invert=Ys(ou),ol.invert=Ys(function(t){return 2*Va(t)}),al.invert=function(t,n){return[-n,2*Va(Qa(t))-Fa]},vl.prototype=ll.prototype={constructor:vl,count:function(){return this.eachAfter(sl)},each:function(t){var n,e,r,i,o=this,a=[o];do{for(n=a.reverse(),a=[];o=n.pop();)if(t(o),e=o.children)for(r=0,i=e.length;r<i;++r)a.push(e[r])}while(a.length);return this},eachAfter:function(t){for(var n,e,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),n=i.children)for(e=0,r=n.length;e<r;++e)o.push(n[e]);for(;i=a.pop();)t(i);return this},eachBefore:function(t){for(var n,e,r=this,i=[r];r=i.pop();)if(t(r),n=r.children)for(e=n.length-1;e>=0;--e)i.push(n[e]);return this},sum:function(t){return this.eachAfter(function(n){for(var e=+t(n.data)||0,r=n.children,i=r&&r.length;--i>=0;)e+=r[i].value;n.value=e})},sort:function(t){return this.eachBefore(function(n){n.children&&n.children.sort(t)})},path:function(t){for(var n=this,e=function(t,n){if(t===n)return t;var e=t.ancestors(),r=n.ancestors(),i=null;for(t=e.pop(),n=r.pop();t===n;)i=t,t=e.pop(),n=r.pop();return i}(n,t),r=[n];n!==e;)n=n.parent,r.push(n);for(var i=r.length;t!==e;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n},descendants:function(){var t=[];return this.each(function(n){t.push(n)}),t},leaves:function(){var t=[];return this.eachBefore(function(n){n.children||t.push(n)}),t},links:function(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n},copy:function(){return ll(this).eachBefore(dl)}};var gl=Array.prototype.slice;function yl(t){for(var n,e,r=0,i=(t=function(t){for(var n,e,r=t.length;r;)e=Math.random()*r--|0,n=t[r],t[r]=t[e],t[e]=n;return t}(gl.call(t))).length,o=[];r<i;)n=t[r],e&&ml(e,n)?++r:(e=wl(o=_l(o,n)),r=0);return e}function _l(t,n){var e,r;if(xl(n,t))return[n];for(e=0;e<t.length;++e)if(bl(n,t[e])&&xl(Ml(t[e],n),t))return[t[e],n];for(e=0;e<t.length-1;++e)for(r=e+1;r<t.length;++r)if(bl(Ml(t[e],t[r]),n)&&bl(Ml(t[e],n),t[r])&&bl(Ml(t[r],n),t[e])&&xl(Nl(t[e],t[r],n),t))return[t[e],t[r],n];throw new Error}function bl(t,n){var e=t.r-n.r,r=n.x-t.x,i=n.y-t.y;return e<0||e*e<r*r+i*i}function ml(t,n){var e=t.r-n.r+1e-6,r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function xl(t,n){for(var e=0;e<n.length;++e)if(!ml(t,n[e]))return!1;return!0}function wl(t){switch(t.length){case 1:return{x:(n=t[0]).x,y:n.y,r:n.r};case 2:return Ml(t[0],t[1]);case 3:return Nl(t[0],t[1],t[2])}var n}function Ml(t,n){var e=t.x,r=t.y,i=t.r,o=n.x,a=n.y,u=n.r,c=o-e,f=a-r,s=u-i,l=Math.sqrt(c*c+f*f);return{x:(e+o+c/l*s)/2,y:(r+a+f/l*s)/2,r:(l+i+u)/2}}function Nl(t,n,e){var r=t.x,i=t.y,o=t.r,a=n.x,u=n.y,c=n.r,f=e.x,s=e.y,l=e.r,h=r-a,d=r-f,p=i-u,v=i-s,g=c-o,y=l-o,_=r*r+i*i-o*o,b=_-a*a-u*u+c*c,m=_-f*f-s*s+l*l,x=d*p-h*v,w=(p*m-v*b)/(2*x)-r,M=(v*g-p*y)/x,N=(d*b-h*m)/(2*x)-i,A=(h*y-d*g)/x,T=M*M+A*A-1,S=2*(o+w*M+N*A),k=w*w+N*N-o*o,E=-(T?(S+Math.sqrt(S*S-4*T*k))/(2*T):k/S);return{x:r+w+M*E,y:i+N+A*E,r:E}}function Al(t,n,e){var r,i,o,a,u=t.x-n.x,c=t.y-n.y,f=u*u+c*c;f?(i=n.r+e.r,i*=i,a=t.r+e.r,i>(a*=a)?(r=(f+a-i)/(2*f),o=Math.sqrt(Math.max(0,a/f-r*r)),e.x=t.x-r*u-o*c,e.y=t.y-r*c+o*u):(r=(f+i-a)/(2*f),o=Math.sqrt(Math.max(0,i/f-r*r)),e.x=n.x+r*u-o*c,e.y=n.y+r*c+o*u)):(e.x=n.x+e.r,e.y=n.y)}function Tl(t,n){var e=t.r+n.r-1e-6,r=n.x-t.x,i=n.y-t.y;return e>0&&e*e>r*r+i*i}function Sl(t){var n=t._,e=t.next._,r=n.r+e.r,i=(n.x*e.r+e.x*n.r)/r,o=(n.y*e.r+e.y*n.r)/r;return i*i+o*o}function kl(t){this._=t,this.next=null,this.previous=null}function El(t){if(!(i=t.length))return 0;var n,e,r,i,o,a,u,c,f,s,l;if((n=t[0]).x=0,n.y=0,!(i>1))return n.r;if(e=t[1],n.x=-e.r,e.x=n.r,e.y=0,!(i>2))return n.r+e.r;Al(e,n,r=t[2]),n=new kl(n),e=new kl(e),r=new kl(r),n.next=r.previous=e,e.next=n.previous=r,r.next=e.previous=n;t:for(u=3;u<i;++u){Al(n._,e._,r=t[u]),r=new kl(r),c=e.next,f=n.previous,s=e._.r,l=n._.r;do{if(s<=l){if(Tl(c._,r._)){e=c,n.next=e,e.previous=n,--u;continue t}s+=c._.r,c=c.next}else{if(Tl(f._,r._)){(n=f).next=e,e.previous=n,--u;continue t}l+=f._.r,f=f.previous}}while(c!==f.next);for(r.previous=n,r.next=e,n.next=e.previous=e=r,o=Sl(n);(r=r.next)!==e;)(a=Sl(r))<o&&(n=r,o=a);e=n.next}for(n=[e._],r=e;(r=r.next)!==e;)n.push(r._);for(r=yl(n),u=0;u<i;++u)(n=t[u]).x-=r.x,n.y-=r.y;return r.r}function Cl(t){if("function"!=typeof t)throw new Error;return t}function Pl(){return 0}function zl(t){return function(){return t}}function Rl(t){return Math.sqrt(t.value)}function Dl(t){return function(n){n.children||(n.r=Math.max(0,+t(n)||0))}}function ql(t,n){return function(e){if(r=e.children){var r,i,o,a=r.length,u=t(e)*n||0;if(u)for(i=0;i<a;++i)r[i].r+=u;if(o=El(r),u)for(i=0;i<a;++i)r[i].r-=u;e.r=o+u}}}function Ll(t){return function(n){var e=n.parent;n.r*=t,e&&(n.x=e.x+t*n.x,n.y=e.y+t*n.y)}}function Ul(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Ol(t,n,e,r,i){for(var o,a=t.children,u=-1,c=a.length,f=t.value&&(r-n)/t.value;++u<c;)(o=a[u]).y0=e,o.y1=i,o.x0=n,o.x1=n+=o.value*f}var Bl="$",Yl={depth:-1},Fl={};function Il(t){return t.id}function jl(t){return t.parentId}function Hl(t,n){return t.parent===n.parent?1:2}function Xl(t){var n=t.children;return n?n[0]:t.t}function Gl(t){var n=t.children;return n?n[n.length-1]:t.t}function Vl(t,n,e){var r=e/(n.i-t.i);n.c-=r,n.s+=e,t.c+=r,n.z+=e,n.m+=e}function $l(t,n,e){return t.a.parent===n.parent?t.a:e}function Wl(t,n){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}function Zl(t,n,e,r,i){for(var o,a=t.children,u=-1,c=a.length,f=t.value&&(i-e)/t.value;++u<c;)(o=a[u]).x0=n,o.x1=r,o.y0=e,o.y1=e+=o.value*f}Wl.prototype=Object.create(vl.prototype);var Ql=(1+Math.sqrt(5))/2;function Jl(t,n,e,r,i,o){for(var a,u,c,f,s,l,h,d,p,v,g,y=[],_=n.children,b=0,m=0,x=_.length,w=n.value;b<x;){c=i-e,f=o-r;do{s=_[m++].value}while(!s&&m<x);for(l=h=s,g=s*s*(v=Math.max(f/c,c/f)/(w*t)),p=Math.max(h/g,g/l);m<x;++m){if(s+=u=_[m].value,u<l&&(l=u),u>h&&(h=u),g=s*s*v,(d=Math.max(h/g,g/l))>p){s-=u;break}p=d}y.push(a={value:s,dice:c<f,children:_.slice(b,m)}),a.dice?Ol(a,e,r,i,w?r+=f*s/w:o):Zl(a,e,r,w?e+=c*s/w:i,o),w-=s,b=m}return y}var Kl=function t(n){function e(t,e,r,i,o){Jl(n,t,e,r,i,o)}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(Ql);var th=function t(n){function e(t,e,r,i,o){if((a=t._squarify)&&a.ratio===n)for(var a,u,c,f,s,l=-1,h=a.length,d=t.value;++l<h;){for(c=(u=a[l]).children,f=u.value=0,s=c.length;f<s;++f)u.value+=c[f].value;u.dice?Ol(u,e,r,i,r+=(o-r)*u.value/d):Zl(u,e,r,e+=(i-e)*u.value/d,o),d-=u.value}else t._squarify=a=Jl(n,t,e,r,i,o),a.ratio=n}return e.ratio=function(n){return t((n=+n)>1?n:1)},e}(Ql);function nh(t,n){return t[0]-n[0]||t[1]-n[1]}function eh(t){for(var n,e,r,i=t.length,o=[0,1],a=2,u=2;u<i;++u){for(;a>1&&(n=t[o[a-2]],e=t[o[a-1]],r=t[u],(e[0]-n[0])*(r[1]-n[1])-(e[1]-n[1])*(r[0]-n[0])<=0);)--a;o[a++]=u}return o.slice(0,a)}function rh(){return Math.random()}var ih=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return n()*e+t}}return e.source=t,e}(rh),oh=function t(n){function e(t,e){var r,i;return t=null==t?0:+t,e=null==e?1:+e,function(){var o;if(null!=r)o=r,r=null;else do{r=2*n()-1,o=2*n()-1,i=r*r+o*o}while(!i||i>1);return t+e*o*Math.sqrt(-2*Math.log(i)/i)}}return e.source=t,e}(rh),ah=function t(n){function e(){var t=oh.source(n).apply(this,arguments);return function(){return Math.exp(t())}}return e.source=t,e}(rh),uh=function t(n){function e(t){return function(){for(var e=0,r=0;r<t;++r)e+=n();return e}}return e.source=t,e}(rh),ch=function t(n){function e(t){var e=uh.source(n)(t);return function(){return e()/t}}return e.source=t,e}(rh),fh=function t(n){function e(t){return function(){return-Math.log(1-n())/t}}return e.source=t,e}(rh);function sh(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}function lh(t,n){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(n).domain(t)}return this}var hh=Array.prototype,dh=hh.map,ph=hh.slice,vh={name:"implicit"};function gh(){var t=Qi(),n=[],e=[],r=vh;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==vh)return r;t.set(o,a=n.push(i))}return e[(a-1)%e.length]}return i.domain=function(e){if(!arguments.length)return n.slice();n=[],t=Qi();for(var r,o,a=-1,u=e.length;++a<u;)t.has(o=(r=e[a])+"")||t.set(o,n.push(r));return i},i.range=function(t){return arguments.length?(e=ph.call(t),i):e.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return gh(n,e).unknown(r)},sh.apply(i,arguments),i}function yh(){var t,n,e=gh().unknown(void 0),r=e.domain,i=e.range,o=[0,1],a=!1,u=0,c=0,f=.5;function s(){var e=r().length,s=o[1]<o[0],l=o[s-0],h=o[1-s];t=(h-l)/Math.max(1,e-u+2*c),a&&(t=Math.floor(t)),l+=(h-l-t*(e-u))*f,n=t*(1-u),a&&(l=Math.round(l),n=Math.round(n));var d=g(e).map(function(n){return l+t*n});return i(s?d.reverse():d)}return delete e.unknown,e.domain=function(t){return arguments.length?(r(t),s()):r()},e.range=function(t){return arguments.length?(o=[+t[0],+t[1]],s()):o.slice()},e.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,s()},e.bandwidth=function(){return n},e.step=function(){return t},e.round=function(t){return arguments.length?(a=!!t,s()):a},e.padding=function(t){return arguments.length?(u=Math.min(1,c=+t),s()):u},e.paddingInner=function(t){return arguments.length?(u=Math.min(1,t),s()):u},e.paddingOuter=function(t){return arguments.length?(c=+t,s()):c},e.align=function(t){return arguments.length?(f=Math.max(0,Math.min(1,t)),s()):f},e.copy=function(){return yh(r(),o).round(a).paddingInner(u).paddingOuter(c).align(f)},sh.apply(s(),arguments)}function _h(t){return+t}var bh=[0,1];function mh(t){return t}function xh(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:(e=isNaN(n)?NaN:.5,function(){return e});var e}function wh(t){var n,e=t[0],r=t[t.length-1];return e>r&&(n=e,e=r,r=n),function(t){return Math.max(e,Math.min(r,t))}}function Mh(t,n,e){var r=t[0],i=t[1],o=n[0],a=n[1];return i<r?(r=xh(i,r),o=e(a,o)):(r=xh(r,i),o=e(o,a)),function(t){return o(r(t))}}function Nh(t,n,e){var r=Math.min(t.length,n.length)-1,o=new Array(r),a=new Array(r),u=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++u<r;)o[u]=xh(t[u],t[u+1]),a[u]=e(n[u],n[u+1]);return function(n){var e=i(t,n,1,r)-1;return a[e](o[e](n))}}function Ah(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Th(){var t,n,e,r,i,o,a=bh,u=bh,c=ye,f=mh;function s(){return r=Math.min(a.length,u.length)>2?Nh:Mh,i=o=null,l}function l(n){return isNaN(n=+n)?e:(i||(i=r(a.map(t),u,c)))(t(f(n)))}return l.invert=function(e){return f(n((o||(o=r(u,a.map(t),he)))(e)))},l.domain=function(t){return arguments.length?(a=dh.call(t,_h),f===mh||(f=wh(a)),s()):a.slice()},l.range=function(t){return arguments.length?(u=ph.call(t),s()):u.slice()},l.rangeRound=function(t){return u=ph.call(t),c=_e,s()},l.clamp=function(t){return arguments.length?(f=t?wh(a):mh,l):f!==mh},l.interpolate=function(t){return arguments.length?(c=t,s()):c},l.unknown=function(t){return arguments.length?(e=t,l):e},function(e,r){return t=e,n=r,s()}}function Sh(t,n){return Th()(t,n)}function kh(n,e,r,i){var o,a=w(n,e,r);switch((i=wa(null==i?",f":i)).type){case"s":var u=Math.max(Math.abs(n),Math.abs(e));return null!=i.precision||isNaN(o=za(a,u))||(i.precision=o),t.formatPrefix(i,u);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(o=Ra(a,Math.max(Math.abs(n),Math.abs(e))))||(i.precision=o-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(o=Pa(a))||(i.precision=o-2*("%"===i.type))}return t.format(i)}function Eh(t){var n=t.domain;return t.ticks=function(t){var e=n();return m(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){var r=n();return kh(r[0],r[r.length-1],null==t?10:t,e)},t.nice=function(e){null==e&&(e=10);var r,i=n(),o=0,a=i.length-1,u=i[o],c=i[a];return c<u&&(r=u,u=c,c=r,r=o,o=a,a=r),(r=x(u,c,e))>0?r=x(u=Math.floor(u/r)*r,c=Math.ceil(c/r)*r,e):r<0&&(r=x(u=Math.ceil(u*r)/r,c=Math.floor(c*r)/r,e)),r>0?(i[o]=Math.floor(u/r)*r,i[a]=Math.ceil(c/r)*r,n(i)):r<0&&(i[o]=Math.ceil(u*r)/r,i[a]=Math.floor(c*r)/r,n(i)),t},t}function Ch(t,n){var e,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(e=r,r=i,i=e,e=o,o=a,a=e),t[r]=n.floor(o),t[i]=n.ceil(a),t}function Ph(t){return Math.log(t)}function zh(t){return Math.exp(t)}function Rh(t){return-Math.log(-t)}function Dh(t){return-Math.exp(-t)}function qh(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Lh(t){return function(n){return-t(-n)}}function Uh(n){var e,r,i=n(Ph,zh),o=i.domain,a=10;function u(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(n){return Math.log(n)/t})}(a),r=function(t){return 10===t?qh:t===Math.E?Math.exp:function(n){return Math.pow(t,n)}}(a),o()[0]<0?(e=Lh(e),r=Lh(r),n(Rh,Dh)):n(Ph,zh),i}return i.base=function(t){return arguments.length?(a=+t,u()):a},i.domain=function(t){return arguments.length?(o(t),u()):o()},i.ticks=function(t){var n,i=o(),u=i[0],c=i[i.length-1];(n=c<u)&&(h=u,u=c,c=h);var f,s,l,h=e(u),d=e(c),p=null==t?10:+t,v=[];if(!(a%1)&&d-h<p){if(h=Math.round(h)-1,d=Math.round(d)+1,u>0){for(;h<d;++h)for(s=1,f=r(h);s<a;++s)if(!((l=f*s)<u)){if(l>c)break;v.push(l)}}else for(;h<d;++h)for(s=a-1,f=r(h);s>=1;--s)if(!((l=f*s)<u)){if(l>c)break;v.push(l)}}else v=m(h,d,Math.min(d-h,p)).map(r);return n?v.reverse():v},i.tickFormat=function(n,o){if(null==o&&(o=10===a?".0e":","),"function"!=typeof o&&(o=t.format(o)),n===1/0)return o;null==n&&(n=10);var u=Math.max(1,a*n/i.ticks().length);return function(t){var n=t/r(Math.round(e(t)));return n*a<a-.5&&(n*=a),n<=u?o(t):""}},i.nice=function(){return o(Ch(o(),{floor:function(t){return r(Math.floor(e(t)))},ceil:function(t){return r(Math.ceil(e(t)))}}))},i}function Oh(t){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/t))}}function Bh(t){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*t}}function Yh(t){var n=1,e=t(Oh(n),Bh(n));return e.constant=function(e){return arguments.length?t(Oh(n=+e),Bh(n)):n},Eh(e)}function Fh(t){return function(n){return n<0?-Math.pow(-n,t):Math.pow(n,t)}}function Ih(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function jh(t){return t<0?-t*t:t*t}function Hh(t){var n=t(mh,mh),e=1;return n.exponent=function(n){return arguments.length?1===(e=+n)?t(mh,mh):.5===e?t(Ih,jh):t(Fh(e),Fh(1/e)):e},Eh(n)}function Xh(){var t=Hh(Th());return t.copy=function(){return Ah(t,Xh()).exponent(t.exponent())},sh.apply(t,arguments),t}var Gh=new Date,Vh=new Date;function $h(t,n,e,r){function i(n){return t(n=new Date(+n)),n}return i.floor=i,i.ceil=function(e){return t(e=new Date(e-1)),n(e,1),t(e),e},i.round=function(t){var n=i(t),e=i.ceil(t);return t-n<e-t?n:e},i.offset=function(t,e){return n(t=new Date(+t),null==e?1:Math.floor(e)),t},i.range=function(e,r,o){var a,u=[];if(e=i.ceil(e),o=null==o?1:Math.floor(o),!(e<r&&o>0))return u;do{u.push(a=new Date(+e)),n(e,o),t(e)}while(a<e&&e<r);return u},i.filter=function(e){return $h(function(n){if(n>=n)for(;t(n),!e(n);)n.setTime(n-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;n(t,-1),!e(t););else for(;--r>=0;)for(;n(t,1),!e(t););})},e&&(i.count=function(n,r){return Gh.setTime(+n),Vh.setTime(+r),t(Gh),t(Vh),Math.floor(e(Gh,Vh))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(n){return r(n)%t==0}:function(n){return i.count(0,n)%t==0}):i:null}),i}var Wh=$h(function(){},function(t,n){t.setTime(+t+n)},function(t,n){return n-t});Wh.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?$h(function(n){n.setTime(Math.floor(n/t)*t)},function(n,e){n.setTime(+n+e*t)},function(n,e){return(e-n)/t}):Wh:null};var Zh=Wh.range,Qh=6e4,Jh=6048e5,Kh=$h(function(t){t.setTime(t-t.getMilliseconds())},function(t,n){t.setTime(+t+1e3*n)},function(t,n){return(n-t)/1e3},function(t){return t.getUTCSeconds()}),td=Kh.range,nd=$h(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())},function(t,n){t.setTime(+t+n*Qh)},function(t,n){return(n-t)/Qh},function(t){return t.getMinutes()}),ed=nd.range,rd=$h(function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-t.getMinutes()*Qh)},function(t,n){t.setTime(+t+36e5*n)},function(t,n){return(n-t)/36e5},function(t){return t.getHours()}),id=rd.range,od=$h(function(t){t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Qh)/864e5},function(t){return t.getDate()-1}),ad=od.range;function ud(t){return $h(function(n){n.setDate(n.getDate()-(n.getDay()+7-t)%7),n.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+7*n)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Qh)/Jh})}var cd=ud(0),fd=ud(1),sd=ud(2),ld=ud(3),hd=ud(4),dd=ud(5),pd=ud(6),vd=cd.range,gd=fd.range,yd=sd.range,_d=ld.range,bd=hd.range,md=dd.range,xd=pd.range,wd=$h(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,n){t.setMonth(t.getMonth()+n)},function(t,n){return n.getMonth()-t.getMonth()+12*(n.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}),Md=wd.range,Nd=$h(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n)},function(t,n){return n.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Nd.every=function(t){return isFinite(t=Math.floor(t))&&t>0?$h(function(n){n.setFullYear(Math.floor(n.getFullYear()/t)*t),n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,e){n.setFullYear(n.getFullYear()+e*t)}):null};var Ad=Nd.range,Td=$h(function(t){t.setUTCSeconds(0,0)},function(t,n){t.setTime(+t+n*Qh)},function(t,n){return(n-t)/Qh},function(t){return t.getUTCMinutes()}),Sd=Td.range,kd=$h(function(t){t.setUTCMinutes(0,0,0)},function(t,n){t.setTime(+t+36e5*n)},function(t,n){return(n-t)/36e5},function(t){return t.getUTCHours()}),Ed=kd.range,Cd=$h(function(t){t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n)},function(t,n){return(n-t)/864e5},function(t){return t.getUTCDate()-1}),Pd=Cd.range;function zd(t){return $h(function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-t)%7),n.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+7*n)},function(t,n){return(n-t)/Jh})}var Rd=zd(0),Dd=zd(1),qd=zd(2),Ld=zd(3),Ud=zd(4),Od=zd(5),Bd=zd(6),Yd=Rd.range,Fd=Dd.range,Id=qd.range,jd=Ld.range,Hd=Ud.range,Xd=Od.range,Gd=Bd.range,Vd=$h(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCMonth(t.getUTCMonth()+n)},function(t,n){return n.getUTCMonth()-t.getUTCMonth()+12*(n.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}),$d=Vd.range,Wd=$h(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n)},function(t,n){return n.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Wd.every=function(t){return isFinite(t=Math.floor(t))&&t>0?$h(function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/t)*t),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,e){n.setUTCFullYear(n.getUTCFullYear()+e*t)}):null};var Zd=Wd.range;function Qd(t){if(0<=t.y&&t.y<100){var n=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return n.setFullYear(t.y),n}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Jd(t){if(0<=t.y&&t.y<100){var n=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return n.setUTCFullYear(t.y),n}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Kd(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function tp(t){var n=t.dateTime,e=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,u=t.months,c=t.shortMonths,f=cp(i),s=fp(i),l=cp(o),h=fp(o),d=cp(a),p=fp(a),v=cp(u),g=fp(u),y=cp(c),_=fp(c),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:null,d:Ep,e:Ep,f:Dp,H:Cp,I:Pp,j:zp,L:Rp,m:qp,M:Lp,p:function(t){return i[+(t.getHours()>=12)]},Q:sv,s:lv,S:Up,u:Op,U:Bp,V:Yp,w:Fp,W:Ip,x:null,X:null,y:jp,Y:Hp,Z:Xp,"%":fv},m={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return u[t.getUTCMonth()]},c:null,d:Gp,e:Gp,f:Qp,H:Vp,I:$p,j:Wp,L:Zp,m:Jp,M:Kp,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:sv,s:lv,S:tv,u:nv,U:ev,V:rv,w:iv,W:ov,x:null,X:null,y:av,Y:uv,Z:cv,"%":fv},x={a:function(t,n,e){var r=d.exec(n.slice(e));return r?(t.w=p[r[0].toLowerCase()],e+r[0].length):-1},A:function(t,n,e){var r=l.exec(n.slice(e));return r?(t.w=h[r[0].toLowerCase()],e+r[0].length):-1},b:function(t,n,e){var r=y.exec(n.slice(e));return r?(t.m=_[r[0].toLowerCase()],e+r[0].length):-1},B:function(t,n,e){var r=v.exec(n.slice(e));return r?(t.m=g[r[0].toLowerCase()],e+r[0].length):-1},c:function(t,e,r){return N(t,n,e,r)},d:bp,e:bp,f:Ap,H:xp,I:xp,j:mp,L:Np,m:_p,M:wp,p:function(t,n,e){var r=f.exec(n.slice(e));return r?(t.p=s[r[0].toLowerCase()],e+r[0].length):-1},Q:Sp,s:kp,S:Mp,u:lp,U:hp,V:dp,w:sp,W:pp,x:function(t,n,r){return N(t,e,n,r)},X:function(t,n,e){return N(t,r,n,e)},y:gp,Y:vp,Z:yp,"%":Tp};function w(t,n){return function(e){var r,i,o,a=[],u=-1,c=0,f=t.length;for(e instanceof Date||(e=new Date(+e));++u<f;)37===t.charCodeAt(u)&&(a.push(t.slice(c,u)),null!=(i=ep[r=t.charAt(++u)])?r=t.charAt(++u):i="e"===r?" ":"0",(o=n[r])&&(r=o(e,i)),a.push(r),c=u+1);return a.push(t.slice(c,u)),a.join("")}}function M(t,n){return function(e){var r,i,o=Kd(1900);if(N(o,t,e+="",0)!=e.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=Jd(Kd(o.y))).getUTCDay(),r=i>4||0===i?Dd.ceil(r):Dd(r),r=Cd.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=n(Kd(o.y))).getDay(),r=i>4||0===i?fd.ceil(r):fd(r),r=od.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?Jd(Kd(o.y)).getUTCDay():n(Kd(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,Jd(o)):n(o)}}function N(t,n,e,r){for(var i,o,a=0,u=n.length,c=e.length;a<u;){if(r>=c)return-1;if(37===(i=n.charCodeAt(a++))){if(i=n.charAt(a++),!(o=x[i in ep?n.charAt(a++):i])||(r=o(t,e,r))<0)return-1}else if(i!=e.charCodeAt(r++))return-1}return r}return b.x=w(e,b),b.X=w(r,b),b.c=w(n,b),m.x=w(e,m),m.X=w(r,m),m.c=w(n,m),{format:function(t){var n=w(t+="",b);return n.toString=function(){return t},n},parse:function(t){var n=M(t+="",Qd);return n.toString=function(){return t},n},utcFormat:function(t){var n=w(t+="",m);return n.toString=function(){return t},n},utcParse:function(t){var n=M(t,Jd);return n.toString=function(){return t},n}}}var np,ep={"-":"",_:" ",0:"0"},rp=/^\s*\d+/,ip=/^%/,op=/[\\^$*+?|[\]().{}]/g;function ap(t,n,e){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<e?new Array(e-o+1).join(n)+i:i)}function up(t){return t.replace(op,"\\$&")}function cp(t){return new RegExp("^(?:"+t.map(up).join("|")+")","i")}function fp(t){for(var n={},e=-1,r=t.length;++e<r;)n[t[e].toLowerCase()]=e;return n}function sp(t,n,e){var r=rp.exec(n.slice(e,e+1));return r?(t.w=+r[0],e+r[0].length):-1}function lp(t,n,e){var r=rp.exec(n.slice(e,e+1));return r?(t.u=+r[0],e+r[0].length):-1}function hp(t,n,e){var r=rp.exec(n.slice(e,e+2));return r?(t.U=+r[0],e+r[0].length):-1}function dp(t,n,e){var r=rp.exec(n.slice(e,e+2));return r?(t.V=+r[0],e+r[0].length):-1}function pp(t,n,e){var r=rp.exec(n.slice(e,e+2));return r?(t.W=+r[0],e+r[0].length):-1}function vp(t,n,e){var r=rp.exec(n.slice(e,e+4));return r?(t.y=+r[0],e+r[0].length):-1}function gp(t,n,e){var r=rp.exec(n.slice(e,e+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1}function yp(t,n,e){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(e,e+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1}function _p(t,n,e){var r=rp.exec(n.slice(e,e+2));return r?(t.m=r[0]-1,e+r[0].length):-1}function bp(t,n,e){var r=rp.exec(n.slice(e,e+2));return r?(t.d=+r[0],e+r[0].length):-1}function mp(t,n,e){var r=rp.exec(n.slice(e,e+3));return r?(t.m=0,t.d=+r[0],e+r[0].length):-1}function xp(t,n,e){var r=rp.exec(n.slice(e,e+2));return r?(t.H=+r[0],e+r[0].length):-1}function wp(t,n,e){var r=rp.exec(n.slice(e,e+2));return r?(t.M=+r[0],e+r[0].length):-1}function Mp(t,n,e){var r=rp.exec(n.slice(e,e+2));return r?(t.S=+r[0],e+r[0].length):-1}function Np(t,n,e){var r=rp.exec(n.slice(e,e+3));return r?(t.L=+r[0],e+r[0].length):-1}function Ap(t,n,e){var r=rp.exec(n.slice(e,e+6));return r?(t.L=Math.floor(r[0]/1e3),e+r[0].length):-1}function Tp(t,n,e){var r=ip.exec(n.slice(e,e+1));return r?e+r[0].length:-1}function Sp(t,n,e){var r=rp.exec(n.slice(e));return r?(t.Q=+r[0],e+r[0].length):-1}function kp(t,n,e){var r=rp.exec(n.slice(e));return r?(t.Q=1e3*+r[0],e+r[0].length):-1}function Ep(t,n){return ap(t.getDate(),n,2)}function Cp(t,n){return ap(t.getHours(),n,2)}function Pp(t,n){return ap(t.getHours()%12||12,n,2)}function zp(t,n){return ap(1+od.count(Nd(t),t),n,3)}function Rp(t,n){return ap(t.getMilliseconds(),n,3)}function Dp(t,n){return Rp(t,n)+"000"}function qp(t,n){return ap(t.getMonth()+1,n,2)}function Lp(t,n){return ap(t.getMinutes(),n,2)}function Up(t,n){return ap(t.getSeconds(),n,2)}function Op(t){var n=t.getDay();return 0===n?7:n}function Bp(t,n){return ap(cd.count(Nd(t),t),n,2)}function Yp(t,n){var e=t.getDay();return t=e>=4||0===e?hd(t):hd.ceil(t),ap(hd.count(Nd(t),t)+(4===Nd(t).getDay()),n,2)}function Fp(t){return t.getDay()}function Ip(t,n){return ap(fd.count(Nd(t),t),n,2)}function jp(t,n){return ap(t.getFullYear()%100,n,2)}function Hp(t,n){return ap(t.getFullYear()%1e4,n,4)}function Xp(t){var n=t.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+ap(n/60|0,"0",2)+ap(n%60,"0",2)}function Gp(t,n){return ap(t.getUTCDate(),n,2)}function Vp(t,n){return ap(t.getUTCHours(),n,2)}function $p(t,n){return ap(t.getUTCHours()%12||12,n,2)}function Wp(t,n){return ap(1+Cd.count(Wd(t),t),n,3)}function Zp(t,n){return ap(t.getUTCMilliseconds(),n,3)}function Qp(t,n){return Zp(t,n)+"000"}function Jp(t,n){return ap(t.getUTCMonth()+1,n,2)}function Kp(t,n){return ap(t.getUTCMinutes(),n,2)}function tv(t,n){return ap(t.getUTCSeconds(),n,2)}function nv(t){var n=t.getUTCDay();return 0===n?7:n}function ev(t,n){return ap(Rd.count(Wd(t),t),n,2)}function rv(t,n){var e=t.getUTCDay();return t=e>=4||0===e?Ud(t):Ud.ceil(t),ap(Ud.count(Wd(t),t)+(4===Wd(t).getUTCDay()),n,2)}function iv(t){return t.getUTCDay()}function ov(t,n){return ap(Dd.count(Wd(t),t),n,2)}function av(t,n){return ap(t.getUTCFullYear()%100,n,2)}function uv(t,n){return ap(t.getUTCFullYear()%1e4,n,4)}function cv(){return"+0000"}function fv(){return"%"}function sv(t){return+t}function lv(t){return Math.floor(+t/1e3)}function hv(n){return np=tp(n),t.timeFormat=np.format,t.timeParse=np.parse,t.utcFormat=np.utcFormat,t.utcParse=np.utcParse,np}hv({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var dv=Date.prototype.toISOString?function(t){return t.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ");var pv=+new Date("2000-01-01T00:00:00.000Z")?function(t){var n=new Date(t);return isNaN(n)?null:n}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ"),vv=1e3,gv=60*vv,yv=60*gv,_v=24*yv,bv=7*_v,mv=30*_v,xv=365*_v;function wv(t){return new Date(t)}function Mv(t){return t instanceof Date?+t:+new Date(+t)}function Nv(t,n,r,i,o,a,u,c,f){var s=Sh(mh,mh),l=s.invert,h=s.domain,d=f(".%L"),p=f(":%S"),v=f("%I:%M"),g=f("%I %p"),y=f("%a %d"),_=f("%b %d"),b=f("%B"),m=f("%Y"),x=[[u,1,vv],[u,5,5*vv],[u,15,15*vv],[u,30,30*vv],[a,1,gv],[a,5,5*gv],[a,15,15*gv],[a,30,30*gv],[o,1,yv],[o,3,3*yv],[o,6,6*yv],[o,12,12*yv],[i,1,_v],[i,2,2*_v],[r,1,bv],[n,1,mv],[n,3,3*mv],[t,1,xv]];function M(e){return(u(e)<e?d:a(e)<e?p:o(e)<e?v:i(e)<e?g:n(e)<e?r(e)<e?y:_:t(e)<e?b:m)(e)}function N(n,r,i,o){if(null==n&&(n=10),"number"==typeof n){var a=Math.abs(i-r)/n,u=e(function(t){return t[2]}).right(x,a);u===x.length?(o=w(r/xv,i/xv,n),n=t):u?(o=(u=x[a/x[u-1][2]<x[u][2]/a?u-1:u])[1],n=u[0]):(o=Math.max(w(r,i,n),1),n=c)}return null==o?n:n.every(o)}return s.invert=function(t){return new Date(l(t))},s.domain=function(t){return arguments.length?h(dh.call(t,Mv)):h().map(wv)},s.ticks=function(t,n){var e,r=h(),i=r[0],o=r[r.length-1],a=o<i;return a&&(e=i,i=o,o=e),e=(e=N(t,i,o,n))?e.range(i,o+1):[],a?e.reverse():e},s.tickFormat=function(t,n){return null==n?M:f(n)},s.nice=function(t,n){var e=h();return(t=N(t,e[0],e[e.length-1],n))?h(Ch(e,t)):s},s.copy=function(){return Ah(s,Nv(t,n,r,i,o,a,u,c,f))},s}function Av(){var t,n,e,r,i,o=0,a=1,u=mh,c=!1;function f(n){return isNaN(n=+n)?i:u(0===e?.5:(n=(r(n)-t)*e,c?Math.max(0,Math.min(1,n)):n))}return f.domain=function(i){return arguments.length?(t=r(o=+i[0]),n=r(a=+i[1]),e=t===n?0:1/(n-t),f):[o,a]},f.clamp=function(t){return arguments.length?(c=!!t,f):c},f.interpolator=function(t){return arguments.length?(u=t,f):u},f.unknown=function(t){return arguments.length?(i=t,f):i},function(i){return r=i,t=i(o),n=i(a),e=t===n?0:1/(n-t),f}}function Tv(t,n){return n.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Sv(){var t=Hh(Av());return t.copy=function(){return Tv(t,Sv()).exponent(t.exponent())},lh.apply(t,arguments)}function kv(){var t,n,e,r,i,o,a,u=0,c=.5,f=1,s=mh,l=!1;function h(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-n)*(t<n?r:i),s(l?Math.max(0,Math.min(1,t)):t))}return h.domain=function(a){return arguments.length?(t=o(u=+a[0]),n=o(c=+a[1]),e=o(f=+a[2]),r=t===n?0:.5/(n-t),i=n===e?0:.5/(e-n),h):[u,c,f]},h.clamp=function(t){return arguments.length?(l=!!t,h):l},h.interpolator=function(t){return arguments.length?(s=t,h):s},h.unknown=function(t){return arguments.length?(a=t,h):a},function(a){return o=a,t=a(u),n=a(c),e=a(f),r=t===n?0:.5/(n-t),i=n===e?0:.5/(e-n),h}}function Ev(){var t=Hh(kv());return t.copy=function(){return Tv(t,Ev()).exponent(t.exponent())},lh.apply(t,arguments)}function Cv(t){for(var n=t.length/6|0,e=new Array(n),r=0;r<n;)e[r]="#"+t.slice(6*r,6*++r);return e}var Pv=Cv("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),zv=Cv("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Rv=Cv("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Dv=Cv("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),qv=Cv("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Lv=Cv("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Uv=Cv("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Ov=Cv("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Bv=Cv("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function Yv(t){return ce(t[t.length-1])}var Fv=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Cv),Iv=Yv(Fv),jv=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Cv),Hv=Yv(jv),Xv=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Cv),Gv=Yv(Xv),Vv=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Cv),$v=Yv(Vv),Wv=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Cv),Zv=Yv(Wv),Qv=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Cv),Jv=Yv(Qv),Kv=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Cv),tg=Yv(Kv),ng=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Cv),eg=Yv(ng),rg=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Cv),ig=Yv(rg),og=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Cv),ag=Yv(og),ug=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Cv),cg=Yv(ug),fg=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Cv),sg=Yv(fg),lg=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Cv),hg=Yv(lg),dg=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Cv),pg=Yv(dg),vg=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Cv),gg=Yv(vg),yg=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Cv),_g=Yv(yg),bg=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Cv),mg=Yv(bg),xg=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Cv),wg=Yv(xg),Mg=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Cv),Ng=Yv(Mg),Ag=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Cv),Tg=Yv(Ag),Sg=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Cv),kg=Yv(Sg),Eg=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Cv),Cg=Yv(Eg),Pg=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Cv),zg=Yv(Pg),Rg=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Cv),Dg=Yv(Rg),qg=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Cv),Lg=Yv(qg),Ug=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Cv),Og=Yv(Ug),Bg=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Cv),Yg=Yv(Bg),Fg=je(Zn(300,.5,0),Zn(-240,.5,1)),Ig=je(Zn(-100,.75,.35),Zn(80,1.5,.8)),jg=je(Zn(260,.75,.35),Zn(80,1.5,.8)),Hg=Zn();var Xg=gn(),Gg=Math.PI/3,Vg=2*Math.PI/3;function $g(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}}var Wg=$g(Cv("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Zg=$g(Cv("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Qg=$g(Cv("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Jg=$g(Cv("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function Kg(t){return function(){return t}}var ty=Math.abs,ny=Math.atan2,ey=Math.cos,ry=Math.max,iy=Math.min,oy=Math.sin,ay=Math.sqrt,uy=1e-12,cy=Math.PI,fy=cy/2,sy=2*cy;function ly(t){return t>=1?fy:t<=-1?-fy:Math.asin(t)}function hy(t){return t.innerRadius}function dy(t){return t.outerRadius}function py(t){return t.startAngle}function vy(t){return t.endAngle}function gy(t){return t&&t.padAngle}function yy(t,n,e,r,i,o,a){var u=t-e,c=n-r,f=(a?o:-o)/ay(u*u+c*c),s=f*c,l=-f*u,h=t+s,d=n+l,p=e+s,v=r+l,g=(h+p)/2,y=(d+v)/2,_=p-h,b=v-d,m=_*_+b*b,x=i-o,w=h*v-p*d,M=(b<0?-1:1)*ay(ry(0,x*x*m-w*w)),N=(w*b-_*M)/m,A=(-w*_-b*M)/m,T=(w*b+_*M)/m,S=(-w*_+b*M)/m,k=N-g,E=A-y,C=T-g,P=S-y;return k*k+E*E>C*C+P*P&&(N=T,A=S),{cx:N,cy:A,x01:-s,y01:-l,x11:N*(i/x-1),y11:A*(i/x-1)}}function _y(t){this._context=t}function by(t){return new _y(t)}function my(t){return t[0]}function xy(t){return t[1]}function wy(){var t=my,n=xy,e=Kg(!0),r=null,i=by,o=null;function a(a){var u,c,f,s=a.length,l=!1;for(null==r&&(o=i(f=Hi())),u=0;u<=s;++u)!(u<s&&e(c=a[u],u,a))===l&&((l=!l)?o.lineStart():o.lineEnd()),l&&o.point(+t(c,u,a),+n(c,u,a));if(f)return o=null,f+""||null}return a.x=function(n){return arguments.length?(t="function"==typeof n?n:Kg(+n),a):t},a.y=function(t){return arguments.length?(n="function"==typeof t?t:Kg(+t),a):n},a.defined=function(t){return arguments.length?(e="function"==typeof t?t:Kg(!!t),a):e},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a}function My(){var t=my,n=null,e=Kg(0),r=xy,i=Kg(!0),o=null,a=by,u=null;function c(c){var f,s,l,h,d,p=c.length,v=!1,g=new Array(p),y=new Array(p);for(null==o&&(u=a(d=Hi())),f=0;f<=p;++f){if(!(f<p&&i(h=c[f],f,c))===v)if(v=!v)s=f,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),l=f-1;l>=s;--l)u.point(g[l],y[l]);u.lineEnd(),u.areaEnd()}v&&(g[f]=+t(h,f,c),y[f]=+e(h,f,c),u.point(n?+n(h,f,c):g[f],r?+r(h,f,c):y[f]))}if(d)return u=null,d+""||null}function f(){return wy().defined(i).curve(a).context(o)}return c.x=function(e){return arguments.length?(t="function"==typeof e?e:Kg(+e),n=null,c):t},c.x0=function(n){return arguments.length?(t="function"==typeof n?n:Kg(+n),c):t},c.x1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:Kg(+t),c):n},c.y=function(t){return arguments.length?(e="function"==typeof t?t:Kg(+t),r=null,c):e},c.y0=function(t){return arguments.length?(e="function"==typeof t?t:Kg(+t),c):e},c.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Kg(+t),c):r},c.lineX0=c.lineY0=function(){return f().x(t).y(e)},c.lineY1=function(){return f().x(t).y(r)},c.lineX1=function(){return f().x(n).y(e)},c.defined=function(t){return arguments.length?(i="function"==typeof t?t:Kg(!!t),c):i},c.curve=function(t){return arguments.length?(a=t,null!=o&&(u=a(o)),c):a},c.context=function(t){return arguments.length?(null==t?o=u=null:u=a(o=t),c):o},c}function Ny(t,n){return n<t?-1:n>t?1:n>=t?0:NaN}function Ay(t){return t}_y.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n)}}};var Ty=ky(by);function Sy(t){this._curve=t}function ky(t){function n(n){return new Sy(t(n))}return n._curve=t,n}function Ey(t){var n=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?n(ky(t)):n()._curve},t}function Cy(){return Ey(wy().curve(Ty))}function Py(){var t=My().curve(Ty),n=t.curve,e=t.lineX0,r=t.lineX1,i=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return Ey(e())},delete t.lineX0,t.lineEndAngle=function(){return Ey(r())},delete t.lineX1,t.lineInnerRadius=function(){return Ey(i())},delete t.lineY0,t.lineOuterRadius=function(){return Ey(o())},delete t.lineY1,t.curve=function(t){return arguments.length?n(ky(t)):n()._curve},t}function zy(t,n){return[(n=+n)*Math.cos(t-=Math.PI/2),n*Math.sin(t)]}Sy.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,n){this._curve.point(n*Math.sin(t),n*-Math.cos(t))}};var Ry=Array.prototype.slice;function Dy(t){return t.source}function qy(t){return t.target}function Ly(t){var n=Dy,e=qy,r=my,i=xy,o=null;function a(){var a,u=Ry.call(arguments),c=n.apply(this,u),f=e.apply(this,u);if(o||(o=a=Hi()),t(o,+r.apply(this,(u[0]=c,u)),+i.apply(this,u),+r.apply(this,(u[0]=f,u)),+i.apply(this,u)),a)return o=null,a+""||null}return a.source=function(t){return arguments.length?(n=t,a):n},a.target=function(t){return arguments.length?(e=t,a):e},a.x=function(t){return arguments.length?(r="function"==typeof t?t:Kg(+t),a):r},a.y=function(t){return arguments.length?(i="function"==typeof t?t:Kg(+t),a):i},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a}function Uy(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n=(n+r)/2,e,n,i,r,i)}function Oy(t,n,e,r,i){t.moveTo(n,e),t.bezierCurveTo(n,e=(e+i)/2,r,e,r,i)}function By(t,n,e,r,i){var o=zy(n,e),a=zy(n,e=(e+i)/2),u=zy(r,e),c=zy(r,i);t.moveTo(o[0],o[1]),t.bezierCurveTo(a[0],a[1],u[0],u[1],c[0],c[1])}var Yy={draw:function(t,n){var e=Math.sqrt(n/cy);t.moveTo(e,0),t.arc(0,0,e,0,sy)}},Fy={draw:function(t,n){var e=Math.sqrt(n/5)/2;t.moveTo(-3*e,-e),t.lineTo(-e,-e),t.lineTo(-e,-3*e),t.lineTo(e,-3*e),t.lineTo(e,-e),t.lineTo(3*e,-e),t.lineTo(3*e,e),t.lineTo(e,e),t.lineTo(e,3*e),t.lineTo(-e,3*e),t.lineTo(-e,e),t.lineTo(-3*e,e),t.closePath()}},Iy=Math.sqrt(1/3),jy=2*Iy,Hy={draw:function(t,n){var e=Math.sqrt(n/jy),r=e*Iy;t.moveTo(0,-e),t.lineTo(r,0),t.lineTo(0,e),t.lineTo(-r,0),t.closePath()}},Xy=Math.sin(cy/10)/Math.sin(7*cy/10),Gy=Math.sin(sy/10)*Xy,Vy=-Math.cos(sy/10)*Xy,$y={draw:function(t,n){var e=Math.sqrt(.8908130915292852*n),r=Gy*e,i=Vy*e;t.moveTo(0,-e),t.lineTo(r,i);for(var o=1;o<5;++o){var a=sy*o/5,u=Math.cos(a),c=Math.sin(a);t.lineTo(c*e,-u*e),t.lineTo(u*r-c*i,c*r+u*i)}t.closePath()}},Wy={draw:function(t,n){var e=Math.sqrt(n),r=-e/2;t.rect(r,r,e,e)}},Zy=Math.sqrt(3),Qy={draw:function(t,n){var e=-Math.sqrt(n/(3*Zy));t.moveTo(0,2*e),t.lineTo(-Zy*e,-e),t.lineTo(Zy*e,-e),t.closePath()}},Jy=Math.sqrt(3)/2,Ky=1/Math.sqrt(12),t_=3*(Ky/2+1),n_={draw:function(t,n){var e=Math.sqrt(n/t_),r=e/2,i=e*Ky,o=r,a=e*Ky+e,u=-o,c=a;t.moveTo(r,i),t.lineTo(o,a),t.lineTo(u,c),t.lineTo(-.5*r-Jy*i,Jy*r+-.5*i),t.lineTo(-.5*o-Jy*a,Jy*o+-.5*a),t.lineTo(-.5*u-Jy*c,Jy*u+-.5*c),t.lineTo(-.5*r+Jy*i,-.5*i-Jy*r),t.lineTo(-.5*o+Jy*a,-.5*a-Jy*o),t.lineTo(-.5*u+Jy*c,-.5*c-Jy*u),t.closePath()}},e_=[Yy,Fy,Hy,Wy,$y,Qy,n_];function r_(){}function i_(t,n,e){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+e)/6)}function o_(t){this._context=t}function a_(t){this._context=t}function u_(t){this._context=t}function c_(t,n){this._basis=new o_(t),this._beta=n}o_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:i_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:i_(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},a_.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:i_(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},u_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var e=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break;case 3:this._point=4;default:i_(this,t,n)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}},c_.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,n=this._y,e=t.length-1;if(e>0)for(var r,i=t[0],o=n[0],a=t[e]-i,u=n[e]-o,c=-1;++c<=e;)r=c/e,this._basis.point(this._beta*t[c]+(1-this._beta)*(i+r*a),this._beta*n[c]+(1-this._beta)*(o+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(t,n){this._x.push(+t),this._y.push(+n)}};var f_=function t(n){function e(t){return 1===n?new o_(t):new c_(t,n)}return e.beta=function(n){return t(+n)},e}(.85);function s_(t,n,e){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-n),t._y2+t._k*(t._y1-e),t._x2,t._y2)}function l_(t,n){this._context=t,this._k=(1-n)/6}l_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:s_(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:s_(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var h_=function t(n){function e(t){return new l_(t,n)}return e.tension=function(n){return t(+n)},e}(0);function d_(t,n){this._context=t,this._k=(1-n)/6}d_.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:s_(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var p_=function t(n){function e(t){return new d_(t,n)}return e.tension=function(n){return t(+n)},e}(0);function v_(t,n){this._context=t,this._k=(1-n)/6}v_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:s_(this,t,n)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var g_=function t(n){function e(t){return new v_(t,n)}return e.tension=function(n){return t(+n)},e}(0);function y_(t,n,e){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>uy){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>uy){var f=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,s=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*f+t._x1*t._l23_2a-n*t._l12_2a)/s,a=(a*f+t._y1*t._l23_2a-e*t._l12_2a)/s}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function __(t,n){this._context=t,this._alpha=n}__.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:y_(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var b_=function t(n){function e(t){return n?new __(t,n):new l_(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function m_(t,n){this._context=t,this._alpha=n}m_.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:y_(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var x_=function t(n){function e(t){return n?new m_(t,n):new d_(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function w_(t,n){this._context=t,this._alpha=n}w_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){if(t=+t,n=+n,this._point){var e=this._x2-t,r=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(e*e+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:y_(this,t,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var M_=function t(n){function e(t){return n?new w_(t,n):new v_(t,0)}return e.alpha=function(n){return t(+n)},e}(.5);function N_(t){this._context=t}function A_(t){return t<0?-1:1}function T_(t,n,e){var r=t._x1-t._x0,i=n-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(e-t._y1)/(i||r<0&&-0),u=(o*i+a*r)/(r+i);return(A_(o)+A_(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(u))||0}function S_(t,n){var e=t._x1-t._x0;return e?(3*(t._y1-t._y0)/e-n)/2:n}function k_(t,n,e){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,u=(o-r)/3;t._context.bezierCurveTo(r+u,i+u*n,o-u,a-u*e,o,a)}function E_(t){this._context=t}function C_(t){this._context=new P_(t)}function P_(t){this._context=t}function z_(t){this._context=t}function R_(t){var n,e,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],n=1;n<r-1;++n)i[n]=1,o[n]=4,a[n]=4*t[n]+2*t[n+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],n=1;n<r;++n)e=i[n]/o[n-1],o[n]-=e,a[n]-=e*a[n-1];for(i[r-1]=a[r-1]/o[r-1],n=r-2;n>=0;--n)i[n]=(a[n]-i[n+1])/o[n];for(o[r-1]=(t[r]+i[r-1])/2,n=0;n<r-1;++n)o[n]=2*t[n+1]-i[n+1];return[i,o]}function D_(t,n){this._context=t,this._t=n}function q_(t,n){if((i=t.length)>1)for(var e,r,i,o=1,a=t[n[0]],u=a.length;o<i;++o)for(r=a,a=t[n[o]],e=0;e<u;++e)a[e][1]+=a[e][0]=isNaN(r[e][1])?r[e][0]:r[e][1]}function L_(t){for(var n=t.length,e=new Array(n);--n>=0;)e[n]=n;return e}function U_(t,n){return t[n]}function O_(t){var n=t.map(B_);return L_(t).sort(function(t,e){return n[t]-n[e]})}function B_(t){for(var n,e=-1,r=0,i=t.length,o=-1/0;++e<i;)(n=+t[e][1])>o&&(o=n,r=e);return r}function Y_(t){var n=t.map(F_);return L_(t).sort(function(t,e){return n[t]-n[e]})}function F_(t){for(var n,e=0,r=-1,i=t.length;++r<i;)(n=+t[r][1])&&(e+=n);return e}function I_(t){return function(){return t}}function j_(t){return t[0]}function H_(t){return t[1]}function X_(){this._=null}function G_(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function V_(t,n){var e=n,r=n.R,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function $_(t,n){var e=n,r=n.L,i=e.U;i?i.L===e?i.L=r:i.R=r:t._=r,r.U=i,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function W_(t){for(;t.L;)t=t.L;return t}function Z_(t,n,e,r){var i=[null,null],o=mb.push(i)-1;return i.left=t,i.right=n,e&&J_(i,t,n,e),r&&J_(i,n,t,r),_b[t.index].halfedges.push(o),_b[n.index].halfedges.push(o),i}function Q_(t,n,e){var r=[n,e];return r.left=t,r}function J_(t,n,e,r){t[0]||t[1]?t.left===e?t[1]=r:t[0]=r:(t[0]=r,t.left=n,t.right=e)}function K_(t,n,e,r,i){var o,a=t[0],u=t[1],c=a[0],f=a[1],s=0,l=1,h=u[0]-c,d=u[1]-f;if(o=n-c,h||!(o>0)){if(o/=h,h<0){if(o<s)return;o<l&&(l=o)}else if(h>0){if(o>l)return;o>s&&(s=o)}if(o=r-c,h||!(o<0)){if(o/=h,h<0){if(o>l)return;o>s&&(s=o)}else if(h>0){if(o<s)return;o<l&&(l=o)}if(o=e-f,d||!(o>0)){if(o/=d,d<0){if(o<s)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>s&&(s=o)}if(o=i-f,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>s&&(s=o)}else if(d>0){if(o<s)return;o<l&&(l=o)}return!(s>0||l<1)||(s>0&&(t[0]=[c+s*h,f+s*d]),l<1&&(t[1]=[c+l*h,f+l*d]),!0)}}}}}function tb(t,n,e,r,i){var o=t[1];if(o)return!0;var a,u,c=t[0],f=t.left,s=t.right,l=f[0],h=f[1],d=s[0],p=s[1],v=(l+d)/2,g=(h+p)/2;if(p===h){if(v<n||v>=r)return;if(l>d){if(c){if(c[1]>=i)return}else c=[v,e];o=[v,i]}else{if(c){if(c[1]<e)return}else c=[v,i];o=[v,e]}}else if(u=g-(a=(l-d)/(p-h))*v,a<-1||a>1)if(l>d){if(c){if(c[1]>=i)return}else c=[(e-u)/a,e];o=[(i-u)/a,i]}else{if(c){if(c[1]<e)return}else c=[(i-u)/a,i];o=[(e-u)/a,e]}else if(h<p){if(c){if(c[0]>=r)return}else c=[n,a*n+u];o=[r,a*r+u]}else{if(c){if(c[0]<n)return}else c=[r,a*r+u];o=[n,a*n+u]}return t[0]=c,t[1]=o,!0}function nb(t,n){var e=t.site,r=n.left,i=n.right;return e===i&&(i=r,r=e),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(e===r?(r=n[1],i=n[0]):(r=n[0],i=n[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function eb(t,n){return n[+(n.left!==t.site)]}function rb(t,n){return n[+(n.left===t.site)]}N_.prototype={areaStart:r_,areaEnd:r_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n))}},E_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:k_(this,this._t0,S_(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,n){var e=NaN;if(n=+n,(t=+t)!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,k_(this,S_(this,e=T_(this,t,n)),e);break;default:k_(this,this._t0,e=T_(this,t,n))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=e}}},(C_.prototype=Object.create(E_.prototype)).point=function(t,n){E_.prototype.point.call(this,n,t)},P_.prototype={moveTo:function(t,n){this._context.moveTo(n,t)},closePath:function(){this._context.closePath()},lineTo:function(t,n){this._context.lineTo(n,t)},bezierCurveTo:function(t,n,e,r,i,o){this._context.bezierCurveTo(n,t,r,e,o,i)}},z_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,n=this._y,e=t.length;if(e)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),2===e)this._context.lineTo(t[1],n[1]);else for(var r=R_(t),i=R_(n),o=0,a=1;a<e;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],n[a]);(this._line||0!==this._line&&1===e)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,n){this._x.push(+t),this._y.push(+n)}},D_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var e=this._x*(1-this._t)+t*this._t;this._context.lineTo(e,this._y),this._context.lineTo(e,n)}}this._x=t,this._y=n}},X_.prototype={constructor:X_,insert:function(t,n){var e,r,i;if(t){if(n.P=t,n.N=t.N,t.N&&(t.N.P=n),t.N=n,t.R){for(t=t.R;t.L;)t=t.L;t.L=n}else t.R=n;e=t}else this._?(t=W_(this._),n.P=null,n.N=t,t.P=t.L=n,e=t):(n.P=n.N=null,this._=n,e=null);for(n.L=n.R=null,n.U=e,n.C=!0,t=n;e&&e.C;)e===(r=e.U).L?(i=r.R)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.R&&(V_(this,e),e=(t=e).U),e.C=!1,r.C=!0,$_(this,r)):(i=r.L)&&i.C?(e.C=i.C=!1,r.C=!0,t=r):(t===e.L&&($_(this,e),e=(t=e).U),e.C=!1,r.C=!0,V_(this,r)),e=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var n,e,r,i=t.U,o=t.L,a=t.R;if(e=o?a?W_(a):o:a,i?i.L===t?i.L=e:i.R=e:this._=e,o&&a?(r=e.C,e.C=t.C,e.L=o,o.U=e,e!==a?(i=e.U,e.U=t.U,t=e.R,i.L=t,e.R=a,a.U=e):(e.U=i,i=e,t=e.R)):(r=t.C,t=e),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((n=i.R).C&&(n.C=!1,i.C=!0,V_(this,i),n=i.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,$_(this,n),n=i.R),n.C=i.C,i.C=n.R.C=!1,V_(this,i),t=this._;break}}else if((n=i.L).C&&(n.C=!1,i.C=!0,$_(this,i),n=i.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,V_(this,n),n=i.L),n.C=i.C,i.C=n.L.C=!1,$_(this,i),t=this._;break}n.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var ib,ob=[];function ab(){G_(this),this.x=this.y=this.arc=this.site=this.cy=null}function ub(t){var n=t.P,e=t.N;if(n&&e){var r=n.site,i=t.site,o=e.site;if(r!==o){var a=i[0],u=i[1],c=r[0]-a,f=r[1]-u,s=o[0]-a,l=o[1]-u,h=2*(c*l-f*s);if(!(h>=-wb)){var d=c*c+f*f,p=s*s+l*l,v=(l*d-f*p)/h,g=(c*p-s*d)/h,y=ob.pop()||new ab;y.arc=t,y.site=i,y.x=v+a,y.y=(y.cy=g+u)+Math.sqrt(v*v+g*g),t.circle=y;for(var _=null,b=bb._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(!b.L){_=b.P;break}b=b.L}else{if(!b.R){_=b;break}b=b.R}bb.insert(_,y),_||(ib=y)}}}}function cb(t){var n=t.circle;n&&(n.P||(ib=n.N),bb.remove(n),ob.push(n),G_(n),t.circle=null)}var fb=[];function sb(){G_(this),this.edge=this.site=this.circle=null}function lb(t){var n=fb.pop()||new sb;return n.site=t,n}function hb(t){cb(t),yb.remove(t),fb.push(t),G_(t)}function db(t){var n=t.circle,e=n.x,r=n.cy,i=[e,r],o=t.P,a=t.N,u=[t];hb(t);for(var c=o;c.circle&&Math.abs(e-c.circle.x)<xb&&Math.abs(r-c.circle.cy)<xb;)o=c.P,u.unshift(c),hb(c),c=o;u.unshift(c),cb(c);for(var f=a;f.circle&&Math.abs(e-f.circle.x)<xb&&Math.abs(r-f.circle.cy)<xb;)a=f.N,u.push(f),hb(f),f=a;u.push(f),cb(f);var s,l=u.length;for(s=1;s<l;++s)f=u[s],c=u[s-1],J_(f.edge,c.site,f.site,i);c=u[0],(f=u[l-1]).edge=Z_(c.site,f.site,null,i),ub(c),ub(f)}function pb(t){for(var n,e,r,i,o=t[0],a=t[1],u=yb._;u;)if((r=vb(u,a)-o)>xb)u=u.L;else{if(!((i=o-gb(u,a))>xb)){r>-xb?(n=u.P,e=u):i>-xb?(n=u,e=u.N):n=e=u;break}if(!u.R){n=u;break}u=u.R}!function(t){_b[t.index]={site:t,halfedges:[]}}(t);var c=lb(t);if(yb.insert(n,c),n||e){if(n===e)return cb(n),e=lb(n.site),yb.insert(c,e),c.edge=e.edge=Z_(n.site,c.site),ub(n),void ub(e);if(e){cb(n),cb(e);var f=n.site,s=f[0],l=f[1],h=t[0]-s,d=t[1]-l,p=e.site,v=p[0]-s,g=p[1]-l,y=2*(h*g-d*v),_=h*h+d*d,b=v*v+g*g,m=[(g*_-d*b)/y+s,(h*b-v*_)/y+l];J_(e.edge,f,p,m),c.edge=Z_(f,t,null,m),e.edge=Z_(t,p,null,m),ub(n),ub(e)}else c.edge=Z_(n.site,c.site)}}function vb(t,n){var e=t.site,r=e[0],i=e[1],o=i-n;if(!o)return r;var a=t.P;if(!a)return-1/0;var u=(e=a.site)[0],c=e[1],f=c-n;if(!f)return u;var s=u-r,l=1/o-1/f,h=s/f;return l?(-h+Math.sqrt(h*h-2*l*(s*s/(-2*f)-c+f/2+i-o/2)))/l+r:(r+u)/2}function gb(t,n){var e=t.N;if(e)return vb(e,n);var r=t.site;return r[1]===n?r[0]:1/0}var yb,_b,bb,mb,xb=1e-6,wb=1e-12;function Mb(t,n){return n[1]-t[1]||n[0]-t[0]}function Nb(t,n){var e,r,i,o=t.sort(Mb).pop();for(mb=[],_b=new Array(t.length),yb=new X_,bb=new X_;;)if(i=ib,o&&(!i||o[1]<i.y||o[1]===i.y&&o[0]<i.x))o[0]===e&&o[1]===r||(pb(o),e=o[0],r=o[1]),o=t.pop();else{if(!i)break;db(i.arc)}if(function(){for(var t,n,e,r,i=0,o=_b.length;i<o;++i)if((t=_b[i])&&(r=(n=t.halfedges).length)){var a=new Array(r),u=new Array(r);for(e=0;e<r;++e)a[e]=e,u[e]=nb(t,mb[n[e]]);for(a.sort(function(t,n){return u[n]-u[t]}),e=0;e<r;++e)u[e]=n[a[e]];for(e=0;e<r;++e)n[e]=u[e]}}(),n){var a=+n[0][0],u=+n[0][1],c=+n[1][0],f=+n[1][1];!function(t,n,e,r){for(var i,o=mb.length;o--;)tb(i=mb[o],t,n,e,r)&&K_(i,t,n,e,r)&&(Math.abs(i[0][0]-i[1][0])>xb||Math.abs(i[0][1]-i[1][1])>xb)||delete mb[o]}(a,u,c,f),function(t,n,e,r){var i,o,a,u,c,f,s,l,h,d,p,v,g=_b.length,y=!0;for(i=0;i<g;++i)if(o=_b[i]){for(a=o.site,u=(c=o.halfedges).length;u--;)mb[c[u]]||c.splice(u,1);for(u=0,f=c.length;u<f;)p=(d=rb(o,mb[c[u]]))[0],v=d[1],l=(s=eb(o,mb[c[++u%f]]))[0],h=s[1],(Math.abs(p-l)>xb||Math.abs(v-h)>xb)&&(c.splice(u,0,mb.push(Q_(a,d,Math.abs(p-t)<xb&&r-v>xb?[t,Math.abs(l-t)<xb?h:r]:Math.abs(v-r)<xb&&e-p>xb?[Math.abs(h-r)<xb?l:e,r]:Math.abs(p-e)<xb&&v-n>xb?[e,Math.abs(l-e)<xb?h:n]:Math.abs(v-n)<xb&&p-t>xb?[Math.abs(h-n)<xb?l:t,n]:null))-1),++f);f&&(y=!1)}if(y){var _,b,m,x=1/0;for(i=0,y=null;i<g;++i)(o=_b[i])&&(m=(_=(a=o.site)[0]-t)*_+(b=a[1]-n)*b)<x&&(x=m,y=o);if(y){var w=[t,n],M=[t,r],N=[e,r],A=[e,n];y.halfedges.push(mb.push(Q_(a=y.site,w,M))-1,mb.push(Q_(a,M,N))-1,mb.push(Q_(a,N,A))-1,mb.push(Q_(a,A,w))-1)}}for(i=0;i<g;++i)(o=_b[i])&&(o.halfedges.length||delete _b[i])}(a,u,c,f)}this.edges=mb,this.cells=_b,yb=bb=mb=_b=null}function Ab(t){return function(){return t}}function Tb(t,n,e){this.target=t,this.type=n,this.transform=e}function Sb(t,n,e){this.k=t,this.x=n,this.y=e}Nb.prototype={constructor:Nb,polygons:function(){var t=this.edges;return this.cells.map(function(n){var e=n.halfedges.map(function(e){return eb(n,t[e])});return e.data=n.site.data,e})},triangles:function(){var t=[],n=this.edges;return this.cells.forEach(function(e,r){if(o=(i=e.halfedges).length)for(var i,o,a,u,c,f,s=e.site,l=-1,h=n[i[o-1]],d=h.left===s?h.right:h.left;++l<o;)a=d,d=(h=n[i[l]]).left===s?h.right:h.left,a&&d&&r<a.index&&r<d.index&&(c=a,f=d,((u=s)[0]-f[0])*(c[1]-u[1])-(u[0]-c[0])*(f[1]-u[1])<0)&&t.push([s.data,a.data,d.data])}),t},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(t,n,e){for(var r,i,o=this,a=o._found||0,u=o.cells.length;!(i=o.cells[a]);)if(++a>=u)return null;var c=t-i.site[0],f=n-i.site[1],s=c*c+f*f;do{i=o.cells[r=a],a=null,i.halfedges.forEach(function(e){var r=o.edges[e],u=r.left;if(u!==i.site&&u||(u=r.right)){var c=t-u[0],f=n-u[1],l=c*c+f*f;l<s&&(s=l,a=u.index)}})}while(null!==a);return o._found=r,null==e||s<=e*e?i.site:null}},Sb.prototype={constructor:Sb,scale:function(t){return 1===t?this:new Sb(this.k*t,this.x,this.y)},translate:function(t,n){return 0===t&0===n?this:new Sb(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var kb=new Sb(1,0,0);function Eb(t){return t.__zoom||kb}function Cb(){t.event.stopImmediatePropagation()}function Pb(){t.event.preventDefault(),t.event.stopImmediatePropagation()}function zb(){return!t.event.button}function Rb(){var t,n,e=this;return e instanceof SVGElement?(t=(e=e.ownerSVGElement||e).width.baseVal.value,n=e.height.baseVal.value):(t=e.clientWidth,n=e.clientHeight),[[0,0],[t,n]]}function Db(){return this.__zoom||kb}function qb(){return-t.event.deltaY*(t.event.deltaMode?120:1)/500}function Lb(){return"ontouchstart"in this}function Ub(t,n,e){var r=t.invertX(n[0][0])-e[0][0],i=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],a=t.invertY(n[1][1])-e[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}Eb.prototype=Sb.prototype,t.version="5.9.1",t.bisect=i,t.bisectRight=i,t.bisectLeft=o,t.ascending=n,t.bisector=e,t.cross=function(t,n,e){var r,i,o,u,c=t.length,f=n.length,s=new Array(c*f);for(null==e&&(e=a),r=o=0;r<c;++r)for(u=t[r],i=0;i<f;++i,++o)s[o]=e(u,n[i]);return s},t.descending=function(t,n){return n<t?-1:n>t?1:n>=t?0:NaN},t.deviation=f,t.extent=s,t.histogram=function(){var t=v,n=s,e=M;function r(r){var o,a,u=r.length,c=new Array(u);for(o=0;o<u;++o)c[o]=t(r[o],o,r);var f=n(c),s=f[0],l=f[1],h=e(c,s,l);Array.isArray(h)||(h=w(s,l,h),h=g(Math.ceil(s/h)*h,l,h));for(var d=h.length;h[0]<=s;)h.shift(),--d;for(;h[d-1]>l;)h.pop(),--d;var p,v=new Array(d+1);for(o=0;o<=d;++o)(p=v[o]=[]).x0=o>0?h[o-1]:s,p.x1=o<d?h[o]:l;for(o=0;o<u;++o)s<=(a=c[o])&&a<=l&&v[i(h,a,0,d)].push(r[o]);return v}return r.value=function(n){return arguments.length?(t="function"==typeof n?n:p(n),r):t},r.domain=function(t){return arguments.length?(n="function"==typeof t?t:p([t[0],t[1]]),r):n},r.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:Array.isArray(t)?p(h.call(t)):p(t),r):e},r},t.thresholdFreedmanDiaconis=function(t,e,r){return t=d.call(t,u).sort(n),Math.ceil((r-e)/(2*(N(t,.75)-N(t,.25))*Math.pow(t.length,-1/3)))},t.thresholdScott=function(t,n,e){return Math.ceil((e-n)/(3.5*f(t)*Math.pow(t.length,-1/3)))},t.thresholdSturges=M,t.max=A,t.mean=function(t,n){var e,r=t.length,i=r,o=-1,a=0;if(null==n)for(;++o<r;)isNaN(e=u(t[o]))?--i:a+=e;else for(;++o<r;)isNaN(e=u(n(t[o],o,t)))?--i:a+=e;if(i)return a/i},t.median=function(t,e){var r,i=t.length,o=-1,a=[];if(null==e)for(;++o<i;)isNaN(r=u(t[o]))||a.push(r);else for(;++o<i;)isNaN(r=u(e(t[o],o,t)))||a.push(r);return N(a.sort(n),.5)},t.merge=T,t.min=S,t.pairs=function(t,n){null==n&&(n=a);for(var e=0,r=t.length-1,i=t[0],o=new Array(r<0?0:r);e<r;)o[e]=n(i,i=t[++e]);return o},t.permute=function(t,n){for(var e=n.length,r=new Array(e);e--;)r[e]=t[n[e]];return r},t.quantile=N,t.range=g,t.scan=function(t,e){if(r=t.length){var r,i,o=0,a=0,u=t[a];for(null==e&&(e=n);++o<r;)(e(i=t[o],u)<0||0!==e(u,u))&&(u=i,a=o);return 0===e(u,u)?a:void 0}},t.shuffle=function(t,n,e){for(var r,i,o=(null==e?t.length:e)-(n=null==n?0:+n);o;)i=Math.random()*o--|0,r=t[o+n],t[o+n]=t[i+n],t[i+n]=r;return t},t.sum=function(t,n){var e,r=t.length,i=-1,o=0;if(null==n)for(;++i<r;)(e=+t[i])&&(o+=e);else for(;++i<r;)(e=+n(t[i],i,t))&&(o+=e);return o},t.ticks=m,t.tickIncrement=x,t.tickStep=w,t.transpose=k,t.variance=c,t.zip=function(){return k(arguments)},t.axisTop=function(t){return Y(z,t)},t.axisRight=function(t){return Y(R,t)},t.axisBottom=function(t){return Y(D,t)},t.axisLeft=function(t){return Y(q,t)},t.brush=function(){return Pi(mi)},t.brushX=function(){return Pi(_i)},t.brushY=function(){return Pi(bi)},t.brushSelection=function(t){var n=t.__brush;return n?n.dim.output(n.selection):null},t.chord=function(){var t=0,n=null,e=null,r=null;function i(i){var o,a,u,c,f,s,l=i.length,h=[],d=g(l),p=[],v=[],y=v.groups=new Array(l),_=new Array(l*l);for(o=0,f=-1;++f<l;){for(a=0,s=-1;++s<l;)a+=i[f][s];h.push(a),p.push(g(l)),o+=a}for(n&&d.sort(function(t,e){return n(h[t],h[e])}),e&&p.forEach(function(t,n){t.sort(function(t,r){return e(i[n][t],i[n][r])})}),c=(o=Ui(0,Li-t*l)/o)?t:Li/l,a=0,f=-1;++f<l;){for(u=a,s=-1;++s<l;){var b=d[f],m=p[b][s],x=i[b][m],w=a,M=a+=x*o;_[m*l+b]={index:b,subindex:m,startAngle:w,endAngle:M,value:x}}y[b]={index:b,startAngle:u,endAngle:a,value:h[b]},a+=c}for(f=-1;++f<l;)for(s=f-1;++s<l;){var N=_[s*l+f],A=_[f*l+s];(N.value||A.value)&&v.push(N.value<A.value?{source:A,target:N}:{source:N,target:A})}return r?v.sort(r):v}return i.padAngle=function(n){return arguments.length?(t=Ui(0,n),i):t},i.sortGroups=function(t){return arguments.length?(n=t,i):n},i.sortSubgroups=function(t){return arguments.length?(e=t,i):e},i.sortChords=function(t){return arguments.length?(null==t?r=null:(n=t,r=function(t,e){return n(t.source.value+t.target.value,e.source.value+e.target.value)})._=t,i):r&&r._;var n},i},t.ribbon=function(){var t=Xi,n=Gi,e=Vi,r=$i,i=Wi,o=null;function a(){var a,u=Oi.call(arguments),c=t.apply(this,u),f=n.apply(this,u),s=+e.apply(this,(u[0]=c,u)),l=r.apply(this,u)-qi,h=i.apply(this,u)-qi,d=s*zi(l),p=s*Ri(l),v=+e.apply(this,(u[0]=f,u)),g=r.apply(this,u)-qi,y=i.apply(this,u)-qi;if(o||(o=a=Hi()),o.moveTo(d,p),o.arc(0,0,s,l,h),l===g&&h===y||(o.quadraticCurveTo(0,0,v*zi(g),v*Ri(g)),o.arc(0,0,v,g,y)),o.quadraticCurveTo(0,0,d,p),o.closePath(),a)return o=null,a+""||null}return a.radius=function(t){return arguments.length?(e="function"==typeof t?t:Bi(+t),a):e},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:Bi(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:Bi(+t),a):i},a.source=function(n){return arguments.length?(t=n,a):t},a.target=function(t){return arguments.length?(n=t,a):n},a.context=function(t){return arguments.length?(o=null==t?null:t,a):o},a},t.nest=function(){var t,n,e,r=[],i=[];function o(e,i,a,u){if(i>=r.length)return null!=t&&e.sort(t),null!=n?n(e):e;for(var c,f,s,l=-1,h=e.length,d=r[i++],p=Qi(),v=a();++l<h;)(s=p.get(c=d(f=e[l])+""))?s.push(f):p.set(c,[f]);return p.each(function(t,n){u(v,n,o(t,i,a,u))}),v}return e={object:function(t){return o(t,0,Ji,Ki)},map:function(t){return o(t,0,to,no)},entries:function(t){return function t(e,o){if(++o>r.length)return e;var a,u=i[o-1];return null!=n&&o>=r.length?a=e.entries():(a=[],e.each(function(n,e){a.push({key:e,values:t(n,o)})})),null!=u?a.sort(function(t,n){return u(t.key,n.key)}):a}(o(t,0,to,no),0)},key:function(t){return r.push(t),e},sortKeys:function(t){return i[r.length-1]=t,e},sortValues:function(n){return t=n,e},rollup:function(t){return n=t,e}}},t.set=io,t.map=Qi,t.keys=function(t){var n=[];for(var e in t)n.push(e);return n},t.values=function(t){var n=[];for(var e in t)n.push(t[e]);return n},t.entries=function(t){var n=[];for(var e in t)n.push({key:e,value:t[e]});return n},t.color=hn,t.rgb=gn,t.hsl=mn,t.lab=Rn,t.hcl=Yn,t.lch=function(t,n,e,r){return 1===arguments.length?Bn(t):new Fn(e,n,t,null==r?1:r)},t.gray=function(t,n){return new Dn(t,0,0,null==n?1:n)},t.cubehelix=Zn,t.contours=po,t.contourDensity=function(){var t=yo,n=_o,e=bo,r=960,i=500,o=20,a=2,u=3*o,c=r+2*u>>a,f=i+2*u>>a,s=uo(20);function l(r){var i=new Float32Array(c*f),l=new Float32Array(c*f);r.forEach(function(r,o,s){var l=+t(r,o,s)+u>>a,h=+n(r,o,s)+u>>a,d=+e(r,o,s);l>=0&&l<c&&h>=0&&h<f&&(i[l+h*c]+=d)}),vo({width:c,height:f,data:i},{width:c,height:f,data:l},o>>a),go({width:c,height:f,data:l},{width:c,height:f,data:i},o>>a),vo({width:c,height:f,data:i},{width:c,height:f,data:l},o>>a),go({width:c,height:f,data:l},{width:c,height:f,data:i},o>>a),vo({width:c,height:f,data:i},{width:c,height:f,data:l},o>>a),go({width:c,height:f,data:l},{width:c,height:f,data:i},o>>a);var d=s(i);if(!Array.isArray(d)){var p=A(i);d=w(0,p,d),(d=g(0,Math.floor(p/d)*d,d)).shift()}return po().thresholds(d).size([c,f])(i).map(h)}function h(t){return t.value*=Math.pow(2,-2*a),t.coordinates.forEach(d),t}function d(t){t.forEach(p)}function p(t){t.forEach(v)}function v(t){t[0]=t[0]*Math.pow(2,a)-u,t[1]=t[1]*Math.pow(2,a)-u}function y(){return c=r+2*(u=3*o)>>a,f=i+2*u>>a,l}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:uo(+n),l):t},l.y=function(t){return arguments.length?(n="function"==typeof t?t:uo(+t),l):n},l.weight=function(t){return arguments.length?(e="function"==typeof t?t:uo(+t),l):e},l.size=function(t){if(!arguments.length)return[r,i];var n=Math.ceil(t[0]),e=Math.ceil(t[1]);if(!(n>=0||n>=0))throw new Error("invalid size");return r=n,i=e,y()},l.cellSize=function(t){if(!arguments.length)return 1<<a;if(!((t=+t)>=1))throw new Error("invalid cell size");return a=Math.floor(Math.log(t)/Math.LN2),y()},l.thresholds=function(t){return arguments.length?(s="function"==typeof t?t:Array.isArray(t)?uo(oo.call(t)):uo(t),l):s},l.bandwidth=function(t){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return o=Math.round((Math.sqrt(4*t*t+1)-1)/2),y()},l},t.dispatch=I,t.drag=function(){var n,e,r,i,o=Gt,a=Vt,u=$t,c=Wt,f={},s=I("start","drag","end"),l=0,h=0;function d(t){t.on("mousedown.drag",p).filter(c).on("touchstart.drag",y).on("touchmove.drag",_).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(){if(!i&&o.apply(this,arguments)){var u=m("mouse",a.apply(this,arguments),Ot,this,arguments);u&&(zt(t.event.view).on("mousemove.drag",v,!0).on("mouseup.drag",g,!0),It(t.event.view),Yt(),r=!1,n=t.event.clientX,e=t.event.clientY,u("start"))}}function v(){if(Ft(),!r){var i=t.event.clientX-n,o=t.event.clientY-e;r=i*i+o*o>h}f.mouse("drag")}function g(){zt(t.event.view).on("mousemove.drag mouseup.drag",null),jt(t.event.view,r),Ft(),f.mouse("end")}function y(){if(o.apply(this,arguments)){var n,e,r=t.event.changedTouches,i=a.apply(this,arguments),u=r.length;for(n=0;n<u;++n)(e=m(r[n].identifier,i,Bt,this,arguments))&&(Yt(),e("start"))}}function _(){var n,e,r=t.event.changedTouches,i=r.length;for(n=0;n<i;++n)(e=f[r[n].identifier])&&(Ft(),e("drag"))}function b(){var n,e,r=t.event.changedTouches,o=r.length;for(i&&clearTimeout(i),i=setTimeout(function(){i=null},500),n=0;n<o;++n)(e=f[r[n].identifier])&&(Yt(),e("end"))}function m(n,e,r,i,o){var a,c,h,p=r(e,n),v=s.copy();if(St(new Xt(d,"beforestart",a,n,l,p[0],p[1],0,0,v),function(){return null!=(t.event.subject=a=u.apply(i,o))&&(c=a.x-p[0]||0,h=a.y-p[1]||0,!0)}))return function t(u){var s,g=p;switch(u){case"start":f[n]=t,s=l++;break;case"end":delete f[n],--l;case"drag":p=r(e,n),s=l}St(new Xt(d,u,a,n,s,p[0]+c,p[1]+h,p[0]-g[0],p[1]-g[1],v),v.apply,v,[u,i,o])}}return d.filter=function(t){return arguments.length?(o="function"==typeof t?t:Ht(!!t),d):o},d.container=function(t){return arguments.length?(a="function"==typeof t?t:Ht(t),d):a},d.subject=function(t){return arguments.length?(u="function"==typeof t?t:Ht(t),d):u},d.touchable=function(t){return arguments.length?(c="function"==typeof t?t:Ht(!!t),d):c},d.on=function(){var t=s.on.apply(s,arguments);return t===s?d:t},d.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,d):Math.sqrt(h)},d},t.dragDisable=It,t.dragEnable=jt,t.dsvFormat=Eo,t.csvParse=Po,t.csvParseRows=zo,t.csvFormat=Ro,t.csvFormatBody=Do,t.csvFormatRows=qo,t.tsvParse=Uo,t.tsvParseRows=Oo,t.tsvFormat=Bo,t.tsvFormatBody=Yo,t.tsvFormatRows=Fo,t.autoType=function(t){for(var n in t){var e,r=t[n].trim();if(r)if("true"===r)r=!0;else if("false"===r)r=!1;else if("NaN"===r)r=NaN;else if(isNaN(e=+r)){if(!/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/.test(r))continue;r=new Date(r)}else r=e;else r=null;t[n]=r}return t},t.easeLinear=function(t){return+t},t.easeQuad=Rr,t.easeQuadIn=function(t){return t*t},t.easeQuadOut=function(t){return t*(2-t)},t.easeQuadInOut=Rr,t.easeCubic=Dr,t.easeCubicIn=function(t){return t*t*t},t.easeCubicOut=function(t){return--t*t*t+1},t.easeCubicInOut=Dr,t.easePoly=Ur,t.easePolyIn=qr,t.easePolyOut=Lr,t.easePolyInOut=Ur,t.easeSin=Yr,t.easeSinIn=function(t){return 1-Math.cos(t*Br)},t.easeSinOut=function(t){return Math.sin(t*Br)},t.easeSinInOut=Yr,t.easeExp=Fr,t.easeExpIn=function(t){return Math.pow(2,10*t-10)},t.easeExpOut=function(t){return 1-Math.pow(2,-10*t)},t.easeExpInOut=Fr,t.easeCircle=Ir,t.easeCircleIn=function(t){return 1-Math.sqrt(1-t*t)},t.easeCircleOut=function(t){return Math.sqrt(1- --t*t)},t.easeCircleInOut=Ir,t.easeBounce=Kr,t.easeBounceIn=function(t){return 1-Kr(1-t)},t.easeBounceOut=Kr,t.easeBounceInOut=function(t){return((t*=2)<=1?1-Kr(1-t):Kr(t-1)+1)/2},t.easeBack=ei,t.easeBackIn=ti,t.easeBackOut=ni,t.easeBackInOut=ei,t.easeElastic=oi,t.easeElasticIn=ii,t.easeElasticOut=oi,t.easeElasticInOut=ai,t.blob=function(t,n){return fetch(t,n).then(Io)},t.buffer=function(t,n){return fetch(t,n).then(jo)},t.dsv=function(t,n,e,r){3===arguments.length&&"function"==typeof e&&(r=e,e=void 0);var i=Eo(t);return Xo(n,e).then(function(t){return i.parse(t,r)})},t.csv=Vo,t.tsv=$o,t.image=function(t,n){return new Promise(function(e,r){var i=new Image;for(var o in n)i[o]=n[o];i.onerror=r,i.onload=function(){e(i)},i.src=t})},t.json=function(t,n){return fetch(t,n).then(Wo)},t.text=Xo,t.xml=Qo,t.html=Jo,t.svg=Ko,t.forceCenter=function(t,n){var e;function r(){var r,i,o=e.length,a=0,u=0;for(r=0;r<o;++r)a+=(i=e[r]).x,u+=i.y;for(a=a/o-t,u=u/o-n,r=0;r<o;++r)(i=e[r]).x-=a,i.y-=u}return null==t&&(t=0),null==n&&(n=0),r.initialize=function(t){e=t},r.x=function(n){return arguments.length?(t=+n,r):t},r.y=function(t){return arguments.length?(n=+t,r):n},r},t.forceCollide=function(t){var n,e,r=1,i=1;function o(){for(var t,o,u,c,f,s,l,h=n.length,d=0;d<i;++d)for(o=aa(n,sa,la).visitAfter(a),t=0;t<h;++t)u=n[t],s=e[u.index],l=s*s,c=u.x+u.vx,f=u.y+u.vy,o.visit(p);function p(t,n,e,i,o){var a=t.data,h=t.r,d=s+h;if(!a)return n>c+d||i<c-d||e>f+d||o<f-d;if(a.index>u.index){var p=c-a.x-a.vx,v=f-a.y-a.vy,g=p*p+v*v;g<d*d&&(0===p&&(g+=(p=na())*p),0===v&&(g+=(v=na())*v),g=(d-(g=Math.sqrt(g)))/g*r,u.vx+=(p*=g)*(d=(h*=h)/(l+h)),u.vy+=(v*=g)*d,a.vx-=p*(d=1-d),a.vy-=v*d)}}}function a(t){if(t.data)return t.r=e[t.data.index];for(var n=t.r=0;n<4;++n)t[n]&&t[n].r>t.r&&(t.r=t[n].r)}function u(){if(n){var r,i,o=n.length;for(e=new Array(o),r=0;r<o;++r)i=n[r],e[i.index]=+t(i,r,n)}}return"function"!=typeof t&&(t=ta(null==t?1:+t)),o.initialize=function(t){n=t,u()},o.iterations=function(t){return arguments.length?(i=+t,o):i},o.strength=function(t){return arguments.length?(r=+t,o):r},o.radius=function(n){return arguments.length?(t="function"==typeof n?n:ta(+n),u(),o):t},o},t.forceLink=function(t){var n,e,r,i,o,a=ha,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=ta(30),f=1;function s(r){for(var i=0,a=t.length;i<f;++i)for(var u,c,s,l,h,d,p,v=0;v<a;++v)c=(u=t[v]).source,l=(s=u.target).x+s.vx-c.x-c.vx||na(),h=s.y+s.vy-c.y-c.vy||na(),l*=d=((d=Math.sqrt(l*l+h*h))-e[v])/d*r*n[v],h*=d,s.vx-=l*(p=o[v]),s.vy-=h*p,c.vx+=l*(p=1-p),c.vy+=h*p}function l(){if(r){var u,c,f=r.length,s=t.length,l=Qi(r,a);for(u=0,i=new Array(f);u<s;++u)(c=t[u]).index=u,"object"!=typeof c.source&&(c.source=da(l,c.source)),"object"!=typeof c.target&&(c.target=da(l,c.target)),i[c.source.index]=(i[c.source.index]||0)+1,i[c.target.index]=(i[c.target.index]||0)+1;for(u=0,o=new Array(s);u<s;++u)c=t[u],o[u]=i[c.source.index]/(i[c.source.index]+i[c.target.index]);n=new Array(s),h(),e=new Array(s),d()}}function h(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}function d(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+c(t[n],n,t)}return null==t&&(t=[]),s.initialize=function(t){r=t,l()},s.links=function(n){return arguments.length?(t=n,l(),s):t},s.id=function(t){return arguments.length?(a=t,s):a},s.iterations=function(t){return arguments.length?(f=+t,s):f},s.strength=function(t){return arguments.length?(u="function"==typeof t?t:ta(+t),h(),s):u},s.distance=function(t){return arguments.length?(c="function"==typeof t?t:ta(+t),d(),s):c},s},t.forceManyBody=function(){var t,n,e,r,i=ta(-30),o=1,a=1/0,u=.81;function c(r){var i,o=t.length,a=aa(t,pa,va).visitAfter(s);for(e=r,i=0;i<o;++i)n=t[i],a.visit(l)}function f(){if(t){var n,e,o=t.length;for(r=new Array(o),n=0;n<o;++n)e=t[n],r[e.index]=+i(e,n,t)}}function s(t){var n,e,i,o,a,u=0,c=0;if(t.length){for(i=o=a=0;a<4;++a)(n=t[a])&&(e=Math.abs(n.value))&&(u+=n.value,c+=e,i+=e*n.x,o+=e*n.y);t.x=i/c,t.y=o/c}else{(n=t).x=n.data.x,n.y=n.data.y;do{u+=r[n.data.index]}while(n=n.next)}t.value=u}function l(t,i,c,f){if(!t.value)return!0;var s=t.x-n.x,l=t.y-n.y,h=f-i,d=s*s+l*l;if(h*h/u<d)return d<a&&(0===s&&(d+=(s=na())*s),0===l&&(d+=(l=na())*l),d<o&&(d=Math.sqrt(o*d)),n.vx+=s*t.value*e/d,n.vy+=l*t.value*e/d),!0;if(!(t.length||d>=a)){(t.data!==n||t.next)&&(0===s&&(d+=(s=na())*s),0===l&&(d+=(l=na())*l),d<o&&(d=Math.sqrt(o*d)));do{t.data!==n&&(h=r[t.data.index]*e/d,n.vx+=s*h,n.vy+=l*h)}while(t=t.next)}}return c.initialize=function(n){t=n,f()},c.strength=function(t){return arguments.length?(i="function"==typeof t?t:ta(+t),f(),c):i},c.distanceMin=function(t){return arguments.length?(o=t*t,c):Math.sqrt(o)},c.distanceMax=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.theta=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c},t.forceRadial=function(t,n,e){var r,i,o,a=ta(.1);function u(t){for(var a=0,u=r.length;a<u;++a){var c=r[a],f=c.x-n||1e-6,s=c.y-e||1e-6,l=Math.sqrt(f*f+s*s),h=(o[a]-l)*i[a]*t/l;c.vx+=f*h,c.vy+=s*h}}function c(){if(r){var n,e=r.length;for(i=new Array(e),o=new Array(e),n=0;n<e;++n)o[n]=+t(r[n],n,r),i[n]=isNaN(o[n])?0:+a(r[n],n,r)}}return"function"!=typeof t&&(t=ta(+t)),null==n&&(n=0),null==e&&(e=0),u.initialize=function(t){r=t,c()},u.strength=function(t){return arguments.length?(a="function"==typeof t?t:ta(+t),c(),u):a},u.radius=function(n){return arguments.length?(t="function"==typeof n?n:ta(+n),c(),u):t},u.x=function(t){return arguments.length?(n=+t,u):n},u.y=function(t){return arguments.length?(e=+t,u):e},u},t.forceSimulation=function(t){var n,e=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,u=Qi(),c=ir(s),f=I("tick","end");function s(){l(),f.call("tick",n),e<r&&(c.stop(),f.call("end",n))}function l(r){var c,f,s=t.length;void 0===r&&(r=1);for(var l=0;l<r;++l)for(e+=(o-e)*i,u.each(function(t){t(e)}),c=0;c<s;++c)null==(f=t[c]).fx?f.x+=f.vx*=a:(f.x=f.fx,f.vx=0),null==f.fy?f.y+=f.vy*=a:(f.y=f.fy,f.vy=0);return n}function h(){for(var n,e=0,r=t.length;e<r;++e){if((n=t[e]).index=e,isNaN(n.fx)||(n.x=n.fx),isNaN(n.fy)||(n.y=n.fy),isNaN(n.x)||isNaN(n.y)){var i=ga*Math.sqrt(e),o=e*ya;n.x=i*Math.cos(o),n.y=i*Math.sin(o)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function d(n){return n.initialize&&n.initialize(t),n}return null==t&&(t=[]),h(),n={tick:l,restart:function(){return c.restart(s),n},stop:function(){return c.stop(),n},nodes:function(e){return arguments.length?(t=e,h(),u.each(d),n):t},alpha:function(t){return arguments.length?(e=+t,n):e},alphaMin:function(t){return arguments.length?(r=+t,n):r},alphaDecay:function(t){return arguments.length?(i=+t,n):+i},alphaTarget:function(t){return arguments.length?(o=+t,n):o},velocityDecay:function(t){return arguments.length?(a=1-t,n):1-a},force:function(t,e){return arguments.length>1?(null==e?u.remove(t):u.set(t,d(e)),n):u.get(t)},find:function(n,e,r){var i,o,a,u,c,f=0,s=t.length;for(null==r?r=1/0:r*=r,f=0;f<s;++f)(a=(i=n-(u=t[f]).x)*i+(o=e-u.y)*o)<r&&(c=u,r=a);return c},on:function(t,e){return arguments.length>1?(f.on(t,e),n):f.on(t)}}},t.forceX=function(t){var n,e,r,i=ta(.1);function o(t){for(var i,o=0,a=n.length;o<a;++o)(i=n[o]).vx+=(r[o]-i.x)*e[o]*t}function a(){if(n){var o,a=n.length;for(e=new Array(a),r=new Array(a),o=0;o<a;++o)e[o]=isNaN(r[o]=+t(n[o],o,n))?0:+i(n[o],o,n)}}return"function"!=typeof t&&(t=ta(null==t?0:+t)),o.initialize=function(t){n=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:ta(+t),a(),o):i},o.x=function(n){return arguments.length?(t="function"==typeof n?n:ta(+n),a(),o):t},o},t.forceY=function(t){var n,e,r,i=ta(.1);function o(t){for(var i,o=0,a=n.length;o<a;++o)(i=n[o]).vy+=(r[o]-i.y)*e[o]*t}function a(){if(n){var o,a=n.length;for(e=new Array(a),r=new Array(a),o=0;o<a;++o)e[o]=isNaN(r[o]=+t(n[o],o,n))?0:+i(n[o],o,n)}}return"function"!=typeof t&&(t=ta(null==t?0:+t)),o.initialize=function(t){n=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:ta(+t),a(),o):i},o.y=function(n){return arguments.length?(t="function"==typeof n?n:ta(+n),a(),o):t},o},t.formatDefaultLocale=Ca,t.formatLocale=Ea,t.formatSpecifier=wa,t.precisionFixed=Pa,t.precisionPrefix=za,t.precisionRound=Ra,t.geoArea=function(t){return mu.reset(),du(t,xu),2*mu},t.geoBounds=function(t){var n,e,r,i,o,a,u;if(Lu=qu=-(Ru=Du=1/0),Fu=[],du(t,ac),e=Fu.length){for(Fu.sort(vc),n=1,o=[r=Fu[0]];n<e;++n)gc(r,(i=Fu[n])[0])||gc(r,i[1])?(pc(r[0],i[1])>pc(r[0],r[1])&&(r[1]=i[1]),pc(i[0],r[1])>pc(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,n=0,r=o[e=o.length-1];n<=e;r=i,++n)i=o[n],(u=pc(r[1],i[0]))>a&&(a=u,Ru=i[0],qu=r[1])}return Fu=Iu=null,Ru===1/0||Du===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ru,Du],[qu,Lu]]},t.geoCentroid=function(t){ju=Hu=Xu=Gu=Vu=$u=Wu=Zu=Qu=Ju=Ku=0,du(t,yc);var n=Qu,e=Ju,r=Ku,i=n*n+e*e+r*r;return i<Ba&&(n=$u,e=Wu,r=Zu,Hu<Oa&&(n=Xu,e=Gu,r=Vu),(i=n*n+e*e+r*r)<Ba)?[NaN,NaN]:[$a(e,n)*Ha,ou(r/eu(i))*Ha]},t.geoCircle=function(){var t,n,e=kc([0,0]),r=kc(90),i=kc(6),o={point:function(e,r){t.push(e=n(e,r)),e[0]*=Ha,e[1]*=Ha}};function a(){var a=e.apply(this,arguments),u=r.apply(this,arguments)*Xa,c=i.apply(this,arguments)*Xa;return t=[],n=Pc(-a[0]*Xa,-a[1]*Xa,0).invert,Lc(o,u,c,1),a={type:"Polygon",coordinates:[t]},t=n=null,a}return a.center=function(t){return arguments.length?(e="function"==typeof t?t:kc([+t[0],+t[1]]),a):e},a.radius=function(t){return arguments.length?(r="function"==typeof t?t:kc(+t),a):r},a.precision=function(t){return arguments.length?(i="function"==typeof t?t:kc(+t),a):i},a},t.geoClipAntimeridian=$c,t.geoClipCircle=Wc,t.geoClipExtent=function(){var t,n,e,r=0,i=0,o=960,a=500;return e={stream:function(e){return t&&n===e?t:t=Jc(r,i,o,a)(n=e)},extent:function(u){return arguments.length?(r=+u[0][0],i=+u[0][1],o=+u[1][0],a=+u[1][1],t=n=null,e):[[r,i],[o,a]]}}},t.geoClipRectangle=Jc,t.geoContains=function(t,n){return(t&&hf.hasOwnProperty(t.type)?hf[t.type]:pf)(t,n)},t.geoDistance=lf,t.geoGraticule=wf,t.geoGraticule10=function(){return wf()()},t.geoInterpolate=function(t,n){var e=t[0]*Xa,r=t[1]*Xa,i=n[0]*Xa,o=n[1]*Xa,a=Wa(r),u=tu(r),c=Wa(o),f=tu(o),s=a*Wa(e),l=a*tu(e),h=c*Wa(i),d=c*tu(i),p=2*ou(eu(au(o-r)+a*c*au(i-e))),v=tu(p),g=p?function(t){var n=tu(t*=p)/v,e=tu(p-t)/v,r=e*s+n*h,i=e*l+n*d,o=e*u+n*f;return[$a(i,r)*Ha,$a(o,eu(r*r+i*i))*Ha]}:function(){return[e*Ha,r*Ha]};return g.distance=p,g},t.geoLength=cf,t.geoPath=function(t,n){var e,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),du(t,e(r))),r.result()}return o.area=function(t){return du(t,e(Cf)),Cf.result()},o.measure=function(t){return du(t,e(gs)),gs.result()},o.bounds=function(t){return du(t,e(Bf)),Bf.result()},o.centroid=function(t){return du(t,e(Kf)),Kf.result()},o.projection=function(n){return arguments.length?(e=null==n?(t=null,Mf):(t=n).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(n=null,new bs):new fs(n=t),"function"!=typeof i&&r.pointRadius(i),o):n},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(n)},t.geoAlbers=Os,t.geoAlbersUsa=function(){var t,n,e,r,i,o,a=Os(),u=Us().rotate([154,0]).center([-2,58.5]).parallels([55,65]),c=Us().rotate([157,0]).center([-3,19.9]).parallels([8,18]),f={point:function(t,n){o=[t,n]}};function s(t){var n=t[0],a=t[1];return o=null,e.point(n,a),o||(r.point(n,a),o)||(i.point(n,a),o)}function l(){return t=n=null,s}return s.invert=function(t){var n=a.scale(),e=a.translate(),r=(t[0]-e[0])/n,i=(t[1]-e[1])/n;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?u:i>=.166&&i<.234&&r>=-.214&&r<-.115?c:a).invert(t)},s.stream=function(e){return t&&n===e?t:(r=[a.stream(n=e),u.stream(e),c.stream(e)],i=r.length,t={point:function(t,n){for(var e=-1;++e<i;)r[e].point(t,n)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},s.precision=function(t){return arguments.length?(a.precision(t),u.precision(t),c.precision(t),l()):a.precision()},s.scale=function(t){return arguments.length?(a.scale(t),u.scale(.35*t),c.scale(t),s.translate(a.translate())):a.scale()},s.translate=function(t){if(!arguments.length)return a.translate();var n=a.scale(),o=+t[0],s=+t[1];return e=a.translate(t).clipExtent([[o-.455*n,s-.238*n],[o+.455*n,s+.238*n]]).stream(f),r=u.translate([o-.307*n,s+.201*n]).clipExtent([[o-.425*n+Oa,s+.12*n+Oa],[o-.214*n-Oa,s+.234*n-Oa]]).stream(f),i=c.translate([o-.205*n,s+.212*n]).clipExtent([[o-.214*n+Oa,s+.166*n+Oa],[o-.115*n-Oa,s+.234*n-Oa]]).stream(f),l()},s.fitExtent=function(t,n){return Ns(s,t,n)},s.fitSize=function(t,n){return As(s,t,n)},s.fitWidth=function(t,n){return Ts(s,t,n)},s.fitHeight=function(t,n){return Ss(s,t,n)},s.scale(1070)},t.geoAzimuthalEqualArea=function(){return Rs(Fs).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=Fs,t.geoAzimuthalEquidistant=function(){return Rs(Is).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=Is,t.geoConicConformal=function(){return qs(Gs).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=Gs,t.geoConicEqualArea=Us,t.geoConicEqualAreaRaw=Ls,t.geoConicEquidistant=function(){return qs($s).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=$s,t.geoEqualEarth=function(){return Rs(tl).scale(177.158)},t.geoEqualEarthRaw=tl,t.geoEquirectangular=function(){return Rs(Vs).scale(152.63)},t.geoEquirectangularRaw=Vs,t.geoGnomonic=function(){return Rs(nl).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=nl,t.geoIdentity=function(){var t,n,e,r,i,o,a=1,u=0,c=0,f=1,s=1,l=Mf,h=null,d=Mf;function p(){return r=i=null,o}return o={stream:function(t){return r&&i===t?r:r=l(d(i=t))},postclip:function(r){return arguments.length?(d=r,h=t=n=e=null,p()):d},clipExtent:function(r){return arguments.length?(d=null==r?(h=t=n=e=null,Mf):Jc(h=+r[0][0],t=+r[0][1],n=+r[1][0],e=+r[1][1]),p()):null==h?null:[[h,t],[n,e]]},scale:function(t){return arguments.length?(l=el((a=+t)*f,a*s,u,c),p()):a},translate:function(t){return arguments.length?(l=el(a*f,a*s,u=+t[0],c=+t[1]),p()):[u,c]},reflectX:function(t){return arguments.length?(l=el(a*(f=t?-1:1),a*s,u,c),p()):f<0},reflectY:function(t){return arguments.length?(l=el(a*f,a*(s=t?-1:1),u,c),p()):s<0},fitExtent:function(t,n){return Ns(o,t,n)},fitSize:function(t,n){return As(o,t,n)},fitWidth:function(t,n){return Ts(o,t,n)},fitHeight:function(t,n){return Ss(o,t,n)}}},t.geoProjection=Rs,t.geoProjectionMutator=Ds,t.geoMercator=function(){return Hs(js).scale(961/ja)},t.geoMercatorRaw=js,t.geoNaturalEarth1=function(){return Rs(rl).scale(175.295)},t.geoNaturalEarth1Raw=rl,t.geoOrthographic=function(){return Rs(il).scale(249.5).clipAngle(90+Oa)},t.geoOrthographicRaw=il,t.geoStereographic=function(){return Rs(ol).scale(250).clipAngle(142)},t.geoStereographicRaw=ol,t.geoTransverseMercator=function(){var t=Hs(al),n=t.center,e=t.rotate;return t.center=function(t){return arguments.length?n([-t[1],t[0]]):[(t=n())[1],-t[0]]},t.rotate=function(t){return arguments.length?e([t[0],t[1],t.length>2?t[2]+90:90]):[(t=e())[0],t[1],t[2]-90]},e([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=al,t.geoRotation=qc,t.geoStream=du,t.geoTransform=function(t){return{stream:xs(t)}},t.cluster=function(){var t=ul,n=1,e=1,r=!1;function i(i){var o,a=0;i.eachAfter(function(n){var e=n.children;e?(n.x=function(t){return t.reduce(cl,0)/t.length}(e),n.y=function(t){return 1+t.reduce(fl,0)}(e)):(n.x=o?a+=t(n,o):0,n.y=0,o=n)});var u=function(t){for(var n;n=t.children;)t=n[0];return t}(i),c=function(t){for(var n;n=t.children;)t=n[n.length-1];return t}(i),f=u.x-t(u,c)/2,s=c.x+t(c,u)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*n,t.y=(i.y-t.y)*e}:function(t){t.x=(t.x-f)/(s-f)*n,t.y=(1-(i.y?t.y/i.y:1))*e})}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i},t.hierarchy=ll,t.pack=function(){var t=null,n=1,e=1,r=Pl;function i(i){return i.x=n/2,i.y=e/2,t?i.eachBefore(Dl(t)).eachAfter(ql(r,.5)).eachBefore(Ll(1)):i.eachBefore(Dl(Rl)).eachAfter(ql(Pl,1)).eachAfter(ql(r,i.r/Math.min(n,e))).eachBefore(Ll(Math.min(n,e)/(2*i.r))),i}return i.radius=function(n){return arguments.length?(t=null==(e=n)?null:Cl(e),i):t;var e},i.size=function(t){return arguments.length?(n=+t[0],e=+t[1],i):[n,e]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:zl(+t),i):r},i},t.packSiblings=function(t){return El(t),t},t.packEnclose=yl,t.partition=function(){var t=1,n=1,e=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=e,i.x1=t,i.y1=n/o,i.eachBefore(function(t,n){return function(r){r.children&&Ol(r,r.x0,t*(r.depth+1)/n,r.x1,t*(r.depth+2)/n);var i=r.x0,o=r.y0,a=r.x1-e,u=r.y1-e;a<i&&(i=a=(i+a)/2),u<o&&(o=u=(o+u)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=u}}(n,o)),r&&i.eachBefore(Ul),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(e){return arguments.length?(t=+e[0],n=+e[1],i):[t,n]},i.padding=function(t){return arguments.length?(e=+t,i):e},i},t.stratify=function(){var t=Il,n=jl;function e(e){var r,i,o,a,u,c,f,s=e.length,l=new Array(s),h={};for(i=0;i<s;++i)r=e[i],u=l[i]=new vl(r),null!=(c=t(r,i,e))&&(c+="")&&(h[f=Bl+(u.id=c)]=f in h?Fl:u);for(i=0;i<s;++i)if(u=l[i],null!=(c=n(e[i],i,e))&&(c+="")){if(!(a=h[Bl+c]))throw new Error("missing: "+c);if(a===Fl)throw new Error("ambiguous: "+c);a.children?a.children.push(u):a.children=[u],u.parent=a}else{if(o)throw new Error("multiple roots");o=u}if(!o)throw new Error("no root");if(o.parent=Yl,o.eachBefore(function(t){t.depth=t.parent.depth+1,--s}).eachBefore(pl),o.parent=null,s>0)throw new Error("cycle");return o}return e.id=function(n){return arguments.length?(t=Cl(n),e):t},e.parentId=function(t){return arguments.length?(n=Cl(t),e):n},e},t.tree=function(){var t=Hl,n=1,e=1,r=null;function i(i){var c=function(t){for(var n,e,r,i,o,a=new Wl(t,0),u=[a];n=u.pop();)if(r=n._.children)for(n.children=new Array(o=r.length),i=o-1;i>=0;--i)u.push(e=n.children[i]=new Wl(r[i],i)),e.parent=n;return(a.parent=new Wl(null,0)).children=[a],a}(i);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(a),r)i.eachBefore(u);else{var f=i,s=i,l=i;i.eachBefore(function(t){t.x<f.x&&(f=t),t.x>s.x&&(s=t),t.depth>l.depth&&(l=t)});var h=f===s?1:t(f,s)/2,d=h-f.x,p=n/(s.x+h+d),v=e/(l.depth||1);i.eachBefore(function(t){t.x=(t.x+d)*p,t.y=t.depth*v})}return i}function o(n){var e=n.children,r=n.parent.children,i=n.i?r[n.i-1]:null;if(e){!function(t){for(var n,e=0,r=0,i=t.children,o=i.length;--o>=0;)(n=i[o]).z+=e,n.m+=e,e+=n.s+(r+=n.c)}(n);var o=(e[0].z+e[e.length-1].z)/2;i?(n.z=i.z+t(n._,i._),n.m=n.z-o):n.z=o}else i&&(n.z=i.z+t(n._,i._));n.parent.A=function(n,e,r){if(e){for(var i,o=n,a=n,u=e,c=o.parent.children[0],f=o.m,s=a.m,l=u.m,h=c.m;u=Gl(u),o=Xl(o),u&&o;)c=Xl(c),(a=Gl(a)).a=n,(i=u.z+l-o.z-f+t(u._,o._))>0&&(Vl($l(u,n,r),n,i),f+=i,s+=i),l+=u.m,f+=o.m,h+=c.m,s+=a.m;u&&!Gl(a)&&(a.t=u,a.m+=l-s),o&&!Xl(c)&&(c.t=o,c.m+=f-h,r=n)}return r}(n,i,n.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function u(t){t.x*=n,t.y=t.depth*e}return i.separation=function(n){return arguments.length?(t=n,i):t},i.size=function(t){return arguments.length?(r=!1,n=+t[0],e=+t[1],i):r?null:[n,e]},i.nodeSize=function(t){return arguments.length?(r=!0,n=+t[0],e=+t[1],i):r?[n,e]:null},i},t.treemap=function(){var t=Kl,n=!1,e=1,r=1,i=[0],o=Pl,a=Pl,u=Pl,c=Pl,f=Pl;function s(t){return t.x0=t.y0=0,t.x1=e,t.y1=r,t.eachBefore(l),i=[0],n&&t.eachBefore(Ul),t}function l(n){var e=i[n.depth],r=n.x0+e,s=n.y0+e,l=n.x1-e,h=n.y1-e;l<r&&(r=l=(r+l)/2),h<s&&(s=h=(s+h)/2),n.x0=r,n.y0=s,n.x1=l,n.y1=h,n.children&&(e=i[n.depth+1]=o(n)/2,r+=f(n)-e,s+=a(n)-e,(l-=u(n)-e)<r&&(r=l=(r+l)/2),(h-=c(n)-e)<s&&(s=h=(s+h)/2),t(n,r,s,l,h))}return s.round=function(t){return arguments.length?(n=!!t,s):n},s.size=function(t){return arguments.length?(e=+t[0],r=+t[1],s):[e,r]},s.tile=function(n){return arguments.length?(t=Cl(n),s):t},s.padding=function(t){return arguments.length?s.paddingInner(t).paddingOuter(t):s.paddingInner()},s.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:zl(+t),s):o},s.paddingOuter=function(t){return arguments.length?s.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):s.paddingTop()},s.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:zl(+t),s):a},s.paddingRight=function(t){return arguments.length?(u="function"==typeof t?t:zl(+t),s):u},s.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:zl(+t),s):c},s.paddingLeft=function(t){return arguments.length?(f="function"==typeof t?t:zl(+t),s):f},s},t.treemapBinary=function(t,n,e,r,i){var o,a,u=t.children,c=u.length,f=new Array(c+1);for(f[0]=a=o=0;o<c;++o)f[o+1]=a+=u[o].value;!function t(n,e,r,i,o,a,c){if(n>=e-1){var s=u[n];return s.x0=i,s.y0=o,s.x1=a,void(s.y1=c)}for(var l=f[n],h=r/2+l,d=n+1,p=e-1;d<p;){var v=d+p>>>1;f[v]<h?d=v+1:p=v}h-f[d-1]<f[d]-h&&n+1<d&&--d;var g=f[d]-l,y=r-g;if(a-i>c-o){var _=(i*y+a*g)/r;t(n,d,g,i,o,_,c),t(d,e,y,_,o,a,c)}else{var b=(o*y+c*g)/r;t(n,d,g,i,o,a,b),t(d,e,y,i,b,a,c)}}(0,c,t.value,n,e,r,i)},t.treemapDice=Ol,t.treemapSlice=Zl,t.treemapSliceDice=function(t,n,e,r,i){(1&t.depth?Zl:Ol)(t,n,e,r,i)},t.treemapSquarify=Kl,t.treemapResquarify=th,t.interpolate=ye,t.interpolateArray=se,t.interpolateBasis=Kn,t.interpolateBasisClosed=te,t.interpolateDate=le,t.interpolateDiscrete=function(t){var n=t.length;return function(e){return t[Math.max(0,Math.min(n-1,Math.floor(e*n)))]}},t.interpolateHue=function(t,n){var e=re(+t,+n);return function(t){var n=e(t);return n-360*Math.floor(n/360)}},t.interpolateNumber=he,t.interpolateObject=de,t.interpolateRound=_e,t.interpolateString=ge,t.interpolateTransformCss=Se,t.interpolateTransformSvg=ke,t.interpolateZoom=De,t.interpolateRgb=ae,t.interpolateRgbBasis=ce,t.interpolateRgbBasisClosed=fe,t.interpolateHsl=Le,t.interpolateHslLong=Ue,t.interpolateLab=function(t,n){var e=oe((t=Rn(t)).l,(n=Rn(n)).l),r=oe(t.a,n.a),i=oe(t.b,n.b),o=oe(t.opacity,n.opacity);return function(n){return t.l=e(n),t.a=r(n),t.b=i(n),t.opacity=o(n),t+""}},t.interpolateHcl=Be,t.interpolateHclLong=Ye,t.interpolateCubehelix=Ie,t.interpolateCubehelixLong=je,t.piecewise=function(t,n){for(var e=0,r=n.length-1,i=n[0],o=new Array(r<0?0:r);e<r;)o[e]=t(i,i=n[++e]);return function(t){var n=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[n](t-n)}},t.quantize=function(t,n){for(var e=new Array(n),r=0;r<n;++r)e[r]=t(r/(n-1));return e},t.path=Hi,t.polygonArea=function(t){for(var n,e=-1,r=t.length,i=t[r-1],o=0;++e<r;)n=i,i=t[e],o+=n[1]*i[0]-n[0]*i[1];return o/2},t.polygonCentroid=function(t){for(var n,e,r=-1,i=t.length,o=0,a=0,u=t[i-1],c=0;++r<i;)n=u,u=t[r],c+=e=n[0]*u[1]-u[0]*n[1],o+=(n[0]+u[0])*e,a+=(n[1]+u[1])*e;return[o/(c*=3),a/c]},t.polygonHull=function(t){if((e=t.length)<3)return null;var n,e,r=new Array(e),i=new Array(e);for(n=0;n<e;++n)r[n]=[+t[n][0],+t[n][1],n];for(r.sort(nh),n=0;n<e;++n)i[n]=[r[n][0],-r[n][1]];var o=eh(r),a=eh(i),u=a[0]===o[0],c=a[a.length-1]===o[o.length-1],f=[];for(n=o.length-1;n>=0;--n)f.push(t[r[o[n]][2]]);for(n=+u;n<a.length-c;++n)f.push(t[r[a[n]][2]]);return f},t.polygonContains=function(t,n){for(var e,r,i=t.length,o=t[i-1],a=n[0],u=n[1],c=o[0],f=o[1],s=!1,l=0;l<i;++l)e=(o=t[l])[0],(r=o[1])>u!=f>u&&a<(c-e)*(u-r)/(f-r)+e&&(s=!s),c=e,f=r;return s},t.polygonLength=function(t){for(var n,e,r=-1,i=t.length,o=t[i-1],a=o[0],u=o[1],c=0;++r<i;)n=a,e=u,n-=a=(o=t[r])[0],e-=u=o[1],c+=Math.sqrt(n*n+e*e);return c},t.quadtree=aa,t.randomUniform=ih,t.randomNormal=oh,t.randomLogNormal=ah,t.randomBates=ch,t.randomIrwinHall=uh,t.randomExponential=fh,t.scaleBand=yh,t.scalePoint=function(){return function t(n){var e=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return t(e())},n}(yh.apply(null,arguments).paddingInner(1))},t.scaleIdentity=function t(n){var e;function r(t){return isNaN(t=+t)?e:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(n=dh.call(t,_h),r):n.slice()},r.unknown=function(t){return arguments.length?(e=t,r):e},r.copy=function(){return t(n).unknown(e)},n=arguments.length?dh.call(n,_h):[0,1],Eh(r)},t.scaleLinear=function t(){var n=Sh(mh,mh);return n.copy=function(){return Ah(n,t())},sh.apply(n,arguments),Eh(n)},t.scaleLog=function t(){var n=Uh(Th()).domain([1,10]);return n.copy=function(){return Ah(n,t()).base(n.base())},sh.apply(n,arguments),n},t.scaleSymlog=function t(){var n=Yh(Th());return n.copy=function(){return Ah(n,t()).constant(n.constant())},sh.apply(n,arguments)},t.scaleOrdinal=gh,t.scaleImplicit=vh,t.scalePow=Xh,t.scaleSqrt=function(){return Xh.apply(null,arguments).exponent(.5)},t.scaleQuantile=function t(){var e,r=[],o=[],a=[];function u(){var t=0,n=Math.max(1,o.length);for(a=new Array(n-1);++t<n;)a[t-1]=N(r,t/n);return c}function c(t){return isNaN(t=+t)?e:o[i(a,t)]}return c.invertExtent=function(t){var n=o.indexOf(t);return n<0?[NaN,NaN]:[n>0?a[n-1]:r[0],n<a.length?a[n]:r[r.length-1]]},c.domain=function(t){if(!arguments.length)return r.slice();r=[];for(var e,i=0,o=t.length;i<o;++i)null==(e=t[i])||isNaN(e=+e)||r.push(e);return r.sort(n),u()},c.range=function(t){return arguments.length?(o=ph.call(t),u()):o.slice()},c.unknown=function(t){return arguments.length?(e=t,c):e},c.quantiles=function(){return a.slice()},c.copy=function(){return t().domain(r).range(o).unknown(e)},sh.apply(c,arguments)},t.scaleQuantize=function t(){var n,e=0,r=1,o=1,a=[.5],u=[0,1];function c(t){return t<=t?u[i(a,t,0,o)]:n}function f(){var t=-1;for(a=new Array(o);++t<o;)a[t]=((t+1)*r-(t-o)*e)/(o+1);return c}return c.domain=function(t){return arguments.length?(e=+t[0],r=+t[1],f()):[e,r]},c.range=function(t){return arguments.length?(o=(u=ph.call(t)).length-1,f()):u.slice()},c.invertExtent=function(t){var n=u.indexOf(t);return n<0?[NaN,NaN]:n<1?[e,a[0]]:n>=o?[a[o-1],r]:[a[n-1],a[n]]},c.unknown=function(t){return arguments.length?(n=t,c):c},c.thresholds=function(){return a.slice()},c.copy=function(){return t().domain([e,r]).range(u).unknown(n)},sh.apply(Eh(c),arguments)},t.scaleThreshold=function t(){var n,e=[.5],r=[0,1],o=1;function a(t){return t<=t?r[i(e,t,0,o)]:n}return a.domain=function(t){return arguments.length?(e=ph.call(t),o=Math.min(e.length,r.length-1),a):e.slice()},a.range=function(t){return arguments.length?(r=ph.call(t),o=Math.min(e.length,r.length-1),a):r.slice()},a.invertExtent=function(t){var n=r.indexOf(t);return[e[n-1],e[n]]},a.unknown=function(t){return arguments.length?(n=t,a):n},a.copy=function(){return t().domain(e).range(r).unknown(n)},sh.apply(a,arguments)},t.scaleTime=function(){return sh.apply(Nv(Nd,wd,cd,od,rd,nd,Kh,Wh,t.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},t.scaleUtc=function(){return sh.apply(Nv(Wd,Vd,Rd,Cd,kd,Td,Kh,Wh,t.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},t.scaleSequential=function t(){var n=Eh(Av()(mh));return n.copy=function(){return Tv(n,t())},lh.apply(n,arguments)},t.scaleSequentialLog=function t(){var n=Uh(Av()).domain([1,10]);return n.copy=function(){return Tv(n,t()).base(n.base())},lh.apply(n,arguments)},t.scaleSequentialPow=Sv,t.scaleSequentialSqrt=function(){return Sv.apply(null,arguments).exponent(.5)},t.scaleSequentialSymlog=function t(){var n=Yh(Av());return n.copy=function(){return Tv(n,t()).constant(n.constant())},lh.apply(n,arguments)},t.scaleSequentialQuantile=function t(){var e=[],r=mh;function o(t){if(!isNaN(t=+t))return r((i(e,t)-1)/(e.length-1))}return o.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var r,i=0,a=t.length;i<a;++i)null==(r=t[i])||isNaN(r=+r)||e.push(r);return e.sort(n),o},o.interpolator=function(t){return arguments.length?(r=t,o):r},o.copy=function(){return t(r).domain(e)},lh.apply(o,arguments)},t.scaleDiverging=function t(){var n=Eh(kv()(mh));return n.copy=function(){return Tv(n,t())},lh.apply(n,arguments)},t.scaleDivergingLog=function t(){var n=Uh(kv()).domain([.1,1,10]);return n.copy=function(){return Tv(n,t()).base(n.base())},lh.apply(n,arguments)},t.scaleDivergingPow=Ev,t.scaleDivergingSqrt=function(){return Ev.apply(null,arguments).exponent(.5)},t.scaleDivergingSymlog=function t(){var n=Yh(kv());return n.copy=function(){return Tv(n,t()).constant(n.constant())},lh.apply(n,arguments)},t.tickFormat=kh,t.schemeCategory10=Pv,t.schemeAccent=zv,t.schemeDark2=Rv,t.schemePaired=Dv,t.schemePastel1=qv,t.schemePastel2=Lv,t.schemeSet1=Uv,t.schemeSet2=Ov,t.schemeSet3=Bv,t.interpolateBrBG=Iv,t.schemeBrBG=Fv,t.interpolatePRGn=Hv,t.schemePRGn=jv,t.interpolatePiYG=Gv,t.schemePiYG=Xv,t.interpolatePuOr=$v,t.schemePuOr=Vv,t.interpolateRdBu=Zv,t.schemeRdBu=Wv,t.interpolateRdGy=Jv,t.schemeRdGy=Qv,t.interpolateRdYlBu=tg,t.schemeRdYlBu=Kv,t.interpolateRdYlGn=eg,t.schemeRdYlGn=ng,t.interpolateSpectral=ig,t.schemeSpectral=rg,t.interpolateBuGn=ag,t.schemeBuGn=og,t.interpolateBuPu=cg,t.schemeBuPu=ug,t.interpolateGnBu=sg,t.schemeGnBu=fg,t.interpolateOrRd=hg,t.schemeOrRd=lg,t.interpolatePuBuGn=pg,t.schemePuBuGn=dg,t.interpolatePuBu=gg,t.schemePuBu=vg,t.interpolatePuRd=_g,t.schemePuRd=yg,t.interpolateRdPu=mg,t.schemeRdPu=bg,t.interpolateYlGnBu=wg,t.schemeYlGnBu=xg,t.interpolateYlGn=Ng,t.schemeYlGn=Mg,t.interpolateYlOrBr=Tg,t.schemeYlOrBr=Ag,t.interpolateYlOrRd=kg,t.schemeYlOrRd=Sg,t.interpolateBlues=Cg,t.schemeBlues=Eg,t.interpolateGreens=zg,t.schemeGreens=Pg,t.interpolateGreys=Dg,t.schemeGreys=Rg,t.interpolatePurples=Lg,t.schemePurples=qg,t.interpolateReds=Og,t.schemeReds=Ug,t.interpolateOranges=Yg,t.schemeOranges=Bg,t.interpolateCubehelixDefault=Fg,t.interpolateRainbow=function(t){(t<0||t>1)&&(t-=Math.floor(t));var n=Math.abs(t-.5);return Hg.h=360*t-100,Hg.s=1.5-1.5*n,Hg.l=.8-.9*n,Hg+""},t.interpolateWarm=Ig,t.interpolateCool=jg,t.interpolateSinebow=function(t){var n;return t=(.5-t)*Math.PI,Xg.r=255*(n=Math.sin(t))*n,Xg.g=255*(n=Math.sin(t+Gg))*n,Xg.b=255*(n=Math.sin(t+Vg))*n,Xg+""},t.interpolateViridis=Wg,t.interpolateMagma=Zg,t.interpolateInferno=Qg,t.interpolatePlasma=Jg,t.create=function(t){return zt(W(t).call(document.documentElement))},t.creator=W,t.local=Dt,t.matcher=tt,t.mouse=Ot,t.namespace=$,t.namespaces=V,t.clientPoint=Ut,t.select=zt,t.selectAll=function(t){return"string"==typeof t?new Ct([document.querySelectorAll(t)],[document.documentElement]):new Ct([null==t?[]:t],Et)},t.selection=Pt,t.selector=Q,t.selectorAll=K,t.style=ct,t.touch=Bt,t.touches=function(t,n){null==n&&(n=Lt().touches);for(var e=0,r=n?n.length:0,i=new Array(r);e<r;++e)i[e]=Ut(t,n[e]);return i},t.window=ut,t.customEvent=St,t.arc=function(){var t=hy,n=dy,e=Kg(0),r=null,i=py,o=vy,a=gy,u=null;function c(){var c,f,s,l=+t.apply(this,arguments),h=+n.apply(this,arguments),d=i.apply(this,arguments)-fy,p=o.apply(this,arguments)-fy,v=ty(p-d),g=p>d;if(u||(u=c=Hi()),h<l&&(f=h,h=l,l=f),h>uy)if(v>sy-uy)u.moveTo(h*ey(d),h*oy(d)),u.arc(0,0,h,d,p,!g),l>uy&&(u.moveTo(l*ey(p),l*oy(p)),u.arc(0,0,l,p,d,g));else{var y,_,b=d,m=p,x=d,w=p,M=v,N=v,A=a.apply(this,arguments)/2,T=A>uy&&(r?+r.apply(this,arguments):ay(l*l+h*h)),S=iy(ty(h-l)/2,+e.apply(this,arguments)),k=S,E=S;if(T>uy){var C=ly(T/l*oy(A)),P=ly(T/h*oy(A));(M-=2*C)>uy?(x+=C*=g?1:-1,w-=C):(M=0,x=w=(d+p)/2),(N-=2*P)>uy?(b+=P*=g?1:-1,m-=P):(N=0,b=m=(d+p)/2)}var z=h*ey(b),R=h*oy(b),D=l*ey(w),q=l*oy(w);if(S>uy){var L,U=h*ey(m),O=h*oy(m),B=l*ey(x),Y=l*oy(x);if(v<cy&&(L=function(t,n,e,r,i,o,a,u){var c=e-t,f=r-n,s=a-i,l=u-o,h=l*c-s*f;if(!(h*h<uy))return[t+(h=(s*(n-o)-l*(t-i))/h)*c,n+h*f]}(z,R,B,Y,U,O,D,q))){var F=z-L[0],I=R-L[1],j=U-L[0],H=O-L[1],X=1/oy(((s=(F*j+I*H)/(ay(F*F+I*I)*ay(j*j+H*H)))>1?0:s<-1?cy:Math.acos(s))/2),G=ay(L[0]*L[0]+L[1]*L[1]);k=iy(S,(l-G)/(X-1)),E=iy(S,(h-G)/(X+1))}}N>uy?E>uy?(y=yy(B,Y,z,R,h,E,g),_=yy(U,O,D,q,h,E,g),u.moveTo(y.cx+y.x01,y.cy+y.y01),E<S?u.arc(y.cx,y.cy,E,ny(y.y01,y.x01),ny(_.y01,_.x01),!g):(u.arc(y.cx,y.cy,E,ny(y.y01,y.x01),ny(y.y11,y.x11),!g),u.arc(0,0,h,ny(y.cy+y.y11,y.cx+y.x11),ny(_.cy+_.y11,_.cx+_.x11),!g),u.arc(_.cx,_.cy,E,ny(_.y11,_.x11),ny(_.y01,_.x01),!g))):(u.moveTo(z,R),u.arc(0,0,h,b,m,!g)):u.moveTo(z,R),l>uy&&M>uy?k>uy?(y=yy(D,q,U,O,l,-k,g),_=yy(z,R,B,Y,l,-k,g),u.lineTo(y.cx+y.x01,y.cy+y.y01),k<S?u.arc(y.cx,y.cy,k,ny(y.y01,y.x01),ny(_.y01,_.x01),!g):(u.arc(y.cx,y.cy,k,ny(y.y01,y.x01),ny(y.y11,y.x11),!g),u.arc(0,0,l,ny(y.cy+y.y11,y.cx+y.x11),ny(_.cy+_.y11,_.cx+_.x11),g),u.arc(_.cx,_.cy,k,ny(_.y11,_.x11),ny(_.y01,_.x01),!g))):u.arc(0,0,l,w,x,g):u.lineTo(D,q)}else u.moveTo(0,0);if(u.closePath(),c)return u=null,c+""||null}return c.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-cy/2;return[ey(r)*e,oy(r)*e]},c.innerRadius=function(n){return arguments.length?(t="function"==typeof n?n:Kg(+n),c):t},c.outerRadius=function(t){return arguments.length?(n="function"==typeof t?t:Kg(+t),c):n},c.cornerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Kg(+t),c):e},c.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:Kg(+t),c):r},c.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:Kg(+t),c):i},c.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:Kg(+t),c):o},c.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:Kg(+t),c):a},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c},t.area=My,t.line=wy,t.pie=function(){var t=Ay,n=Ny,e=null,r=Kg(0),i=Kg(sy),o=Kg(0);function a(a){var u,c,f,s,l,h=a.length,d=0,p=new Array(h),v=new Array(h),g=+r.apply(this,arguments),y=Math.min(sy,Math.max(-sy,i.apply(this,arguments)-g)),_=Math.min(Math.abs(y)/h,o.apply(this,arguments)),b=_*(y<0?-1:1);for(u=0;u<h;++u)(l=v[p[u]=u]=+t(a[u],u,a))>0&&(d+=l);for(null!=n?p.sort(function(t,e){return n(v[t],v[e])}):null!=e&&p.sort(function(t,n){return e(a[t],a[n])}),u=0,f=d?(y-h*b)/d:0;u<h;++u,g=s)c=p[u],s=g+((l=v[c])>0?l*f:0)+b,v[c]={data:a[c],index:u,value:l,startAngle:g,endAngle:s,padAngle:_};return v}return a.value=function(n){return arguments.length?(t="function"==typeof n?n:Kg(+n),a):t},a.sortValues=function(t){return arguments.length?(n=t,e=null,a):n},a.sort=function(t){return arguments.length?(e=t,n=null,a):e},a.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:Kg(+t),a):r},a.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:Kg(+t),a):i},a.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:Kg(+t),a):o},a},t.areaRadial=Py,t.radialArea=Py,t.lineRadial=Cy,t.radialLine=Cy,t.pointRadial=zy,t.linkHorizontal=function(){return Ly(Uy)},t.linkVertical=function(){return Ly(Oy)},t.linkRadial=function(){var t=Ly(By);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},t.symbol=function(){var t=Kg(Yy),n=Kg(64),e=null;function r(){var r;if(e||(e=r=Hi()),t.apply(this,arguments).draw(e,+n.apply(this,arguments)),r)return e=null,r+""||null}return r.type=function(n){return arguments.length?(t="function"==typeof n?n:Kg(n),r):t},r.size=function(t){return arguments.length?(n="function"==typeof t?t:Kg(+t),r):n},r.context=function(t){return arguments.length?(e=null==t?null:t,r):e},r},t.symbols=e_,t.symbolCircle=Yy,t.symbolCross=Fy,t.symbolDiamond=Hy,t.symbolSquare=Wy,t.symbolStar=$y,t.symbolTriangle=Qy,t.symbolWye=n_,t.curveBasisClosed=function(t){return new a_(t)},t.curveBasisOpen=function(t){return new u_(t)},t.curveBasis=function(t){return new o_(t)},t.curveBundle=f_,t.curveCardinalClosed=p_,t.curveCardinalOpen=g_,t.curveCardinal=h_,t.curveCatmullRomClosed=x_,t.curveCatmullRomOpen=M_,t.curveCatmullRom=b_,t.curveLinearClosed=function(t){return new N_(t)},t.curveLinear=by,t.curveMonotoneX=function(t){return new E_(t)},t.curveMonotoneY=function(t){return new C_(t)},t.curveNatural=function(t){return new z_(t)},t.curveStep=function(t){return new D_(t,.5)},t.curveStepAfter=function(t){return new D_(t,1)},t.curveStepBefore=function(t){return new D_(t,0)},t.stack=function(){var t=Kg([]),n=L_,e=q_,r=U_;function i(i){var o,a,u=t.apply(this,arguments),c=i.length,f=u.length,s=new Array(f);for(o=0;o<f;++o){for(var l,h=u[o],d=s[o]=new Array(c),p=0;p<c;++p)d[p]=l=[0,+r(i[p],h,p,i)],l.data=i[p];d.key=h}for(o=0,a=n(s);o<f;++o)s[a[o]].index=o;return e(s,a),s}return i.keys=function(n){return arguments.length?(t="function"==typeof n?n:Kg(Ry.call(n)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:Kg(+t),i):r},i.order=function(t){return arguments.length?(n=null==t?L_:"function"==typeof t?t:Kg(Ry.call(t)),i):n},i.offset=function(t){return arguments.length?(e=null==t?q_:t,i):e},i},t.stackOffsetExpand=function(t,n){if((r=t.length)>0){for(var e,r,i,o=0,a=t[0].length;o<a;++o){for(i=e=0;e<r;++e)i+=t[e][o][1]||0;if(i)for(e=0;e<r;++e)t[e][o][1]/=i}q_(t,n)}},t.stackOffsetDiverging=function(t,n){if((u=t.length)>1)for(var e,r,i,o,a,u,c=0,f=t[n[0]].length;c<f;++c)for(o=a=0,e=0;e<u;++e)(i=(r=t[n[e]][c])[1]-r[0])>=0?(r[0]=o,r[1]=o+=i):i<0?(r[1]=a,r[0]=a+=i):r[0]=o},t.stackOffsetNone=q_,t.stackOffsetSilhouette=function(t,n){if((e=t.length)>0){for(var e,r=0,i=t[n[0]],o=i.length;r<o;++r){for(var a=0,u=0;a<e;++a)u+=t[a][r][1]||0;i[r][1]+=i[r][0]=-u/2}q_(t,n)}},t.stackOffsetWiggle=function(t,n){if((i=t.length)>0&&(r=(e=t[n[0]]).length)>0){for(var e,r,i,o=0,a=1;a<r;++a){for(var u=0,c=0,f=0;u<i;++u){for(var s=t[n[u]],l=s[a][1]||0,h=(l-(s[a-1][1]||0))/2,d=0;d<u;++d){var p=t[n[d]];h+=(p[a][1]||0)-(p[a-1][1]||0)}c+=l,f+=h*l}e[a-1][1]+=e[a-1][0]=o,c&&(o-=f/c)}e[a-1][1]+=e[a-1][0]=o,q_(t,n)}},t.stackOrderAppearance=O_,t.stackOrderAscending=Y_,t.stackOrderDescending=function(t){return Y_(t).reverse()},t.stackOrderInsideOut=function(t){var n,e,r=t.length,i=t.map(F_),o=O_(t),a=0,u=0,c=[],f=[];for(n=0;n<r;++n)e=o[n],a<u?(a+=i[e],c.push(e)):(u+=i[e],f.push(e));return f.reverse().concat(c)},t.stackOrderNone=L_,t.stackOrderReverse=function(t){return L_(t).reverse()},t.timeInterval=$h,t.timeMillisecond=Wh,t.timeMilliseconds=Zh,t.utcMillisecond=Wh,t.utcMilliseconds=Zh,t.timeSecond=Kh,t.timeSeconds=td,t.utcSecond=Kh,t.utcSeconds=td,t.timeMinute=nd,t.timeMinutes=ed,t.timeHour=rd,t.timeHours=id,t.timeDay=od,t.timeDays=ad,t.timeWeek=cd,t.timeWeeks=vd,t.timeSunday=cd,t.timeSundays=vd,t.timeMonday=fd,t.timeMondays=gd,t.timeTuesday=sd,t.timeTuesdays=yd,t.timeWednesday=ld,t.timeWednesdays=_d,t.timeThursday=hd,t.timeThursdays=bd,t.timeFriday=dd,t.timeFridays=md,t.timeSaturday=pd,t.timeSaturdays=xd,t.timeMonth=wd,t.timeMonths=Md,t.timeYear=Nd,t.timeYears=Ad,t.utcMinute=Td,t.utcMinutes=Sd,t.utcHour=kd,t.utcHours=Ed,t.utcDay=Cd,t.utcDays=Pd,t.utcWeek=Rd,t.utcWeeks=Yd,t.utcSunday=Rd,t.utcSundays=Yd,t.utcMonday=Dd,t.utcMondays=Fd,t.utcTuesday=qd,t.utcTuesdays=Id,t.utcWednesday=Ld,t.utcWednesdays=jd,t.utcThursday=Ud,t.utcThursdays=Hd,t.utcFriday=Od,t.utcFridays=Xd,t.utcSaturday=Bd,t.utcSaturdays=Gd,t.utcMonth=Vd,t.utcMonths=$d,t.utcYear=Wd,t.utcYears=Zd,t.timeFormatDefaultLocale=hv,t.timeFormatLocale=tp,t.isoFormat=dv,t.isoParse=pv,t.now=nr,t.timer=ir,t.timerFlush=or,t.timeout=fr,t.interval=function(t,n,e){var r=new rr,i=n;return null==n?(r.restart(t,n,e),r):(n=+n,e=null==e?nr():+e,r.restart(function o(a){a+=i,r.restart(o,i+=n,e),t(a)},n,e),r)},t.transition=Cr,t.active=function(t,n){var e,r,i=t.__transition;if(i)for(r in n=null==n?null:n+"",i)if((e=i[r]).state>dr&&e.name===n)return new Er([[t]],fi,n,+r);return null},t.interrupt=Mr,t.voronoi=function(){var t=j_,n=H_,e=null;function r(r){return new Nb(r.map(function(e,i){var o=[Math.round(t(e,i,r)/xb)*xb,Math.round(n(e,i,r)/xb)*xb];return o.index=i,o.data=e,o}),e)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(n){return arguments.length?(t="function"==typeof n?n:I_(+n),r):t},r.y=function(t){return arguments.length?(n="function"==typeof t?t:I_(+t),r):n},r.extent=function(t){return arguments.length?(e=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):e&&[[e[0][0],e[0][1]],[e[1][0],e[1][1]]]},r.size=function(t){return arguments.length?(e=null==t?null:[[0,0],[+t[0],+t[1]]],r):e&&[e[1][0]-e[0][0],e[1][1]-e[0][1]]},r},t.zoom=function(){var n,e,r=zb,i=Rb,o=Ub,a=qb,u=Lb,c=[0,1/0],f=[[-1/0,-1/0],[1/0,1/0]],s=250,l=De,h=[],d=I("start","zoom","end"),p=500,v=150,g=0;function y(t){t.property("__zoom",Db).on("wheel.zoom",N).on("mousedown.zoom",A).on("dblclick.zoom",T).filter(u).on("touchstart.zoom",S).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function _(t,n){return(n=Math.max(c[0],Math.min(c[1],n)))===t.k?t:new Sb(n,t.x,t.y)}function b(t,n,e){var r=n[0]-e[0]*t.k,i=n[1]-e[1]*t.k;return r===t.x&&i===t.y?t:new Sb(t.k,r,i)}function m(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function x(t,n,e){t.on("start.zoom",function(){w(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).end()}).tween("zoom",function(){var t=arguments,r=w(this,t),o=i.apply(this,t),a=e||m(o),u=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),c=this.__zoom,f="function"==typeof n?n.apply(this,t):n,s=l(c.invert(a).concat(u/c.k),f.invert(a).concat(u/f.k));return function(t){if(1===t)t=f;else{var n=s(t),e=u/n[2];t=new Sb(e,a[0]-n[0]*e,a[1]-n[1]*e)}r.zoom(null,t)}})}function w(t,n){for(var e,r=0,i=h.length;r<i;++r)if((e=h[r]).that===t)return e;return new M(t,n)}function M(t,n){this.that=t,this.args=n,this.index=-1,this.active=0,this.extent=i.apply(t,n)}function N(){if(r.apply(this,arguments)){var t=w(this,arguments),n=this.__zoom,e=Math.max(c[0],Math.min(c[1],n.k*Math.pow(2,a.apply(this,arguments)))),i=Ot(this);if(t.wheel)t.mouse[0][0]===i[0]&&t.mouse[0][1]===i[1]||(t.mouse[1]=n.invert(t.mouse[0]=i)),clearTimeout(t.wheel);else{if(n.k===e)return;t.mouse=[i,n.invert(i)],Mr(this),t.start()}Pb(),t.wheel=setTimeout(function(){t.wheel=null,t.end()},v),t.zoom("mouse",o(b(_(n,e),t.mouse[0],t.mouse[1]),t.extent,f))}}function A(){if(!e&&r.apply(this,arguments)){var n=w(this,arguments),i=zt(t.event.view).on("mousemove.zoom",function(){if(Pb(),!n.moved){var e=t.event.clientX-u,r=t.event.clientY-c;n.moved=e*e+r*r>g}n.zoom("mouse",o(b(n.that.__zoom,n.mouse[0]=Ot(n.that),n.mouse[1]),n.extent,f))},!0).on("mouseup.zoom",function(){i.on("mousemove.zoom mouseup.zoom",null),jt(t.event.view,n.moved),Pb(),n.end()},!0),a=Ot(this),u=t.event.clientX,c=t.event.clientY;It(t.event.view),Cb(),n.mouse=[a,this.__zoom.invert(a)],Mr(this),n.start()}}function T(){if(r.apply(this,arguments)){var n=this.__zoom,e=Ot(this),a=n.invert(e),u=n.k*(t.event.shiftKey?.5:2),c=o(b(_(n,u),e,a),i.apply(this,arguments),f);Pb(),s>0?zt(this).transition().duration(s).call(x,c,e):zt(this).call(y.transform,c)}}function S(){if(r.apply(this,arguments)){var e,i,o,a,u=w(this,arguments),c=t.event.changedTouches,f=c.length;for(Cb(),i=0;i<f;++i)a=[a=Bt(this,c,(o=c[i]).identifier),this.__zoom.invert(a),o.identifier],u.touch0?u.touch1||(u.touch1=a):(u.touch0=a,e=!0);if(n&&(n=clearTimeout(n),!u.touch1))return u.end(),void((a=zt(this).on("dblclick.zoom"))&&a.apply(this,arguments));e&&(n=setTimeout(function(){n=null},p),Mr(this),u.start())}}function k(){var e,r,i,a,u=w(this,arguments),c=t.event.changedTouches,s=c.length;for(Pb(),n&&(n=clearTimeout(n)),e=0;e<s;++e)i=Bt(this,c,(r=c[e]).identifier),u.touch0&&u.touch0[2]===r.identifier?u.touch0[0]=i:u.touch1&&u.touch1[2]===r.identifier&&(u.touch1[0]=i);if(r=u.that.__zoom,u.touch1){var l=u.touch0[0],h=u.touch0[1],d=u.touch1[0],p=u.touch1[1],v=(v=d[0]-l[0])*v+(v=d[1]-l[1])*v,g=(g=p[0]-h[0])*g+(g=p[1]-h[1])*g;r=_(r,Math.sqrt(v/g)),i=[(l[0]+d[0])/2,(l[1]+d[1])/2],a=[(h[0]+p[0])/2,(h[1]+p[1])/2]}else{if(!u.touch0)return;i=u.touch0[0],a=u.touch0[1]}u.zoom("touch",o(b(r,i,a),u.extent,f))}function E(){var n,r,i=w(this,arguments),o=t.event.changedTouches,a=o.length;for(Cb(),e&&clearTimeout(e),e=setTimeout(function(){e=null},p),n=0;n<a;++n)r=o[n],i.touch0&&i.touch0[2]===r.identifier?delete i.touch0:i.touch1&&i.touch1[2]===r.identifier&&delete i.touch1;i.touch1&&!i.touch0&&(i.touch0=i.touch1,delete i.touch1),i.touch0?i.touch0[1]=this.__zoom.invert(i.touch0[0]):i.end()}return y.transform=function(t,n){var e=t.selection?t.selection():t;e.property("__zoom",Db),t!==e?x(t,n):e.interrupt().each(function(){w(this,arguments).start().zoom(null,"function"==typeof n?n.apply(this,arguments):n).end()})},y.scaleBy=function(t,n){y.scaleTo(t,function(){return this.__zoom.k*("function"==typeof n?n.apply(this,arguments):n)})},y.scaleTo=function(t,n){y.transform(t,function(){var t=i.apply(this,arguments),e=this.__zoom,r=m(t),a=e.invert(r),u="function"==typeof n?n.apply(this,arguments):n;return o(b(_(e,u),r,a),t,f)})},y.translateBy=function(t,n,e){y.transform(t,function(){return o(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof e?e.apply(this,arguments):e),i.apply(this,arguments),f)})},y.translateTo=function(t,n,e){y.transform(t,function(){var t=i.apply(this,arguments),r=this.__zoom,a=m(t);return o(kb.translate(a[0],a[1]).scale(r.k).translate("function"==typeof n?-n.apply(this,arguments):-n,"function"==typeof e?-e.apply(this,arguments):-e),t,f)})},M.prototype={start:function(){return 1==++this.active&&(this.index=h.push(this)-1,this.emit("start")),this},zoom:function(t,n){return this.mouse&&"mouse"!==t&&(this.mouse[1]=n.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=n.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=n.invert(this.touch1[0])),this.that.__zoom=n,this.emit("zoom"),this},end:function(){return 0==--this.active&&(h.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(t){St(new Tb(y,t,this.that.__zoom),d.apply,d,[t,this.that,this.args])}},y.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:Ab(+t),y):a},y.filter=function(t){return arguments.length?(r="function"==typeof t?t:Ab(!!t),y):r},y.touchable=function(t){return arguments.length?(u="function"==typeof t?t:Ab(!!t),y):u},y.extent=function(t){return arguments.length?(i="function"==typeof t?t:Ab([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),y):i},y.scaleExtent=function(t){return arguments.length?(c[0]=+t[0],c[1]=+t[1],y):[c[0],c[1]]},y.translateExtent=function(t){return arguments.length?(f[0][0]=+t[0][0],f[1][0]=+t[1][0],f[0][1]=+t[0][1],f[1][1]=+t[1][1],y):[[f[0][0],f[0][1]],[f[1][0],f[1][1]]]},y.constrain=function(t){return arguments.length?(o=t,y):o},y.duration=function(t){return arguments.length?(s=+t,y):s},y.interpolate=function(t){return arguments.length?(l=t,y):l},y.on=function(){var t=d.on.apply(d,arguments);return t===d?y:t},y.clickDistance=function(t){return arguments.length?(g=(t=+t)*t,y):Math.sqrt(g)},y},t.zoomTransform=Eb,t.zoomIdentity=kb,Object.defineProperty(t,"__esModule",{value:!0})});

;// Copyright (c) 2018 NHOGS Interactive.
(function (global, factory) {
typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('d3'), require('jquery')) :
typeof define === 'function' && define.amd ? define(['exports', 'd3', 'jquery'], factory) :
(global = global || self, factory(global.popoto = global.popoto || {}, global.d3, global.jQuery));
}(this, function (exports, d3, jQuery) { 'use strict';

jQuery = jQuery && jQuery.hasOwnProperty('default') ? jQuery['default'] : jQuery;

var version = "2.0.17";

var dataModel = {};

dataModel.idGen = 0;

dataModel.generateId = function () {
    return dataModel.idGen++;
};

dataModel.nodes = [];
dataModel.links = [];

dataModel.getRootNode = function () {
    return dataModel.nodes[0];
};

/**
 * logger module.
 * @module logger
 */

// LOGGER -----------------------------------------------------------------------------------------------------------
var logger = {};
logger.LogLevels = Object.freeze({DEBUG: 0, INFO: 1, WARN: 2, ERROR: 3, NONE: 4});
logger.LEVEL = logger.LogLevels.NONE;
logger.TRACE = false;

/**
 * Log a message on console depending on configured log levels.
 * Level is define in popoto.logger.LEVEL property.
 * If popoto.logger.TRACE is set to true, the stack trace is also added in log.
 * @param logLevel Level of the message from popoto.logger.LogLevels.
 * @param message Message to log.
 */
logger.log = function (logLevel, message) {
    if (console && logLevel >= logger.LEVEL) {
        if (logger.TRACE) {
            message = message + "\n" + new Error().stack;
        }
        switch (logLevel) {
            case logger.LogLevels.DEBUG:
                console.log(message);
                break;
            case logger.LogLevels.INFO:
                console.log(message);
                break;
            case logger.LogLevels.WARN:
                console.warn(message);
                break;
            case logger.LogLevels.ERROR:
                console.error(message);
                break;
        }
    }
};

/**
 * Log a message in DEBUG level.
 * @param message to log.
 */
logger.debug = function (message) {
    logger.log(logger.LogLevels.DEBUG, message);
};

/**
 * Log a message in INFO level.
 * @param message to log.
 */
logger.info = function (message) {
    logger.log(logger.LogLevels.INFO, message);
};

/**
 * Log a message in WARN level.
 * @param message to log.
 */
logger.warn = function (message) {
    logger.log(logger.LogLevels.WARN, message);
};

/**
 * Log a message in ERROR level.
 * @param message to log.
 */
logger.error = function (message) {
    logger.log(logger.LogLevels.ERROR, message);
};

var query = {};

/**
 * Define the number of results displayed in result list.
 */
query.MAX_RESULTS_COUNT = 100;
// query.RESULTS_PAGE_NUMBER = 1;
query.VALUE_QUERY_LIMIT = 100;
query.USE_PARENT_RELATION = false;
query.USE_RELATION_DIRECTION = true;
query.COLLECT_RELATIONS_WITH_VALUES = false;
query.prefilter = "";
query.prefilterParameters = {};

query.applyPrefilters = function (queryStructure) {
    queryStructure.statement = query.prefilter + queryStructure.statement;

    Object.keys(query.prefilterParameters).forEach(function (key) {
        queryStructure.parameters[key] = query.prefilterParameters[key];
    });

    return queryStructure;
};

/**
 * Immutable constant object to identify Neo4j internal ID
 */
query.NEO4J_INTERNAL_ID = Object.freeze({queryInternalName: "NEO4JID"});

/**
 * Function used to filter returned relations
 * return false if the result should be filtered out.
 *
 * @param d relation returned object
 * @returns {boolean}
 */
query.filterRelation = function (d) {
    return true;
};

/**
 * Generate the query to count nodes of a label.
 * If the label is defined as distinct in configuration the query will count only distinct values on constraint attribute.
 */
query.generateTaxonomyCountQuery = function (label) {
    var constraintAttr = provider.node.getConstraintAttribute(label);

    var whereElements = [];

    var predefinedConstraints = provider.node.getPredefinedConstraints(label);
    predefinedConstraints.forEach(function (predefinedConstraint) {
        whereElements.push(predefinedConstraint.replace(new RegExp("\\$identifier", 'g'), "n"));
    });

    if (constraintAttr === query.NEO4J_INTERNAL_ID) {
        return "MATCH (n:`" + label + "`)" + ((whereElements.length > 0) ? " WHERE " + whereElements.join(" AND ") : "") + " RETURN count(DISTINCT ID(n)) as count"
    } else {
        return "MATCH (n:`" + label + "`)" + ((whereElements.length > 0) ? " WHERE " + whereElements.join(" AND ") : "") + " RETURN count(DISTINCT n." + constraintAttr + ") as count"
    }
};

query.generateNegativeQueryElements = function () {
    var whereElements = [];
    var parameters = {};

    var negativeNodes = dataModel.nodes.filter(function (n) {
        return n.isNegative === true;
    });

    negativeNodes.forEach(
        function (n) {
            if (provider.node.getGenerateNegativeNodeValueConstraints(n) !== undefined) {
                var custom = provider.node.getGenerateNegativeNodeValueConstraints(n)(n);
                whereElements = whereElements.concat(custom.whereElements);
                for (var prop in custom.parameters) {
                    if (custom.parameters.hasOwnProperty(prop)) {
                        parameters[prop] = custom.parameters[prop];
                    }
                }
            } else {
                var linksToRoot = query.getLinksToRoot(n, dataModel.links);

                var i = linksToRoot.length - 1;
                var statement = "(NOT exists(";

                statement += "(" + dataModel.getRootNode().internalLabel + ")";

                while (i >= 0) {
                    var l = linksToRoot[i];
                    var targetNode = l.target;

                    if (targetNode.isParentRelReverse === true && query.USE_RELATION_DIRECTION === true) {
                        statement += "<-";
                    } else {
                        statement += "-";
                    }

                    statement += "[:`" + l.label + "`]";

                    if (targetNode.isParentRelReverse !== true && query.USE_RELATION_DIRECTION === true) {
                        statement += "->";
                    } else {
                        statement += "-";
                    }

                    if (targetNode === n && targetNode.value !== undefined && targetNode.value.length > 0) {
                        var constraintAttr = provider.node.getConstraintAttribute(targetNode.label);
                        var paramName = targetNode.internalLabel + "_" + constraintAttr;

                        if (targetNode.value.length > 1) {
                            for (var pid = 0; pid < targetNode.value.length; pid++) {
                                parameters[paramName + "_" + pid] = targetNode.value[pid].attributes[constraintAttr];
                            }

                            statement += "(:`" + targetNode.label + "`{" + constraintAttr + ":$x$})";
                        } else {
                            parameters[paramName] = targetNode.value[0].attributes[constraintAttr];
                            statement += "(:`" + targetNode.label + "`{" + constraintAttr + ":$" + paramName + "})";
                        }
                    } else {
                        statement += "(:`" + targetNode.label + "`)";
                    }

                    i--;
                }

                statement += "))";

                if (n.value !== undefined && n.value.length > 1) {
                    var cAttr = provider.node.getConstraintAttribute(n.label);
                    var pn = n.internalLabel + "_" + cAttr;

                    for (var nid = 0; nid < targetNode.value.length; nid++) {
                        whereElements.push(statement.replace("$x$", "$" + pn + "_" + nid));
                    }
                } else {
                    whereElements.push(statement);
                }
            }
        }
    );

    return {
        "whereElements": whereElements,
        "parameters": parameters
    };
};

/**
 * Generate Cypher query match and where elements from root node, selected node and a set of the graph links.
 *
 * @param rootNode root node in the graph.
 * @param selectedNode graph target node.
 * @param links list of links subset of the graph.
 * @returns {{matchElements: Array, whereElements: Array}}  list of match and where elements.
 * @param isConstraintNeeded (used only for relation query)
 * @param useCustomConstraints define whether to use the custom constraints (actually it is used only for results)
 */
query.generateQueryElements = function (rootNode, selectedNode, links, isConstraintNeeded, useCustomConstraints) {
    var matchElements = [];
    var whereElements = [];
    var relationElements = [];
    var returnElements = [];
    var parameters = {};

    var rootPredefinedConstraints = provider.node.getPredefinedConstraints(rootNode.label);

    rootPredefinedConstraints.forEach(function (predefinedConstraint) {
        whereElements.push(predefinedConstraint.replace(new RegExp("\\$identifier", 'g'), rootNode.internalLabel));
    });

    matchElements.push("(" + rootNode.internalLabel + ":`" + rootNode.label + "`)");

    // Generate root node match element
    if (isConstraintNeeded || rootNode.immutable) {
        var rootValueConstraints = query.generateNodeValueConstraints(rootNode, useCustomConstraints);
        whereElements = whereElements.concat(rootValueConstraints.whereElements);
        for (var param in rootValueConstraints.parameters) {
            if (rootValueConstraints.parameters.hasOwnProperty(param)) {
                parameters[param] = rootValueConstraints.parameters[param];
            }
        }
    }

    var relId = 0;

    // Generate match elements for each links
    links.forEach(function (l) {
        var sourceNode = l.source;
        var targetNode = l.target;

        var sourceRel = "";
        var targetRel = "";

        if (!query.USE_RELATION_DIRECTION) {
            sourceRel = "-";
            targetRel = "-";
        } else {
            if (targetNode.isParentRelReverse === true) {
                sourceRel = "<-";
                targetRel = "-";
            } else {
                sourceRel = "-";
                targetRel = "->";
            }
        }

        var relIdentifier = "r" + relId++;
        relationElements.push(relIdentifier);
        var predefinedConstraints = provider.node.getPredefinedConstraints(targetNode.label);

        predefinedConstraints.forEach(function (predefinedConstraint) {
            whereElements.push(predefinedConstraint.replace(new RegExp("\\$identifier", 'g'), targetNode.internalLabel));
        });

        if (query.COLLECT_RELATIONS_WITH_VALUES && targetNode === selectedNode) {
            returnElements.push("COLLECT(" + relIdentifier + ") AS incomingRels");
        }

        var sourceLabelStatement = "";

        if (!useCustomConstraints || provider.node.getGenerateNodeValueConstraints(sourceNode) === undefined) {
            sourceLabelStatement = ":`" + sourceNode.label + "`";
        }

        var targetLabelStatement = "";

        if (!useCustomConstraints || provider.node.getGenerateNodeValueConstraints(targetNode) === undefined) {
            targetLabelStatement = ":`" + targetNode.label + "`";
        }

        matchElements.push("(" + sourceNode.internalLabel + sourceLabelStatement + ")" + sourceRel + "[" + relIdentifier + ":`" + l.label + "`]" + targetRel + "(" + targetNode.internalLabel + targetLabelStatement + ")");

        if (targetNode !== selectedNode && (isConstraintNeeded || targetNode.immutable)) {
            var nodeValueConstraints = query.generateNodeValueConstraints(targetNode, useCustomConstraints);
            whereElements = whereElements.concat(nodeValueConstraints.whereElements);
            for (var param in nodeValueConstraints.parameters) {
                if (nodeValueConstraints.parameters.hasOwnProperty(param)) {
                    parameters[param] = nodeValueConstraints.parameters[param];
                }
            }
        }
    });

    return {
        "matchElements": matchElements,
        "whereElements": whereElements,
        "relationElements": relationElements,
        "returnElements": returnElements,
        "parameters": parameters
    };
};

/**
 * Generate the where and parameter statements for the nodes with value
 *
 * @param node the node to generate value constraints
 * @param useCustomConstraints define whether to use custom generation in popoto config
 */
query.generateNodeValueConstraints = function (node, useCustomConstraints) {
    if (useCustomConstraints && provider.node.getGenerateNodeValueConstraints(node) !== undefined) {
        return provider.node.getGenerateNodeValueConstraints(node)(node);
    } else {
        var parameters = {}, whereElements = [];
        if (node.value !== undefined && node.value.length > 0) {
            var constraintAttr = provider.node.getConstraintAttribute(node.label);
            var paramName;
            if (constraintAttr === query.NEO4J_INTERNAL_ID) {
                paramName = node.internalLabel + "_internalID";
            } else {
                paramName = node.internalLabel + "_" + constraintAttr;
            }

            if (node.value.length > 1) { // Generate IN constraint
                parameters[paramName] = [];

                node.value.forEach(function (value) {
                    var constraintValue;
                    if (constraintAttr === query.NEO4J_INTERNAL_ID) {
                        constraintValue = value.internalID;
                    } else {
                        constraintValue = value.attributes[constraintAttr];
                    }

                    parameters[paramName].push(constraintValue);
                });

                if (constraintAttr === query.NEO4J_INTERNAL_ID) {
                    whereElements.push("ID(" + node.internalLabel + ") IN " + "$" + paramName);
                } else {
                    whereElements.push(node.internalLabel + "." + constraintAttr + " IN " + "$" + paramName);
                }
            } else { // Generate = constraint
                if (constraintAttr === query.NEO4J_INTERNAL_ID) {
                    parameters[paramName] = node.value[0].internalID;
                } else {
                    parameters[paramName] = node.value[0].attributes[constraintAttr];
                }

                var operator = "=";

                if (constraintAttr === query.NEO4J_INTERNAL_ID) {
                    whereElements.push("ID(" + node.internalLabel + ") " + operator + " " + "$" + paramName);
                } else {
                    whereElements.push(node.internalLabel + "." + constraintAttr + " " + operator + " " + "$" + paramName);
                }
            }
        }

        return {
            parameters: parameters,
            whereElements: whereElements
        }
    }
};

/**
 * Filter links to get only paths from root to leaf containing a value or being the selectedNode.
 * All other paths in the graph containing no value are ignored.
 *
 * @param rootNode root node of the graph.
 * @param targetNode node in the graph target of the query.
 * @param initialLinks list of links representing the graph to filter.
 * @returns {Array} list of relevant links.
 */
query.getRelevantLinks = function (rootNode, targetNode, initialLinks) {
    var links = initialLinks.slice();
    var finalLinks = [];

    // Filter all links to keep only those containing a value or being the selected node.
    // Negatives nodes are handled separately.
    var filteredLinks = links.filter(function (l) {
        return l.target === targetNode || ((l.target.value !== undefined && l.target.value.length > 0) && (!l.target.isNegative === true));
    });

    // All the filtered links are removed from initial links list.
    filteredLinks.forEach(function (l) {
        links.splice(links.indexOf(l), 1);
    });

    // Then all the intermediate links up to the root node are added to get only the relevant links.
    filteredLinks.forEach(function (fl) {
        var sourceNode = fl.source;
        var search = true;

        while (search) {
            var intermediateLink = null;
            links.forEach(function (l) {
                if (l.target === sourceNode) {
                    intermediateLink = l;
                }
            });

            if (intermediateLink === null) { // no intermediate links needed
                search = false;
            } else {
                if (intermediateLink.source === rootNode) {
                    finalLinks.push(intermediateLink);
                    links.splice(links.indexOf(intermediateLink), 1);
                    search = false;
                } else {
                    finalLinks.push(intermediateLink);
                    links.splice(links.indexOf(intermediateLink), 1);
                    sourceNode = intermediateLink.source;
                }
            }
        }
    });

    return filteredLinks.concat(finalLinks);
};

/**
 * Get the list of link defining the complete path from node to root.
 * All other links are ignored.
 *
 * @param node The node where to start in the graph.
 * @param links
 */
query.getLinksToRoot = function (node, links) {
    var pathLinks = [];
    var targetNode = node;

    while (targetNode !== dataModel.getRootNode()) {
        var nodeLink;

        for (var i = 0; i < links.length; i++) {
            var link = links[i];
            if (link.target === targetNode) {
                nodeLink = link;
                break;
            }
        }

        if (nodeLink) {
            pathLinks.push(nodeLink);
            targetNode = nodeLink.source;
        }
    }

    return pathLinks;
};

/**
 * Generate a Cypher query to retrieve the results matching the current graph.
 *
 * @param isGraph
 * @returns {{statement: string, parameters: (*|{})}}
 */
query.generateResultQuery = function (isGraph) {
    var rootNode = dataModel.getRootNode();
    var negativeElements = query.generateNegativeQueryElements();
    var queryElements = query.generateQueryElements(rootNode, rootNode, query.getRelevantLinks(rootNode, rootNode, dataModel.links), true, true);
    var queryMatchElements = queryElements.matchElements,
        queryWhereElements = queryElements.whereElements.concat(negativeElements.whereElements),
        queryRelationElements = queryElements.relationElements,
        queryReturnElements = [],
        queryEndElements = [],
        queryParameters = queryElements.parameters;

    for (var prop in negativeElements.parameters) {
        if (negativeElements.parameters.hasOwnProperty(prop)) {
            queryParameters[prop] = negativeElements.parameters[prop];
        }
    }

    // Sort results by specified attribute
    var resultOrderByAttribute = provider.node.getResultOrderByAttribute(rootNode.label);

    if (resultOrderByAttribute !== undefined && resultOrderByAttribute !== null) {
        var sorts = [];
        var order = provider.node.isResultOrderAscending(rootNode.label);

        var orders = [];
        if (Array.isArray(order)) {
            orders = order.map(function (v) {
                return v ? "ASC" : "DESC";
            });
        } else {
            orders.push(order ? "ASC" : "DESC");
        }

        if (Array.isArray(resultOrderByAttribute)) {
            sorts = resultOrderByAttribute.map(function (ra) {
                var index = resultOrderByAttribute.indexOf(ra);

                if (index < orders.length) {
                    return ra + " " + orders[index];
                } else {
                    return ra + " " + orders[orders.length - 1];
                }
            });

        } else {
            sorts.push(resultOrderByAttribute + " " + orders[0]);
        }

        queryEndElements.push("ORDER BY " + sorts.join(", "));
    }

    queryParameters.limit = query.MAX_RESULTS_COUNT;
    queryEndElements.push("LIMIT $limit");

    var resultAttributes = provider.node.getReturnAttributes(rootNode.label);

    if (!isGraph) {
        for (var i = 0; i < resultAttributes.length; i++) {
            var attribute = resultAttributes[i];
            if (attribute === query.NEO4J_INTERNAL_ID) {
                queryReturnElements.push("ID(" + rootNode.internalLabel + ") AS " + query.NEO4J_INTERNAL_ID.queryInternalName);
            } else {
                queryReturnElements.push(rootNode.internalLabel + "." + attribute + " AS " + attribute);
            }
        }
    } else {
        // Only return relations
        queryReturnElements.push(rootNode.internalLabel);
        queryRelationElements.forEach(
            function (el) {
                queryReturnElements.push(el);
            }
        );
    }

    var queryStatement = "MATCH " + queryMatchElements.join(", ") + ((queryWhereElements.length > 0) ? " WHERE " + queryWhereElements.join(" AND ") : "") + " RETURN DISTINCT " + queryReturnElements.join(", ") + " " + queryEndElements.join(" ");

    // Filter the query if defined in config
    var queryStructure = provider.node.filterResultQuery(rootNode.label, {
        statement: queryStatement,
        matchElements: queryMatchElements,
        whereElements: queryWhereElements,
        withElements: [],
        returnElements: queryReturnElements,
        endElements: queryEndElements,
        parameters: queryParameters
    });

    return query.applyPrefilters(queryStructure);
};

/**
 * Generate a cypher query to the get the node count, set as parameter matching the current graph.
 *
 * @param countedNode the counted node
 * @returns {string} the node count cypher query
 */
query.generateNodeCountQuery = function (countedNode) {
    var negativeElements = query.generateNegativeQueryElements();
    var queryElements = query.generateQueryElements(dataModel.getRootNode(), countedNode, query.getRelevantLinks(dataModel.getRootNode(), countedNode, dataModel.links), true, true);
    var queryMatchElements = queryElements.matchElements,
        queryWhereElements = queryElements.whereElements.concat(negativeElements.whereElements),
        queryReturnElements = [],
        queryEndElements = [],
        queryParameters = queryElements.parameters;

    for (var prop in negativeElements.parameters) {
        if (negativeElements.parameters.hasOwnProperty(prop)) {
            queryParameters[prop] = negativeElements.parameters[prop];
        }
    }

    var countAttr = provider.node.getConstraintAttribute(countedNode.label);

    if (countAttr === query.NEO4J_INTERNAL_ID) {
        queryReturnElements.push("count(DISTINCT ID(" + countedNode.internalLabel + ")) as count");
    } else {
        queryReturnElements.push("count(DISTINCT " + countedNode.internalLabel + "." + countAttr + ") as count");
    }

    var queryStatement = "MATCH " + queryMatchElements.join(", ") + ((queryWhereElements.length > 0) ? " WHERE " + queryWhereElements.join(" AND ") : "") + " RETURN " + queryReturnElements.join(", ");

    // Filter the query if defined in config
    var queryStructure = provider.node.filterNodeCountQuery(countedNode, {
        statement: queryStatement,
        matchElements: queryMatchElements,
        whereElements: queryWhereElements,
        returnElements: queryReturnElements,
        endElements: queryEndElements,
        parameters: queryParameters
    });

    return query.applyPrefilters(queryStructure);
};

/**
 * Generate a Cypher query from the graph model to get all the possible values for the targetNode element.
 *
 * @param targetNode node in the graph to get the values.
 * @returns {string} the query to execute to get all the values of targetNode corresponding to the graph.
 */
query.generateNodeValueQuery = function (targetNode) {
    var negativeElements = query.generateNegativeQueryElements();
    var rootNode = dataModel.getRootNode();
    var queryElements = query.generateQueryElements(rootNode, targetNode, query.getRelevantLinks(rootNode, targetNode, dataModel.links), true, false);
    var queryMatchElements = queryElements.matchElements,
        queryWhereElements = queryElements.whereElements.concat(negativeElements.whereElements),
        queryReturnElements = [],
        queryEndElements = [],
        queryParameters = queryElements.parameters;

    for (var prop in negativeElements.parameters) {
        if (negativeElements.parameters.hasOwnProperty(prop)) {
            queryParameters[prop] = negativeElements.parameters[prop];
        }
    }

    // Sort results by specified attribute
    var valueOrderByAttribute = provider.node.getValueOrderByAttribute(targetNode.label);
    if (valueOrderByAttribute) {
        var order = provider.node.isValueOrderAscending(targetNode.label) ? "ASC" : "DESC";
        queryEndElements.push("ORDER BY " + valueOrderByAttribute + " " + order);
    }

    queryEndElements.push("LIMIT " + query.VALUE_QUERY_LIMIT);

    var resultAttributes = provider.node.getReturnAttributes(targetNode.label);
    var constraintAttribute = provider.node.getConstraintAttribute(targetNode.label);

    for (var i = 0; i < resultAttributes.length; i++) {
        if (resultAttributes[i] === query.NEO4J_INTERNAL_ID) {
            queryReturnElements.push("ID(" + targetNode.internalLabel + ") AS " + query.NEO4J_INTERNAL_ID.queryInternalName);
        } else {
            queryReturnElements.push(targetNode.internalLabel + "." + resultAttributes[i] + " AS " + resultAttributes[i]);
        }
    }

    // Add count return attribute on root node
    var rootConstraintAttr = provider.node.getConstraintAttribute(rootNode.label);

    if (rootConstraintAttr === query.NEO4J_INTERNAL_ID) {
        queryReturnElements.push("count(DISTINCT ID(" + rootNode.internalLabel + ")) AS count");
    } else {
        queryReturnElements.push("count(DISTINCT " + rootNode.internalLabel + "." + rootConstraintAttr + ") AS count");
    }

    if (query.COLLECT_RELATIONS_WITH_VALUES) {
        queryElements.returnElements.forEach(function (re) {
            queryReturnElements.push(re);
        });
    }

    var queryStatement = "MATCH " + queryMatchElements.join(", ") + ((queryWhereElements.length > 0) ? " WHERE " + queryWhereElements.join(" AND ") : "") + " RETURN " + queryReturnElements.join(", ") + " " + queryEndElements.join(" ");

    // Filter the query if defined in config
    var queryStructure = provider.node.filterNodeValueQuery(targetNode, {
        statement: queryStatement,
        matchElements: queryMatchElements,
        whereElements: queryWhereElements,
        returnElements: queryReturnElements,
        endElements: queryEndElements,
        parameters: queryParameters
    });

    return query.applyPrefilters(queryStructure);
};

/**
 * Generate a Cypher query to retrieve all the relation available for a given node.
 *
 * @param targetNode
 * @returns {string}
 */
query.generateNodeRelationQuery = function (targetNode) {

    var linksToRoot = query.getLinksToRoot(targetNode, dataModel.links);

    var queryElements = query.generateQueryElements(dataModel.getRootNode(), targetNode, linksToRoot, false, false);
    var queryMatchElements = queryElements.matchElements,
        queryWhereElements = queryElements.whereElements,
        queryReturnElements = [],
        queryEndElements = [],
        queryParameters = queryElements.parameters;

    var rel = query.USE_RELATION_DIRECTION ? "->" : "-";

    queryMatchElements.push("(" + targetNode.internalLabel + ":`" + targetNode.label + "`)-[r]" + rel + "(x)");
    queryReturnElements.push("type(r) AS label");
    if (query.USE_PARENT_RELATION) {
        queryReturnElements.push("head(labels(x)) AS target");
    } else {
        queryReturnElements.push("last(labels(x)) AS target");
    }
    queryReturnElements.push("count(r) AS count");
    queryEndElements.push("ORDER BY count(r) DESC");

    var queryStatement = "MATCH " + queryMatchElements.join(", ") + ((queryWhereElements.length > 0) ? " WHERE " + queryWhereElements.join(" AND ") : "") + " RETURN " + queryReturnElements.join(", ") + " " + queryEndElements.join(" ");
    // Filter the query if defined in config
    var queryStructure = provider.node.filterNodeRelationQuery(targetNode, {
        statement: queryStatement,
        matchElements: queryMatchElements,
        whereElements: queryWhereElements,
        returnElements: queryReturnElements,
        endElements: queryEndElements,
        parameters: queryParameters
    });

    return query.applyPrefilters(queryStructure);
};

/**
 * logger module.
 * @module logger
 */

var rest = {};

/**
 * Default REST URL used to call Neo4j server with cypher queries to execute.
 * This property should be updated to access to your own server.
 * @type {string}
 */
rest.CYPHER_URL = "http://localhost:7474/db/data/transaction/commit";
rest.WITH_CREDENTIALS = false;

/**
 * Create JQuery ajax POST request to access Neo4j REST API.
 *
 * @param data data object containing Cypher query.
 * @param url url where to post the data, default to popoto.rest.CYPHER_URL property.
 * @returns {*} the JQuery ajax request object.
 */
rest.post = function (data, url) {
    var strData = JSON.stringify(data);
    logger.info("REST POST:" + strData);

    var settings = {
        type: "POST",
        beforeSend: function (request) {
            if (rest.AUTHORIZATION) {
                request.setRequestHeader("Authorization", rest.AUTHORIZATION);
            }
        },
        contentType: "application/json"
    };

    if (data !== undefined) {
        settings.data = strData;
    }

    if (rest.WITH_CREDENTIALS === true) {
        settings.xhrFields = {
            withCredentials: true
        };
    }

    var postURL = rest.CYPHER_URL;

    if (url !== undefined) {
        postURL = url;
    }

    return jQuery.ajax(postURL, settings);
};

rest.response = {
    parse: function (data) {
        logger.debug(JSON.stringify((data)));
        var parsedData = [];

        if (data !== undefined && data.hasOwnProperty("results") && data.results.length > 0 && !(data.hasOwnProperty("errors") && data.errors.length > 0)) {
            parsedData = data.results.map(function (queryResults) {
                var results = [];
                for (var x = 0; x < queryResults.data.length; x++) {
                    var obj = {};

                    for (var i = 0; i < queryResults.columns.length; i++) {
                        obj[queryResults.columns[i]] = queryResults.data[x].row[i];
                    }

                    results.push(obj);
                }
                return results;
            });
        }

        logger.info(JSON.stringify((parsedData)));
        return parsedData
    }
};

var result = {};
result.containerId = "popoto-results";
result.hasChanged = true;
result.resultCountListeners = [];
result.resultListeners = [];
result.graphResultListeners = [];
result.RESULTS_PAGE_SIZE = 10;
result.TOTAL_COUNT = false;

/**
 * Register a listener to the result count event.
 * This listener will be called on evry result change with total result count.
 */
result.onTotalResultCount = function (listener) {
    result.resultCountListeners.push(listener);
};

result.onResultReceived = function (listener) {
    result.resultListeners.push(listener);
};

result.onGraphResultReceived = function (listener) {
    result.graphResultListeners.push(listener);
};

/**
 * Parse REST returned Graph data and generate a list of nodes and edges.
 *
 * @param data
 * @returns {{nodes: Array, edges: Array}}
 */
result.parseGraphResultData = function (data) {

    var nodes = {}, edges = {};

    data.results[1].data.forEach(function (row) {
        row.graph.nodes.forEach(function (n) {
            if (!nodes.hasOwnProperty(n.id)) {
                nodes[n.id] = n;
            }
        });

        row.graph.relationships.forEach(function (r) {
            if (!edges.hasOwnProperty(r.id)) {
                edges[r.id] = r;
            }
        });
    });

    var nodesArray = [], edgesArray = [];

    for (var n in nodes) {
        if (nodes.hasOwnProperty(n)) {
            nodesArray.push(nodes[n]);
        }
    }

    for (var e in edges) {
        if (edges.hasOwnProperty(e)) {
            edgesArray.push(edges[e]);
        }
    }

    return {nodes: nodesArray, edges: edgesArray};
};

result.updateResults = function () {
    if (result.hasChanged) {
        var resultsIndex = {};
        var index = 0;

        // Abort any old running request before starting a new one
        if (result.resultsXhr !== undefined) {
            result.resultsXhr.abort();
        }

        var resultQuery = query.generateResultQuery();
        result.lastGeneratedQuery = resultQuery;

        var postData = {
            "statements": [
                {
                    "statement": resultQuery.statement,
                    "parameters": resultQuery.parameters,
                    "resultDataContents": ["row"]
                }
            ]
        };
        resultsIndex["results"] = index++;

        // Add Graph result query if listener found
        if (result.graphResultListeners.length > 0) {
            var graphQuery = query.generateResultQuery(true);
            result.lastGeneratedQuery = graphQuery;

            postData.statements.push(
                {
                    "statement": graphQuery.statement,
                    "parameters": graphQuery.parameters,
                    "resultDataContents": ["row", "graph"]
                });
            resultsIndex["graph"] = index++;
        }

        if (result.TOTAL_COUNT === true && result.resultCountListeners.length > 0) {
            var nodeCountQuery = query.generateNodeCountQuery(dataModel.getRootNode());
            postData.statements.push(
                {
                    "statement": nodeCountQuery.statement,
                    "parameters": nodeCountQuery.parameters
                }
            );
            resultsIndex["total"] = index++;
        }

        logger.info("Results ==>");

        result.resultsXhr = rest.post(postData)
            .done(function (response) {
                logger.info("<== Results");

                var parsedData = rest.response.parse(response);

                var resultObjects = parsedData[resultsIndex["results"]].map(function (d, i) {
                    return {
                        "resultIndex": i,
                        "label": dataModel.getRootNode().label,
                        "attributes": d
                    };
                });

                result.lastResults = resultObjects;

                if (resultsIndex.hasOwnProperty("total")) {
                    var count = parsedData[resultsIndex["total"]][0].count;

                    // Notify listeners
                    result.resultCountListeners.forEach(function (listener) {
                        listener(count);
                    });
                }

                // Notify listeners
                result.resultListeners.forEach(function (listener) {
                    listener(resultObjects);
                });

                if (result.graphResultListeners.length > 0) {
                    var graphResultObjects = result.parseGraphResultData(response);
                    result.graphResultListeners.forEach(function (listener) {
                        listener(graphResultObjects);
                    });
                }

                // Update displayed results only if needed ()
                if (result.isActive) {
                    // Clear all results
                    var results = d3.select("#" + result.containerId).selectAll(".ppt-result").data([]);
                    results.exit().remove();
                    // Update data
                    results = d3.select("#" + result.containerId).selectAll(".ppt-result").data(resultObjects.slice(0, result.RESULTS_PAGE_SIZE), function (d) {
                        return d.resultIndex;
                    });

                    // Add new elements
                    var pElmt = results.enter()
                        .append("div")
                        .attr("class", "ppt-result")
                        .attr("id", function (d) {
                            return "popoto-result-" + d.resultIndex;
                        });

                    // Generate results with providers
                    pElmt.each(function (d) {
                        provider.node.getDisplayResults(d.label)(d3.select(this));
                    });
                }

                result.hasChanged = false;
            })
            .fail(function (xhr, textStatus, errorThrown) {
                if (textStatus !== "abort") {
                    logger.error(textStatus + ": error while accessing Neo4j server on URL:\"" + rest.CYPHER_URL + "\" defined in \"rest.CYPHER_URL\" property: " + errorThrown);

                    // Notify listeners
                    result.resultListeners.forEach(function (listener) {
                        listener([]);
                    });
                } else {
                    logger.info("<=X= Results - Aborted!");
                }
            });
    }
};

result.updateResultsCount = function () {
    // Update result counts with root node count
    if (result.resultCountListeners.length > 0) {
        result.resultCountListeners.forEach(function (listener) {
            listener(dataModel.getRootNode().count);
        });
    }
};

result.generatePreQuery = function () {
    var p = {"ids": []};

    result.lastResults.forEach(function (d) {
        p.ids.push(d.attributes.id);
    });

    return {
        query: "MATCH (d) WHERE d.id IN $ids WITH d",
        param: p
    };
};

/**
 * Main function to call to use Popoto.js.
 * This function will create all the HTML content based on available IDs in the page.
 *
 * @param startParam Root label or graph schema to use in the graph query builder.
 */
//TODO add instance creation + config
function start(startParam) {
    logger.info("Popoto " + version + " start on " + startParam);

    graph.mainLabel = startParam;

    if (rest.CYPHER_URL === undefined) {
        logger.error("popoto.rest.CYPHER_URL is not set but is required.");
    } else {
        // TODO introduce component generator mechanism instead for future plugin extensions
        checkHtmlComponents();

        if (taxonomy.isActive) {
            taxonomy.createTaxonomyPanel();
        }

        if (graph.isActive) {
            graph.createGraphArea();
            graph.createForceLayout();

            if (typeof startParam === 'string' || startParam instanceof String) {
                var labelSchema = provider.node.getSchema(startParam);
                if (labelSchema !== undefined) {
                    graph.addSchema(labelSchema);
                } else {
                    graph.addRootNode(startParam);
                }
            } else {
                graph.loadSchema(startParam);
            }
        }

        if (queryviewer.isActive) {
            queryviewer.createQueryArea();
        }

        if (cypherviewer.isActive) {
            cypherviewer.createQueryArea();
        }

        if (graph.USE_VORONOI_LAYOUT === true) {
            graph.voronoi.extent([[-popoto.graph.getSVGWidth(), -popoto.graph.getSVGWidth()], [popoto.graph.getSVGWidth() * 2, popoto.graph.getSVGHeight() * 2]]);
        }

        update();
    }
}

/**
 * Check in the HTML page the components to generate.
 */
function checkHtmlComponents() {
    var graphHTMLContainer = d3.select("#" + graph.containerId);
    var taxonomyHTMLContainer = d3.select("#" + taxonomy.containerId);
    var queryHTMLContainer = d3.select("#" + queryviewer.containerId);
    var cypherHTMLContainer = d3.select("#" + cypherviewer.containerId);
    var resultsHTMLContainer = d3.select("#" + result.containerId);

    if (graphHTMLContainer.empty()) {
        logger.debug("The page doesn't contain a container with ID = \"" + graph.containerId + "\" no graph area will be generated. This ID is defined in graph.containerId property.");
        graph.isActive = false;
    } else {
        graph.isActive = true;
    }

    if (taxonomyHTMLContainer.empty()) {
        logger.debug("The page doesn't contain a container with ID = \"" + taxonomy.containerId + "\" no taxonomy filter will be generated. This ID is defined in taxonomy.containerId property.");
        taxonomy.isActive = false;
    } else {
        taxonomy.isActive = true;
    }

    if (queryHTMLContainer.empty()) {
        logger.debug("The page doesn't contain a container with ID = \"" + queryviewer.containerId + "\" no query viewer will be generated. This ID is defined in queryviewer.containerId property.");
        queryviewer.isActive = false;
    } else {
        queryviewer.isActive = true;
    }

    if (cypherHTMLContainer.empty()) {
        logger.debug("The page doesn't contain a container with ID = \"" + cypherviewer.containerId + "\" no cypher query viewer will be generated. This ID is defined in cypherviewer.containerId property.");
        cypherviewer.isActive = false;
    } else {
        cypherviewer.isActive = true;
    }

    if (resultsHTMLContainer.empty()) {
        logger.debug("The page doesn't contain a container with ID = \"" + result.containerId + "\" no result area will be generated. This ID is defined in result.containerId property.");
        result.isActive = false;
    } else {
        result.isActive = true;
    }
}

/**
 * Function to call to update all the generated elements including svg graph, query viewer and generated results.
 */
function update() {
    updateGraph();

    // Do not update if rootNode is not valid.
    var root = dataModel.getRootNode();

    if (!root || root.label === undefined) {
        return;
    }

    if (queryviewer.isActive) {
        queryviewer.updateQuery();
    }
    if (cypherviewer.isActive) {
        cypherviewer.updateQuery();
    }
    // Results are updated only if needed.
    // If id found in html page or if result listeners have been added.
    // In this case the query must be executed.
    if (result.isActive || result.resultListeners.length > 0 || result.resultCountListeners.length > 0 || result.graphResultListeners.length > 0) {
        result.updateResults();
    }
}

/**
 * Function to call to update the graph only.
 */
function updateGraph() {
    if (graph.isActive) {
        // Starts the D3.js force simulation.
        // This method must be called when the layout is first created, after assigning the nodes and links.
        // In addition, it should be called again whenever the nodes or links change.
        graph.link.updateLinks();
        graph.node.updateNodes();

        // Force simulation restart
        graph.force.nodes(dataModel.nodes);
        graph.force.force("link").links(dataModel.links);
        graph.force.alpha(1).restart();
    }
}

var taxonomy = {};
taxonomy.containerId = "popoto-taxonomy";

/**
 * Create the taxonomy panel HTML elements.
 */
taxonomy.createTaxonomyPanel = function () {
    var htmlContainer = d3.select("#" + taxonomy.containerId);

    var taxoUL = htmlContainer.append("ul")
        .attr("class", "ppt-taxo-ul");

    var data = taxonomy.generateTaxonomiesData();

    var taxos = taxoUL.selectAll(".taxo").data(data);

    var taxoli = taxos.enter().append("li")
        .attr("id", function (d) {
            return d.id
        })
        .attr("class", "ppt-taxo-li")
        .attr("value", function (d) {
            return d.label;
        });

    taxoli.append("span")
        .attr("class", function (d) {
            return "ppt-icon " + provider.taxonomy.getCSSClass(d.label, "span-icon");
        })
        .html("&nbsp;");

    taxoli.append("span")
        .attr("class", "ppt-label")
        .text(function (d) {
            return provider.taxonomy.getTextValue(d.label);
        });

    taxoli.append("span")
        .attr("class", "ppt-count");

    // Add an on click event on the taxonomy to clear the graph and set this label as root
    taxoli.on("click", taxonomy.onClick);

    taxonomy.addTaxonomyChildren(taxoli);

    // The count is updated for each labels.
    var flattenData = [];
    data.forEach(function (d) {
        flattenData.push(d);
        if (d.children) {
            taxonomy.flattenChildren(d, flattenData);
        }
    });

    if (!graph.DISABLE_COUNT) {
        taxonomy.updateCount(flattenData);
    }
};

/**
 * Recursive function to flatten data content.
 *
 */
taxonomy.flattenChildren = function (d, vals) {
    d.children.forEach(function (c) {
        vals.push(c);
        if (c.children) {
            vals.concat(taxonomy.flattenChildren(c, vals));
        }
    });
};

/**
 * Updates the count number on a taxonomy.
 *
 * @param taxonomyData
 */
taxonomy.updateCount = function (taxonomyData) {
    var statements = [];

    taxonomyData.forEach(function (taxo) {
        statements.push(
            {
                "statement": query.generateTaxonomyCountQuery(taxo.label)
            }
        );
    });

    (function (taxonomies) {
        logger.info("Count taxonomies ==>");
        rest.post(
            {
                "statements": statements
            })
            .done(function (response) {
                logger.info("<== Count taxonomies");
                var parsedData = rest.response.parse(response);
                for (var i = 0; i < taxonomies.length; i++) {
                    var count = parsedData[i][0].count;
                    d3.select("#" + taxonomies[i].id)
                        .select(".ppt-count")
                        .text(" (" + count + ")");
                }
            })
            .fail(function (xhr, textStatus, errorThrown) {
                logger.error(textStatus + ": error while accessing Neo4j server on URL:\"" + rest.CYPHER_URL + "\" defined in \"rest.CYPHER_URL\" property: " + errorThrown);
                d3.select("#popoto-taxonomy")
                    .selectAll(".ppt-count")
                    .text(" (0)");
            });
    })(taxonomyData);
};

/**
 * Recursively generate the taxonomy children elements.
 *
 * @param selection
 */
taxonomy.addTaxonomyChildren = function (selection) {
    selection.each(function (d) {
        var li = d3.select(this);

        var children = d.children;
        if (d.children) {
            var childLi = li.append("ul")
                .attr("class", "ppt-taxo-sub-ul")
                .selectAll("li")
                .data(children)
                .enter()
                .append("li")
                .attr("id", function (d) {
                    return d.id
                })
                .attr("class", "ppt-taxo-sub-li")
                .attr("value", function (d) {
                    return d.label;
                });

            childLi.append("span")
                .attr("class", function (d) {
                    return "ppt-icon " + provider.taxonomy.getCSSClass(d.label, "span-icon");
                })
                .html("&nbsp;");

            childLi.append("span")
                .attr("class", "ppt-label")
                .text(function (d) {
                    return provider.taxonomy.getTextValue(d.label);
                });

            childLi.append("span")
                .attr("class", "ppt-count");

            childLi.on("click", taxonomy.onClick);

            taxonomy.addTaxonomyChildren(childLi);
        }

    });
};

taxonomy.onClick = function () {
    d3.event.stopPropagation();

    var label = this.attributes.value.value;

    dataModel.nodes.length = 0;
    dataModel.links.length = 0;

    // Reinitialize internal label generator
    graph.node.internalLabels = {};

    update();
    graph.mainLabel = label;
    if (provider.node.getSchema(label) !== undefined) {
        graph.addSchema(provider.node.getSchema(label));
    } else {
        graph.addRootNode(label);
    }
    graph.hasGraphChanged = true;
    result.hasChanged = true;
    graph.ignoreCount = false;
    update();
    tools.center();
};

/**
 * Parse the list of label providers and return a list of data object containing only searchable labels.
 * @returns {Array}
 */
taxonomy.generateTaxonomiesData = function () {
    var id = 0;
    var data = [];
    // Retrieve root providers (searchable and without parent)
    for (var label in provider.node.Provider) {
        if (provider.node.Provider.hasOwnProperty(label)) {
            if (provider.node.getProperty(label, "isSearchable") && !provider.node.Provider[label].parent) {
                data.push({
                    "label": label,
                    "id": "popoto-lbl-" + id++
                });
            }
        }
    }

    // Add children data for each provider with children.
    data.forEach(function (d) {
        if (provider.node.getProvider(d.label).hasOwnProperty("children")) {
            id = taxonomy.addChildrenData(d, id);
        }
    });

    return data;
};

/**
 * Add children providers data.
 * @param parentData
 * @param id
 */
taxonomy.addChildrenData = function (parentData, id) {
    parentData.children = [];

    provider.node.getProvider(parentData.label).children.forEach(function (d) {
        var childProvider = provider.node.getProvider(d);
        var childData = {
            "label": d,
            "id": "popoto-lbl-" + id++
        };
        if (childProvider.hasOwnProperty("children")) {
            id = taxonomy.addChildrenData(childData, id);
        }
        if (provider.node.getProperty(d, "isSearchable")) {
            parentData.children.push(childData);
        }
    });

    return id;
};

// TOOLS -----------------------------------------------------------------------------------------------------------

var tools = {};
// TODO introduce plugin mechanism to add tools
tools.CENTER_GRAPH = true;
tools.RESET_GRAPH = true;
tools.SAVE_GRAPH = false;
tools.TOGGLE_TAXONOMY = false;
tools.TOGGLE_FULL_SCREEN = true;
tools.TOGGLE_VIEW_RELATION = true;
tools.TOGGLE_FIT_TEXT = true;

/**
 * Reset the graph to display the root node only.
 */
tools.reset = function () {
    dataModel.nodes.length = 0;
    dataModel.links.length = 0;

    // Reinitialize internal label generator
    graph.node.internalLabels = {};

    if (typeof graph.mainLabel === 'string' || graph.mainLabel instanceof String) {
        if (provider.node.getSchema(graph.mainLabel) !== undefined) {
            graph.addSchema(provider.node.getSchema(graph.mainLabel));
        } else {
            graph.addRootNode(graph.mainLabel);
        }
    } else {
        graph.loadSchema(graph.mainLabel);
    }

    graph.hasGraphChanged = true;
    result.hasChanged = true;
    update();
    tools.center();
};

/**
 * Reset zoom and center the view on svg center.
 */
tools.center = function () {
    graph.svgTag.transition().call(graph.zoom.transform, d3.zoomIdentity);
};

/**
 * Show, hide taxonomy panel.
 */
tools.toggleTaxonomy = function () {
    var taxo = d3.select("#" + taxonomy.containerId);
    if (taxo.filter(".disabled").empty()) {
        taxo.classed("disabled", true);
    } else {
        taxo.classed("disabled", false);
    }

    graph.centerRootNode();
};

/**
 * Enable, disable text fitting on nodes.
 */
tools.toggleFitText = function () {
    graph.USE_FIT_TEXT = !graph.USE_FIT_TEXT;
    graph.node.updateNodes();
};

/**
 * Show, hide relation donuts.
 */
tools.toggleViewRelation = function () {
    graph.DISABLE_RELATION = !graph.DISABLE_RELATION;
    d3.selectAll(".ppt-g-node-background").classed("hide", graph.DISABLE_RELATION);
    graph.tick();
};

tools.toggleFullScreen = function () {

    var elem = document.getElementById(graph.containerId);

    if (!document.fullscreenElement &&    // alternative standard method
        !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {  // current working methods
        if (elem.requestFullscreen) {
            elem.requestFullscreen();
        } else if (elem.msRequestFullscreen) {
            elem.msRequestFullscreen();
        } else if (elem.mozRequestFullScreen) {
            elem.mozRequestFullScreen();
        } else if (elem.webkitRequestFullscreen) {
            elem.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
        }
    } else {
        if (document.exitFullscreen) {
            document.exitFullscreen();
        } else if (document.msExitFullscreen) {
            document.msExitFullscreen();
        } else if (document.mozCancelFullScreen) {
            document.mozCancelFullScreen();
        } else if (document.webkitExitFullscreen) {
            document.webkitExitFullscreen();
        }
    }
};

var toolbar = {};

toolbar.TOOL_TAXONOMY = "Show/hide taxonomy panel";
toolbar.TOOL_RELATION = "Show/hide relation";
toolbar.TOOL_CENTER = "Center view";
toolbar.TOOL_FULL_SCREEN = "Full screen";
toolbar.TOOL_RESET = "Reset graph";
toolbar.TOOL_SAVE = "Save graph";
toolbar.TOOL_FIT_TEXT = "Fit text in nodes";

toolbar.render = function (container) {
    var toolbar = container
        .append("div")
        .attr("class", "ppt-toolbar");

    if (tools.TOGGLE_VIEW_RELATION) {
        toolbar.append("span")
            .attr("id", "popoto-toggle-relation")
            .attr("class", "ppt-icon ppt-menu relation")
            .attr("title", toolbar.TOOL_RELATION)
            .on("click", function () {
                tools.toggleViewRelation();
            });
    }

    if (tools.RESET_GRAPH) {
        toolbar.append("span")
            .attr("id", "popoto-reset-menu")
            .attr("class", "ppt-icon ppt-menu reset")
            .attr("title", toolbar.TOOL_RESET)
            .on("click", function () {
                graph.notifyListeners(graph.Events.GRAPH_RESET, []);
                tools.reset();
            });
    }

    if (tools.TOGGLE_TAXONOMY) {
        toolbar.append("span")
            .attr("id", "popoto-taxonomy-menu")
            .attr("class", "ppt-icon ppt-menu taxonomy")
            .attr("title", toolbar.TOOL_TAXONOMY)
            .on("click", tools.toggleTaxonomy);
    }

    if (tools.CENTER_GRAPH) {
        toolbar.append("span")
            .attr("id", "popoto-center-menu")
            .attr("class", "ppt-icon ppt-menu center")
            .attr("title", toolbar.TOOL_CENTER)
            .on("click", tools.center);
    }

    if (tools.TOGGLE_FULL_SCREEN) {
        toolbar.append("span")
            .attr("id", "popoto-fullscreen-menu")
            .attr("class", "ppt-icon ppt-menu fullscreen")
            .attr("title", toolbar.TOOL_FULL_SCREEN)
            .on("click", tools.toggleFullScreen);
    }

    if (tools.SAVE_GRAPH) {
        toolbar.append("span")
            .attr("id", "popoto-save-menu")
            .attr("class", "ppt-icon ppt-menu save")
            .attr("title", toolbar.TOOL_SAVE)
            .on("click", function () {
                graph.notifyListeners(graph.Events.GRAPH_SAVE, [graph.getSchema()]);
            });
    }

    if (tools.TOGGLE_FIT_TEXT) {
        toolbar.append("span")
            .attr("id", "popoto-fit-text-menu")
            .attr("class", "ppt-icon ppt-menu fit-text")
            .attr("title", toolbar.TOOL_FIT_TEXT)
            .on("click", tools.toggleFitText);
    }
};

var link = {};

/**
 * Defines the different type of link.
 * RELATION is a relation link between two nodes.
 * VALUE is a link between a generic node and a value.
 */
link.LinkTypes = Object.freeze({RELATION: 0, VALUE: 1, SEGMENT: 2});

/**
 * Offset added to text displayed on links.
 * @type {number}
 */
link.TEXT_DY = -4;

/**
 * Define whether or not to display path markers.
 */
link.SHOW_MARKER = false;

// ID of the g element in SVG graph containing all the link elements.
link.gID = "popoto-glinks";

/**
 * Function to call to update the links after modification in the model.
 * This function will update the graph with all removed, modified or added links using d3.js mechanisms.
 */
link.updateLinks = function () {
    var data = link.updateData();
    link.removeElements(data.exit());
    link.addNewElements(data.enter());
    link.updateElements();
};

/**
 * Update the links element with data coming from dataModel.links.
 */
link.updateData = function () {
    return graph.svg.select("#" + link.gID).selectAll(".ppt-glink").data(dataModel.links, function (d) {
        return d.id;
    });
};

/**
 * Clean links elements removed from the list.
 */
link.removeElements = function (exitingData) {
    exitingData.remove();
};

/**
 * Create new elements.
 */
link.addNewElements = function (enteringData) {

    var newLinkElements = enteringData.append("g")
        .attr("class", "ppt-glink")
        .on("click", link.clickLink)
        .on("mouseover", link.mouseOverLink)
        .on("mouseout", link.mouseOutLink);

    newLinkElements.append("path")
        .attr("class", "ppt-link");

    newLinkElements.append("text")
        .attr("text-anchor", "middle")
        .attr("dy", link.TEXT_DY)
        .append("textPath")
        .attr("class", "ppt-textPath")
        .attr("startOffset", "50%");
};

/**
 * Update all the elements (new + modified)
 */
link.updateElements = function () {
    var toUpdateElem = graph.svg.select("#" + link.gID).selectAll(".ppt-glink");

    toUpdateElem
        .attr("id", function (d) {
            return "ppt-glink_" + d.id;
        });

    toUpdateElem.selectAll(".ppt-link")
        .attr("id", function (d) {
            return "ppt-path_" + d.id
        })
        .attr("stroke", function (d) {
            return provider.link.getColor(d, "path", "stroke");
        })
        .attr("class", function (link) {
            return "ppt-link " + provider.link.getCSSClass(link, "path")
        });

    // Due to a bug on webkit browsers (as of 30/01/2014) textPath cannot be selected
    // To workaround this issue the selection is done with its associated css class
    toUpdateElem.selectAll("text")
        .attr("id", function (d) {
            return "ppt-text_" + d.id
        })
        .attr("class", function (link) {
            return provider.link.getCSSClass(link, "text")
        })
        .attr("fill", function (d) {
            return provider.link.getColor(d, "text", "fill");
        })
        .selectAll(".ppt-textPath")
        .attr("id", function (d) {
            return "ppt-textpath_" + d.id;
        })
        .attr("class", function (link) {
            return "ppt-textpath " + provider.link.getCSSClass(link, "text-path")
        })
        .attr("xlink:href", function (d) {
            return "#ppt-path_" + d.id;
        })
        .text(function (d) {
            return provider.link.getTextValue(d);
        });
};

/**
 * Function called when mouse is over the link.
 * This function is used to change the CSS class on hover of the link and query viewer element.
 *
 * TODO try to introduce event instead of directly access query spans here. This could be used in future extensions.
 */
link.mouseOverLink = function () {
    d3.select(this)
        .select("path")
        .attr("class", function (link) {
            return "ppt-link " + provider.link.getCSSClass(link, "path--hover")
        });

    d3.select(this).select("text")
        .attr("class", function (link) {
            return provider.link.getCSSClass(link, "text--hover")
        });

    var hoveredLink = d3.select(this).data()[0];

    if (queryviewer.isActive) {
        queryviewer.queryConstraintSpanElements.filter(function (d) {
            return d.ref === hoveredLink;
        }).classed("hover", true);
        queryviewer.querySpanElements.filter(function (d) {
            return d.ref === hoveredLink;
        }).classed("hover", true);
    }

    if (cypherviewer.isActive) {
        cypherviewer.querySpanElements.filter(function (d) {
            return d.link === hoveredLink;
        }).classed("hover", true);
    }
};

/**
 * Function called when mouse goes out of the link.
 * This function is used to reinitialize the CSS class of the link and query viewer element.
 */
link.mouseOutLink = function () {
    d3.select(this)
        .select("path")
        .attr("class", function (link) {
            return "ppt-link " + provider.link.getCSSClass(link, "path")
        });

    d3.select(this).select("text")
        .attr("class", function (link) {
            return provider.link.getCSSClass(link, "text")
        });

    var hoveredLink = d3.select(this).data()[0];

    if (queryviewer.isActive) {
        queryviewer.queryConstraintSpanElements.filter(function (d) {
            return d.ref === hoveredLink;
        }).classed("hover", false);
        queryviewer.querySpanElements.filter(function (d) {
            return d.ref === hoveredLink;
        }).classed("hover", false);
    }

    if (cypherviewer.isActive) {
        cypherviewer.querySpanElements.filter(function (d) {
            return d.link === hoveredLink;
        }).classed("hover", false);
    }
};

// Delete all related nodes from this link
link.clickLink = function () {
    var clickedLink = d3.select(this).data()[0];

    if (clickedLink.type !== link.LinkTypes.VALUE) {
        // Collapse all expanded choose nodes first to avoid having invalid displayed value node if collapsed relation contains a value.
        graph.node.collapseAllNode();

        var willChangeResults = graph.node.removeNode(clickedLink.target);

        graph.hasGraphChanged = true;
        result.hasChanged = willChangeResults;
        update();
    }

};

/**
 * Convert the parameter to a function returning the parameter if it is not already a function.
 *
 * @param param
 * @return {*}
 */

function toFunction(param) {
    if (typeof param === "function") {
        return param;
    } else {
        return function () {
            return param;
        };
    }
}

var CONTEXT_2D = document.createElement("canvas").getContext("2d");
var DEFAULT_CANVAS_LINE_HEIGHT = 12;

function measureTextWidth(text) {
    return CONTEXT_2D.measureText(text).width;
}

/**
 * Compute the radius of the circle wrapping all the lines.
 *
 * @param lines array of text lines
 * @return {number}
 */
function computeTextRadius(lines) {
    var textRadius = 0;

    for (var i = 0, n = lines.length; i < n; ++i) {
        var dx = lines[i].width / 2;
        var dy = (Math.abs(i - n / 2 + 0.5) + 0.5) * DEFAULT_CANVAS_LINE_HEIGHT;
        textRadius = Math.max(textRadius, Math.sqrt(dx * dx + dy * dy));
    }

    return textRadius;
}

function computeLines(words, targetWidth) {
    var line;
    var lineWidth0 = Infinity;
    var lines = [];

    for (var i = 0, n = words.length; i < n; ++i) {
        var lineText1 = (line ? line.text + " " : "") + words[i];
        var lineWidth1 = measureTextWidth(lineText1);
        if ((lineWidth0 + lineWidth1) / 2 < targetWidth) {
            line.width = lineWidth0 = lineWidth1;
            line.text = lineText1;
        } else {
            lineWidth0 = measureTextWidth(words[i]);
            line = {width: lineWidth0, text: words[i]};
            lines.push(line);
        }
    }

    return lines;
}

function computeTargetWidth(text) {
    return Math.sqrt(measureTextWidth(text.trim()) * DEFAULT_CANVAS_LINE_HEIGHT);
}

/**
 * Split text into words.
 *
 * @param text
 * @return {*|string[]}
 */
function computeWords(text) {
    var words = text.split(/\s+/g); // To hyphenate: /\s+|(?<=-)/
    if (!words[words.length - 1]) words.pop();
    if (!words[0]) words.shift();
    return words;
}

/**
 * Inspired by https://beta.observablehq.com/@mbostock/fit-text-to-circle
 * Extract words from the text and group them by lines to fit a circle.
 *
 * @param text
 * @returns {*}
 */
function extractLines(text) {
    if (text === undefined || text === null) {
        return [];
    }

    var textString = String(text);

    var words = computeWords(textString);
    var targetWidth = computeTargetWidth(textString);

    return computeLines(words, targetWidth);
}

function createTextElements(selection, getClass) {
    selection.each(function (d) {
        var text = d3.select(this)
            .selectAll(".fitted-text")
            .data([{}]);

        text.enter()
            .append("text")
            .merge(text)
            .attr("class", "fitted-text" + (getClass !== undefined ? " " + getClass(d) : ""))
            .attr("style", "text-anchor: middle; font: 10px sans-serif");
    });
}

function createSpanElements(text, getText) {
    text.each(function (fitData) {
        var lines = extractLines(getText(fitData));
        var span = d3.select(this).selectAll("tspan")
            .data(lines);

        span.exit().remove();

        span.enter()
            .append("tspan")
            .merge(span)
            .attr("x", 0)
            .attr("y", function (d, i) {
                var lineCount = lines.length;
                return (i - lineCount / 2 + 0.8) * DEFAULT_CANVAS_LINE_HEIGHT
            })
            .text(function (d) {
                return d.text
            });
    });
}

/**
 * Create the text representation of a node by slicing the text into lines to fit the node.
 *
 * @param selection
 * @param textParam
 * @param radiusParam
 * @param classParam
 */
function appendFittedText(selection, textParam, radiusParam, classParam) {
    var getRadius = toFunction(radiusParam);
    var getText = toFunction(textParam);
    var getClass = classParam ? toFunction(classParam) : classParam;

    createTextElements(selection, getClass);

    var text = selection.select(".fitted-text");

    createSpanElements(text, getText);

    text.attr("transform", function (d) {
        var lines = extractLines(getText(d));
        var textRadius = computeTextRadius(lines);

        var scale = 1;
        if (textRadius !== 0 && textRadius) {
            scale = getRadius(d) / textRadius;
        }
        return "translate(" + 0 + "," + 0 + ")" + " scale(" + scale + ")"
    });
}

var fitTextRenderer = {};

fitTextRenderer.getNodeBoundingBox = function(node) {
    return node.getBBox();
};

/**
 * Create the text representation of a node by slicing the text into lines to fit the node.
 *
 * TODO: Clean getLines return and corresponding data.
 * @param nodeSelection
 */
fitTextRenderer.render = function (nodeSelection) {

    var backgroundRectSelection = nodeSelection
        .append("rect")
        .attr("fill", function (node) {
            return provider.node.getColor(node, "back-text", "fill");
        })
        .attr("class", function (node) {
            return provider.node.getCSSClass(node, "back-text")
        });

    appendFittedText(nodeSelection,
        function (d) { return provider.node.getTextValue(d)},
        function (d) { return provider.node.getSize(d) },
        function (d) { return provider.node.getCSSClass(d, "text") });

    backgroundRectSelection
        .attr("x", function (d) {
            var bbox = fitTextRenderer.getNodeBoundingBox(d3.select(this.parentNode).select("text").node());
            return bbox.x - 3;
        })
        .attr("y", function (d) {
            var bbox = fitTextRenderer.getNodeBoundingBox(d3.select(this.parentNode).select("text").node());
            return bbox.y;
        })
        .attr("rx", "5")
        .attr("ry", "5")
        .attr("width", function (d) {
            var bbox = fitTextRenderer.getNodeBoundingBox(d3.select(this.parentNode).select("text").node());
            return bbox.width + 6;
        })
        .attr("height", function (d) {
            var bbox = fitTextRenderer.getNodeBoundingBox(d3.select(this.parentNode).select("text").node());
            return bbox.height;
        })
        .attr("transform", function (d) {
            return d3.select(this.parentNode).select("text").attr("transform")
        });
};

var textRenderer = {};
textRenderer.TEXT_Y = 8; // TODO move this in dedicated config

textRenderer.getNodeBoundingBox = function(node) {
    return node.getBBox();
};

/**
 * Create the text representation of a node with a SVG rect element as background.
 *
 * TODO: clean mouseover text because this renderer change parent clip-path attribute
 * @param nodeSelection
 */
textRenderer.render = function (nodeSelection) {

    var backgroundRectSelection = nodeSelection
        .append("rect")
        .attr("fill", function (node) {
            return provider.node.getColor(node, "back-text", "fill");
        })
        .attr("class", function (node) {
            return provider.node.getCSSClass(node, "back-text")
        });

    nodeSelection.append('text')
        .attr('x', 0)
        .attr('y', textRenderer.TEXT_Y)
        .attr('text-anchor', 'middle')
        .attr("class", function (node) {
            return provider.node.getCSSClass(node, "text")
        })
        .on("mouseover", function (d) {
            d3.select(this.parentNode).attr("clip-path", null);
        })
        .on("mouseout", function (d) {
            d3.select(this.parentNode)
                .attr("clip-path", function (node) {
                    return "url(#node-view" + node.id + ")";
                });
        })
        .text(function (d) {
            return provider.node.getTextValue(d);
        });

    backgroundRectSelection
        .attr("x", function (d) {
            var bbox = textRenderer.getNodeBoundingBox(d3.select(this.parentNode).select("text").node());
            return bbox.x - 3;
        })
        .attr("y", function (d) {
            var bbox = textRenderer.getNodeBoundingBox(d3.select(this.parentNode).select("text").node());
            return bbox.y;
        })
        .attr("rx", "5")
        .attr("ry", "5")
        .attr("width", function (d) {
            var bbox = textRenderer.getNodeBoundingBox(d3.select(this.parentNode).select("text").node());
            return bbox.width + 6;
        })
        .attr("height", function (d) {
            var bbox = textRenderer.getNodeBoundingBox(d3.select(this.parentNode).select("text").node());
            return bbox.height;
        });
};

var node = {};

// ID of the g element in SVG graph containing all the link elements.
node.gID = "popoto-gnodes";

// Node ellipse size used by default for text nodes.
node.DONUTS_MARGIN = 0;
node.DONUT_WIDTH = 20;

// Define the max number of character displayed in node.
node.NODE_MAX_CHARS = 11;
node.NODE_TITLE_MAX_CHARS = 100;

// Number of nodes displayed per page during value selection.
node.PAGE_SIZE = 10;

// Count box default size
node.CountBox = {x: 16, y: 33, w: 52, h: 19};

// Store choose node state to avoid multiple node expand at the same time
node.chooseWaiting = false;

node.getDonutInnerRadius = function (n) {
    return provider.node.getSize(n) + node.DONUTS_MARGIN;
};

node.getDonutOuterRadius = function (n) {
    return provider.node.getSize(n) + node.DONUTS_MARGIN + node.DONUT_WIDTH;
};

node.pie = d3.pie()
    .sort(null)
    .value(function (d) {
        return 1;
    });

/**
 * Defines the list of possible nodes.
 * ROOT: Node used as graph root. It is the target of the query. Only one node of this type should be available in graph.
 * CHOOSE: Nodes defining a generic node label. From these node is is possible to select a value or explore relations.
 * VALUE: Unique node containing a value constraint. Usually replace CHOOSE nodes once a value as been selected.
 * GROUP: Empty node used to group relations. No value can be selected but relations can be explored. These nodes doesn't have count.
 */
node.NodeTypes = Object.freeze({ROOT: 0, CHOOSE: 1, VALUE: 2, GROUP: 3});

// Used to generate unique internal labels used for example as identifier in Cypher query.
node.internalLabels = {};

/**
 * Create a normalized identifier from a node label.
 * Multiple calls with the same node label will generate different unique identifier.
 *
 * @param nodeLabel
 * @returns {string}
 */
node.generateInternalLabel = function (nodeLabel) {
    var label = nodeLabel ? nodeLabel.toLowerCase().replace(/ /g, '') : "n";

    if (label in node.internalLabels) {
        node.internalLabels[label] = node.internalLabels[label] + 1;
    } else {
        node.internalLabels[label] = 0;
        return label;
    }

    return label + node.internalLabels[label];
};

/**
 * Update Nodes SVG elements using D3.js update mechanisms.
 */
node.updateNodes = function () {
    var data = node.updateData();
    node.removeElements(data.exit());
    node.addNewElements(data.enter());
    node.updateElements();
};

/**
 * Update node data with changes done in dataModel.nodes model.
 */
node.updateData = function () {
    var data = graph.svg.select("#" + node.gID).selectAll(".ppt-gnode").data(dataModel.nodes, function (d) {
        return d.id;
    });

    if (graph.hasGraphChanged) {
        node.updateAutoLoadValues();

        if (!graph.DISABLE_COUNT && !graph.ignoreCount) {
            node.updateCount();
        }
    }
    graph.hasGraphChanged = false;

    return data;
};

/**
 * Update nodes and result counts by executing a query for every nodes with the new graph structure.
 */
node.updateCount = function () {

    // Abort any old running request before starting a new one
    if (node.updateCountXhr !== undefined) {
        node.updateCountXhr.abort();
    }

    var statements = [];

    var countedNodes = dataModel.nodes
        .filter(function (d) {
            return d.type !== node.NodeTypes.VALUE && d.type !== node.NodeTypes.GROUP && (!d.hasOwnProperty("isNegative") || !d.isNegative);
        });

    countedNodes.forEach(function (n) {
        var nodeCountQuery = query.generateNodeCountQuery(n);
        statements.push(
            {
                "statement": nodeCountQuery.statement,
                "parameters": nodeCountQuery.parameters
            }
        );
    });

    logger.info("Count nodes ==>");
    node.updateCountXhr = rest.post(
        {
            "statements": statements
        })
        .done(function (response) {
            logger.info("<== Count nodes");
            var parsedData = rest.response.parse(response);

            // TODO throw exception in parser in case of failure?
            // if (parsedData.status === "success") {
            //     logger.error("Cypher query error:" + JSON.stringify(parsedData.errors));
            //     countedNodes.forEach(function (node) {
            //         node.count = 0;
            //     });
            // }

            for (var i = 0; i < countedNodes.length; i++) {
                countedNodes[i].count = parsedData[i][0].count;
            }

            // Update result count with root node new count
            if (result.resultCountListeners.length > 0) {
                result.updateResultsCount();
            }

            node.updateElements();
            graph.link.updateElements();
        })
        .fail(function (xhr, textStatus, errorThrown) {
            if (textStatus !== "abort") {
                logger.error(textStatus + ": error while accessing Neo4j server on URL:\"" + rest.CYPHER_URL + "\" defined in \"rest.CYPHER_URL\" property: " + errorThrown);
                countedNodes.forEach(function (n) {
                    n.count = 0;
                });
                node.updateElements();
                graph.link.updateElements();
            } else {
                logger.info("<=X= Count nodes - Aborted!");
            }
        });
};

/**
 * Update values for nodes having preloadData property
 */
node.updateAutoLoadValues = function () {
    var statements = [];

    var nodesToLoadData = node.getAutoLoadValueNodes();

    for (var i = 0; i < nodesToLoadData.length; i++) {
        var nodeToQuery = nodesToLoadData[i];
        var nodeValueQuery = query.generateNodeValueQuery(nodeToQuery);
        statements.push(
            {
                "statement": nodeValueQuery.statement,
                "parameters": nodeValueQuery.parameters
            }
        );
    }

    if (statements.length > 0) {
        logger.info("AutoLoadValue ==>");
        rest.post(
            {
                "statements": statements
            })
            .done(function (response) {
                logger.info("<== AutoLoadValue");

                var parsedData = rest.response.parse(response);

                for (var i = 0; i < nodesToLoadData.length; i++) {
                    var nodeToQuery = nodesToLoadData[i];
                    var constraintAttr = provider.node.getConstraintAttribute(nodeToQuery.label);
                    // Here results are parsed and values already selected are filtered out
                    nodeToQuery.data = parsedData[i].filter(function (dataToFilter) {
                        var keepData = true;
                        if (nodeToQuery.hasOwnProperty("value") && nodeToQuery.value.length > 0) {
                            nodeToQuery.value.forEach(function (value) {
                                if (value.attributes[constraintAttr] === dataToFilter[constraintAttr]) {
                                    keepData = false;
                                }
                            });
                        }
                        return keepData;
                    });

                    nodeToQuery.page = 1;
                }

                graph.notifyListeners(graph.Events.GRAPH_NODE_DATA_LOADED, [nodesToLoadData]);
            })
            .fail(function (xhr, textStatus, errorThrown) {
                logger.error(textStatus + ": error while accessing Neo4j server on URL:\"" + rest.CYPHER_URL + "\" defined in \"rest.CYPHER_URL\" property: " + errorThrown);
            });
    }
};

/**
 * Remove old elements.
 * Should be called after updateData.
 */
node.removeElements = function (exitingData) {
    // Nodes without parent are simply removed.
    exitingData.filter(function (d) {
        return !d.parent;
    }).remove();

    // Nodes with a parent are removed with an animation (nodes are collapsed to their parents before being removed)
    exitingData.filter(function (d) {
        return d.parent;
    }).transition().duration(300).attr("transform", function (d) {
        return "translate(" + d.parent.x + "," + d.parent.y + ")";
    }).remove();
};

/**
 * Add all new elements.
 * Only the skeleton of new nodes are added custom data will be added during the element update phase.
 * Should be called after updateData and before updateElements.
 */
node.addNewElements = function (enteringData) {

    var gNewNodeElements = enteringData
        .append("g")
        .attr("class", "ppt-gnode");

    gNewNodeElements.on("click", node.nodeClick)
        .on("mouseover", node.mouseOverNode)
        // .on("mousemove", nUdeXXX.mouseMoveNode)
        .on("mouseout", node.mouseOutNode);

    // Add right click on all nodes except value
    gNewNodeElements.filter(function (d) {
        return d.type !== node.NodeTypes.VALUE;
    }).on("contextmenu", node.clearSelection);

    // Disable right click context menu on value nodes
    gNewNodeElements.filter(function (d) {
        return d.type === node.NodeTypes.VALUE;
    }).on("contextmenu", function () {
        // Disable context menu on
        d3.event.preventDefault();
    });

    var nodeDefs = gNewNodeElements.append("defs");

    // Circle clipPath using node radius size
    nodeDefs.append("clipPath")
        .attr("id", function (n) {
            return "node-view" + n.id;
        })
        .append("circle")
        .attr("cx", 0)
        .attr("cy", 0);

    // Nodes are composed of 3 layouts and skeleton are created here.
    node.addBackgroundElements(gNewNodeElements);
    node.addMiddlegroundElements(gNewNodeElements);
    node.addForegroundElements(gNewNodeElements);
};

/**
 * Create the background for a new node element.
 * The background of a node is defined by a circle not visible by default (fill-opacity set to 0) but can be used to highlight a node with animation on this attribute.
 * This circle also define the node zone that can receive events like mouse clicks.
 *
 * @param gNewNodeElements
 */
node.addBackgroundElements = function (gNewNodeElements) {
    var background = gNewNodeElements
        .append("g")
        .attr("class", "ppt-g-node-background")
        .classed("hide", graph.DISABLE_RELATION);

    background.append("g")
        .attr("class", "ppt-donut-labels");
    background.append("g")
        .attr("class", "ppt-donut-segments");
};

/**
 * Create the node main elements.
 *
 * @param gNewNodeElements
 */
node.addMiddlegroundElements = function (gNewNodeElements) {
    var middle = gNewNodeElements
        .append("g")
        .attr("class", "ppt-g-node-middleground");
};

/**
 * Create the node foreground elements.
 * It contains node additional elements, count or tools like navigation arrows.
 *
 * @param gNewNodeElements
 */
node.addForegroundElements = function (gNewNodeElements) {
    var foreground = gNewNodeElements
        .append("g")
        .attr("class", "ppt-g-node-foreground");

    // Arrows icons added only for root and choose nodes
    var gArrow = foreground.filter(function (d) {
        return d.type === node.NodeTypes.ROOT || d.type === node.NodeTypes.CHOOSE;
    })
        .append("g")
        .attr("class", "ppt-node-foreground-g-arrows");

    var glArrow = gArrow.append("g");
    //glArrow.append("polygon")
    //.attr("points", "-53,-23 -33,-33 -33,-13");
    glArrow.append("circle")
        .attr("class", "ppt-larrow")
        .attr("cx", "-43")
        .attr("cy", "-23")
        .attr("r", "17");

    glArrow.append("path")
        .attr("class", "ppt-arrow")
        .attr("d", "m -44.905361,-23 6.742,-6.742 c 0.81,-0.809 0.81,-2.135 0,-2.944 l -0.737,-0.737 c -0.81,-0.811 -2.135,-0.811 -2.945,0 l -8.835,8.835 c -0.435,0.434 -0.628,1.017 -0.597,1.589 -0.031,0.571 0.162,1.154 0.597,1.588 l 8.835,8.834 c 0.81,0.811 2.135,0.811 2.945,0 l 0.737,-0.737 c 0.81,-0.808 0.81,-2.134 0,-2.943 l -6.742,-6.743 z");

    glArrow.on("click", function (clickedNode) {
        d3.event.stopPropagation(); // To avoid click event on svg element in background

        // On left arrow click page number is decreased and node expanded to display the new page
        if (clickedNode.page > 1) {
            clickedNode.page--;
            node.collapseNode(clickedNode);
            node.expandNode(clickedNode);
        }
    });

    var grArrow = gArrow.append("g");
    //grArrow.append("polygon")
    //.attr("points", "53,-23 33,-33 33,-13");

    grArrow.append("circle")
        .attr("class", "ppt-rarrow")
        .attr("cx", "43")
        .attr("cy", "-23")
        .attr("r", "17");

    grArrow.append("path")
        .attr("class", "ppt-arrow")
        .attr("d", "m 51.027875,-24.5875 -8.835,-8.835 c -0.811,-0.811 -2.137,-0.811 -2.945,0 l -0.738,0.737 c -0.81,0.81 -0.81,2.136 0,2.944 l 6.742,6.742 -6.742,6.742 c -0.81,0.81 -0.81,2.136 0,2.943 l 0.737,0.737 c 0.81,0.811 2.136,0.811 2.945,0 l 8.835,-8.836 c 0.435,-0.434 0.628,-1.017 0.597,-1.588 0.032,-0.569 -0.161,-1.152 -0.596,-1.586 z");

    grArrow.on("click", function (clickedNode) {
        d3.event.stopPropagation(); // To avoid click event on svg element in background

        if (clickedNode.page * node.PAGE_SIZE < clickedNode.count) {
            clickedNode.page++;
            node.collapseNode(clickedNode);
            node.expandNode(clickedNode);
        }
    });

    // Count box
    if (!graph.DISABLE_COUNT) {
        var countForeground = foreground.filter(function (d) {
            return d.type !== node.NodeTypes.GROUP;
        });

        countForeground
            .append("rect")
            .attr("x", node.CountBox.x)
            .attr("y", node.CountBox.y)
            .attr("width", node.CountBox.w)
            .attr("height", node.CountBox.h)
            .attr("class", "ppt-count-box");

        countForeground
            .append("text")
            .attr("x", 42)
            .attr("y", 48)
            .attr("text-anchor", "middle")
            .attr("class", "ppt-count-text");
    }

    var ban = foreground.filter(function (d) {
        return d.type === node.NodeTypes.CHOOSE;
    }).append("g")
        .attr("class", "ppt-g-node-ban")
        .append("path")
        .attr("d", "M89.1 19.2C88 17.7 86.6 16.2 85.2 14.8 83.8 13.4 82.3 12 80.8 10.9 72 3.9 61.3 0 50 0 36.7 0 24.2 5.4 14.8 14.8 5.4 24.2 0 36.7 0 50c0 11.4 3.9 22.1 10.9 30.8 1.2 1.5 2.5 3 3.9 4.4 1.4 1.4 2.9 2.7 4.4 3.9C27.9 96.1 38.6 100 50 100 63.3 100 75.8 94.6 85.2 85.2 94.6 75.8 100 63.3 100 50 100 38.7 96.1 28 89.1 19.2ZM11.9 50c0-10.2 4-19.7 11.1-27C30.3 15.9 39.8 11.9 50 11.9c8.2 0 16 2.6 22.4 7.3L19.3 72.4C14.5 66 11.9 58.2 11.9 50Zm65 27c-7.2 7.1-16.8 11.1-27 11.1-8.2 0-16-2.6-22.4-7.4L80.8 27.6C85.5 34 88.1 41.8 88.1 50c0 10.2-4 19.7-11.1 27z");
};

/**
 * Updates all elements.
 */
node.updateElements = function () {
    var toUpdateElem = graph.svg.select("#" + node.gID).selectAll(".ppt-gnode");

    toUpdateElem.attr("id", function (d) {
        return "popoto-gnode_" + d.id;
    });

    if (graph.USE_VORONOI_LAYOUT) {
        toUpdateElem.attr("clip-path", function (d) {
            return "url(#voroclip-" + d.id + ")";
        });
    }

    toUpdateElem.select("defs")
        .select("clipPath")
        .attr("id", function (n) {
            return "node-view" + n.id;
        }).selectAll("circle")
        .attr("r", function (n) {
            return provider.node.getSize(n);
        });

    // Display voronoi paths
    // TODO ZZZ re|move
    // nUdeXXX.selectAllData.selectAll(".gra").data(["unique"]).enter().append("g").attr("class", "gra").append("use");
    // nUdeXXX.selectAllData.selectAll("use").attr("xlink:href",function(d){
    //     console.log("#pvoroclip-"+d3.select(this.parentNode.parentNode).datum().id);
    //     return "#pvoroclip-"+d3.select(this.parentNode.parentNode).datum().id;
    // }).attr("fill","none").attr("stroke","red").attr("stroke-width","1px");

    // TODO ZZZ move functions?
    toUpdateElem.filter(function (n) {
        return n.type !== node.NodeTypes.ROOT
    }).call(d3.drag()
        .on("start", dragstarted)
        .on("drag", dragged)
        .on("end", dragended));

    function dragstarted(d) {
        if (!d3.event.active) graph.force.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
    }

    function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
    }

    function dragended(d) {
        if (!d3.event.active) graph.force.alphaTarget(0);
        if (d.fixed === false) {
            d.fx = null;
            d.fy = null;
        }

    }

    node.updateBackgroundElements();
    node.updateMiddlegroundElements();
    node.updateForegroundElements();
};

node.updateBackgroundElements = function () {
    var nodeBackgroundElements = graph.svg.select("#" + node.gID).selectAll(".ppt-gnode").selectAll(".ppt-g-node-background");

    nodeBackgroundElements.select(".ppt-donut-labels").selectAll("*").remove();
    nodeBackgroundElements.select(".ppt-donut-segments").selectAll("*").remove();

    var gSegment = nodeBackgroundElements.select(".ppt-donut-segments").selectAll(".ppt-segment-container")
        .data(function (d) {
            var relationships = [];
            if (d.hasOwnProperty("relationships")) {
                relationships = d.relationships;
            }
            return relationships;
        }, function (d) {
            return d.id;
        })
        .enter()
        .append("g")
        .attr("class", ".ppt-segment-container")
        .on("click", node.segmentClick)
        .on("mouseover", function (d) {
            d3.select(this).select(".ppt-text-arc").classed("hover", true);
        })
        .on("mouseout", function (d) {
            d3.select(this).select(".ppt-text-arc").classed("hover", false);
        });

    gSegment.append("title").attr("class", "ppt-svg-title")
        .text(function (d) {
            return d.label + " " + d.target;
        });

    var gLabel = nodeBackgroundElements.select(".ppt-donut-labels").selectAll(".ppt-segment-container")
        .data(function (n) {
            var relationships = [];
            if (n.hasOwnProperty("relationships")) {
                relationships = n.relationships;
            }
            return relationships;
        }, function (relationship) {
            return relationship.id;
        })
        .enter()
        .append("g")
        .attr("class", ".ppt-segment-container")
        .on("click", node.segmentClick)
        .on("mouseover", function (d) {
            d3.select(this).select(".ppt-text-arc").classed("hover", true);
        })
        .on("mouseout", function (d) {
            d3.select(this).select(".ppt-text-arc").classed("hover", false);
        });

    gLabel.append("path")
        .attr("class", "ppt-hidden-arc")
        .attr("id", function (d, i) {
            var n = d3.select(this.parentNode.parentNode).datum();
            return "arc_" + n.id + "_" + i;
        })
        .attr("d", function (relationship) {
            var n = d3.select(this.parentNode.parentNode).datum();

            //A regular expression that captures all in between the start of a string (denoted by ^)
            //and the first capital letter L
            var firstArcSection = /(^.+?)L/;
            var singleArcSection = /(^.+?)M/;

            var intermediateArc = {
                startAngle: relationship.directionAngle - (Math.PI - 0.1),
                endAngle: relationship.directionAngle + (Math.PI - 0.1)
            };

            var arcPath = d3.arc()
                .innerRadius(node.getDonutInnerRadius(n))
                .outerRadius(node.getDonutOuterRadius(n))(intermediateArc);

            //The [1] gives back the expression between the () (thus not the L as well)
            //which is exactly the arc statement
            var res = firstArcSection.exec(arcPath);
            var newArc = "";
            if (res && res.length > 1) {
                newArc = res[1];
            } else {
                newArc = singleArcSection.exec(arcPath)[1];
            }

            //Replace all the comma's so that IE can handle it -_-
            //The g after the / is a modifier that "find all matches rather than stopping after the first match"
            newArc = newArc.replace(/,/g, " ");

            return newArc;
        })
        .style("fill", "none")
        .style("stroke", "none");

    gSegment.append("text")
        .attr("text-anchor", "middle")
        .attr("class", function (d) {
            var n = d3.select(this.parentNode.parentNode).datum();
            if (n.hasOwnProperty("count") && n.count === 0) {
                return "ppt-text-arc disabled";
            } else {
                return "ppt-text-arc";
            }
        })
        .attr("fill", function (d) {
            var n = d3.select(this.parentNode.parentNode).datum();

            return provider.link.getColor({
                label: d.label,
                type: graph.link.LinkTypes.SEGMENT,
                source: n,
                target: {label: d.target}
            }, "segment", "fill");
        })
        .attr("dy", graph.link.TEXT_DY)
        .append("textPath")
        .attr("startOffset", "50%")
        .attr("xlink:href", function (d, i) {
            var n = d3.select(this.parentNode.parentNode.parentNode).datum();
            return "#arc_" + n.id + "_" + i;
        })
        .text(function (d) {
            var n = d3.select(this.parentNode.parentNode.parentNode).datum();

            return provider.link.getTextValue({
                source: n,
                target: {label: d.target},
                label: d.label,
                type: graph.link.LinkTypes.SEGMENT
            });
        });

    gSegment.append("path")
        .attr("class", function (d) {
            var n = d3.select(this.parentNode.parentNode).datum();
            if (n.hasOwnProperty("count") && n.count === 0) {
                return "ppt-segment disabled";
            } else {
                return "ppt-segment";
            }
        })
        .attr("d", function (d) {
            var n = d3.select(this.parentNode.parentNode).datum();
            return d3.arc()
                .innerRadius(node.getDonutInnerRadius(n))
                .outerRadius(node.getDonutOuterRadius(n))(d)
        })
        .attr("fill", function (d) {
            var n = d3.select(this.parentNode.parentNode).datum();
            return provider.link.getColor({
                label: d.label,
                type: graph.link.LinkTypes.RELATION,
                source: n,
                target: {label: d.target}
            }, "path", "fill");
        })
        .attr("stroke", function (d) {
            var n = d3.select(this.parentNode.parentNode).datum();

            return provider.link.getColor({
                label: d.label,
                type: graph.link.LinkTypes.RELATION,
                source: n,
                target: {label: d.target}
            }, "path", "stroke");
        })
    ;

};

/**
 * Update the middle layer of nodes.
 * TODO refactor node generation to allow future extensions (for example add plugin with new node types...)
 */
node.updateMiddlegroundElements = function () {
    var middleG = graph.svg.select("#" + node.gID).selectAll(".ppt-gnode").selectAll(".ppt-g-node-middleground");

    middleG.attr("clip-path", function (n) {
        return "url(#node-view" + n.id + ")";
    });

    // Clear all content in case node type has changed
    middleG.selectAll("*").remove();


    node.updateMiddlegroundElementsTooltip(middleG);

    node.updateMiddlegroundElementsText(middleG.filter(function (d) {
        return provider.node.getNodeDisplayType(d) === provider.node.DisplayTypes.TEXT;
    }));

    node.updateMiddlegroundElementsImage(middleG.filter(function (d) {
        return provider.node.getNodeDisplayType(d) === provider.node.DisplayTypes.IMAGE;
    }));

    node.updateMiddlegroundElementsSymbol(middleG.filter(function (d) {
        return provider.node.getNodeDisplayType(d) === provider.node.DisplayTypes.SYMBOL;
    }));

    node.updateMiddlegroundElementsSVG(middleG.filter(function (d) {
        return provider.node.getNodeDisplayType(d) === provider.node.DisplayTypes.SVG;
    }));

    node.updateMiddlegroundElementsDisplayedText(middleG.filter(function (d) {
        return provider.node.isTextDisplayed(d);
    }));

};

node.updateMiddlegroundElementsTooltip = function (middleG) {
    // Most browser will generate a tooltip if a title is specified for the SVG element
    // TODO Introduce an SVG tooltip instead?
    middleG.append("title")
        .attr("class", function (n) {
            return provider.node.getCSSClass(n, "title")
        })
        .text(function (d) {
            return provider.node.getTextValue(d, node.NODE_TITLE_MAX_CHARS);
        });

};

node.updateMiddlegroundElementsText = function (gMiddlegroundTextNodes) {
    var circle = gMiddlegroundTextNodes.append("circle").attr("r", function (n) {
        return provider.node.getSize(n);
    });

    // Set class according to node type
    circle
        .attr("class", function (n) {
            return provider.node.getCSSClass(n, "circle")
        })
        .attr("fill", function (n) {
            return provider.node.getColor(n, "circle", "fill");
        })
        .attr("stroke", function (n) {
            return provider.node.getColor(n, "circle", "stroke");
        });
};

node.updateMiddlegroundElementsImage = function (gMiddlegroundImageNodes) {
    gMiddlegroundImageNodes.append("circle").attr("r", function (n) {
        return provider.node.getSize(n);
    })
        .attr("class", function (n) {
            return provider.node.getCSSClass(n, "image-background-circle")
        });

    gMiddlegroundImageNodes.append("image")
        .attr("class", function (n) {
            return provider.node.getCSSClass(n, "image")
        })
        .attr("width", function (d) {
            return provider.node.getImageWidth(d);
        })
        .attr("height", function (d) {
            return provider.node.getImageHeight(d);
        })
        // Center the image on node
        .attr("transform", function (d) {
            return "translate(" + (-provider.node.getImageWidth(d) / 2) + "," + (-provider.node.getImageHeight(d) / 2) + ")";
        })
        .attr("xlink:href", function (d) {
            return provider.node.getImagePath(d);
        });
};

node.updateMiddlegroundElementsSymbol = function (gMiddlegroundSymbolNodes) {
    gMiddlegroundSymbolNodes.append("circle").attr("r", function (n) {
        return provider.node.getSize(n);
    })
        .attr("class", function (n) {
            return provider.node.getCSSClass(n, "symbol-background-circle")
        })
        .attr("fill", function (n) {
            return provider.node.getColor(n, "circle", "fill");
        })
        .attr("stroke", function (n) {
            return provider.node.getColor(n, "circle", "stroke");
        });

    gMiddlegroundSymbolNodes.append("use")
        .attr("class", function (n) {
            return provider.node.getCSSClass(n, "symbol")
        })
        .attr("width", function (d) {
            return provider.node.getImageWidth(d);
        })
        .attr("height", function (d) {
            return provider.node.getImageHeight(d);
        })
        // Center the image on node
        .attr("transform", function (d) {
            return "translate(" + (-provider.node.getImageWidth(d) / 2) + "," + (-provider.node.getImageHeight(d) / 2) + ")";
        })
        .attr("xlink:href", function (d) {
            return provider.node.getImagePath(d);
        })
        .attr("fill", function (n) {
            return provider.node.getColor(n, "circle", "fill");
        })
        .attr("stroke", function (n) {
            return provider.node.getColor(n, "circle", "stroke");
        });
};

node.updateMiddlegroundElementsSVG = function (gMiddlegroundSVGNodes) {
    var SVGmiddleG = gMiddlegroundSVGNodes.append("g");

    var circle = SVGmiddleG.append("circle").attr("r", function (n) {
        return provider.node.getSize(n);
    }).attr("class", "ppt-svg-node-background");

    var svgMiddlePaths = SVGmiddleG.selectAll("path").data(function (d) {
        return provider.node.getSVGPaths(d);
    });

    // Update nested data elements
    svgMiddlePaths.exit().remove();
    svgMiddlePaths.enter().append("path");

    SVGmiddleG
        .selectAll("path")
        .attr("class", function (d) {
            var n = d3.select(this.parentNode).datum();
            return provider.node.getCSSClass(n, "path")
        })
        .each(function (d, i) {
            for (var prop in d) {
                if (d.hasOwnProperty(prop)) {
                    d3.select(this).attr(prop, d[prop]);
                }
            }
        });
};

node.updateMiddlegroundElementsDisplayedText = function (middleG) {
    var textDisplayed = middleG.filter(function (d) {
        return provider.node.isTextDisplayed(d);
    });

    if (graph.USE_FIT_TEXT) {
        fitTextRenderer.render(textDisplayed);
    } else {
        textRenderer.render(textDisplayed);
    }
};

/**
 * Updates the foreground elements
 */
node.updateForegroundElements = function () {

    // Updates browse arrows status
    // TODO ZZZ extract variable?
    var gArrows = graph.svg.select("#" + node.gID).selectAll(".ppt-gnode").selectAll(".ppt-g-node-foreground")
        .selectAll(".ppt-node-foreground-g-arrows");
    gArrows.classed("active", function (d) {
        return d.valueExpanded && d.data && d.data.length > node.PAGE_SIZE;
    });

    gArrows.selectAll(".ppt-larrow").classed("enabled", function (d) {
        return d.page > 1;
    });

    gArrows.selectAll(".ppt-rarrow").classed("enabled", function (d) {
        if (d.data) {
            var count = d.data.length;
            return d.page * node.PAGE_SIZE < count;
        } else {
            return false;
        }
    });

    // Update count box class depending on node type
    var gForegrounds = graph.svg.select("#" + node.gID).selectAll(".ppt-gnode").selectAll(".ppt-g-node-foreground");

    gForegrounds.selectAll(".ppt-count-box").filter(function (d) {
        return d.type !== node.NodeTypes.CHOOSE;
    }).classed("root", true);

    gForegrounds.selectAll(".ppt-count-box").filter(function (d) {
        return d.type === node.NodeTypes.CHOOSE;
    }).classed("value", true);

    gForegrounds.selectAll(".ppt-count-box").classed("disabled", function (d) {
        return d.count === 0;
    });

    if (!graph.DISABLE_COUNT) {
        gForegrounds.selectAll(".ppt-count-text")
            .text(function (d) {
                if (d.count !== null) {
                    return d.count;
                } else {
                    return "...";
                }
            })
            .classed("disabled", function (d) {
                return d.count === 0;
            });
    }

    graph.svg.select("#" + node.gID).selectAll(".ppt-gnode").selectAll(".ppt-g-node-foreground").filter(function (n) {
        return n.isNegative === true;
    }).selectAll(".ppt-g-node-ban")
        .attr("transform", function (d) {
            return "translate(" + (-provider.node.getSize(d)) + "," + (-provider.node.getSize(d)) + ") " +
                "scale(" + ((provider.node.getSize(d) * 2) / 100) + ")"; // 100 is the size of the image drawn with the path
        })
        .attr("stroke-width", function (d) {
            return (2 / ((provider.node.getSize(d) * 2) / 100)) + "px";
        });


    graph.svg.select("#" + node.gID).selectAll(".ppt-gnode").selectAll(".ppt-g-node-foreground").selectAll(".ppt-g-node-ban")
        .classed("active", function (n) {
            return n.isNegative === true;
        });
};

node.segmentClick = function (d) {
    d3.event.preventDefault();

    var n = d3.select(this.parentNode.parentNode).datum();

    graph.ignoreCount = true;

    graph.addRelationshipData(n, d, function (targetNode) {
        graph.notifyListeners(graph.Events.GRAPH_NODE_RELATION_ADD, [
            dataModel.links.filter(function (l) {
                return l.target === targetNode;
            })
        ]);
        graph.ignoreCount = false;
        graph.hasGraphChanged = true;
        update();
    });
};

/**
 * Handle the mouse over event on nodes.
 */
node.mouseOverNode = function () {
    d3.event.preventDefault();

    // TODO don't work on IE (nodes unstable) find another way to move node in foreground on mouse over?
    // d3.select(this).moveToFront();

    // tootip.div.style("display", "inline");

    var hoveredNode = d3.select(this).data()[0];

    if (queryviewer.isActive) {
        // Hover the node in query
        queryviewer.queryConstraintSpanElements.filter(function (d) {
            return d.ref === hoveredNode;
        }).classed("hover", true);
        queryviewer.querySpanElements.filter(function (d) {
            return d.ref === hoveredNode;
        }).classed("hover", true);
    }

    if (cypherviewer.isActive) {
        cypherviewer.querySpanElements.filter(function (d) {
            return d.node === hoveredNode;
        }).classed("hover", true);
    }
};

// nUdeXXX.mouseMoveNode = function () {
//     d3.event.preventDefault();
//
//     var hoveredNode = d3.select(this).data()[0];
//
//     tootip.div
//         .text(provider.node.getTextValue(hoveredNode, nUdeXXX.NODE_TITLE_MAX_CHARS))
//         .style("left", (d3.event.pageX - 34) + "px")
//         .style("top", (d3.event.pageY - 12) + "px");
// };

/**
 * Handle mouse out event on nodes.
 */
node.mouseOutNode = function () {
    d3.event.preventDefault();

    // tootip.div.style("display", "none");

    var hoveredNode = d3.select(this).data()[0];

    if (queryviewer.isActive) {
        // Remove hover class on node.
        queryviewer.queryConstraintSpanElements.filter(function (d) {
            return d.ref === hoveredNode;
        }).classed("hover", false);
        queryviewer.querySpanElements.filter(function (d) {
            return d.ref === hoveredNode;
        }).classed("hover", false);
    }

    if (cypherviewer.isActive) {
        cypherviewer.querySpanElements.filter(function (d) {
            return d.node === hoveredNode;
        }).classed("hover", false);
    }
};

/**
 * Handle the click event on nodes.
 */
node.nodeClick = function () {
    if (!d3.event.defaultPrevented) { // To avoid click on drag end
        var clickedNode = d3.select(this).data()[0]; // Clicked node data
        logger.debug("nodeClick (" + clickedNode.label + ")");

        if (clickedNode.type === node.NodeTypes.VALUE) {
            node.valueNodeClick(clickedNode);
        } else if (clickedNode.type === node.NodeTypes.CHOOSE || clickedNode.type === node.NodeTypes.ROOT) {
            if (d3.event.ctrlKey) {
                if (clickedNode.type === node.NodeTypes.CHOOSE) {
                    clickedNode.isNegative = !clickedNode.hasOwnProperty("isNegative") || !clickedNode.isNegative;

                    node.collapseAllNode();

                    if (clickedNode.hasOwnProperty("value") && clickedNode.value.length > 0) ; else {

                        if (clickedNode.isNegative) {
                            // Remove all related nodes
                            for (var i = dataModel.links.length - 1; i >= 0; i--) {
                                if (dataModel.links[i].source === clickedNode) {
                                    node.removeNode(dataModel.links[i].target);
                                }
                            }

                            clickedNode.count = 0;
                        }
                    }

                    result.hasChanged = true;
                    graph.hasGraphChanged = true;
                    update();
                } // negation not supported on root node
            } else {
                if (clickedNode.valueExpanded) {
                    node.collapseNode(clickedNode);
                } else {
                    node.chooseNodeClick(clickedNode);
                }
            }
        }
    }
};

/**
 * Remove all the value node directly linked to clicked node.
 *
 * @param clickedNode
 */
node.collapseNode = function (clickedNode) {
    if (clickedNode.valueExpanded) { // node is collapsed only if it has been expanded first
        logger.debug("collapseNode (" + clickedNode.label + ")");

        graph.notifyListeners(graph.Events.GRAPH_NODE_VALUE_COLLAPSE, [clickedNode]);

        var linksToRemove = dataModel.links.filter(function (l) {
            return l.source === clickedNode && l.type === graph.link.LinkTypes.VALUE;
        });

        // Remove children nodes from model
        linksToRemove.forEach(function (l) {
            dataModel.nodes.splice(dataModel.nodes.indexOf(l.target), 1);
        });

        // Remove links from model
        for (var i = dataModel.links.length - 1; i >= 0; i--) {
            if (linksToRemove.indexOf(dataModel.links[i]) >= 0) {
                dataModel.links.splice(i, 1);
            }
        }

        // Node has been fixed when expanded so we unfix it back here.
        if (clickedNode.type !== node.NodeTypes.ROOT) {
            clickedNode.fixed = false;
            clickedNode.fx = null;
            clickedNode.fy = null;
        }

        // Parent node too if not root
        if (clickedNode.parent && clickedNode.parent.type !== node.NodeTypes.ROOT) {
            clickedNode.parent.fixed = false;
            clickedNode.parent.fx = null;
            clickedNode.parent.fy = null;
        }

        clickedNode.valueExpanded = false;
        update();

    } else {
        logger.debug("collapseNode called on an unexpanded node");
    }
};

/**
 * Collapse all nodes with value expanded.
 *
 */
node.collapseAllNode = function () {
    dataModel.nodes.forEach(function (n) {
        if ((n.type === node.NodeTypes.CHOOSE || n.type === node.NodeTypes.ROOT) && n.valueExpanded) {
            node.collapseNode(n);
        }
    });
};

/**
 * Function called on a value node click.
 * In this case the value is added in the parent node and all the value nodes are collapsed.
 *
 * @param clickedNode
 */
node.valueNodeClick = function (clickedNode) {
    logger.debug("valueNodeClick (" + clickedNode.label + ")");

    graph.notifyListeners(graph.Events.GRAPH_NODE_ADD_VALUE, [clickedNode]);

    if (clickedNode.parent.value === undefined) {
        clickedNode.parent.value = [];
    }
    clickedNode.parent.value.push(clickedNode);
    result.hasChanged = true;
    graph.hasGraphChanged = true;

    node.collapseNode(clickedNode.parent);
};

/**
 * Function called on choose node click.
 * In this case a query is executed to get all the possible value
 * @param clickedNode
 * TODO optimize with cached data?
 */
node.chooseNodeClick = function (clickedNode) {
    logger.debug("chooseNodeClick (" + clickedNode.label + ") with waiting state set to " + node.chooseWaiting);
    if (!node.chooseWaiting && !clickedNode.immutable && !(clickedNode.count === 0)) {

        // Collapse all expanded nodes first
        node.collapseAllNode();

        // Set waiting state to true to avoid multiple call on slow query execution
        node.chooseWaiting = true;

        // Don't run query to get value if node isAutoLoadValue is set to true
        if (clickedNode.data !== undefined && clickedNode.isAutoLoadValue) {
            clickedNode.page = 1;
            node.expandNode(clickedNode);
            node.chooseWaiting = false;
        } else {
            logger.info("Values (" + clickedNode.label + ") ==>");
            var nodeValueQuery = query.generateNodeValueQuery(clickedNode);
            rest.post(
                {
                    "statements": [
                        {
                            "statement": nodeValueQuery.statement,
                            "parameters": nodeValueQuery.parameters
                        }]
                })
                .done(function (response) {
                    logger.info("<== Values (" + clickedNode.label + ")");
                    var parsedData = rest.response.parse(response);
                    var constraintAttr = provider.node.getConstraintAttribute(clickedNode.label);

                    clickedNode.data = parsedData[0].filter(function (dataToFilter) {
                        var keepData = true;
                        if (clickedNode.hasOwnProperty("value") && clickedNode.value.length > 0) {
                            clickedNode.value.forEach(function (value) {
                                if (value.attributes[constraintAttr] === dataToFilter[constraintAttr]) {
                                    keepData = false;
                                }
                            });
                        }
                        return keepData;
                    });

                    clickedNode.page = 1;
                    node.expandNode(clickedNode);
                    node.chooseWaiting = false;
                })
                .fail(function (xhr, textStatus, errorThrown) {
                    node.chooseWaiting = false;
                    logger.error(textStatus + ": error while accessing Neo4j server on URL:\"" + rest.CYPHER_URL + "\" defined in \"rest.CYPHER_URL\" property: " + errorThrown);
                });
        }
    }
};

/**
 * Add in all expanded choose nodes the value containing the specified value for the given attribute.
 * And remove it from the nodes data.
 *
 * @param attribute
 * @param value
 */
node.addExpandedValue = function (attribute, value) {

    var isAnyChangeDone = false;

    // For each expanded nodes
    for (var i = dataModel.nodes.length - 1; i >= 0; i--) {
        if (dataModel.nodes[i].valueExpanded) {

            // Look in node data if value can be found in reverse order to be able to remove value without effect on iteration index
            for (var j = dataModel.nodes[i].data.length - 1; j >= 0; j--) {
                if (dataModel.nodes[i].data[j][attribute] === value) {
                    isAnyChangeDone = true;

                    // Create field value if needed
                    if (!dataModel.nodes[i].hasOwnProperty("value")) {
                        dataModel.nodes[i].value = [];
                    }

                    // Add value
                    dataModel.nodes[i].value.push({
                        attributes: dataModel.nodes[i].data[j]
                    });

                    // Remove data added in value
                    dataModel.nodes[i].data.splice(j, 1);
                }
            }

            // Refresh node
            node.collapseNode(dataModel.nodes[i]);
            node.expandNode(dataModel.nodes[i]);
        }
    }

    if (isAnyChangeDone) {
        result.hasChanged = true;
        graph.hasGraphChanged = true;
        update();
    }
};

/**
 * Get all nodes that contains a value.
 *
 * @param label If set return only node of this label.
 * @return {Array} Array of nodes containing at least one value.
 */
node.getContainingValue = function (label) {
    var nodesWithValue = [];
    var links = dataModel.links, nodes = dataModel.nodes;

    if (nodes.length > 0) {

        var rootNode = nodes[0];

        // Add root value
        if (rootNode.value !== undefined && rootNode.value.length > 0) {
            if (label === undefined || label === rootNode.label) {
                nodesWithValue.push(rootNode);
            }
        }

        links.forEach(function (l) {
            var targetNode = l.target;
            if (l.type === graph.link.LinkTypes.RELATION && targetNode.value !== undefined && targetNode.value.length > 0) {
                if (label === undefined || label === targetNode.label) {
                    nodesWithValue.push(targetNode);
                }
            }
        });
    }

    return nodesWithValue;
};


/**
 * Add value in all CHOOSE nodes with specified label.
 *
 * @param label nodes where to insert
 * @param value
 */
node.addValueForLabel = function (label, value) {
    var isAnyChangeDone = false;

    // Find choose node with label
    for (var i = dataModel.nodes.length - 1; i >= 0; i--) {
        if (dataModel.nodes[i].type === node.NodeTypes.CHOOSE && dataModel.nodes[i].label === label) {

            // Create field value if needed
            if (!dataModel.nodes[i].hasOwnProperty("value")) {
                dataModel.nodes[i].value = [];
            }

            // check if value already exists
            var isValueFound = false;
            var constraintAttr = provider.node.getConstraintAttribute(label);
            dataModel.nodes[i].value.forEach(function (val) {
                if (val.attributes.hasOwnProperty(constraintAttr) && val.attributes[constraintAttr] === value.attributes[constraintAttr]) {
                    isValueFound = true;
                }
            });

            if (!isValueFound) {
                // Add value
                dataModel.nodes[i].value.push(value);
                isAnyChangeDone = true;
            }
        }
    }

    return isAnyChangeDone;
};

/**
 * Add a value in a node with the given id and the value of the first attribute if found in its data.
 *
 * @param nodeIds a list of node ids where to add the value.
 * @param displayAttributeValue the value to find in data and to add if found
 */
node.addValue = function (nodeIds, displayAttributeValue) {
    var isAnyChangeDone = false;

    // Find choose node with label
    for (var i = 0; i < dataModel.nodes.length; i++) {
        var n = dataModel.nodes[i];
        if (nodeIds.indexOf(n.id) >= 0) {

            // Create field value in node if needed
            if (!n.hasOwnProperty("value")) {
                n.value = [];
            }

            var displayAttr = provider.node.getReturnAttributes(n.label)[0];

            // Find data for this node and add value
            n.data.forEach(function (d) {
                if (d.hasOwnProperty(displayAttr) && d[displayAttr] === displayAttributeValue) {
                    isAnyChangeDone = true;
                    n.value.push({attributes: d});
                }
            });
        }
    }

    if (isAnyChangeDone) {
        result.hasChanged = true;
        graph.hasGraphChanged = true;
        update();
    }
};

/**
 * Remove a value from a node.
 * If the value is not found nothing is done.
 *
 * @param n
 * @param value
 */
node.removeValue = function (n, value) {
    var isAnyChangeDone = false;

    node.collapseNode(n);

    for (var j = n.value.length - 1; j >= 0; j--) {
        if (n.value[j] === value) {
            n.value.splice(j, 1);

            isAnyChangeDone = true;
        }
    }
    return isAnyChangeDone;
};

node.removeValues = function (n) {
    var isAnyChangeDone = false;

    node.collapseNode(n);

    if (n.value !== undefined && n.value.length > 0) {
        n.value.length = 0;
        isAnyChangeDone = true;
    }

    return isAnyChangeDone
};

/**
 * Get the value in the provided nodeId for a specific value id.
 *
 * @param nodeId
 * @param constraintAttributeValue
 */
node.getValue = function (nodeId, constraintAttributeValue) {
    for (var i = 0; i < dataModel.nodes.length; i++) {
        var n = dataModel.nodes[i];

        if (n.id === nodeId) {
            var constraintAttribute = provider.node.getConstraintAttribute(n.label);

            for (var j = n.value.length - 1; j >= 0; j--) {
                if (n.value[j].attributes[constraintAttribute] === constraintAttributeValue) {
                    return n.value[j]
                }
            }
        }
    }
};

/**
 * Remove in all expanded nodes the value containing the specified value for the given attribute.
 * And move it back to nodes data.
 *
 * @param attribute
 * @param value
 */
node.removeExpandedValue = function (attribute, value) {
    var isAnyChangeDone = false;

    // For each expanded nodes in reverse order as some values can be removed
    for (var i = dataModel.nodes.length - 1; i >= 0; i--) {
        if (dataModel.nodes[i].valueExpanded) {

            var removedValues = [];

            // Remove values
            for (var j = dataModel.nodes[i].value.length - 1; j >= 0; j--) {
                if (dataModel.nodes[i].value[j].attributes[attribute] === value) {
                    isAnyChangeDone = true;

                    removedValues = removedValues.concat(dataModel.nodes[i].value.splice(j, 1));
                }
            }

            //And add them back in data
            for (var k = 0; k < removedValues.length; k++) {
                dataModel.nodes[i].data.push(removedValues[k].attributes);
            }

            // Refresh node
            node.collapseNode(dataModel.nodes[i]);
            node.expandNode(dataModel.nodes[i]);
        }
    }

    if (isAnyChangeDone) {
        result.hasChanged = true;
        graph.hasGraphChanged = true;
        update();
    }
};

/**
 * Return all nodes with isAutoLoadValue property set to true.
 */
node.getAutoLoadValueNodes = function () {
    return dataModel.nodes
        .filter(function (d) {
            return d.hasOwnProperty("isAutoLoadValue") && d.isAutoLoadValue === true && !(d.isNegative === true);
        });
};

/**
 * Add a list of related value if not already found in node.
 * A value is defined with the following structure
 * {
 *   id,
 *   rel,
 *   label
 * }
 *
 * @param n
 * @param values
 * @param isNegative
 */
node.addRelatedValues = function (n, values, isNegative) {
    var valuesToAdd = node.filterExistingValues(n, values);

    if (valuesToAdd.length <= 0) {
        return;
    }

    var statements = [];

    valuesToAdd.forEach(function (v) {
        var constraintAttr = provider.node.getConstraintAttribute(v.label);

        var statement = "MATCH ";
        if (constraintAttr === query.NEO4J_INTERNAL_ID) {
            statement += "(v:`" + v.label + "`) WHERE (ID(v) = $p)";
        } else {
            statement += "(v:`" + v.label + "`) WHERE (v." + constraintAttr + " = $p)";
        }

        var resultAttributes = provider.node.getReturnAttributes(v.label);
        var sep = "";

        statement += " RETURN DISTINCT \"" + v.rel + "\" AS rel, \"" + v.label + "\" AS label, {" + resultAttributes.reduce(function (a, attr) {
            a += sep + attr + ":v." + attr;
            sep = ", ";
            return a
        }, "") + "} AS value LIMIT 1";

        statements.push(
            {
                "statement": statement,
                "parameters": {p: v.id},
                "resultDataContents": ["row"]
            }
        );
    });

    logger.info("addRelatedValues ==>");
    rest.post(
        {
            "statements": statements
        })
        .done(function (response) {
            logger.info("<== addRelatedValues");

            var parsedData = rest.response.parse(response);
            var count = 0;
            parsedData.forEach(function (data) {
                if (data.length > 0) {
                    var dataLabel = data[0].label;
                    var dataValue = data[0].value;
                    var dataRel = data[0].rel;

                    var value = {
                        "id": dataModel.generateId(),
                        "parent": n,
                        "attributes": dataValue,
                        "type": node.NodeTypes.VALUE,
                        "label": dataLabel
                    };
                    graph.ignoreCount = true;

                    var nodeRelationships = n.relationships;
                    var nodeRels = nodeRelationships.filter(function (r) {
                        return r.label === dataRel && r.target === dataLabel
                    });

                    var nodeRel = {label: dataRel, target: dataLabel};
                    if (nodeRels.length > 0) {
                        nodeRel = nodeRels[0];
                    }

                    graph.addRelationshipData(n, nodeRel, function () {
                        count++;

                        if (count === parsedData.length) {
                            graph.ignoreCount = false;
                            graph.hasGraphChanged = true;
                            result.hasChanged = true;
                            update();
                        }
                    }, [value], isNegative);
                }
            });
        })
        .fail(function (xhr, textStatus, errorThrown) {
            console.error(xhr, textStatus, errorThrown);
        });
};

/**
 * Add a list of related value prefixed by a path of nodes.
 * A value is defined with the following structure
 * {
 *   id,
 *   rel,
 *   label
 * }
 *
 * @param n
 * @param relPath
 * @param values
 * @param isNegative
 */
node.addRelatedBranch = function (n, relPath, values, isNegative) {
    if (relPath.length > 0) {
        var rel = relPath[0];
        relPath = relPath.slice(1);

        var relationships = n.relationships.filter(function (r) {
            return r.label === rel.type && r.target === rel.target;
        });

        if (relationships.length > 0) {
            graph.addRelationshipData(n, relationships[0], function (createdNode) {
                node.addRelatedBranch(createdNode, relPath, values, isNegative);
            });
        }
    } else {
        node.addRelatedValues(n, values, isNegative);
    }
};

/**
 * A value is defined with the following structure
 * {
 *   id,
 *   rel,
 *   label
 * }
 *
 * @param n
 * @param values
 */
node.filterExistingValues = function (n, values) {
    var notFoundValues = [];
    var possibleValueNodes = dataModel.nodes.filter(function (n) {
        return n.parent === n && n.hasOwnProperty("value") && n.value.length > 0;
    });

    values.forEach(function (v) {
        var found = false;
        var constraintAttr = provider.node.getConstraintAttribute(v.label);

        possibleValueNodes.forEach(function (n) {
            if (n.label === v.label) {
                n.value.forEach(function (nv) {
                    if (nv.attributes[constraintAttr] === v.id) {
                        found = true;
                    }
                });
            }
        });

        if (!found) {
            notFoundValues.push(v);
        }
    });

    return notFoundValues;
};

/**
 * Function called to expand a node containing values.
 * This function will create the value nodes with the clicked node internal data.
 * Only nodes corresponding to the current page index will be generated.
 *
 * @param clickedNode
 */
node.expandNode = function (clickedNode) {

    graph.notifyListeners(graph.Events.GRAPH_NODE_VALUE_EXPAND, [clickedNode]);

    // Get subset of node corresponding to the current node page and page size
    var lIndex = clickedNode.page * node.PAGE_SIZE;
    var sIndex = lIndex - node.PAGE_SIZE;

    var dataToAdd = clickedNode.data.slice(sIndex, lIndex);
    var parentAngle = graph.computeParentAngle(clickedNode);

    // Then each node are created and dispatched around the clicked node using computed coordinates.
    var i = 1;
    dataToAdd.forEach(function (d) {
        var angleDeg;
        if (clickedNode.parent) {
            angleDeg = (((360 / (dataToAdd.length + 1)) * i));
        } else {
            angleDeg = (((360 / (dataToAdd.length)) * i));
        }

        var nx = clickedNode.x + (100 * Math.cos((angleDeg * (Math.PI / 180)) - parentAngle)),
            ny = clickedNode.y + (100 * Math.sin((angleDeg * (Math.PI / 180)) - parentAngle));

        var n = {
            "id": dataModel.generateId(),
            "parent": clickedNode,
            "attributes": d,
            "type": node.NodeTypes.VALUE,
            "label": clickedNode.label,
            "count": d.count,
            "x": nx,
            "y": ny,
            "internalID": d[query.NEO4J_INTERNAL_ID.queryInternalName]
        };

        dataModel.nodes.push(n);
        dataModel.links.push(
            {
                id: "l" + dataModel.generateId(),
                source: clickedNode,
                target: n,
                type: graph.link.LinkTypes.VALUE
            }
        );

        i++;
    });

    // Pin clicked node and its parent to avoid the graph to move for selection, only new value nodes will blossom around the clicked node.
    clickedNode.fixed = true;
    clickedNode.fx = clickedNode.x;
    clickedNode.fy = clickedNode.y;
    if (clickedNode.parent && clickedNode.parent.type !== node.NodeTypes.ROOT) {
        clickedNode.parent.fixed = true;
        clickedNode.parent.fx = clickedNode.parent.x;
        clickedNode.parent.fy = clickedNode.parent.y;
    }
    // Change node state
    clickedNode.valueExpanded = true;
    update();
};

/**
 * Fetches the list of relationships of a node and store them in the relationships property.
 *
 * @param n the node to fetch the relationships.
 * @param callback
 * @param directionAngle
 */
node.loadRelationshipData = function (n, callback, directionAngle) {
    var schema = provider.node.getSchema(n.label);

    if (schema !== undefined) {
        if (schema.hasOwnProperty("rel") && schema.rel.length > 0) {
            callback(node.pie.startAngle(directionAngle - Math.PI).endAngle(directionAngle + Math.PI)(schema.rel).map(function (d) {
                var data = {
                    id: d.data.label + d.data.target.label,
                    label: d.data.label,
                    target: d.data.target.label,
                    count: 0,
                    startAngle: d.startAngle,
                    endAngle: d.endAngle,
                    directionAngle: (d.startAngle + d.endAngle) / 2
                };

                if (d.data.isReverse === true) {
                    data.isReverse = true;
                }

                return data;
            }));
        } else {
            callback([]);
        }
    } else {
        var nodeRelationQuery = query.generateNodeRelationQuery(n);

        logger.info("Relations (" + n.label + ") ==>");
        rest.post(
            {
                "statements": [
                    {
                        "statement": nodeRelationQuery.statement,
                        "parameters": nodeRelationQuery.parameters
                    }]
            })
            .done(function (response) {
                logger.info("<== Relations (" + n.label + ")");
                var parsedData = rest.response.parse(response);

                // Filter data to eventually remove relations if a filter has been defined in config.
                var filteredData = parsedData[0].filter(function (d) {
                    return query.filterRelation(d);
                });

                filteredData = node.pie.startAngle(directionAngle - Math.PI).endAngle(directionAngle + Math.PI)(filteredData).map(function (d) {
                    return {
                        id: d.data.label + d.data.target,
                        label: d.data.label,
                        target: d.data.target,
                        count: d.data.count,
                        startAngle: d.startAngle,
                        endAngle: d.endAngle,
                        directionAngle: (d.startAngle + d.endAngle) / 2
                    }
                });

                callback(filteredData);
            })
            .fail(function (xhr, textStatus, errorThrown) {
                logger.error(textStatus + ": error while accessing Neo4j server on URL:\"" + rest.CYPHER_URL + "\" defined in \"rest.CYPHER_URL\" property: " + errorThrown);
                callback([]);
            });
    }
};

/**
 * Expands all the relationships available in node.
 *
 * @param n
 * @param callback
 */
node.expandRelationships = function (n, callback) {
    var callbackCount = 0;

    if (n.hasOwnProperty("relationships") && n.relationships.length > 0) {

        for (var i = 0; i < n.relationships.length; i++) {
            graph.addRelationshipData(n, n.relationships[i], function () {
                callbackCount++;

                if (callbackCount === n.relationships.length) {
                    callback();
                }
            });
        }
    } else {
        callback();
    }
};

/**
 * Remove a node and its relationships (recursively) from the graph.
 *
 * @param n the node to remove.
 */
node.removeNode = function (n) {
    var willChangeResults = n.hasOwnProperty("value") && n.value.length > 0;

    var linksToRemove = dataModel.links.filter(function (l) {
        return l.source === n;
    });

    // Remove children nodes from model
    linksToRemove.forEach(function (l) {
        var rc = node.removeNode(l.target);
        willChangeResults = willChangeResults || rc;
    });

    // Remove links to nodes from model
    for (var i = dataModel.links.length - 1; i >= 0; i--) {
        if (dataModel.links[i].target === n) {
            dataModel.links.splice(i, 1);
        }
    }

    dataModel.nodes.splice(dataModel.nodes.indexOf(n), 1);

    return willChangeResults;
};

/**
 * Remove empty branches containing a node.
 *
 * @param n the node to remove.
 * @return true if node have been removed
 */
node.removeEmptyBranches = function (n) {
    var hasValues = n.hasOwnProperty("value") && n.value.length > 0;

    var childrenLinks = dataModel.links.filter(function (l) {
        return l.source === n;
    });

    childrenLinks.forEach(function (l) {
        var hasRemainingNodes = !node.removeEmptyBranches(l.target);
        hasValues = hasValues || hasRemainingNodes;
    });

    if (!hasValues) {
        // Remove links to node from model
        for (var i = dataModel.links.length - 1; i >= 0; i--) {
            if (dataModel.links[i].target === n) {
                dataModel.links.splice(i, 1);
            }
        }

        dataModel.nodes.splice(dataModel.nodes.indexOf(n), 1);
    }

    return !hasValues;
};

/**
 * Get in the parent nodes the closest one to the root.
 *
 * @param n the node to start from.
 * @return {*} the trunk node or the node in parameters if not found.
 */
node.getTrunkNode = function (n) {

    for (var i = 0; i < dataModel.links.length; i++) {
        var l = dataModel.links[i];
        if (l.target === n) {
            if (l.source !== graph.getRootNode()) {
                return node.getTrunkNode(l.source);
            }
        }
    }

    return n;
};

/**
 * Function to add on node event to clear the selection.
 * Call to this function on a node will remove the selected value and trigger a graph update.
 */
node.clearSelection = function () {
    // Prevent default event like right click  opening menu.
    d3.event.preventDefault();

    // Get clicked node.
    var clickedNode = d3.select(this).data()[0];

    // Collapse all expanded choose nodes first
    node.collapseAllNode();

    if (clickedNode.value !== undefined && clickedNode.value.length > 0 && !clickedNode.immutable) {
        // Remove last value of chosen node
        clickedNode.value.pop();

        if (clickedNode.isNegative === true) {
            if (clickedNode.value.length === 0) {
                // Remove all related nodes
                for (var i = dataModel.links.length - 1; i >= 0; i--) {
                    if (dataModel.links[i].source === clickedNode) {
                        node.removeNode(dataModel.links[i].target);
                    }
                }

                clickedNode.count = 0;
            }
        }

        result.hasChanged = true;
        graph.hasGraphChanged = true;
        update();
    }
};

var graph = {};

graph.link = link;
graph.node = node;

graph.DISABLE_RELATION = false;
graph.DISABLE_COUNT = false;

/**
 * ID of the HTML component where the graph query builder elements will be generated in.
 * @type {string}
 */
graph.containerId = "popoto-graph";
graph.hasGraphChanged = true;
// Defines the min and max level of zoom available in graph query builder.
graph.zoom = d3.zoom().scaleExtent([0.1, 10]);
graph.WHEEL_ZOOM_ENABLED = true;
graph.USE_DONUT_FORCE = false;
graph.USE_VORONOI_LAYOUT = false;
graph.USE_FIT_TEXT = false;

/**
 * Define the list of listenable events on graph.
 */
graph.Events = Object.freeze({
    NODE_ROOT_ADD: "root.node.add",
    NODE_EXPAND_RELATIONSHIP: "node.expandRelationship",
    GRAPH_SAVE: "graph.save",
    GRAPH_RESET: "graph.reset",
    GRAPH_NODE_RELATION_ADD: "graph.node.relation_add",
    GRAPH_NODE_VALUE_EXPAND: "graph.node.value_expand",
    GRAPH_NODE_VALUE_COLLAPSE: "graph.node.value_collapse",
    GRAPH_NODE_ADD_VALUE: "graph.node.add_value",
    GRAPH_NODE_DATA_LOADED: "graph.node.data_loaded"
});

graph.listeners = {};

/**
 * Add a listener to the specified event.
 *
 * @param event name of the event to add the listener.
 * @param listener the listener to add.
 */
graph.on = function (event, listener) {
    if (!graph.listeners.hasOwnProperty(event)) {
        graph.listeners[event] = [];
    }

    graph.listeners[event].push(listener);
};

/**
 * Notify the listeners.
 *
 * @param event
 * @param parametersArray
 */
graph.notifyListeners = function (event, parametersArray) {
    if (graph.listeners.hasOwnProperty(event)) {
        graph.listeners[event].forEach(function (listener) {
            listener.apply(event, parametersArray);
        });
    }
};

/**
 * Add a listener on graph save event.
 * @param listener
 */
graph.onSave = function (listener) {
    graph.on(graph.Events.GRAPH_SAVE, listener);
};

/**
 * Add a listener on graph reset event.
 * @param listener
 */
graph.onReset = function (listener) {
    graph.on(graph.Events.GRAPH_RESET, listener);
};

/**
 * Set default graph to a predefined value.
 * @param graph
 */
graph.setDefaultGraph = function (graph) {
    graph.mainLabel = graph;
};

/**
 * Generates all the HTML and SVG element needed to display the graph query builder.
 * Everything will be generated in the container with id defined by graph.containerId.
 */
graph.createGraphArea = function () {

    var htmlContainer = d3.select("#" + graph.containerId);

    toolbar.render(htmlContainer);

    graph.svgTag = htmlContainer.append("svg")
        .attr("class", "ppt-svg-graph")
        // .attr("viewBox", "0 0 800 600") TODO to avoid need of windows resize event
        .call(graph.zoom.on("zoom", graph.rescale));

    graph.svgTag.on("dblclick.zoom", null);

    if (!graph.WHEEL_ZOOM_ENABLED) {
        // Disable mouse wheel events.
        graph.svgTag.on("wheel.zoom", null)
            .on("mousewheel.zoom", null);
    }

    // Objects created inside a <defs> element are not rendered immediately; instead, think of them as templates or macros created for future use.
    graph.svgdefs = graph.svgTag.append("defs");

    // Cross marker for path with id #cross -X-
    graph.svgdefs.append("marker")
        .attr("id", "cross")
        .attr("refX", 10)
        .attr("refY", 10)
        .attr("markerWidth", 20)
        .attr("markerHeight", 20)
        .attr("markerUnits", "strokeWidth")
        .attr("orient", "auto")
        .append("path")
        .attr("class", "ppt-marker-cross")
        .attr("d", "M5,5 L15,15 M15,5 L5,15");

    // Triangle marker for paths with id #arrow --|>
    graph.svgdefs.append("marker")
        .attr("id", "arrow")
        .attr("refX", 9)
        .attr("refY", 3)
        .attr("markerWidth", 10)
        .attr("markerHeight", 10)
        .attr("markerUnits", "strokeWidth")
        .attr("orient", "auto")
        .append("path")
        .attr("class", "ppt-marker-arrow")
        .attr("d", "M0,0 L0,6 L9,3 z");

    // Reversed triangle marker for paths with id #reverse-arrow <|--
    graph.svgdefs.append("marker")
        .attr("id", "reverse-arrow")
        .attr("refX", 0)
        .attr("refY", 3)
        .attr("markerWidth", 10)
        .attr("markerHeight", 10)
        .attr("markerUnits", "strokeWidth")
        .attr("orient", "auto")
        .append("path")
        .attr("class", "ppt-marker-reverse-arrow")
        .attr("d", "M0,3 L9,6 L9,0 z");

    // Gray scale filter for images.
    var grayscaleFilter = graph.svgdefs.append("filter")
        .attr("id", "grayscale");

    grayscaleFilter.append("feColorMatrix")
        .attr("type", "saturate")
        .attr("values", "0");

    // to change brightness
    // var feCT = grayscaleFilter
    //     .append("feComponentTransfer");
    //
    // feCT.append("feFuncR")
    //     .attr("type", "linear")
    //     .attr("slope", "0.2");
    //
    // feCT.append("feFuncG")
    //     .attr("type", "linear")
    //     .attr("slope", "0.2");
    //
    // feCT.append("feFuncB")
    //     .attr("type", "linear")
    //     .attr("slope", "0.2");

    // gooey
    var filter = graph.svgdefs.append("filter").attr("id", "gooey");
    filter.append("feGaussianBlur")
        .attr("in", "SourceGraphic")
        .attr("stdDeviation", "10")
        //to fix safari: http://stackoverflow.com/questions/24295043/svg-gaussian-blur-in-safari-unexpectedly-lightens-image
        .attr("color-interpolation-filters", "sRGB")
        .attr("result", "blur");
    filter.append("feColorMatrix")
        .attr("class", "blurValues")
        .attr("in", "blur")
        .attr("mode", "matrix")
        .attr("values", "1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 35 -6")
        .attr("result", "gooey");
    filter.append("feBlend")
        .attr("in", "SourceGraphic")
        .attr("in2", "gooey")
        .attr("operator", "atop");


    graph.svgdefs.append("g")
        .attr("id", "voronoi-clip-path");

    graph.svg = graph.svgTag.append("svg:g");

    // Create two separated area for links and nodes
    // Links and nodes are separated in a dedicated "g" element
    // and nodes are generated after links to ensure that nodes are always on foreground.
    graph.svg.append("g").attr("id", graph.link.gID);
    graph.svg.append("g").attr("id", graph.node.gID);

    // This listener is used to center the root node in graph during a window resize.
    // TODO can the listener be limited on the parent container only?
    window.addEventListener('resize', graph.centerRootNode);
};

graph.getRootNode = function () {
    return dataModel.getRootNode();
};

graph.centerRootNode = function () {
    dataModel.getRootNode().fx = graph.getSVGWidth() / 2;
    dataModel.getRootNode().fy = graph.getSVGHeight() / 2;
    update();
};

/**
 * Get the actual width of the SVG element containing the graph query builder.
 * @returns {number}
 */
graph.getSVGWidth = function () {
    if (typeof graph.svg == 'undefined' || graph.svg.empty()) {
        logger.debug("graph.svg is undefined or empty.");
        return 0;
    } else {
        return document.getElementById(graph.containerId).clientWidth;
    }
};

/**
 * Get the actual height of the SVG element containing the graph query builder.
 * @returns {number}
 */
graph.getSVGHeight = function () {
    if (typeof graph.svg == 'undefined' || graph.svg.empty()) {
        logger.debug("graph.svg is undefined or empty.");
        return 0;
    } else {
        return document.getElementById(graph.containerId).clientHeight;
    }
};

/**
 * Function to call on SVG zoom event to update the svg transform attribute.
 */
graph.rescale = function () {
    var transform = d3.event.transform;
    if (isNaN(transform.x) || isNaN(transform.y) || isNaN(transform.k)) {
        graph.svg.attr("transform", d3.zoomIdentity);
    } else {
        graph.svg.attr("transform", transform);
    }
};

graph.CHARGE = -500;

/**
 *  Create the D3.js force simultation for the graph query builder.
 */
// TODO ZZZ rename to create createForceSimulation
graph.createForceLayout = function () {

    graph.force = d3.forceSimulation()
        .force("charge", d3.forceManyBody()
            .strength(function (d) {
                    if (d.charge) {
                        return d.charge;
                    } else {
                        return graph.CHARGE;
                    }
                }
            )
        )
        .force(
            "link",
            d3.forceLink().id(
                function (d) {
                    return d.id;
                }
            ).distance(provider.link.getDistance)
        );


    graph.force.nodes(dataModel.nodes);
    graph.force.force("link").links(dataModel.links);

    graph.force.on("tick", graph.tick);
};

/**
 * Adds graph root nodes using the label set as parameter.
 * All the other nodes should have been removed first to avoid inconsistent data.
 *
 * @param label label of the node to add as root.
 */
graph.addRootNode = function (label) {
    if (dataModel.nodes.length > 0) {
        logger.warn("graph.addRootNode is called but the graph is not empty.");
    }
    if (provider.node.getSchema(label) !== undefined) {
        graph.addSchema(provider.node.getSchema(label));
    } else {

        var n = {
            "id": dataModel.generateId(),
            "type": graph.node.NodeTypes.ROOT,
            // x and y coordinates are set to the center of the SVG area.
            // These coordinate will never change at runtime except if the window is resized.
            "x": graph.getSVGWidth() / 2,
            "y": graph.getSVGHeight() / 2,
            "fx": graph.getSVGWidth() / 2,
            "fy": graph.getSVGHeight() / 2,
            "tx": graph.getSVGWidth() / 2,
            "ty": graph.getSVGHeight() / 2,
            "label": label,
            // The node is fixed to always remain in the center of the svg area.
            // This property should not be changed at runtime to avoid issues with the zoom and pan.
            "fixed": true,
            // Label used internally to identify the node.
            // This label is used for example as cypher query identifier.
            "internalLabel": graph.node.generateInternalLabel(label),
            // List of relationships
            "relationships": [],
            "isAutoLoadValue": provider.node.getIsAutoLoadValue(label) === true
        };

        dataModel.nodes.push(n);
        graph.notifyListeners(graph.Events.NODE_ROOT_ADD, [n]);

        graph.node.loadRelationshipData(n, function (relationships) {
            n.relationships = relationships;

            if (provider.node.getIsAutoExpandRelations(label)) {

                graph.ignoreCount = true;
                graph.node.expandRelationships(n, function () {

                    graph.ignoreCount = false;
                    graph.hasGraphChanged = true;
                    updateGraph();
                });
            } else {
                graph.hasGraphChanged = true;
                updateGraph();
            }
        }, Math.PI / 2);
    }
};

graph.loadSchema = function (graphToLoad) {
    if (dataModel.nodes.length > 0) {
        logger.warn("graph.loadSchema is called but the graph is not empty.");
    }

    var rootNodeSchema = graphToLoad;
    var rootNode = {
        "id": dataModel.generateId(),
        "type": graph.node.NodeTypes.ROOT,
        // x and y coordinates are set to the center of the SVG area.
        // These coordinate will never change at runtime except if the window is resized.
        "x": graph.getSVGWidth() / 2,
        "y": graph.getSVGHeight() / 2,
        "fx": graph.getSVGWidth() / 2,
        "fy": graph.getSVGHeight() / 2,
        "tx": graph.getSVGWidth() / 2,
        "ty": graph.getSVGHeight() / 2,
        "label": rootNodeSchema.label,
        // The node is fixed to always remain in the center of the svg area.
        // This property should not be changed at runtime to avoid issues with the zoom and pan.
        "fixed": true,
        // Label used internally to identify the node.
        // This label is used for example as cypher query identifier.
        "internalLabel": graph.node.generateInternalLabel(rootNodeSchema.label),
        // List of relationships
        "relationships": [],
        "isAutoLoadValue": provider.node.getIsAutoLoadValue(rootNodeSchema.label) === true
    };
    dataModel.nodes.push(rootNode);
    graph.notifyListeners(graph.Events.NODE_ROOT_ADD, [rootNode]);

    var labelSchema = provider.node.getSchema(graphToLoad.label);

    // Add relationship from schema if defined
    if (labelSchema !== undefined && labelSchema.hasOwnProperty("rel") && labelSchema.rel.length > 0) {
        var directionAngle = (Math.PI / 2);

        rootNode.relationships = graph.node.pie.startAngle(directionAngle - Math.PI).endAngle(directionAngle + Math.PI)(labelSchema.rel).map(function (d) {

            var data = {
                id: d.data.label + d.data.target.label,
                label: d.data.label,
                target: d.data.target.label,
                count: 0,
                startAngle: d.startAngle,
                endAngle: d.endAngle,
                directionAngle: (d.startAngle + d.endAngle) / 2
            };

            if (d.data.isReverse === true) {
                data.isReverse = true;
            }

            return data;
        });
    } else {
        graph.node.loadRelationshipData(rootNode, function (relationships) {
            rootNode.relationships = relationships;
            graph.hasGraphChanged = true;
            updateGraph();
        }, Math.PI / 2);
    }

    if (rootNodeSchema.hasOwnProperty("value")) {
        var nodeSchemaValue = [].concat(rootNodeSchema.value);
        rootNode.value = [];
        nodeSchemaValue.forEach(function (value) {
            rootNode.value.push(
                {
                    "id": dataModel.generateId(),
                    "parent": rootNode,
                    "attributes": value,
                    "type": graph.node.NodeTypes.VALUE,
                    "label": rootNode.label
                }
            );
        });
    }

    if (rootNodeSchema.hasOwnProperty("rel")) {
        for (var linkIndex = 0; linkIndex < rootNodeSchema.rel.length; linkIndex++) {
            graph.loadSchemaRelation(rootNodeSchema.rel[linkIndex], rootNode, linkIndex + 1, rootNodeSchema.rel.length);
        }
    }
};

graph.loadSchemaRelation = function (relationSchema, parentNode, linkIndex, parentLinkTotalCount) {
    var targetNodeSchema = relationSchema.target;
    var target = graph.loadSchemaNode(targetNodeSchema, parentNode, linkIndex, parentLinkTotalCount, relationSchema.label, (relationSchema.hasOwnProperty("isReverse") && relationSchema.isReverse === true));

    var newLink = {
        id: "l" + dataModel.generateId(),
        source: parentNode,
        target: target,
        type: graph.link.LinkTypes.RELATION,
        label: relationSchema.label,
        schema: relationSchema
    };

    dataModel.links.push(newLink);

    var labelSchema = provider.node.getSchema(targetNodeSchema.label);

    // Add relationship from schema if defined
    if (labelSchema !== undefined && labelSchema.hasOwnProperty("rel") && labelSchema.rel.length > 0) {
        var directionAngle = (Math.PI / 2);

        target.relationships = graph.node.pie.startAngle(directionAngle - Math.PI).endAngle(directionAngle + Math.PI)(labelSchema.rel).map(function (d) {
            var data = {
                id: d.data.label + d.data.target.label,
                label: d.data.label,
                target: d.data.target.label,
                count: 0,
                startAngle: d.startAngle,
                endAngle: d.endAngle,
                directionAngle: (d.startAngle + d.endAngle) / 2
            };

            if (d.data.isReverse === true) {
                data.isReverse = true;
            }

            return data;
        });
    } else {
        graph.node.loadRelationshipData(target, function (relationships) {
            target.relationships = relationships;
            graph.hasGraphChanged = true;
            updateGraph();
        }, Math.PI / 2);
    }

    if (targetNodeSchema.hasOwnProperty("rel")) {
        for (var linkIndex2 = 0; linkIndex2 < targetNodeSchema.rel.length; linkIndex2++) {
            graph.loadSchemaRelation(targetNodeSchema.rel[linkIndex2], target, linkIndex2 + 1, targetNodeSchema.rel.length);
        }
    }
};

graph.loadSchemaNode = function (nodeSchema, parentNode, index, parentLinkTotalCount, parentRel, isReverse) {
    var isGroupNode = provider.node.getIsGroup(nodeSchema);
    var parentAngle = graph.computeParentAngle(parentNode);

    var angleDeg;
    if (parentAngle) {
        angleDeg = (((360 / (parentLinkTotalCount + 1)) * index));
    } else {
        angleDeg = (((360 / (parentLinkTotalCount)) * index));
    }

    var nx = parentNode.x + (200 * Math.cos((angleDeg * (Math.PI / 180)) - parentAngle)),
        ny = parentNode.y + (200 * Math.sin((angleDeg * (Math.PI / 180)) - parentAngle));

    // TODO add force coordinate X X X
    // var tx = nx + ((provider.link.getDistance(newLink)) * Math.cos(link.directionAngle - Math.PI / 2));
    // var ty = ny + ((provider.link.getDistance(newLink)) * Math.sin(link.directionAngle - Math.PI / 2));

    var n = {
        "id": dataModel.generateId(),
        "parent": parentNode,
        "parentRel": parentRel,
        "type": (isGroupNode) ? graph.node.NodeTypes.GROUP : graph.node.NodeTypes.CHOOSE,
        "label": nodeSchema.label,
        "fixed": false,
        "internalLabel": graph.node.generateInternalLabel(nodeSchema.label),
        "x": nx,
        "y": ny,
        "schema": nodeSchema,
        "isAutoLoadValue": provider.node.getIsAutoLoadValue(nodeSchema.label) === true,
        "relationships": []
    };

    if (isReverse === true) {
        n.isParentRelReverse = true;
    }

    if (nodeSchema.hasOwnProperty("isNegative") && nodeSchema.isNegative === true) {
        n.isNegative = true;
        n.count = 0;
    }

    dataModel.nodes.push(n);

    if (nodeSchema.hasOwnProperty("value")) {
        var nodeSchemaValue = [].concat(nodeSchema.value);
        n.value = [];
        nodeSchemaValue.forEach(function (value) {
            n.value.push(
                {
                    "id": dataModel.generateId(),
                    "parent": n,
                    "attributes": value,
                    "type": graph.node.NodeTypes.VALUE,
                    "label": n.label
                }
            );
        });
    }

    return n;
};

/**
 * Adds a complete graph from schema.
 * All the other nodes should have been removed first to avoid inconsistent data.
 *
 * @param graphSchema schema of the graph to add.
 */
graph.addSchema = function (graphSchema) {
    if (dataModel.nodes.length > 0) {
        logger.warn("graph.addSchema is called but the graph is not empty.");
    }

    var rootNodeSchema = graphSchema;

    var rootNode = {
        "id": dataModel.generateId(),
        "type": graph.node.NodeTypes.ROOT,
        // x and y coordinates are set to the center of the SVG area.
        // These coordinate will never change at runtime except if the window is resized.
        "x": graph.getSVGWidth() / 2,
        "y": graph.getSVGHeight() / 2,
        "fx": graph.getSVGWidth() / 2,
        "fy": graph.getSVGHeight() / 2,
        "tx": graph.getSVGWidth() / 2,
        "ty": graph.getSVGHeight() / 2,
        "label": rootNodeSchema.label,
        // The node is fixed to always remain in the center of the svg area.
        // This property should not be changed at runtime to avoid issues with the zoom and pan.
        "fixed": true,
        // Label used internally to identify the node.
        // This label is used for example as cypher query identifier.
        "internalLabel": graph.node.generateInternalLabel(rootNodeSchema.label),
        // List of relationships
        "relationships": [],
        "isAutoLoadValue": provider.node.getIsAutoLoadValue(rootNodeSchema.label) === true
    };
    dataModel.nodes.push(rootNode);
    graph.notifyListeners(graph.Events.NODE_ROOT_ADD, [rootNode]);

    if (rootNodeSchema.hasOwnProperty("rel") && rootNodeSchema.rel.length > 0) {
        var directionAngle = (Math.PI / 2);

        rootNode.relationships = graph.node.pie.startAngle(directionAngle - Math.PI).endAngle(directionAngle + Math.PI)(rootNodeSchema.rel).map(function (d) {
            var data = {
                id: d.data.label + d.data.target.label,
                label: d.data.label,
                target: d.data.target.label,
                count: 0,
                startAngle: d.startAngle,
                endAngle: d.endAngle,
                directionAngle: (d.startAngle + d.endAngle) / 2
            };

            if (d.data.isReverse === true) {
                data.isReverse = true;
            }

            return data;
        });
    }

    // if (!isCollapsed && rootNodeSchema.hasOwnProperty("rel")) {
    //     for (var linkIndex = 0; linkIndex < rootNodeSchema.rel.length; linkIndex++) {
    //         graph.addSchemaRelation(rootNodeSchema.rel[linkIndex], rootNode, linkIndex + 1, rootNodeSchema.rel.length);
    //     }
    // }
};

graph.addSchemaRelation = function (relationSchema, parentNode, linkIndex, parentLinkTotalCount) {
    var targetNodeSchema = relationSchema.target;
    var target = graph.addSchemaNode(targetNodeSchema, parentNode, linkIndex, parentLinkTotalCount, relationSchema.label);

    var newLink = {
        id: "l" + dataModel.generateId(),
        source: parentNode,
        target: target,
        type: graph.link.LinkTypes.RELATION,
        label: relationSchema.label,
        schema: relationSchema
    };

    dataModel.links.push(newLink);
};

graph.addSchemaNode = function (nodeSchema, parentNode, index, parentLinkTotalCount, parentRel) {
    var isGroupNode = provider.node.getIsGroup(nodeSchema);
    var isCollapsed = nodeSchema.hasOwnProperty("collapsed") && nodeSchema.collapsed === true;

    var parentAngle = graph.computeParentAngle(parentNode);

    var angleDeg;
    if (parentAngle) {
        angleDeg = (((360 / (parentLinkTotalCount + 1)) * index));
    } else {
        angleDeg = (((360 / (parentLinkTotalCount)) * index));
    }

    var nx = parentNode.x + (200 * Math.cos((angleDeg * (Math.PI / 180)) - parentAngle)),
        ny = parentNode.y + (200 * Math.sin((angleDeg * (Math.PI / 180)) - parentAngle));

    // TODO add force coordinate X X X
    // var tx = nx + ((provider.link.getDistance(newLink)) * Math.cos(link.directionAngle - Math.PI / 2));
    // var ty = ny + ((provider.link.getDistance(newLink)) * Math.sin(link.directionAngle - Math.PI / 2));

    var n = {
        "id": dataModel.generateId(),
        "parent": parentNode,
        "parentRel": parentRel,
        "type": (isGroupNode) ? graph.node.NodeTypes.GROUP : graph.node.NodeTypes.CHOOSE,
        "label": nodeSchema.label,
        "fixed": false,
        "internalLabel": graph.node.generateInternalLabel(nodeSchema.label),
        "x": nx,
        "y": ny,
        "schema": nodeSchema,
        "isAutoLoadValue": provider.node.getIsAutoLoadValue(nodeSchema.label) === true,
        "relationships": []
    };

    if (nodeSchema.hasOwnProperty("rel") && nodeSchema.rel.length > 0) {
        var relMap = {};
        var relSegments = [];

        for (var i = 0; i < nodeSchema.rel.length; i++) {
            var rel = nodeSchema.rel[i];
            var id = rel.label + rel.target.label;

            if (!relMap.hasOwnProperty(id)) {
                relMap[id] = rel;
                relSegments.push(rel);
            }

        }

        n.relationships = graph.node.pie(relSegments).map(function (d) {
            return {
                id: d.data.label + d.data.target.label,
                count: d.data.count || 0,
                label: d.data.label,
                target: d.data.target.label,
                startAngle: d.startAngle,
                endAngle: d.endAngle,
                directionAngle: (d.startAngle + d.endAngle) / 2
            }
        });

    }

    if (nodeSchema.hasOwnProperty("value")) {
        var nodeSchemaValue = [].concat(nodeSchema.value);
        n.value = [];
        nodeSchemaValue.forEach(function (value) {
            n.value.push(
                {
                    "id": dataModel.generateId(),
                    "parent": n,
                    "attributes": value,
                    "type": graph.node.NodeTypes.VALUE,
                    "label": n.label
                }
            );
        });
    }

    dataModel.nodes.push(n);

    if (!isCollapsed && nodeSchema.hasOwnProperty("rel")) {
        for (var linkIndex = 0; linkIndex < nodeSchema.rel.length; linkIndex++) {
            graph.addSchemaRelation(nodeSchema.rel[linkIndex], n, linkIndex + 1, nodeSchema.rel.length);
        }
    }

    return n;
};

/**
 * Get the current schema of the graph.
 * @returns {{}}
 */
graph.getSchema = function () {
    var nodesMap = {};

    var rootNode = dataModel.getRootNode();

    nodesMap[rootNode.id] = {
        label: rootNode.label
    };

    if (rootNode.hasOwnProperty("value")) {
        nodesMap[rootNode.id].value = [];
        rootNode.value.forEach(function (value) {
            nodesMap[rootNode.id].value.push(value.attributes);
        });
    }

    var links = dataModel.links;
    if (links.length > 0) {
        links.forEach(function (l) {
            if (l.type === graph.link.LinkTypes.RELATION) {
                var sourceNode = l.source;
                var targetNode = l.target;

                if (!nodesMap.hasOwnProperty(sourceNode.id)) {
                    nodesMap[sourceNode.id] = {
                        label: sourceNode.label
                    };
                    if (sourceNode.hasOwnProperty("isNegative") && sourceNode.isNegative === true) {
                        nodesMap[sourceNode.id].isNegative = true;
                    }
                    if (sourceNode.hasOwnProperty("value")) {
                        nodesMap[sourceNode.id].value = [];
                        sourceNode.value.forEach(function (value) {
                            nodesMap[sourceNode.id].value.push(value.attributes);
                        });
                    }
                }

                if (!nodesMap.hasOwnProperty(targetNode.id)) {
                    nodesMap[targetNode.id] = {
                        label: targetNode.label
                    };
                    if (targetNode.hasOwnProperty("isNegative") && targetNode.isNegative === true) {
                        nodesMap[targetNode.id].isNegative = true;
                    }
                    if (targetNode.hasOwnProperty("value")) {
                        nodesMap[targetNode.id].value = [];
                        targetNode.value.forEach(function (value) {
                            nodesMap[targetNode.id].value.push(value.attributes);
                        });
                    }
                }

                if (!nodesMap[sourceNode.id].hasOwnProperty("rel")) {
                    nodesMap[sourceNode.id].rel = [];
                }

                var rel = {
                    label: l.label,
                    target: nodesMap[targetNode.id]
                };

                if (targetNode.hasOwnProperty("isParentRelReverse") && targetNode.isParentRelReverse === true) {
                    rel.isReverse = true;
                }

                nodesMap[sourceNode.id].rel.push(rel);
            }
        });

    }

    return nodesMap[rootNode.id];
};

/**
 * Function to call on D3.js force layout tick event.
 * This function will update the position of all links and nodes elements in the graph with the force layout computed coordinate.
 */
graph.tick = function () {
    var paths = graph.svg.selectAll("#" + graph.link.gID + " > g");

    // Update link paths
    paths.selectAll(".ppt-link")
        .attr("d", function (d) {
            var linkSource = d.source;
            var linkTarget = d.target;
            var parentAngle = graph.computeParentAngle(linkTarget);
            var sourceMargin = provider.node.getSize(linkSource);
            var targetMargin = provider.node.getSize(linkTarget);

            if (!graph.DISABLE_RELATION && linkSource.hasOwnProperty("relationships") && linkSource.relationships.length > 0) {
                sourceMargin = graph.node.getDonutOuterRadius(linkSource);
            }

            if (!graph.DISABLE_RELATION && linkTarget.hasOwnProperty("relationships") && linkTarget.relationships.length > 0) {
                targetMargin = graph.node.getDonutOuterRadius(linkTarget);
            }

            var targetX = linkTarget.x + ((targetMargin) * Math.cos(parentAngle)),
                targetY = linkTarget.y - ((targetMargin) * Math.sin(parentAngle));

            var sourceX = linkSource.x - ((sourceMargin) * Math.cos(parentAngle)),
                sourceY = linkSource.y + ((sourceMargin) * Math.sin(parentAngle));

            // Add an intermediate point in path center
            var middleX = (targetX + sourceX) / 2,
                middleY = (targetY + sourceY) / 2;

            if (linkSource.x <= linkTarget.x || graph.ignoreMirroLinkLabels === true) {
                return "M" + sourceX + " " + sourceY + "L" + middleX + " " + middleY + "L" + targetX + " " + targetY;
            } else {
                return "M" + targetX + " " + targetY + "L" + middleX + " " + middleY + "L" + sourceX + " " + sourceY;
            }
        })
        .attr("marker-end", function (d) {
            if (graph.link.SHOW_MARKER) {
                if (d.target.isParentRelReverse === true) {
                    if (d.source.x > d.target.x) {
                        return "url(#arrow)";
                    }
                } else {
                    if (d.source.x <= d.target.x) {
                        return "url(#arrow)";
                    }
                }
            }
            return null;
        })
        .attr("marker-start", function (d) {
            if (graph.link.SHOW_MARKER) {
                if (d.target.isParentRelReverse === true) {
                    if (d.source.x <= d.target.x) {
                        return "url(#reverse-arrow)";
                    }
                } else {
                    if (d.source.x > d.target.x) {
                        return "url(#reverse-arrow)";
                    }
                }
            }
            return null;
        });

    // Workaround to WebKit browsers:
    // Updating a path element by itself does not trigger redraw on dependent elements that reference this path.
    // So, even though we update the path, the referencing textPath element will not be redrawn.
    // To workaround this update bug, the xlink:href attribute to #path is updated.
    paths.selectAll(".ppt-textPath")
        .attr("xlink:href", function (d) {
            return "#ppt-path_" + d.id;
        });

    graph.svg.selectAll("#" + graph.node.gID + " > g")
        .attr("transform", function (d) {
            return "translate(" + (d.x) + "," + (d.y) + ")";
        });

    if (graph.USE_VORONOI_LAYOUT === true) {

        var clip = d3.select("#voronoi-clip-path").selectAll('.voroclip')
            .data(graph.recenterVoronoi(dataModel.nodes), function (d) {
                return d.point.id;
            });

        clip.enter().append('clipPath')
            .attr('id', function (d) {
                return 'voroclip-' + d.point.id;
            })
            .attr('class', 'voroclip');

        clip.exit().remove();

        clip.selectAll('path').remove();

        clip.append('path')
            .attr('id', function (d) {
                return 'pvoroclip-' + d.point.id;
            })
            .attr('d', function (d) {
                return 'M' + d.join(',') + 'Z';
            });
    }
};

/**
 * Compute the angle in radian between the node and its parent.
 * TODO: clean or add comments to explain the code...
 *
 * @param n node to compute angle.
 * @returns {number} angle in radian.
 */
graph.computeParentAngle = function (n) {
    var angleRadian = 0;
    var r = 100;
    if (n.parent) {
        var xp = n.parent.x;
        var yp = n.parent.y;
        var x0 = n.x;
        var y0 = n.y;
        var dist = Math.sqrt(Math.pow(xp - x0, 2) + Math.pow(yp - y0, 2));

        var k = r / (dist - r);
        var xc = (x0 + (k * xp)) / (1 + k);

        var val = (xc - x0) / r;
        if (val < -1) {
            val = -1;
        }
        if (val > 1) {
            val = 1;
        }

        angleRadian = Math.acos(val);

        if (yp > y0) {
            angleRadian = 2 * Math.PI - angleRadian;
        }
    }
    return angleRadian;
};

/**
 *
 * @param n
 * @param l
 * @param callback
 * @param values
 * @param isNegative
 */
graph.addRelationshipData = function (n, l, callback, values, isNegative) {
    var targetNode = {
        "id": "" + dataModel.generateId(),
        "parent": n,
        "parentRel": l.label,
        "type": graph.node.NodeTypes.CHOOSE,
        "label": l.target,
        "fixed": false,
        "internalLabel": graph.node.generateInternalLabel(l.target),
        "relationships": []
    };

    if (l.isReverse === true) {
        targetNode.isParentRelReverse = true;
    }

    if (values !== undefined && values.length > 0) {
        targetNode.value = values;
    }
    if (isNegative !== undefined && isNegative === true) {
        targetNode.isNegative = true;
    }

    var newLink = {
        id: "l" + dataModel.generateId(),
        source: n,
        target: targetNode,
        type: graph.link.LinkTypes.RELATION,
        label: l.label
    };

    targetNode.x = n.x + ((provider.link.getDistance(newLink) * 2 / 3) * Math.cos(l.directionAngle - Math.PI / 2)) + Math.random() * 10;
    targetNode.y = n.y + ((provider.link.getDistance(newLink) * 2 / 3) * Math.sin(l.directionAngle - Math.PI / 2)) + Math.random() * 10;

    targetNode.tx = n.tx + ((provider.link.getDistance(newLink)) * Math.cos(l.directionAngle - Math.PI / 2));
    targetNode.ty = n.ty + ((provider.link.getDistance(newLink)) * Math.sin(l.directionAngle - Math.PI / 2));

    dataModel.nodes.push(targetNode);
    dataModel.links.push(newLink);

    graph.hasGraphChanged = true;
    updateGraph();

    graph.node.loadRelationshipData(targetNode, function (relationships) {
            targetNode.relationships = relationships;

            graph.hasGraphChanged = true;
            updateGraph();

            if (provider.node.getIsAutoExpandRelations(targetNode.label)) {
                graph.node.expandRelationships(targetNode, function () {
                    callback(targetNode);
                });
            } else {
                callback(targetNode);
            }
        },
        l.directionAngle
    );


};

graph.voronoi = d3.voronoi()
    .x(function (d) {
        return d.x;
    })
    .y(function (d) {
        return d.y;
    });

graph.recenterVoronoi = function (nodes) {
    var shapes = [];

    var voronois = graph.voronoi.polygons(nodes.map(function (d) {
        d.x = d.x || 0;
        d.y = d.y || 0;
        return d
    }));

    voronois.forEach(function (d) {
        if (!d.length) {
            return;
        }

        var n = [];
        d.forEach(function (c) {
            n.push([c[0] - d.data.x, c[1] - d.data.y]);
        });

        n.point = d.data;
        shapes.push(n);
    });
    return shapes;
};

var provider = {};

/**
 * Default color scale generator.
 * Used in getColor link and node providers.
 */
provider.colorScale = d3.scaleOrdinal(d3.schemeCategory10);
provider.link = {};
provider.link.Provider = {};
provider.taxonomy = {};
provider.taxonomy.Provider = {};
provider.node = {};
provider.node.Provider = {};

//------------------------------------------------
// LINKS

/**
 *  Get the text representation of a link.
 *
 * @param link the link to get the text representation.
 * @returns {string} the text representation of the link.
 */
provider.link.getTextValue = function (link) {
    if (provider.link.Provider.hasOwnProperty("getTextValue")) {
        return provider.link.Provider.getTextValue(link);
    } else {
        if (provider.link.DEFAULT_PROVIDER.hasOwnProperty("getTextValue")) {
            return provider.link.DEFAULT_PROVIDER.getTextValue(link);
        } else {
            logger.error("No provider defined for link getTextValue");
        }
    }
};

provider.link.getColor = function (link, element, attribute) {
    if (provider.link.Provider.hasOwnProperty("getColor")) {
        return provider.link.Provider.getColor(link, element, attribute);
    } else {
        if (provider.link.DEFAULT_PROVIDER.hasOwnProperty("getColor")) {
            return provider.link.DEFAULT_PROVIDER.getColor(link, element, attribute);
        } else {
            logger.error("No provider defined for getColor");
        }
    }
};

provider.link.getCSSClass = function (link, element) {
    if (provider.link.Provider.hasOwnProperty("getCSSClass")) {
        return provider.link.Provider.getCSSClass(link, element);
    } else {
        if (provider.link.DEFAULT_PROVIDER.hasOwnProperty("getCSSClass")) {
            return provider.link.DEFAULT_PROVIDER.getCSSClass(link, element);
        } else {
            logger.error("No provider defined for getCSSClass");
        }
    }
};

provider.link.getDistance = function (link) {
    if (provider.link.Provider.hasOwnProperty("getDistance")) {
        return provider.link.Provider.getDistance(link);
    } else {
        if (provider.link.DEFAULT_PROVIDER.hasOwnProperty("getDistance")) {
            return provider.link.DEFAULT_PROVIDER.getDistance(link);
        } else {
            logger.error("No provider defined for getDistance");
        }
    }
};

/**
 *  Get the semantic text representation of a link.
 *
 * @param link the link to get the semantic text representation.
 * @returns {string} the semantic text representation of the link.
 */
provider.link.getSemanticValue = function (link) {
    if (provider.link.Provider.hasOwnProperty("getSemanticValue")) {
        return provider.link.Provider.getSemanticValue(link);
    } else {
        if (provider.link.DEFAULT_PROVIDER.hasOwnProperty("getSemanticValue")) {
            return provider.link.DEFAULT_PROVIDER.getSemanticValue(link);
        } else {
            logger.error("No provider defined for getSemanticValue");
        }
    }
};

provider.colorLuminance = function (hex, lum) {

    // validate hex string
    hex = String(hex).replace(/[^0-9a-f]/gi, '');
    if (hex.length < 6) {
        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
    }
    lum = lum || 0;

    // convert to decimal and change luminosity
    var rgb = "#", c, i;
    for (i = 0; i < 3; i++) {
        c = parseInt(hex.substr(i * 2, 2), 16);
        c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);
        rgb += ("00" + c).substr(c.length);
    }

    return rgb;
};

/**
 * Label provider used by default if none have been defined for a label.
 * This provider can be changed if needed to customize default behavior.
 * If some properties are not found in user customized providers, default values will be extracted from this provider.
 */
provider.link.DEFAULT_PROVIDER = {
    /**
     * Function used to return the text representation of a link.
     *
     * The default behavior is to return the internal relation name as text for relation links.
     * And return the target node text value for links between a node and its expanded values but only if text is not displayed on value node.
     *
     * @param link the link to represent as text.
     * @returns {string} the text representation of the link.
     */
    "getTextValue": function (link) {
        if (link.type === graph.link.LinkTypes.VALUE) {
            // Links between node and list of values.

            if (provider.node.isTextDisplayed(link.target)) {
                // Don't display text on link if text is displayed on target node.
                return "";
            } else {
                // No text is displayed on target node then the text is displayed on link.
                return provider.node.getTextValue(link.target);
            }

        } else {
            var targetName = "";
            if (link.type === graph.link.LinkTypes.SEGMENT) {
                targetName = " " + provider.node.getTextValue(link.target);
            }
            return link.label + targetName;
        }
    },


    /**
     *
     * @param link
     */
    "getDistance": function (link) {
        if (link.type === graph.link.LinkTypes.VALUE) {
            return (13 / 8) * (provider.node.getSize(link.source) + provider.node.getSize(link.target));
        } else {
            return (20 / 8) * (provider.node.getSize(link.source) + provider.node.getSize(link.target));
        }
    },

    /**
     * Return the color to use on links and relation donut segments.
     *
     *
     * Return null or undefined
     * @param link
     * @param element
     * @param attribute
     * @return {*}
     */
    "getColor": function (link, element, attribute) {
        if (link.type === graph.link.LinkTypes.VALUE) {
            return "#525863";
        } else {
            var colorId = link.source.label + link.label + link.target.label;

            var color = provider.colorScale(colorId);
            if (attribute === "stroke") {
                return provider.colorLuminance(color, -0.2);
            }
            return color;
        }
    },

    /**
     *
     * @param link
     * @param element
     * @return {string}
     */
    "getCSSClass": function (link, element) {
        var cssClass = "ppt-link__" + element;

        if (link.type === graph.link.LinkTypes.VALUE) {
            cssClass = cssClass + "--value";
        } else {
            var labelAsCSSName = "ppt-" + link.label.replace(/[^0-9a-z\-_]/gi, '');
            if (link.type === graph.link.LinkTypes.RELATION) {
                cssClass = cssClass + "--relation";

                if (link.target.count === 0) {
                    cssClass = cssClass + "--disabled";
                }

                cssClass = cssClass + " " + labelAsCSSName;
            }
        }

        return cssClass;
    },

    /**
     * Function used to return a descriptive text representation of a link.
     * This representation should be more complete than getLinkTextValue and can contain semantic data.
     * This function is used for example to generate the label in the query viewer.
     *
     * The default behavior is to return the getLinkTextValue.
     *
     * @param link the link to represent as text.
     * @returns {string} the text semantic representation of the link.
     */
    "getSemanticValue": function (link) {
        return provider.link.getTextValue(link);
    }
};

provider.link.Provider = provider.link.DEFAULT_PROVIDER;

//------------------------------------------------
// TAXONOMY

/**
 *  Get the text representation of a taxonomy.
 *
 * @param label the label used for the taxonomy.
 * @returns {string} the text representation of the taxonomy.
 */
provider.taxonomy.getTextValue = function (label) {
    if (provider.taxonomy.Provider.hasOwnProperty("getTextValue")) {
        return provider.taxonomy.Provider.getTextValue(label);
    } else {
        if (provider.taxonomy.DEFAULT_PROVIDER.hasOwnProperty("getTextValue")) {
            return provider.taxonomy.DEFAULT_PROVIDER.getTextValue(label);
        } else {
            logger.error("No provider defined for taxonomy getTextValue");
        }
    }
};

/**
 *
 * @param label
 * @param element
 * @return {*}
 */
provider.taxonomy.getCSSClass = function (label, element) {
    if (provider.taxonomy.Provider.hasOwnProperty("getCSSClass")) {
        return provider.taxonomy.Provider.getCSSClass(label, element);
    } else {
        if (provider.taxonomy.DEFAULT_PROVIDER.hasOwnProperty("getCSSClass")) {
            return provider.taxonomy.DEFAULT_PROVIDER.getCSSClass(label, element);
        } else {
            logger.error("No provider defined for taxonomy getCSSClass");
        }
    }
};

/**
 * Label provider used by default if none have been defined for a label.
 * This provider can be changed if needed to customize default behavior.
 * If some properties are not found in user customized providers, default values will be extracted from this provider.
 */
provider.taxonomy.DEFAULT_PROVIDER = {
    /**
     * Function used to return the text representation of a taxonomy.
     *
     * The default behavior is to return the label without changes.
     *
     * @param label the label used to represent the taxonomy.
     * @returns {string} the text representation of the taxonomy.
     */
    "getTextValue": function (label) {
        return label;
    },

    /**
     *
     * @param label
     * @return {string}
     */
    "getCSSClass": function (label, element) {
        var labelAsCSSName = label.replace(/[^0-9a-z\-_]/gi, '');

        var cssClass = "ppt-taxo__" + element;

        return cssClass + " " + labelAsCSSName;
    }

};

provider.taxonomy.Provider = provider.taxonomy.DEFAULT_PROVIDER;

/**
 * Define the different type of rendering of a node for a given label.
 * TEXT: default rendering type, the node will be displayed with an ellipse and a text in it.
 * IMAGE: the node is displayed as an image using the image tag in the svg graph.
 * In this case an image path is required.
 * SVG: the node is displayed using a list of svg path, each path can contain its own color.
 */
provider.node.DisplayTypes = Object.freeze({TEXT: 0, IMAGE: 1, SVG: 2, SYMBOL: 3});

/**
 * Get the label provider for the given label.
 * If no provider is defined for the label:
 * First search in parent provider.
 * Then if not found will create one from default provider.
 *
 * @param label to retrieve the corresponding label provider.
 * @returns {object} corresponding label provider.
 */
provider.node.getProvider = function (label) {
    if (label === undefined) {
        logger.error("Node label is undefined, no label provider can be found.");
    } else {
        if (provider.node.Provider.hasOwnProperty(label)) {
            return provider.node.Provider[label];
        } else {
            logger.debug("No direct provider found for label " + label);

            // Search in all children list definitions to find the parent provider.
            for (var p in provider.node.Provider) {
                if (provider.node.Provider.hasOwnProperty(p)) {
                    var nProvider = provider.node.Provider[p];
                    if (nProvider.hasOwnProperty("children")) {
                        if (nProvider["children"].indexOf(label) > -1) {
                            logger.debug("No provider is defined for label (" + label + "), parent (" + p + ") will be used");
                            // A provider containing the required label in its children definition has been found it will be cloned.

                            var newProvider = {"parent": p};
                            for (var pr in nProvider) {
                                if (nProvider.hasOwnProperty(pr) && pr !== "children" && pr !== "parent") {
                                    newProvider[pr] = nProvider[pr];
                                }
                            }

                            provider.node.Provider[label] = newProvider;
                            return provider.node.Provider[label];
                        }
                    }
                }
            }

            logger.debug("No label provider defined for label (" + label + ") default one will be created from provider.node.DEFAULT_PROVIDER");

            provider.node.Provider[label] = {};
            // Clone default provider properties in new provider.
            for (var prop in provider.node.DEFAULT_PROVIDER) {
                if (provider.node.DEFAULT_PROVIDER.hasOwnProperty(prop)) {
                    provider.node.Provider[label][prop] = provider.node.DEFAULT_PROVIDER[prop];
                }
            }
            return provider.node.Provider[label];
        }
    }
};

/**
 * Get the property or function defined in node label provider.
 * If the property is not found search is done in parents.
 * If not found in parent, property defined in provider.node.DEFAULT_PROVIDER is returned.
 * If not found in default provider, defaultValue is set and returned.
 *
 * @param label node label to get the property in its provider.
 * @param name name of the property to retrieve.
 * @returns {*} node property defined in its label provider.
 */
provider.node.getProperty = function (label, name) {
    var nProvider = provider.node.getProvider(label);

    if (!nProvider.hasOwnProperty(name)) {
        var providerIterator = nProvider;

        // Check parents
        var isPropertyFound = false;
        while (providerIterator.hasOwnProperty("parent") && !isPropertyFound) {
            providerIterator = provider.node.getProvider(providerIterator.parent);
            if (providerIterator.hasOwnProperty(name)) {

                // Set attribute in child to optimize next call.
                nProvider[name] = providerIterator[name];
                isPropertyFound = true;
            }
        }

        if (!isPropertyFound) {
            logger.debug("No \"" + name + "\" property found for node label provider (" + label + "), default value will be used");
            if (provider.node.DEFAULT_PROVIDER.hasOwnProperty(name)) {
                nProvider[name] = provider.node.DEFAULT_PROVIDER[name];
            } else {
                logger.debug("No default value for \"" + name + "\" property found for label provider (" + label + ")");
            }
        }
    }
    return nProvider[name];
};

/**
 *
 * @param label
 */
provider.node.getIsAutoLoadValue = function (label) {
    return provider.node.getProperty(label, "isAutoLoadValue");
};

/**
 * Return the "isSearchable" property for the node label provider.
 * Is Searchable defines whether the label can be used as graph query builder root.
 * If true the label can be displayed in the taxonomy filter.
 *
 * @param label
 * @returns boolean
 */
provider.node.getIsSearchable = function (label) {
    return provider.node.getProperty(label, "isSearchable");
};

/**
 * Return the "autoExpandRelations" property for the node label provider.
 * Auto expand relations defines whether the label will automatically add its relations when displayed on graph.
 *
 * @param label
 * @returns boolean
 */
provider.node.getIsAutoExpandRelations = function (label) {
    return provider.node.getProperty(label, "autoExpandRelations");
};

provider.node.getSchema = function (label) {
    return provider.node.getProperty(label, "schema");
};

/**
 * Return the list of attributes defined in node label provider.
 * Parents return attributes are also returned.
 *
 * @param label used to retrieve parent attributes.
 * @returns {Array} list of return attributes for a node.
 */
provider.node.getReturnAttributes = function (label) {
    var nProvider = provider.node.getProvider(label);
    var attributes = {}; // Object is used as a Set to merge possible duplicate in parents

    if (nProvider.hasOwnProperty("returnAttributes")) {
        for (var i = 0; i < nProvider.returnAttributes.length; i++) {
            if (nProvider.returnAttributes[i] === query.NEO4J_INTERNAL_ID) {
                attributes[query.NEO4J_INTERNAL_ID.queryInternalName] = true;
            } else {
                attributes[nProvider.returnAttributes[i]] = true;
            }
        }
    }

    // Add parent attributes
    while (nProvider.hasOwnProperty("parent")) {
        nProvider = provider.node.getProvider(nProvider.parent);
        if (nProvider.hasOwnProperty("returnAttributes")) {
            for (var j = 0; j < nProvider.returnAttributes.length; j++) {
                if (nProvider.returnAttributes[j] === query.NEO4J_INTERNAL_ID) {
                    attributes[query.NEO4J_INTERNAL_ID.queryInternalName] = true;
                } else {
                    attributes[nProvider.returnAttributes[j]] = true;
                }
            }
        }
    }

    // Add default provider attributes if any but not internal id as this id is added only if none has been found.
    if (provider.node.DEFAULT_PROVIDER.hasOwnProperty("returnAttributes")) {
        for (var k = 0; k < provider.node.DEFAULT_PROVIDER.returnAttributes.length; k++) {
            if (provider.node.DEFAULT_PROVIDER.returnAttributes[k] !== query.NEO4J_INTERNAL_ID) {
                attributes[provider.node.DEFAULT_PROVIDER.returnAttributes[k]] = true;
            }
        }
    }

    // Add constraint attribute in the list
    var constraintAttribute = provider.node.getConstraintAttribute(label);
    if (constraintAttribute === query.NEO4J_INTERNAL_ID) {
        attributes[query.NEO4J_INTERNAL_ID.queryInternalName] = true;
    } else {
        attributes[constraintAttribute] = true;
    }


    // Add all in array
    var attrList = [];
    for (var attr in attributes) {
        if (attributes.hasOwnProperty(attr)) {
            if (attr === query.NEO4J_INTERNAL_ID.queryInternalName) {
                attrList.push(query.NEO4J_INTERNAL_ID);
            } else {
                attrList.push(attr);
            }
        }
    }

    // If no attributes have been found internal ID is used
    if (attrList.length <= 0) {
        attrList.push(query.NEO4J_INTERNAL_ID);
    }
    return attrList;
};

/**
 * Return the attribute to use as constraint attribute for a node defined in its label provider.
 *
 * @param label
 * @returns {*}
 */
provider.node.getConstraintAttribute = function (label) {
    return provider.node.getProperty(label, "constraintAttribute");
};

provider.node.getDisplayAttribute = function (label) {
    var displayAttribute = provider.node.getProperty(label, "displayAttribute");

    if (displayAttribute === undefined) {
        var returnAttributes = provider.node.getReturnAttributes(label);
        if (returnAttributes.length > 0) {
            displayAttribute = returnAttributes[0];
        } else {
            displayAttribute = provider.node.getConstraintAttribute(label);
        }
    }

    return displayAttribute
};

/**
 * Return a list of predefined constraint defined in the node label configuration.
 *
 * @param label
 * @returns {*}
 */
provider.node.getPredefinedConstraints = function (label) {
    return provider.node.getProperty(label, "getPredefinedConstraints")();
};

provider.node.filterResultQuery = function (label, initialQuery) {
    return provider.node.getProperty(label, "filterResultQuery")(initialQuery);
};

provider.node.getValueOrderByAttribute = function (label) {
    return provider.node.getProperty(label, "valueOrderByAttribute");
};

provider.node.isValueOrderAscending = function (label) {
    return provider.node.getProperty(label, "isValueOrderAscending");
};

provider.node.getResultOrderByAttribute = function (label) {
    return provider.node.getProperty(label, "resultOrderByAttribute");
};

/**
 *
 * @param label
 */
provider.node.isResultOrderAscending = function (label) {
    return provider.node.getProperty(label, "isResultOrderAscending");
};

/**
 * Return the value of the getTextValue function defined in the label provider corresponding to the parameter node.
 * If no "getTextValue" function is defined in the provider, search is done in parents.
 * If none is found in parent default provider method is used.
 *
 * @param node
 * @param parameter
 */
provider.node.getTextValue = function (node, parameter) {
    return provider.node.getProperty(node.label, "getTextValue")(node, parameter);
};


/**
 * Return the value of the getSemanticValue function defined in the label provider corresponding to the parameter node.
 * The semantic value is a more detailed description of the node used for example in the query viewer.
 * If no "getTextValue" function is defined in the provider, search is done in parents.
 * If none is found in parent default provider method is used.
 *
 * @param node
 * @returns {*}
 */
provider.node.getSemanticValue = function (node) {
    return provider.node.getProperty(node.label, "getSemanticValue")(node);
};

/**
 * Return a list of SVG paths objects, each defined by a "d" property containing the path and "f" property for the color.
 *
 * @param node
 * @returns {*}
 */
provider.node.getSVGPaths = function (node) {
    return provider.node.getProperty(node.label, "getSVGPaths")(node);
};

/**
 * Check in label provider if text must be displayed with images nodes.
 * @param node
 * @returns {*}
 */
provider.node.isTextDisplayed = function (node) {
    return provider.node.getProperty(node.label, "getIsTextDisplayed")(node);
};

/**
 *
 * @param node
 */
provider.node.getSize = function (node) {
    return provider.node.getProperty(node.label, "getSize")(node);
};

/**
 * Return the getColor property.
 *
 * @param node
 * @param style
 * @returns {*}
 */
provider.node.getColor = function (node, style) {
    return provider.node.getProperty(node.label, "getColor")(node, style);
};

/**
 *
 * @param node
 * @param element
 */
provider.node.getCSSClass = function (node, element) {
    return provider.node.getProperty(node.label, "getCSSClass")(node, element);
};

/**
 * Return the getIsGroup property.
 *
 * @param node
 * @returns {*}
 */
provider.node.getIsGroup = function (node) {
    return provider.node.getProperty(node.label, "getIsGroup")(node);
};

/**
 * Return the node display type.
 * can be TEXT, IMAGE, SVG or GROUP.
 *
 * @param node
 * @returns {*}
 */
provider.node.getNodeDisplayType = function (node) {
    return provider.node.getProperty(node.label, "getDisplayType")(node);
};

/**
 * Return the file path of the image defined in the provider.
 *
 * @param node the node to get the image path.
 * @returns {string} the path of the node image.
 */
provider.node.getImagePath = function (node) {
    return provider.node.getProperty(node.label, "getImagePath")(node);
};

/**
 * Return the width size of the node image.
 *
 * @param node the node to get the image width.
 * @returns {int} the image width.
 */
provider.node.getImageWidth = function (node) {
    return provider.node.getProperty(node.label, "getImageWidth")(node);
};

/**
 * Return the height size of the node image.
 *
 * @param node the node to get the image height.
 * @returns {int} the image height.
 */
provider.node.getImageHeight = function (node) {
    return provider.node.getProperty(node.label, "getImageHeight")(node);
};

provider.node.filterNodeValueQuery = function (node, initialQuery) {
    return provider.node.getProperty(node.label, "filterNodeValueQuery")(node, initialQuery);
};

provider.node.filterNodeCountQuery = function (node, initialQuery) {
    return provider.node.getProperty(node.label, "filterNodeCountQuery")(node, initialQuery);
};

provider.node.filterNodeRelationQuery = function (node, initialQuery) {
    return provider.node.getProperty(node.label, "filterNodeRelationQuery")(node, initialQuery);
};

provider.node.getGenerateNodeValueConstraints = function (node) {
    return provider.node.getProperty(node.label, "generateNodeValueConstraints");
};

provider.node.getGenerateNegativeNodeValueConstraints = function (node) {
    return provider.node.getProperty(node.label, "generateNegativeNodeValueConstraints");
};

/**
 * Return the displayResults function defined in label parameter's provider.
 *
 * @param label
 * @returns {*}
 */
provider.node.getDisplayResults = function (label) {
    return provider.node.getProperty(label, "displayResults");
};

/**
 * Label provider used by default if none have been defined for a label.
 * This provider can be changed if needed to customize default behavior.
 * If some properties are not found in user customized providers, default
 * values will be extracted from this provider.
 */
provider.node.DEFAULT_PROVIDER = (
    {
        /**********************************************************************
         * Label specific parameters:
         *
         * These attributes are specific to a node label and will be used for
         * every node having this label.
         **********************************************************************/

        /**
         * Defines whether this label can be used as root element of the graph
         * query builder.
         * This property is also used to determine whether the label can be
         * displayed in the taxonomy filter.
         *
         * The default value is true.
         */
        "isSearchable": true,

        /**
         * Defines whether this label will automatically expend its relations
         * when displayed on graph.
         * If set to true, once displayed additional request will be sent on
         * the database to retrieve its relations.
         *
         * The default value is false.
         */
        "autoExpandRelations": false,

        /**
         * Defines whether this label will automatically load its available
         * data displayed on graph.
         * If set to true, once displayed additional request will be sent on
         * the database to retrieve its possible values.
         *
         * The default value is false.
         */
        "isAutoLoadValue": false,

        /**
         * Defines the list of attribute to return for node of this label.
         * All the attributes listed here will be added in generated cypher
         * queries and available in result list and in node provider's
         * functions.
         *
         * The default value contains only the Neo4j internal id.
         * This id is used by default because it is a convenient way to identify
         * a node when nothing is known about its attributes.
         * But you should really consider using your application attributes
         * instead, it is a bad practice to rely on this attribute.
         */
        "returnAttributes": [query.NEO4J_INTERNAL_ID],

        /**
         * Defines the attribute used to order the value displayed on node.
         *
         * Default value is "count" attribute.
         */
        "valueOrderByAttribute": "count",

        /**
         * Defines whether the value query order by is ascending, if false order
         * by will be descending.
         *
         * Default value is false (descending)
         */
        "isValueOrderAscending": false,

        /**
         * Defines the attributes used to order the results.
         * It can be an attribute name or a list of attribute names.
         *
         * Default value is "null" to disable order by.
         */
        "resultOrderByAttribute": null,

        /**
         * Defines whether the result query order by is ascending, if false
         * order by will be descending.
         * It can be a boolean value or a list of boolean to match the resultOrderByAttribute.
         * If size of isResultOrderAscending < size of resultOrderByAttribute last value is used.
         *
         * Default value is true (ascending)
         */
        "isResultOrderAscending": true,

        /**
         * Defines the attribute of the node to use in query constraint for
         * nodes of this label.
         * This attribute is used in the generated cypher query to build the
         * constraints with selected values.
         *
         * The default value is the Neo4j internal id.
         * This id is used by default because it is a convenient way to
         * identify a node when nothing is known about its attributes.
         * But you should really consider using your application attributes
         * instead, it is a bad practice to rely on this attribute.
         */
        "constraintAttribute": query.NEO4J_INTERNAL_ID,

        /**
         * Defines the attribute of the node to use by default to display the node.
         * This attribute must be present in returnAttributes list.
         *
         * The default value is undefined.
         * If undefined the first attribute of the returnAttributes will be used or
         * constraintAttribute if the list is empty.
         */
        "displayAttribute": undefined,

        /**
         * Return the list of predefined constraints to add for the given label.
         * These constraints will be added in every generated Cypher query.
         *
         * For example if the returned list contain ["$identifier.born > 1976"]
         * for "Person" nodes everywhere in popoto.js the generated Cypher
         * query will add the constraint "WHERE person.born > 1976"
         *
         * @returns {Array}
         */
        "getPredefinedConstraints": function () {
            return [];
        },

        /**
         * Filters the query generated to retrieve the queries.
         *
         * @param initialQuery contains the query as an object structure.
         * @returns {*}
         */
        "filterResultQuery": function (initialQuery) {
            return initialQuery;
        },

        /**********************************************************************
         * Node specific parameters:
         *
         * These attributes are specific to nodes (in graph or query viewer)
         * for a given label.
         * But they can be customized for nodes of the same label.
         * The parameters are defined by a function that will be called with
         * the node as parameter.
         * In this function the node internal attributes can be used to
         * customize the value to return.
         **********************************************************************/

        /**
         * Function returning the display type of a node.
         * This type defines how the node will be drawn in the graph.
         *
         * The result must be one of the following values:
         *
         * provider.node.DisplayTypes.IMAGE
         *  In this case the node will be drawn as an image and "getImagePath"
         *  function is required to return the node image path.
         *
         * provider.node.DisplayTypes.SVG
         *  In this case the node will be drawn as SVG paths and "getSVGPaths"
         *
         * provider.node.DisplayTypes.TEXT
         *  In this case the node will be drawn as a simple circle.
         *
         * Default value is TEXT.
         *
         * @param node the node to extract its type.
         * @returns {number} one value from provider.node.DisplayTypes
         */
        "getDisplayType": function (node) {
            return provider.node.DisplayTypes.TEXT;
        },

        /**
         * Function defining the size of the node in graph.
         *
         * The size define the radius of the circle defining the node.
         * other elements (menu, counts...) will scale on this size.
         *
         * Default value is 50.
         *
         * @param node
         */
        "getSize": function (node) {
            return 50;
        },

        /**
         * Return a color for the node.
         *
         * @param node
         * @returns {*}
         */
        "getColor": function (node) {
            if (node.type === graph.node.NodeTypes.VALUE) {
                return provider.node.getColor(node.parent);
            } else {
                var parentLabel = "";
                if (node.hasOwnProperty("parent")) {
                    parentLabel = node.parent.label;
                }

                var incomingRelation = node.parentRel || "";

                var colorId = parentLabel + incomingRelation + node.label;
                return provider.colorScale(colorId);
            }
        },

        /**
         * Generate a CSS class for the node depending on its type.
         *
         * @param node
         * @param element
         * @return {string}
         */
        "getCSSClass": function (node, element) {
            var labelAsCSSName = node.label.replace(/[^0-9a-z\-_]/gi, '');

            var cssClass = "ppt-node__" + element;

            if (node.type === graph.node.NodeTypes.ROOT) {
                cssClass = cssClass + "--root";
            }
            if (node.type === graph.node.NodeTypes.CHOOSE) {
                cssClass = cssClass + "--choose";
            }
            if (node.type === graph.node.NodeTypes.GROUP) {
                cssClass = cssClass + "--group";
            }
            if (node.type === graph.node.NodeTypes.VALUE) {
                cssClass = cssClass + "--value";
            }
            if (node.value !== undefined && node.value.length > 0) {
                cssClass = cssClass + "--value-selected";
            }
            if (node.count === 0) {
                cssClass = cssClass + "--disabled";
            }

            return cssClass + " " + labelAsCSSName;
        },

        /**
         * Function defining whether the node is a group node.
         * In this case no count are displayed and no value can be selected on
         * the node.
         *
         * Default value is false.
         */
        "getIsGroup": function (node) {
            return false;
        },

        /**
         * Function defining whether the node text representation must be
         * displayed on graph.
         * If true the value returned for getTextValue on node will be displayed
         * on graph.
         *
         * This text will be added in addition to the getDisplayType
         * representation.
         * It can be displayed on all type of node display, images, SVG or text.
         *
         * Default value is true
         *
         * @param node the node to display on graph.
         * @returns {boolean} true if text must be displayed on graph for the
         * node.
         */
        "getIsTextDisplayed": function (node) {
            return true;
        },

        /**
         * Function used to return the text representation of a node.
         *
         * The default behavior is to return the label of the node
         * or the value of constraint attribute of the node if it contains
         * value.
         *
         * The returned value is truncated using
         * graph.node.NODE_MAX_CHARS property.
         *
         * @param node the node to represent as text.
         * @param maxLength used to truncate the text.
         * @returns {string} the text representation of the node.
         */
        "getTextValue": function (node, maxLength) {
            var text = "";
            var displayAttr = provider.node.getDisplayAttribute(node.label);
            if (node.type === graph.node.NodeTypes.VALUE) {
                if (displayAttr === query.NEO4J_INTERNAL_ID) {
                    text = "" + node.internalID;
                } else {
                    text = "" + node.attributes[displayAttr];
                }
            } else {
                if (node.value !== undefined && node.value.length > 0) {
                    if (displayAttr === query.NEO4J_INTERNAL_ID) {
                        var separator = "";
                        node.value.forEach(function (value) {
                            text += separator + value.internalID;
                            separator = " or ";
                        });
                    } else {
                        var separator = "";
                        node.value.forEach(function (value) {
                            text += separator + value.attributes[displayAttr];
                            separator = " or ";
                        });
                    }
                } else {
                    text = node.label;
                }
            }

            return text;
        },

        /**
         * Function used to return a descriptive text representation of a link.
         * This representation should be more complete than getTextValue and can
         * contain semantic data.
         * This function is used for example to generate the label in the query
         * viewer.
         *
         * The default behavior is to return the getTextValue not truncated.
         *
         * @param node the node to represent as text.
         * @returns {string} the text semantic representation of the node.
         */
        "getSemanticValue": function (node) {
            var text = "";
            var displayAttr = provider.node.getDisplayAttribute(node.label);
            if (node.type === graph.node.NodeTypes.VALUE) {
                if (displayAttr === query.NEO4J_INTERNAL_ID) {
                    text = "" + node.internalID;
                } else {
                    text = "" + node.attributes[displayAttr];
                }
            } else {
                if (node.value !== undefined && node.value.length > 0) {
                    if (displayAttr === query.NEO4J_INTERNAL_ID) {
                        var separator = "";
                        node.value.forEach(function (value) {
                            text += separator + value.internalID;
                            separator = " or ";
                        });
                    } else {
                        var separator = "";
                        node.value.forEach(function (value) {
                            text += separator + value.attributes[displayAttr];
                            separator = " or ";
                        });
                    }
                } else {
                    text = node.label;
                }
            }
            return text;
        },

        /**
         * Function returning the image file path to use for a node.
         * This function is only used for provider.node.DisplayTypes.IMAGE
         * type nodes.
         *
         * @param node
         * @returns {string}
         */
        "getImagePath": function (node) {
            // if (node.type === graph.node.NodeTypes.VALUE) {
            //     var constraintAttribute = provider.node.getConstraintAttribute(node.label);
            //     return "image/node/value/" + node.label.toLowerCase() + "/" + node.attributes[constraintAttribute] + ".svg";
            // } else {
            return "image/node/" + node.label.toLowerCase() + "/" + node.label.toLowerCase() + ".svg";
            // }
        },

        /**
         * Function returning a array of path objects to display in the node.
         *
         * @param node
         * @returns {*[]}
         */
        "getSVGPaths": function (node) {
            var size = provider.node.getSize(node);
            return [
                {
                    "d": "M 0, 0 m -" + size + ", 0 a " + size + "," + size + " 0 1,0 " + 2 * size + ",0 a " + size + "," + size + " 0 1,0 -" + 2 * size + ",0",
                    "fill": "transparent",
                    "stroke": provider.node.getColor(node),
                    "stroke-width": "2px"
                }
            ];
        },

        /**
         * Function returning the image width of the node.
         * This function is only used for provider.node.DisplayTypes.IMAGE
         * type nodes.
         *
         * @param node
         * @returns {number}
         */
        "getImageWidth": function (node) {
            return provider.node.getSize(node) * 2;
        },

        /**
         * Function returning the image height of the node.
         * This function is only used for provider.node.DisplayTypes.IMAGE
         * type nodes.
         *
         * @param node
         * @returns {number}
         */
        "getImageHeight": function (node) {
            return provider.node.getSize(node) * 2;
        },

        /**
         * Filters the query generated to retrieve the values on a node.
         *
         * @param node
         * @param initialQuery contains the query as an object structure.
         * @returns {*}
         */
        "filterNodeValueQuery": function (node, initialQuery) {
            return initialQuery;
        },
        /**
         * Filters the query generated to retrieve the values on a node.
         *
         * @param node
         * @param initialQuery contains the query as an object structure.
         * @returns {*}
         */
        "filterNodeCountQuery": function (node, initialQuery) {
            return initialQuery;
        },
        /**
         * Filters the query used to retrieve the values on a node.
         *
         * @param node
         * @param initialQuery contains the query as an object structure.
         * @returns {*}
         */
        "filterNodeRelationQuery": function (node, initialQuery) {
            return initialQuery;
        },

        /**
         * Customize, in query, the generated constraint for the node.
         *
         * If undefined use default constraint generation.
         */
        "generateNodeValueConstraints": undefined,

        /**
         * Customize, in query, the generated negative constraint for the node.
         *
         * If undefined use default negative constraint generation.
         */
        "generateNegativeNodeValueConstraints": undefined,

        /**********************************************************************
         * Results specific parameters:
         *
         * These attributes are specific to result display.
         **********************************************************************/

        /**
         * Generate the result entry content using d3.js mechanisms.
         *
         * The parameter of the function is the &lt;p&gt; selected with d3.js
         *
         * The default behavior is to generate a &lt;table&gt; containing all
         * the return attributes in a &lt;th&gt; and their value in a &lt;td&gt;.
         *
         * @param pElmt the &lt;p&gt; element generated in the result list.
         */
        "displayResults": function (pElmt) {
            var result = pElmt.data()[0];
            var returnAttributes = provider.node.getReturnAttributes(result.label);

            returnAttributes.forEach(function (attribute) {
                var div = pElmt.append("div").attr("class", "ppt-result-attribute-div");
                var attributeName = attribute;

                if (query.NEO4J_INTERNAL_ID === attribute) {
                    attributeName = query.NEO4J_INTERNAL_ID.queryInternalName;
                }

                var span = div.append("span");
                span.text(function () {
                    if (attribute === query.NEO4J_INTERNAL_ID) {
                        return "internal ID:"
                    } else {
                        return attribute + ":";
                    }
                });
                if (result.attributes[attributeName] !== undefined) {
                    div.append("span").text(function (result) {
                        return result.attributes[attributeName];
                    });
                }
            });
        }
    });

var queryviewer = {};

queryviewer.containerId = "popoto-query";
queryviewer.QUERY_STARTER = "I'm looking for";
queryviewer.CHOOSE_LABEL = "choose";

/**
 * Create the query viewer area.
 *
 */
queryviewer.createQueryArea = function () {
    var id = "#" + queryviewer.containerId;

    queryviewer.queryConstraintSpanElements = d3.select(id).append("p").attr("class", "ppt-query-constraint-elements").selectAll(".queryConstraintSpan");
    queryviewer.querySpanElements = d3.select(id).append("p").attr("class", "ppt-query-elements").selectAll(".querySpan");
};

/**
 * Update all the elements displayed on the query viewer based on current graph.
 */
queryviewer.updateQuery = function () {

    // Remove all query span elements
    queryviewer.queryConstraintSpanElements = queryviewer.queryConstraintSpanElements.data([]);
    queryviewer.querySpanElements = queryviewer.querySpanElements.data([]);

    queryviewer.queryConstraintSpanElements.exit().remove();
    queryviewer.querySpanElements.exit().remove();

    // Update data
    queryviewer.queryConstraintSpanElements = queryviewer.queryConstraintSpanElements.data(queryviewer.generateConstraintData(dataModel.links, dataModel.nodes));
    queryviewer.querySpanElements = queryviewer.querySpanElements.data(queryviewer.generateData(dataModel.links, dataModel.nodes));

    // Remove old span (not needed as all have been cleaned before)
    // queryviewer.querySpanElements.exit().remove();

    // Add new span
    queryviewer.queryConstraintSpanElements = queryviewer.queryConstraintSpanElements.enter().append("span")
        .on("contextmenu", queryviewer.rightClickSpan)
        .on("click", queryviewer.clickSpan)
        .on("mouseover", queryviewer.mouseOverSpan)
        .on("mouseout", queryviewer.mouseOutSpan)
        .merge(queryviewer.queryConstraintSpanElements);

    queryviewer.querySpanElements = queryviewer.querySpanElements.enter().append("span")
        .on("contextmenu", queryviewer.rightClickSpan)
        .on("click", queryviewer.clickSpan)
        .on("mouseover", queryviewer.mouseOverSpan)
        .on("mouseout", queryviewer.mouseOutSpan)
        .merge(queryviewer.querySpanElements);

    // Update all span
    queryviewer.queryConstraintSpanElements
        .attr("id", function (d) {
            return d.id
        })
        .attr("class", function (d) {
            if (d.isLink) {
                return "ppt-span-link";
            } else {
                if (d.type === graph.node.NodeTypes.ROOT) {
                    return "ppt-span-root";
                } else if (d.type === graph.node.NodeTypes.CHOOSE) {
                    if (d.ref.value !== undefined && d.ref.value.length > 0) {
                        return "ppt-span-value";
                    } else {
                        return "ppt-span-choose";
                    }
                } else if (d.type === graph.node.NodeTypes.VALUE) {
                    return "ppt-span-value";
                } else if (d.type === graph.node.NodeTypes.GROUP) {
                    return "ppt-span-group";
                } else {
                    return "ppt-span";
                }
            }
        })
        .text(function (d) {
            return d.term + " ";
        });

    queryviewer.querySpanElements
        .attr("id", function (d) {
            return d.id
        })
        .attr("class", function (d) {
            if (d.isLink) {
                return "ppt-span-link";
            } else {
                if (d.type === graph.node.NodeTypes.ROOT) {
                    return "ppt-span-root";
                } else if (d.type === graph.node.NodeTypes.CHOOSE) {
                    if (d.ref.value !== undefined && d.ref.value.length > 0) {
                        return "ppt-span-value";
                    } else {
                        return "ppt-span-choose";
                    }
                } else if (d.type === graph.node.NodeTypes.VALUE) {
                    return "ppt-span-value";
                } else if (d.type === graph.node.NodeTypes.GROUP) {
                    return "ppt-span-group";
                } else {
                    return "ppt-span";
                }
            }
        })
        .text(function (d) {
            return d.term + " ";
        });
};

queryviewer.generateConstraintData = function (links, nodes) {
    var elmts = [], id = 0;

    // Add query starter
    elmts.push(
        {id: id++, term: queryviewer.QUERY_STARTER}
    );

    // Add the root node as query term
    if (nodes.length > 0) {
        elmts.push(
            {id: id++, type: nodes[0].type, term: provider.node.getSemanticValue(nodes[0]), ref: nodes[0]}
        );
    }

    // Add a span for each link and its target node
    links.forEach(function (l) {

        var sourceNode = l.source;
        var targetNode = l.target;
        if (l.type === graph.link.LinkTypes.RELATION && targetNode.type !== graph.node.NodeTypes.GROUP && targetNode.value !== undefined && targetNode.value.length > 0) {
            if (sourceNode.type === graph.node.NodeTypes.GROUP) {
                elmts.push(
                    {
                        id: id++,
                        type: sourceNode.type,
                        term: provider.node.getSemanticValue(sourceNode),
                        ref: sourceNode
                    }
                );
            }

            elmts.push({id: id++, isLink: true, term: provider.link.getSemanticValue(l), ref: l});

            if (targetNode.type !== graph.node.NodeTypes.GROUP) {
                if (targetNode.value !== undefined && targetNode.value.length > 0) {
                    elmts.push(
                        {
                            id: id++,
                            type: targetNode.type,
                            term: provider.node.getSemanticValue(targetNode),
                            ref: targetNode
                        }
                    );
                } else {
                    elmts.push(
                        {
                            id: id++,
                            type: targetNode.type,
                            term: "<" + queryviewer.CHOOSE_LABEL + " " + provider.node.getSemanticValue(targetNode) + ">",
                            ref: targetNode
                        }
                    );
                }
            }
        }
    });

    return elmts;
};

// TODO add option nodes in generated query when no value is available
queryviewer.generateData = function (links, nodes) {
    var elmts = [], options = [], id = 0;

    // Add a span for each link and its target node
    links.forEach(function (l) {

        var sourceNode = l.source;
        var targetNode = l.target;

        if (targetNode.type === graph.node.NodeTypes.GROUP) {
            options.push(
                {
                    id: id++,
                    type: targetNode.type,
                    term: provider.node.getSemanticValue(targetNode),
                    ref: targetNode
                }
            );
        }

        if (l.type === graph.link.LinkTypes.RELATION && targetNode.type !== graph.node.NodeTypes.GROUP && (targetNode.value === undefined || targetNode.value.length === 0)) {
            if (sourceNode.type === graph.node.NodeTypes.GROUP) {
                elmts.push(
                    {
                        id: id++,
                        type: sourceNode.type,
                        term: provider.node.getSemanticValue(sourceNode),
                        ref: sourceNode
                    }
                );
            }

            elmts.push({id: id++, isLink: true, term: provider.link.getSemanticValue(l), ref: l});

            if (targetNode.type !== graph.node.NodeTypes.GROUP) {
                elmts.push(
                    {
                        id: id++,
                        type: targetNode.type,
                        term: "<" + queryviewer.CHOOSE_LABEL + " " + provider.node.getSemanticValue(targetNode) + ">",
                        ref: targetNode
                    }
                );
            }
        }
    });

    return elmts.concat(options);
};

/**
 *
 */
queryviewer.mouseOverSpan = function () {
    d3.select(this).classed("hover", function (d) {
        return d.ref;
    });

    var hoveredSpan = d3.select(this).data()[0];

    if (hoveredSpan.ref) {
        var linkElmt = graph.svg.selectAll("#" + graph.link.gID + " > g").filter(function (d) {
            return d === hoveredSpan.ref;
        });
        linkElmt.select("path").classed("ppt-link-hover", true);
        linkElmt.select("text").classed("ppt-link-hover", true);

        var nodeElmt = graph.svg.selectAll("#" + graph.node.gID + " > g").filter(function (d) {
            return d === hoveredSpan.ref;
        });

        nodeElmt.select(".ppt-g-node-background").selectAll("circle").transition().style("fill-opacity", 0.5);

        if (cypherviewer.isActive) {
            cypherviewer.querySpanElements.filter(function (d) {
                return d.node === hoveredSpan.ref || d.link === hoveredSpan.ref;
            }).classed("hover", true);
        }
    }
};

queryviewer.rightClickSpan = function () {
    var clickedSpan = d3.select(this).data()[0];

    if (!clickedSpan.isLink && clickedSpan.ref) {
        var nodeElmt = graph.svg.selectAll("#" + graph.node.gID + " > g").filter(function (d) {
            return d === clickedSpan.ref;
        });

        nodeElmt.on("contextmenu").call(nodeElmt.node(), clickedSpan.ref);
    }
};

queryviewer.clickSpan = function () {
    var clickedSpan = d3.select(this).data()[0];

    if (!clickedSpan.isLink && clickedSpan.ref) {
        var nodeElmt = graph.svg.selectAll("#" + graph.node.gID + " > g").filter(function (d) {
            return d === clickedSpan.ref;
        });

        nodeElmt.on("click").call(nodeElmt.node(), clickedSpan.ref);
    }
};

/**
 *
 */
queryviewer.mouseOutSpan = function () {
    d3.select(this).classed("hover", false);

    var hoveredSpan = d3.select(this).data()[0];

    if (hoveredSpan.ref) {
        var linkElmt = graph.svg.selectAll("#" + graph.link.gID + " > g").filter(function (d) {
            return d === hoveredSpan.ref;
        });
        linkElmt.select("path").classed("ppt-link-hover", false);
        linkElmt.select("text").classed("ppt-link-hover", false);

        var nodeElmt = graph.svg.selectAll("#" + graph.node.gID + " > g").filter(function (d) {
            return d === hoveredSpan.ref;
        });
        nodeElmt.select(".ppt-g-node-background").selectAll("circle").transition().style("fill-opacity", 0);

        if (cypherviewer.isActive) {
            cypherviewer.querySpanElements.filter(function (d) {
                return d.node === hoveredSpan.ref || d.link === hoveredSpan.ref;
            }).classed("hover", false);
        }
    }
};

var cypherviewer = {};
cypherviewer.containerId = "popoto-cypher";
cypherviewer.MATCH = "MATCH";
cypherviewer.RETURN = "RETURN";
cypherviewer.WHERE = "WHERE";
cypherviewer.QueryElementTypes = Object.freeze({
    KEYWORD: 0,
    NODE: 1,
    SEPARATOR: 2,
    SOURCE: 3,
    LINK: 4,
    TARGET: 5,
    RETURN: 6,
    WHERE: 7
});

/**
 * Create the Cypher viewer area.
 *
 */
cypherviewer.createQueryArea = function () {
    var id = "#" + cypherviewer.containerId;

    cypherviewer.querySpanElements = d3.select(id).append("p").attr("class", "ppt-query-constraint-elements").selectAll(".queryConstraintSpan");
};

/**
 * Update all the elements displayed on the cypher viewer based on current graph.
 */
cypherviewer.updateQuery = function () {

    // Remove all query span elements
    cypherviewer.querySpanElements = cypherviewer.querySpanElements.data([]);

    cypherviewer.querySpanElements.exit().remove();

    // Update data
    cypherviewer.querySpanElements = cypherviewer.querySpanElements.data(cypherviewer.generateData(dataModel.links, dataModel.nodes));

    // Remove old span (not needed as all have been cleaned before)
    // queryviewer.querySpanElements.exit().remove();

    // Add new span
    cypherviewer.querySpanElements = cypherviewer.querySpanElements.enter().append("span")
        .attr("id", function (d) {
            return "cypher-" + d.id;
        })
        .on("mouseover", cypherviewer.mouseOverSpan)
        .on("mouseout", cypherviewer.mouseOutSpan)
        .on("contextmenu", cypherviewer.rightClickSpan)
        .on("click", cypherviewer.clickSpan)
        .merge(cypherviewer.querySpanElements);

    // Update all spans:
    cypherviewer.querySpanElements.filter(function (d) {
        return d.type === cypherviewer.QueryElementTypes.KEYWORD;
    })
        .attr("class", "ppt-span")
        .text(function (d) {
            return " " + d.value + " ";
        });

    cypherviewer.querySpanElements.filter(function (d) {
        return d.type === cypherviewer.QueryElementTypes.SEPARATOR;
    })
        .attr("class", "ppt-span")
        .text(function (d) {
            return d.value + " ";
        });

    cypherviewer.querySpanElements.filter(function (d) {
        return d.type === cypherviewer.QueryElementTypes.NODE;
    })
        .attr("class", function (d) {
            if (d.node.value !== undefined && d.node.value.length > 0) {
                return "ppt-span-root-value";
            } else {
                return "ppt-span-root";
            }
        })
        .text(function (d) {
            return "(" + d.node.internalLabel + ":`" + d.node.label + "`)";
        });

    cypherviewer.querySpanElements.filter(function (d) {
        return d.type === cypherviewer.QueryElementTypes.SOURCE;
    })
        .attr("class", function (d) {
            if (d.node === dataModel.getRootNode()) {
                if (d.node.value !== undefined && d.node.value.length > 0) {
                    return "ppt-span-root-value";
                } else {
                    return "ppt-span-root";
                }
            } else {
                if (d.node.value !== undefined && d.node.value.length > 0) {
                    return "ppt-span-value";
                } else {
                    return "ppt-span-choose";
                }
            }
        })
        .text(function (d) {
            var sourceNode = d.node;
            return "(" + sourceNode.internalLabel + ":`" + sourceNode.label + "`)";
        });

    cypherviewer.querySpanElements.filter(function (d) {
        return d.type === cypherviewer.QueryElementTypes.LINK;
    })
        .attr("class", "ppt-span-link")
        .text(function (d) {
            if (d.link.target.isParentRelReverse === true) {
                return "<-[:`" + d.link.label + "`]-";
            } else {
                return "-[:`" + d.link.label + "`]-" + (query.USE_RELATION_DIRECTION ? ">" : "");
            }
        });

    cypherviewer.querySpanElements.filter(function (d) {
        return d.type === cypherviewer.QueryElementTypes.TARGET;
    })
        .attr("class", function (d) {
            if (d.node.value !== undefined && d.node.value.length > 0) {
                return "ppt-span-value";
            } else {
                return "ppt-span-choose";
            }
        })
        .text(function (d) {
            return "(" + d.node.internalLabel + ":`" + d.node.label + "`)";
        });

    cypherviewer.querySpanElements.filter(function (d) {
        return d.type === cypherviewer.QueryElementTypes.WHERE;
    })
        .attr("class", function (d) {
            if (d.node === dataModel.getRootNode()) {
                return "ppt-span-root-value";
            } else {
                return "ppt-span-value";
            }
        })
        .text(function (d) {
            var node = d.node;
            if (node.isNegative === true) {
                if (!node.hasOwnProperty("value") || node.value.length <= 0) {
                    return "(NOT (" + d.link.source.internalLabel + ":`" + d.link.source.label + "`)-[:`" + d.link.label + "`]->(:`" + d.link.target.label + "`))";
                } else {
                    var clauses = [];
                    var constAttr = provider.node.getConstraintAttribute(node.label);
                    node.value.forEach(function (value) {
                        clauses.push(
                            "(NOT (" + d.link.source.internalLabel + ":`" + d.link.source.label + "`)-[:`" + d.link.label + "`]->(:`" + d.link.target.label + "`{" + constAttr + ":" + value.attributes[constAttr] + "}))"
                        );
                    });

                    return clauses.join(" AND ");
                }
            } else {
                var constraintAttr = provider.node.getConstraintAttribute(node.label);

                var text = "";
                var separator = "";

                if (constraintAttr === query.NEO4J_INTERNAL_ID) {
                    text += node.internalLabel + ".id";
                } else {
                    text += node.internalLabel + "." + constraintAttr;
                }

                if (node.hasOwnProperty("value") && node.value.length > 1) {
                    text += " IN [";
                } else {
                    text += " = ";
                }

                node.value.forEach(function (value) {
                    text += separator;
                    separator = ", ";
                    if (constraintAttr === query.NEO4J_INTERNAL_ID) {
                        text += value.internalID;
                    } else {
                        var constraintValue = value.attributes[constraintAttr];
                        if (typeof constraintValue === "boolean" || typeof constraintValue === "number") {
                            text += constraintValue;
                        } else {
                            text += "\"" + constraintValue + "\"";
                        }
                    }
                });

                if (node.value.length > 1) {
                    text += "]";
                }

                return "(" + text + ")";
            }
        });

    cypherviewer.querySpanElements.filter(function (d) {
        return d.type === cypherviewer.QueryElementTypes.RETURN;
    })
        .attr("class", function (d) {
            if (d.node.value !== undefined && d.node.value.length > 0) {
                return "ppt-span-root-value";
            } else {
                return "ppt-span-root";
            }
        })
        .text(function (d) {
            return d.node.internalLabel;
        });

};

/**
 * Generate the data from graph to use in cypher query viewer.
 * The returned data is a list of elements representing the current query.
 * Example:
 *
 * MATCH
 * (person:`Person`),
 * (person:`Person`)-[:`FOLLOWS`]->(person1:`Person`{`name`:\"Jessica Thompson\"}),
 * (person1:`Person`)-[:`REVIEWED`]->(movie5:`Movie`{`title`:\"The Replacements\"})
 * RETURN person
 *
 * @param links
 * @returns {Array}
 */
cypherviewer.generateData = function (links) {
    var elmts = [], id = 0;
    var rootNode = dataModel.getRootNode();
    var relevantLinks = query.getRelevantLinks(rootNode, rootNode, links);
    var negativeLinks = relevantLinks.filter(function (rl) {
        return rl.target.isNegative === true && (!rl.target.hasOwnProperty("value") || rl.target.value.length <= 0)
    });

    elmts.push(
        {
            id: id++,
            type: cypherviewer.QueryElementTypes.KEYWORD,
            value: cypherviewer.MATCH
        }
    );

    if (rootNode) {
        elmts.push(
            {
                id: id++,
                type: cypherviewer.QueryElementTypes.NODE,
                node: rootNode
            }
        );
    }

    if (relevantLinks.length > 0 && relevantLinks.length > negativeLinks.length) {
        elmts.push(
            {
                id: id++,
                type: cypherviewer.QueryElementTypes.SEPARATOR,
                value: ","
            }
        );
    }

    for (var i = 0; i < relevantLinks.length; i++) {
        var relevantLink = relevantLinks[i];

        if (relevantLink.target.isNegative === true && (!relevantLink.target.hasOwnProperty("value") || relevantLink.target.value.length <= 0)) ; else {
            elmts.push(
                {
                    id: id++,
                    type: cypherviewer.QueryElementTypes.SOURCE,
                    node: relevantLink.source
                }
            );

            elmts.push(
                {
                    id: id++,
                    type: cypherviewer.QueryElementTypes.LINK,
                    link: relevantLink
                }
            );

            elmts.push(
                {
                    id: id++,
                    type: cypherviewer.QueryElementTypes.TARGET,
                    node: relevantLink.target
                }
            );

            // Add separator except for last element
            if (i < (relevantLinks.length - 1)) {
                elmts.push(
                    {
                        id: id++,
                        type: cypherviewer.QueryElementTypes.SEPARATOR,
                        value: ","
                    }
                );
            }
        }
    }

    if ((rootNode && rootNode.value !== undefined && rootNode.value.length > 0) || (relevantLinks.length > 0)) {
        elmts.push(
            {
                id: id++,
                type: cypherviewer.QueryElementTypes.KEYWORD,
                value: cypherviewer.WHERE
            }
        );
    }

    if (rootNode && rootNode.value !== undefined && rootNode.value.length > 0) {
        elmts.push(
            {
                id: id++,
                type: cypherviewer.QueryElementTypes.WHERE,
                node: rootNode
            }
        );

        if (relevantLinks.length > 0) {
            elmts.push(
                {
                    id: id++,
                    type: cypherviewer.QueryElementTypes.SEPARATOR,
                    value: " AND "
                }
            );
        }
    }

    var needSeparator = false;
    for (var i = 0; i < relevantLinks.length; i++) {
        var relevantLink = relevantLinks[i];
        if (relevantLink.target.isNegative === true) {
            if (needSeparator) {
                elmts.push(
                    {
                        id: id++,
                        type: cypherviewer.QueryElementTypes.SEPARATOR,
                        value: " AND "
                    }
                );
            }
            elmts.push(
                {
                    id: id++,
                    type: cypherviewer.QueryElementTypes.WHERE,
                    node: relevantLink.target,
                    link: relevantLink
                }
            );
            needSeparator = true;
        } else {
            if (relevantLink.target.value !== undefined && relevantLink.target.value.length > 0) {

                if (needSeparator) {
                    elmts.push(
                        {
                            id: id++,
                            type: cypherviewer.QueryElementTypes.SEPARATOR,
                            value: " AND "
                        }
                    );
                }

                elmts.push(
                    {
                        id: id++,
                        type: cypherviewer.QueryElementTypes.WHERE,
                        node: relevantLink.target
                    }
                );

                needSeparator = true;
            }
        }
    }

    elmts.push(
        {
            id: id++,
            type: cypherviewer.QueryElementTypes.KEYWORD,
            value: cypherviewer.RETURN
        }
    );

    if (rootNode) {
        elmts.push(
            {
                id: id++,
                type: cypherviewer.QueryElementTypes.RETURN,
                node: rootNode
            }
        );
    }

    return elmts;
};

/**
 *
 */
cypherviewer.mouseOverSpan = function () {
    var hoveredSpan = d3.select(this).data()[0];
    if (hoveredSpan.node) {
        // Hover all spans with same node data
        cypherviewer.querySpanElements.filter(function (d) {
            return d.node === hoveredSpan.node;
        }).classed("hover", true);

        // Highlight node in graph
        var nodeElmt = graph.svg.selectAll("#" + graph.node.gID + " > g").filter(function (d) {
            return d === hoveredSpan.node;
        });
        nodeElmt.select(".ppt-g-node-background").selectAll("circle").transition().style("fill-opacity", 0.5);

        // Highlight query viewer
        if (queryviewer.isActive) {
            queryviewer.queryConstraintSpanElements.filter(function (d) {
                return d.ref === hoveredSpan.node;
            }).classed("hover", true);

            queryviewer.querySpanElements.filter(function (d) {
                return d.ref === hoveredSpan.node;
            }).classed("hover", true);
        }
    } else if (hoveredSpan.link) {
        d3.select(this).classed("hover", true);

        // Highlight link in graph
        var linkElmt = graph.svg.selectAll("#" + graph.link.gID + " > g").filter(function (d) {
            return d === hoveredSpan.link;
        });
        linkElmt.select("path").classed("ppt-link-hover", true);
        linkElmt.select("text").classed("ppt-link-hover", true);
    }
};

cypherviewer.mouseOutSpan = function () {
    var hoveredSpan = d3.select(this).data()[0];
    if (hoveredSpan.node) {
        // Remove hover on all spans with same node data
        cypherviewer.querySpanElements.filter(function (d) {
            return d.node === hoveredSpan.node;
        }).classed("hover", false);

        // Remove highlight on node in graph
        var nodeElmt = graph.svg.selectAll("#" + graph.node.gID + " > g").filter(function (d) {
            return d === hoveredSpan.node;
        });
        nodeElmt.select(".ppt-g-node-background").selectAll("circle").transition().style("fill-opacity", 0);

        if (queryviewer.isActive) {
            queryviewer.queryConstraintSpanElements.filter(function (d) {
                return d.ref === hoveredSpan.node;
            }).classed("hover", false);

            queryviewer.querySpanElements.filter(function (d) {
                return d.ref === hoveredSpan.node;
            }).classed("hover", false);
        }
    } else if (hoveredSpan.link) {
        d3.select(this).classed("hover", false);

        // Remove highlight on link in graph
        var linkElmt = graph.svg.selectAll("#" + graph.link.gID + " > g").filter(function (d) {
            return d === hoveredSpan.link;
        });
        linkElmt.select("path").classed("ppt-link-hover", false);
        linkElmt.select("text").classed("ppt-link-hover", false);
    }
};

cypherviewer.clickSpan = function () {
    var clickedSpan = d3.select(this).data()[0];

    if (clickedSpan.node) {
        var nodeElmt = graph.svg.selectAll("#" + graph.node.gID + " > g").filter(function (d) {
            return d === clickedSpan.node;
        });

        nodeElmt.on("click").call(nodeElmt.node(), clickedSpan.node);
    }
};

cypherviewer.rightClickSpan = function () {
    var clickedSpan = d3.select(this).data()[0];

    if (clickedSpan.node) {
        var nodeElmt = graph.svg.selectAll("#" + graph.node.gID + " > g").filter(function (d) {
            return d === clickedSpan.node;
        });

        nodeElmt.on("contextmenu").call(nodeElmt.node(), clickedSpan.node);
    }
};

exports.version = version;
exports.cypherviewer = cypherviewer;
exports.dataModel = dataModel;
exports.graph = graph;
exports.logger = logger;
exports.provider = provider;
exports.query = query;
exports.queryviewer = queryviewer;
exports.rest = rest;
exports.result = result;
exports.taxonomy = taxonomy;
exports.tools = tools;
exports.start = start;
exports.update = update;
exports.updateGraph = updateGraph;
exports.appendFittedText = appendFittedText;

Object.defineProperty(exports, '__esModule', { value: true });

}));

;/*!
 * Materialize v0.100.2 (http://materializecss.com)
 * Copyright 2014-2017 Materialize
 * MIT License (https://raw.githubusercontent.com/Dogfalo/materialize/master/LICENSE)
 */
function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();"undefined"==typeof jQuery&&("function"==typeof require?jQuery=$=require("jquery"):jQuery=$),function(t){"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):"object"==typeof module&&"object"==typeof module.exports?exports=t(require("jquery")):t(jQuery)}(function(t){function e(t){var e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375}t.easing.jswing=t.easing.swing;var i=Math.pow,n=Math.sqrt,o=Math.sin,a=Math.cos,r=Math.PI,s=1.70158,l=1.525*s,c=2*r/3,u=2*r/4.5;t.extend(t.easing,{def:"easeOutQuad",swing:function(e){return t.easing[t.easing.def](e)},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return 1-(1-t)*(1-t)},easeInOutQuad:function(t){return t<.5?2*t*t:1-i(-2*t+2,2)/2},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1-i(1-t,3)},easeInOutCubic:function(t){return t<.5?4*t*t*t:1-i(-2*t+2,3)/2},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1-i(1-t,4)},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-i(-2*t+2,4)/2},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1-i(1-t,5)},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1-i(-2*t+2,5)/2},easeInSine:function(t){return 1-a(t*r/2)},easeOutSine:function(t){return o(t*r/2)},easeInOutSine:function(t){return-(a(r*t)-1)/2},easeInExpo:function(t){return 0===t?0:i(2,10*t-10)},easeOutExpo:function(t){return 1===t?1:1-i(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:t<.5?i(2,20*t-10)/2:(2-i(2,-20*t+10))/2},easeInCirc:function(t){return 1-n(1-i(t,2))},easeOutCirc:function(t){return n(1-i(t-1,2))},easeInOutCirc:function(t){return t<.5?(1-n(1-i(2*t,2)))/2:(n(1-i(-2*t+2,2))+1)/2},easeInElastic:function(t){return 0===t?0:1===t?1:-i(2,10*t-10)*o((10*t-10.75)*c)},easeOutElastic:function(t){return 0===t?0:1===t?1:i(2,-10*t)*o((10*t-.75)*c)+1},easeInOutElastic:function(t){return 0===t?0:1===t?1:t<.5?-i(2,20*t-10)*o((20*t-11.125)*u)/2:i(2,-20*t+10)*o((20*t-11.125)*u)/2+1},easeInBack:function(t){return 2.70158*t*t*t-s*t*t},easeOutBack:function(t){return 1+2.70158*i(t-1,3)+s*i(t-1,2)},easeInOutBack:function(t){return t<.5?i(2*t,2)*(7.189819*t-l)/2:(i(2*t-2,2)*((l+1)*(2*t-2)+l)+2)/2},easeInBounce:function(t){return 1-e(1-t)},easeOutBounce:e,easeInOutBounce:function(t){return t<.5?(1-e(1-2*t))/2:(1+e(2*t-1))/2}})}),jQuery.extend(jQuery.easing,{easeInOutMaterial:function(t,e,i,n,o){return(e/=o/2)<1?n/2*e*e+i:n/4*((e-=2)*e*e+2)+i}}),jQuery.Velocity?console.log("Velocity is already loaded. You may be needlessly importing Velocity again; note that Materialize includes Velocity."):(function(t){function e(t){var e=t.length,n=i.type(t);return"function"!==n&&!i.isWindow(t)&&(!(1!==t.nodeType||!e)||("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t))}if(!t.jQuery){var i=function(t,e){return new i.fn.init(t,e)};i.isWindow=function(t){return null!=t&&t==t.window},i.type=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?o[r.call(t)]||"object":typeof t},i.isArray=Array.isArray||function(t){return"array"===i.type(t)},i.isPlainObject=function(t){var e;if(!t||"object"!==i.type(t)||t.nodeType||i.isWindow(t))return!1;try{if(t.constructor&&!a.call(t,"constructor")&&!a.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(e in t);return void 0===e||a.call(t,e)},i.each=function(t,i,n){var o=0,a=t.length,r=e(t);if(n){if(r)for(;a>o&&!1!==i.apply(t[o],n);o++);else for(o in t)if(!1===i.apply(t[o],n))break}else if(r)for(;a>o&&!1!==i.call(t[o],o,t[o]);o++);else for(o in t)if(!1===i.call(t[o],o,t[o]))break;return t},i.data=function(t,e,o){if(void 0===o){var a=(r=t[i.expando])&&n[r];if(void 0===e)return a;if(a&&e in a)return a[e]}else if(void 0!==e){var r=t[i.expando]||(t[i.expando]=++i.uuid);return n[r]=n[r]||{},n[r][e]=o,o}},i.removeData=function(t,e){var o=t[i.expando],a=o&&n[o];a&&i.each(e,function(t,e){delete a[e]})},i.extend=function(){var t,e,n,o,a,r,s=arguments[0]||{},l=1,c=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[l]||{},l++),"object"!=typeof s&&"function"!==i.type(s)&&(s={}),l===c&&(s=this,l--);c>l;l++)if(null!=(a=arguments[l]))for(o in a)t=s[o],s!==(n=a[o])&&(u&&n&&(i.isPlainObject(n)||(e=i.isArray(n)))?(e?(e=!1,r=t&&i.isArray(t)?t:[]):r=t&&i.isPlainObject(t)?t:{},s[o]=i.extend(u,r,n)):void 0!==n&&(s[o]=n));return s},i.queue=function(t,n,o){if(t){n=(n||"fx")+"queue";var a=i.data(t,n);return o?(!a||i.isArray(o)?a=i.data(t,n,function(t,i){var n=i||[];return null!=t&&(e(Object(t))?function(t,e){for(var i=+e.length,n=0,o=t.length;i>n;)t[o++]=e[n++];if(i!==i)for(;void 0!==e[n];)t[o++]=e[n++];t.length=o}(n,"string"==typeof t?[t]:t):[].push.call(n,t)),n}(o)):a.push(o),a):a||[]}},i.dequeue=function(t,e){i.each(t.nodeType?[t]:t,function(t,n){e=e||"fx";var o=i.queue(n,e),a=o.shift();"inprogress"===a&&(a=o.shift()),a&&("fx"===e&&o.unshift("inprogress"),a.call(n,function(){i.dequeue(n,e)}))})},i.fn=i.prototype={init:function(t){if(t.nodeType)return this[0]=t,this;throw new Error("Not a DOM node.")},offset:function(){var e=this[0].getBoundingClientRect?this[0].getBoundingClientRect():{top:0,left:0};return{top:e.top+(t.pageYOffset||document.scrollTop||0)-(document.clientTop||0),left:e.left+(t.pageXOffset||document.scrollLeft||0)-(document.clientLeft||0)}},position:function(){function t(){for(var t=this.offsetParent||document;t&&"html"===!t.nodeType.toLowerCase&&"static"===t.style.position;)t=t.offsetParent;return t||document}var e=this[0],t=t.apply(e),n=this.offset(),o=/^(?:body|html)$/i.test(t.nodeName)?{top:0,left:0}:i(t).offset();return n.top-=parseFloat(e.style.marginTop)||0,n.left-=parseFloat(e.style.marginLeft)||0,t.style&&(o.top+=parseFloat(t.style.borderTopWidth)||0,o.left+=parseFloat(t.style.borderLeftWidth)||0),{top:n.top-o.top,left:n.left-o.left}}};var n={};i.expando="velocity"+(new Date).getTime(),i.uuid=0;for(var o={},a=o.hasOwnProperty,r=o.toString,s="Boolean Number String Function Array Date RegExp Object Error".split(" "),l=0;l<s.length;l++)o["[object "+s[l]+"]"]=s[l].toLowerCase();i.fn.init.prototype=i.fn,t.Velocity={Utilities:i}}}(window),function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t():"function"==typeof define&&define.amd?define(t):t()}(function(){return function(t,e,i,n){function o(t){for(var e=-1,i=t?t.length:0,n=[];++e<i;){var o=t[e];o&&n.push(o)}return n}function a(t){return v.isWrapped(t)?t=[].slice.call(t):v.isNode(t)&&(t=[t]),t}function r(t){var e=p.data(t,"velocity");return null===e?n:e}function s(t){return function(e){return Math.round(e*t)*(1/t)}}function l(t,i,n,o){function a(t,e){return 1-3*e+3*t}function r(t,e){return 3*e-6*t}function s(t){return 3*t}function l(t,e,i){return((a(e,i)*t+r(e,i))*t+s(e))*t}function c(t,e,i){return 3*a(e,i)*t*t+2*r(e,i)*t+s(e)}function u(e,i){for(var o=0;v>o;++o){var a=c(i,t,n);if(0===a)return i;i-=(l(i,t,n)-e)/a}return i}function d(){for(var e=0;b>e;++e)C[e]=l(e*w,t,n)}function p(e,i,o){var a,r,s=0;do{(a=l(r=i+(o-i)/2,t,n)-e)>0?o=r:i=r}while(Math.abs(a)>g&&++s<y);return r}function h(e){for(var i=0,o=1,a=b-1;o!=a&&C[o]<=e;++o)i+=w;var r=i+(e-C[--o])/(C[o+1]-C[o])*w,s=c(r,t,n);return s>=m?u(e,r):0==s?r:p(e,i,i+w)}function f(){T=!0,(t!=i||n!=o)&&d()}var v=4,m=.001,g=1e-7,y=10,b=11,w=1/(b-1),k="Float32Array"in e;if(4!==arguments.length)return!1;for(var x=0;4>x;++x)if("number"!=typeof arguments[x]||isNaN(arguments[x])||!isFinite(arguments[x]))return!1;t=Math.min(t,1),n=Math.min(n,1),t=Math.max(t,0),n=Math.max(n,0);var C=k?new Float32Array(b):new Array(b),T=!1,S=function(e){return T||f(),t===i&&n===o?e:0===e?0:1===e?1:l(h(e),i,o)};S.getControlPoints=function(){return[{x:t,y:i},{x:n,y:o}]};var P="generateBezier("+[t,i,n,o]+")";return S.toString=function(){return P},S}function c(t,e){var i=t;return v.isString(t)?b.Easings[t]||(i=!1):i=v.isArray(t)&&1===t.length?s.apply(null,t):v.isArray(t)&&2===t.length?w.apply(null,t.concat([e])):!(!v.isArray(t)||4!==t.length)&&l.apply(null,t),!1===i&&(i=b.Easings[b.defaults.easing]?b.defaults.easing:y),i}function u(t){if(t){var e=(new Date).getTime(),i=b.State.calls.length;i>1e4&&(b.State.calls=o(b.State.calls));for(var a=0;i>a;a++)if(b.State.calls[a]){var s=b.State.calls[a],l=s[0],c=s[2],h=s[3],f=!!h,m=null;h||(h=b.State.calls[a][3]=e-16);for(var g=Math.min((e-h)/c.duration,1),y=0,w=l.length;w>y;y++){var x=l[y],T=x.element;if(r(T)){var S=!1;if(c.display!==n&&null!==c.display&&"none"!==c.display){if("flex"===c.display){var P=["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex"];p.each(P,function(t,e){k.setPropertyValue(T,"display",e)})}k.setPropertyValue(T,"display",c.display)}c.visibility!==n&&"hidden"!==c.visibility&&k.setPropertyValue(T,"visibility",c.visibility);for(var A in x)if("element"!==A){var O,E=x[A],_=v.isString(E.easing)?b.Easings[E.easing]:E.easing;if(1===g)O=E.endValue;else{var M=E.endValue-E.startValue;if(O=E.startValue+M*_(g,c,M),!f&&O===E.currentValue)continue}if(E.currentValue=O,"tween"===A)m=O;else{if(k.Hooks.registered[A]){var I=k.Hooks.getRoot(A),D=r(T).rootPropertyValueCache[I];D&&(E.rootPropertyValue=D)}var q=k.setPropertyValue(T,A,E.currentValue+(0===parseFloat(O)?"":E.unitType),E.rootPropertyValue,E.scrollData);k.Hooks.registered[A]&&(r(T).rootPropertyValueCache[I]=k.Normalizations.registered[I]?k.Normalizations.registered[I]("extract",null,q[1]):q[1]),"transform"===q[0]&&(S=!0)}}c.mobileHA&&r(T).transformCache.translate3d===n&&(r(T).transformCache.translate3d="(0px, 0px, 0px)",S=!0),S&&k.flushTransformCache(T)}}c.display!==n&&"none"!==c.display&&(b.State.calls[a][2].display=!1),c.visibility!==n&&"hidden"!==c.visibility&&(b.State.calls[a][2].visibility=!1),c.progress&&c.progress.call(s[1],s[1],g,Math.max(0,h+c.duration-e),h,m),1===g&&d(a)}}b.State.isTicking&&C(u)}function d(t,e){if(!b.State.calls[t])return!1;for(var i=b.State.calls[t][0],o=b.State.calls[t][1],a=b.State.calls[t][2],s=b.State.calls[t][4],l=!1,c=0,u=i.length;u>c;c++){var d=i[c].element;if(e||a.loop||("none"===a.display&&k.setPropertyValue(d,"display",a.display),"hidden"===a.visibility&&k.setPropertyValue(d,"visibility",a.visibility)),!0!==a.loop&&(p.queue(d)[1]===n||!/\.velocityQueueEntryFlag/i.test(p.queue(d)[1]))&&r(d)){r(d).isAnimating=!1,r(d).rootPropertyValueCache={};var h=!1;p.each(k.Lists.transforms3D,function(t,e){var i=/^scale/.test(e)?1:0,o=r(d).transformCache[e];r(d).transformCache[e]!==n&&new RegExp("^\\("+i+"[^.]").test(o)&&(h=!0,delete r(d).transformCache[e])}),a.mobileHA&&(h=!0,delete r(d).transformCache.translate3d),h&&k.flushTransformCache(d),k.Values.removeClass(d,"velocity-animating")}if(!e&&a.complete&&!a.loop&&c===u-1)try{a.complete.call(o,o)}catch(t){setTimeout(function(){throw t},1)}s&&!0!==a.loop&&s(o),r(d)&&!0===a.loop&&!e&&(p.each(r(d).tweensContainer,function(t,e){/^rotate/.test(t)&&360===parseFloat(e.endValue)&&(e.endValue=0,e.startValue=360),/^backgroundPosition/.test(t)&&100===parseFloat(e.endValue)&&"%"===e.unitType&&(e.endValue=0,e.startValue=100)}),b(d,"reverse",{loop:!0,delay:a.delay})),!1!==a.queue&&p.dequeue(d,a.queue)}b.State.calls[t]=!1;for(var f=0,v=b.State.calls.length;v>f;f++)if(!1!==b.State.calls[f]){l=!0;break}!1===l&&(b.State.isTicking=!1,delete b.State.calls,b.State.calls=[])}var p,h=function(){if(i.documentMode)return i.documentMode;for(var t=7;t>4;t--){var e=i.createElement("div");if(e.innerHTML="\x3c!--[if IE "+t+"]><span></span><![endif]--\x3e",e.getElementsByTagName("span").length)return e=null,t}return n}(),f=function(){var t=0;return e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||function(e){var i,n=(new Date).getTime();return i=Math.max(0,16-(n-t)),t=n+i,setTimeout(function(){e(n+i)},i)}}(),v={isString:function(t){return"string"==typeof t},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},isNode:function(t){return t&&t.nodeType},isNodeList:function(t){return"object"==typeof t&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(Object.prototype.toString.call(t))&&t.length!==n&&(0===t.length||"object"==typeof t[0]&&t[0].nodeType>0)},isWrapped:function(t){return t&&(t.jquery||e.Zepto&&e.Zepto.zepto.isZ(t))},isSVG:function(t){return e.SVGElement&&t instanceof e.SVGElement},isEmptyObject:function(t){for(var e in t)return!1;return!0}},m=!1;if(t.fn&&t.fn.jquery?(p=t,m=!0):p=e.Velocity.Utilities,8>=h&&!m)throw new Error("Velocity: IE8 and below require jQuery to be loaded before Velocity.");{if(!(7>=h)){var g=400,y="swing",b={State:{isMobile:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),isAndroid:/Android/i.test(navigator.userAgent),isGingerbread:/Android 2\.3\.[3-7]/i.test(navigator.userAgent),isChrome:e.chrome,isFirefox:/Firefox/i.test(navigator.userAgent),prefixElement:i.createElement("div"),prefixMatches:{},scrollAnchor:null,scrollPropertyLeft:null,scrollPropertyTop:null,isTicking:!1,calls:[]},CSS:{},Utilities:p,Redirects:{},Easings:{},Promise:e.Promise,defaults:{queue:"",duration:g,easing:y,begin:n,complete:n,progress:n,display:n,visibility:n,loop:!1,delay:!1,mobileHA:!0,_cacheValues:!0},init:function(t){p.data(t,"velocity",{isSVG:v.isSVG(t),isAnimating:!1,computedStyle:null,tweensContainer:null,rootPropertyValueCache:{},transformCache:{}})},hook:null,mock:!1,version:{major:1,minor:2,patch:2},debug:!1};e.pageYOffset!==n?(b.State.scrollAnchor=e,b.State.scrollPropertyLeft="pageXOffset",b.State.scrollPropertyTop="pageYOffset"):(b.State.scrollAnchor=i.documentElement||i.body.parentNode||i.body,b.State.scrollPropertyLeft="scrollLeft",b.State.scrollPropertyTop="scrollTop");var w=function(){function t(t){return-t.tension*t.x-t.friction*t.v}function e(e,i,n){var o={x:e.x+n.dx*i,v:e.v+n.dv*i,tension:e.tension,friction:e.friction};return{dx:o.v,dv:t(o)}}function i(i,n){var o={dx:i.v,dv:t(i)},a=e(i,.5*n,o),r=e(i,.5*n,a),s=e(i,n,r),l=1/6*(o.dx+2*(a.dx+r.dx)+s.dx),c=1/6*(o.dv+2*(a.dv+r.dv)+s.dv);return i.x=i.x+l*n,i.v=i.v+c*n,i}return function t(e,n,o){var a,r,s,l={x:-1,v:0,tension:null,friction:null},c=[0],u=0;for(e=parseFloat(e)||500,n=parseFloat(n)||20,o=o||null,l.tension=e,l.friction=n,(a=null!==o)?(u=t(e,n),r=u/o*.016):r=.016;s=i(s||l,r),c.push(1+s.x),u+=16,Math.abs(s.x)>1e-4&&Math.abs(s.v)>1e-4;);return a?function(t){return c[t*(c.length-1)|0]}:u}}();b.Easings={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},spring:function(t){return 1-Math.cos(4.5*t*Math.PI)*Math.exp(6*-t)}},p.each([["ease",[.25,.1,.25,1]],["ease-in",[.42,0,1,1]],["ease-out",[0,0,.58,1]],["ease-in-out",[.42,0,.58,1]],["easeInSine",[.47,0,.745,.715]],["easeOutSine",[.39,.575,.565,1]],["easeInOutSine",[.445,.05,.55,.95]],["easeInQuad",[.55,.085,.68,.53]],["easeOutQuad",[.25,.46,.45,.94]],["easeInOutQuad",[.455,.03,.515,.955]],["easeInCubic",[.55,.055,.675,.19]],["easeOutCubic",[.215,.61,.355,1]],["easeInOutCubic",[.645,.045,.355,1]],["easeInQuart",[.895,.03,.685,.22]],["easeOutQuart",[.165,.84,.44,1]],["easeInOutQuart",[.77,0,.175,1]],["easeInQuint",[.755,.05,.855,.06]],["easeOutQuint",[.23,1,.32,1]],["easeInOutQuint",[.86,0,.07,1]],["easeInExpo",[.95,.05,.795,.035]],["easeOutExpo",[.19,1,.22,1]],["easeInOutExpo",[1,0,0,1]],["easeInCirc",[.6,.04,.98,.335]],["easeOutCirc",[.075,.82,.165,1]],["easeInOutCirc",[.785,.135,.15,.86]]],function(t,e){b.Easings[e[0]]=l.apply(null,e[1])});var k=b.CSS={RegEx:{isHex:/^#([A-f\d]{3}){1,2}$/i,valueUnwrap:/^[A-z]+\((.*)\)$/i,wrappedValueAlreadyExtracted:/[0-9.]+ [0-9.]+ [0-9.]+( [0-9.]+)?/,valueSplit:/([A-z]+\(.+\))|(([A-z0-9#-.]+?)(?=\s|$))/gi},Lists:{colors:["fill","stroke","stopColor","color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor"],transformsBase:["translateX","translateY","scale","scaleX","scaleY","skewX","skewY","rotateZ"],transforms3D:["transformPerspective","translateZ","scaleZ","rotateX","rotateY"]},Hooks:{templates:{textShadow:["Color X Y Blur","black 0px 0px 0px"],boxShadow:["Color X Y Blur Spread","black 0px 0px 0px 0px"],clip:["Top Right Bottom Left","0px 0px 0px 0px"],backgroundPosition:["X Y","0% 0%"],transformOrigin:["X Y Z","50% 50% 0px"],perspectiveOrigin:["X Y","50% 50%"]},registered:{},register:function(){for(a=0;a<k.Lists.colors.length;a++){var t="color"===k.Lists.colors[a]?"0 0 0 1":"255 255 255 1";k.Hooks.templates[k.Lists.colors[a]]=["Red Green Blue Alpha",t]}var e,i,n;if(h)for(e in k.Hooks.templates){n=(i=k.Hooks.templates[e])[0].split(" ");var o=i[1].match(k.RegEx.valueSplit);"Color"===n[0]&&(n.push(n.shift()),o.push(o.shift()),k.Hooks.templates[e]=[n.join(" "),o.join(" ")])}for(e in k.Hooks.templates){n=(i=k.Hooks.templates[e])[0].split(" ");for(var a in n){var r=e+n[a],s=a;k.Hooks.registered[r]=[e,s]}}},getRoot:function(t){var e=k.Hooks.registered[t];return e?e[0]:t},cleanRootPropertyValue:function(t,e){return k.RegEx.valueUnwrap.test(e)&&(e=e.match(k.RegEx.valueUnwrap)[1]),k.Values.isCSSNullValue(e)&&(e=k.Hooks.templates[t][1]),e},extractValue:function(t,e){var i=k.Hooks.registered[t];if(i){var n=i[0],o=i[1];return(e=k.Hooks.cleanRootPropertyValue(n,e)).toString().match(k.RegEx.valueSplit)[o]}return e},injectValue:function(t,e,i){var n=k.Hooks.registered[t];if(n){var o,a=n[0],r=n[1];return i=k.Hooks.cleanRootPropertyValue(a,i),o=i.toString().match(k.RegEx.valueSplit),o[r]=e,o.join(" ")}return i}},Normalizations:{registered:{clip:function(t,e,i){switch(t){case"name":return"clip";case"extract":var n;return k.RegEx.wrappedValueAlreadyExtracted.test(i)?n=i:(n=i.toString().match(k.RegEx.valueUnwrap),n=n?n[1].replace(/,(\s+)?/g," "):i),n;case"inject":return"rect("+i+")"}},blur:function(t,e,i){switch(t){case"name":return b.State.isFirefox?"filter":"-webkit-filter";case"extract":var n=parseFloat(i);if(!n&&0!==n){var o=i.toString().match(/blur\(([0-9]+[A-z]+)\)/i);n=o?o[1]:0}return n;case"inject":return parseFloat(i)?"blur("+i+")":"none"}},opacity:function(t,e,i){if(8>=h)switch(t){case"name":return"filter";case"extract":var n=i.toString().match(/alpha\(opacity=(.*)\)/i);return i=n?n[1]/100:1;case"inject":return e.style.zoom=1,parseFloat(i)>=1?"":"alpha(opacity="+parseInt(100*parseFloat(i),10)+")"}else switch(t){case"name":return"opacity";case"extract":case"inject":return i}}},register:function(){9>=h||b.State.isGingerbread||(k.Lists.transformsBase=k.Lists.transformsBase.concat(k.Lists.transforms3D));for(t=0;t<k.Lists.transformsBase.length;t++)!function(){var e=k.Lists.transformsBase[t];k.Normalizations.registered[e]=function(t,i,o){switch(t){case"name":return"transform";case"extract":return r(i)===n||r(i).transformCache[e]===n?/^scale/i.test(e)?1:0:r(i).transformCache[e].replace(/[()]/g,"");case"inject":var a=!1;switch(e.substr(0,e.length-1)){case"translate":a=!/(%|px|em|rem|vw|vh|\d)$/i.test(o);break;case"scal":case"scale":b.State.isAndroid&&r(i).transformCache[e]===n&&1>o&&(o=1),a=!/(\d)$/i.test(o);break;case"skew":a=!/(deg|\d)$/i.test(o);break;case"rotate":a=!/(deg|\d)$/i.test(o)}return a||(r(i).transformCache[e]="("+o+")"),r(i).transformCache[e]}}}();for(var t=0;t<k.Lists.colors.length;t++)!function(){var e=k.Lists.colors[t];k.Normalizations.registered[e]=function(t,i,o){switch(t){case"name":return e;case"extract":var a;if(k.RegEx.wrappedValueAlreadyExtracted.test(o))a=o;else{var r,s={black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",gray:"rgb(128, 128, 128)",green:"rgb(0, 128, 0)",red:"rgb(255, 0, 0)",white:"rgb(255, 255, 255)"};/^[A-z]+$/i.test(o)?r=s[o]!==n?s[o]:s.black:k.RegEx.isHex.test(o)?r="rgb("+k.Values.hexToRgb(o).join(" ")+")":/^rgba?\(/i.test(o)||(r=s.black),a=(r||o).toString().match(k.RegEx.valueUnwrap)[1].replace(/,(\s+)?/g," ")}return 8>=h||3!==a.split(" ").length||(a+=" 1"),a;case"inject":return 8>=h?4===o.split(" ").length&&(o=o.split(/\s+/).slice(0,3).join(" ")):3===o.split(" ").length&&(o+=" 1"),(8>=h?"rgb":"rgba")+"("+o.replace(/\s+/g,",").replace(/\.(\d)+(?=,)/g,"")+")"}}}()}},Names:{camelCase:function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})},SVGAttribute:function(t){var e="width|height|x|y|cx|cy|r|rx|ry|x1|x2|y1|y2";return(h||b.State.isAndroid&&!b.State.isChrome)&&(e+="|transform"),new RegExp("^("+e+")$","i").test(t)},prefixCheck:function(t){if(b.State.prefixMatches[t])return[b.State.prefixMatches[t],!0];for(var e=["","Webkit","Moz","ms","O"],i=0,n=e.length;n>i;i++){var o;if(o=0===i?t:e[i]+t.replace(/^\w/,function(t){return t.toUpperCase()}),v.isString(b.State.prefixElement.style[o]))return b.State.prefixMatches[t]=o,[o,!0]}return[t,!1]}},Values:{hexToRgb:function(t){var e,i=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;return t=t.replace(i,function(t,e,i,n){return e+e+i+i+n+n}),e=n.exec(t),e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:[0,0,0]},isCSSNullValue:function(t){return 0==t||/^(none|auto|transparent|(rgba\(0, ?0, ?0, ?0\)))$/i.test(t)},getUnitType:function(t){return/^(rotate|skew)/i.test(t)?"deg":/(^(scale|scaleX|scaleY|scaleZ|alpha|flexGrow|flexHeight|zIndex|fontWeight)$)|((opacity|red|green|blue|alpha)$)/i.test(t)?"":"px"},getDisplayType:function(t){var e=t&&t.tagName.toString().toLowerCase();return/^(b|big|i|small|tt|abbr|acronym|cite|code|dfn|em|kbd|strong|samp|var|a|bdo|br|img|map|object|q|script|span|sub|sup|button|input|label|select|textarea)$/i.test(e)?"inline":/^(li)$/i.test(e)?"list-item":/^(tr)$/i.test(e)?"table-row":/^(table)$/i.test(e)?"table":/^(tbody)$/i.test(e)?"table-row-group":"block"},addClass:function(t,e){t.classList?t.classList.add(e):t.className+=(t.className.length?" ":"")+e},removeClass:function(t,e){t.classList?t.classList.remove(e):t.className=t.className.toString().replace(new RegExp("(^|\\s)"+e.split(" ").join("|")+"(\\s|$)","gi")," ")}},getPropertyValue:function(t,i,o,a){function s(t,i){function o(){c&&k.setPropertyValue(t,"display","none")}var l=0;if(8>=h)l=p.css(t,i);else{var c=!1;if(/^(width|height)$/.test(i)&&0===k.getPropertyValue(t,"display")&&(c=!0,k.setPropertyValue(t,"display",k.Values.getDisplayType(t))),!a){if("height"===i&&"border-box"!==k.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var u=t.offsetHeight-(parseFloat(k.getPropertyValue(t,"borderTopWidth"))||0)-(parseFloat(k.getPropertyValue(t,"borderBottomWidth"))||0)-(parseFloat(k.getPropertyValue(t,"paddingTop"))||0)-(parseFloat(k.getPropertyValue(t,"paddingBottom"))||0);return o(),u}if("width"===i&&"border-box"!==k.getPropertyValue(t,"boxSizing").toString().toLowerCase()){var d=t.offsetWidth-(parseFloat(k.getPropertyValue(t,"borderLeftWidth"))||0)-(parseFloat(k.getPropertyValue(t,"borderRightWidth"))||0)-(parseFloat(k.getPropertyValue(t,"paddingLeft"))||0)-(parseFloat(k.getPropertyValue(t,"paddingRight"))||0);return o(),d}}var f;f=r(t)===n?e.getComputedStyle(t,null):r(t).computedStyle?r(t).computedStyle:r(t).computedStyle=e.getComputedStyle(t,null),"borderColor"===i&&(i="borderTopColor"),(""===(l=9===h&&"filter"===i?f.getPropertyValue(i):f[i])||null===l)&&(l=t.style[i]),o()}if("auto"===l&&/^(top|right|bottom|left)$/i.test(i)){var v=s(t,"position");("fixed"===v||"absolute"===v&&/top|left/i.test(i))&&(l=p(t).position()[i]+"px")}return l}var l;if(k.Hooks.registered[i]){var c=i,u=k.Hooks.getRoot(c);o===n&&(o=k.getPropertyValue(t,k.Names.prefixCheck(u)[0])),k.Normalizations.registered[u]&&(o=k.Normalizations.registered[u]("extract",t,o)),l=k.Hooks.extractValue(c,o)}else if(k.Normalizations.registered[i]){var d,f;"transform"!==(d=k.Normalizations.registered[i]("name",t))&&(f=s(t,k.Names.prefixCheck(d)[0]),k.Values.isCSSNullValue(f)&&k.Hooks.templates[i]&&(f=k.Hooks.templates[i][1])),l=k.Normalizations.registered[i]("extract",t,f)}if(!/^[\d-]/.test(l))if(r(t)&&r(t).isSVG&&k.Names.SVGAttribute(i))if(/^(height|width)$/i.test(i))try{l=t.getBBox()[i]}catch(t){l=0}else l=t.getAttribute(i);else l=s(t,k.Names.prefixCheck(i)[0]);return k.Values.isCSSNullValue(l)&&(l=0),b.debug>=2&&console.log("Get "+i+": "+l),l},setPropertyValue:function(t,i,n,o,a){var s=i;if("scroll"===i)a.container?a.container["scroll"+a.direction]=n:"Left"===a.direction?e.scrollTo(n,a.alternateValue):e.scrollTo(a.alternateValue,n);else if(k.Normalizations.registered[i]&&"transform"===k.Normalizations.registered[i]("name",t))k.Normalizations.registered[i]("inject",t,n),s="transform",n=r(t).transformCache[i];else{if(k.Hooks.registered[i]){var l=i,c=k.Hooks.getRoot(i);o=o||k.getPropertyValue(t,c),n=k.Hooks.injectValue(l,n,o),i=c}if(k.Normalizations.registered[i]&&(n=k.Normalizations.registered[i]("inject",t,n),i=k.Normalizations.registered[i]("name",t)),s=k.Names.prefixCheck(i)[0],8>=h)try{t.style[s]=n}catch(t){b.debug&&console.log("Browser does not support ["+n+"] for ["+s+"]")}else r(t)&&r(t).isSVG&&k.Names.SVGAttribute(i)?t.setAttribute(i,n):t.style[s]=n;b.debug>=2&&console.log("Set "+i+" ("+s+"): "+n)}return[s,n]},flushTransformCache:function(t){function e(e){return parseFloat(k.getPropertyValue(t,e))}var i="";if((h||b.State.isAndroid&&!b.State.isChrome)&&r(t).isSVG){var n={translate:[e("translateX"),e("translateY")],skewX:[e("skewX")],skewY:[e("skewY")],scale:1!==e("scale")?[e("scale"),e("scale")]:[e("scaleX"),e("scaleY")],rotate:[e("rotateZ"),0,0]};p.each(r(t).transformCache,function(t){/^translate/i.test(t)?t="translate":/^scale/i.test(t)?t="scale":/^rotate/i.test(t)&&(t="rotate"),n[t]&&(i+=t+"("+n[t].join(" ")+") ",delete n[t])})}else{var o,a;p.each(r(t).transformCache,function(e){return o=r(t).transformCache[e],"transformPerspective"===e?(a=o,!0):(9===h&&"rotateZ"===e&&(e="rotate"),void(i+=e+o+" "))}),a&&(i="perspective"+a+" "+i)}k.setPropertyValue(t,"transform",i)}};k.Hooks.register(),k.Normalizations.register(),b.hook=function(t,e,i){var o=n;return t=a(t),p.each(t,function(t,a){if(r(a)===n&&b.init(a),i===n)o===n&&(o=b.CSS.getPropertyValue(a,e));else{var s=b.CSS.setPropertyValue(a,e,i);"transform"===s[0]&&b.CSS.flushTransformCache(a),o=s}}),o};var x=function(){function t(){return s?P.promise||null:l}function o(){function t(t){function d(t,e){var i=n,o=n,r=n;return v.isArray(t)?(i=t[0],!v.isArray(t[1])&&/^[\d-]/.test(t[1])||v.isFunction(t[1])||k.RegEx.isHex.test(t[1])?r=t[1]:(v.isString(t[1])&&!k.RegEx.isHex.test(t[1])||v.isArray(t[1]))&&(o=e?t[1]:c(t[1],s.duration),t[2]!==n&&(r=t[2]))):i=t,e||(o=o||s.easing),v.isFunction(i)&&(i=i.call(a,T,C)),v.isFunction(r)&&(r=r.call(a,T,C)),[i||0,o,r]}function h(t,e){var i,n;return n=(e||"0").toString().toLowerCase().replace(/[%A-z]+$/,function(t){return i=t,""}),i||(i=k.Values.getUnitType(t)),[n,i]}if(s.begin&&0===T)try{s.begin.call(f,f)}catch(t){setTimeout(function(){throw t},1)}if("scroll"===A){var g,w,x,S=/^x$/i.test(s.axis)?"Left":"Top",O=parseFloat(s.offset)||0;s.container?v.isWrapped(s.container)||v.isNode(s.container)?(s.container=s.container[0]||s.container,g=s.container["scroll"+S],x=g+p(a).position()[S.toLowerCase()]+O):s.container=null:(g=b.State.scrollAnchor[b.State["scrollProperty"+S]],w=b.State.scrollAnchor[b.State["scrollProperty"+("Left"===S?"Top":"Left")]],x=p(a).offset()[S.toLowerCase()]+O),l={scroll:{rootPropertyValue:!1,startValue:g,currentValue:g,endValue:x,unitType:"",easing:s.easing,scrollData:{container:s.container,direction:S,alternateValue:w}},element:a},b.debug&&console.log("tweensContainer (scroll): ",l.scroll,a)}else if("reverse"===A){if(!r(a).tweensContainer)return void p.dequeue(a,s.queue);"none"===r(a).opts.display&&(r(a).opts.display="auto"),"hidden"===r(a).opts.visibility&&(r(a).opts.visibility="visible"),r(a).opts.loop=!1,r(a).opts.begin=null,r(a).opts.complete=null,y.easing||delete s.easing,y.duration||delete s.duration,s=p.extend({},r(a).opts,s);M=p.extend(!0,{},r(a).tweensContainer);for(var E in M)if("element"!==E){var _=M[E].startValue;M[E].startValue=M[E].currentValue=M[E].endValue,M[E].endValue=_,v.isEmptyObject(y)||(M[E].easing=s.easing),b.debug&&console.log("reverse tweensContainer ("+E+"): "+JSON.stringify(M[E]),a)}l=M}else if("start"===A){var M;r(a).tweensContainer&&!0===r(a).isAnimating&&(M=r(a).tweensContainer),p.each(m,function(t,e){if(RegExp("^"+k.Lists.colors.join("$|^")+"$").test(t)){var i=d(e,!0),o=i[0],a=i[1],r=i[2];if(k.RegEx.isHex.test(o)){for(var s=["Red","Green","Blue"],l=k.Values.hexToRgb(o),c=r?k.Values.hexToRgb(r):n,u=0;u<s.length;u++){var p=[l[u]];a&&p.push(a),c!==n&&p.push(c[u]),m[t+s[u]]=p}delete m[t]}}});for(var q in m){var z=d(m[q]),V=z[0],H=z[1],L=z[2];q=k.Names.camelCase(q);var j=k.Hooks.getRoot(q),$=!1;if(r(a).isSVG||"tween"===j||!1!==k.Names.prefixCheck(j)[1]||k.Normalizations.registered[j]!==n){(s.display!==n&&null!==s.display&&"none"!==s.display||s.visibility!==n&&"hidden"!==s.visibility)&&/opacity|filter/.test(q)&&!L&&0!==V&&(L=0),s._cacheValues&&M&&M[q]?(L===n&&(L=M[q].endValue+M[q].unitType),$=r(a).rootPropertyValueCache[j]):k.Hooks.registered[q]?L===n?($=k.getPropertyValue(a,j),L=k.getPropertyValue(a,q,$)):$=k.Hooks.templates[j][1]:L===n&&(L=k.getPropertyValue(a,q));var N,W,F,Q=!1;if(N=h(q,L),L=N[0],F=N[1],N=h(q,V),V=N[0].replace(/^([+-\/*])=/,function(t,e){return Q=e,""}),W=N[1],L=parseFloat(L)||0,V=parseFloat(V)||0,"%"===W&&(/^(fontSize|lineHeight)$/.test(q)?(V/=100,W="em"):/^scale/.test(q)?(V/=100,W=""):/(Red|Green|Blue)$/i.test(q)&&(V=V/100*255,W="")),/[\/*]/.test(Q))W=F;else if(F!==W&&0!==L)if(0===V)W=F;else{o=o||function(){var t={myParent:a.parentNode||i.body,position:k.getPropertyValue(a,"position"),fontSize:k.getPropertyValue(a,"fontSize")},n=t.position===I.lastPosition&&t.myParent===I.lastParent,o=t.fontSize===I.lastFontSize;I.lastParent=t.myParent,I.lastPosition=t.position,I.lastFontSize=t.fontSize;var s=100,l={};if(o&&n)l.emToPx=I.lastEmToPx,l.percentToPxWidth=I.lastPercentToPxWidth,l.percentToPxHeight=I.lastPercentToPxHeight;else{var c=r(a).isSVG?i.createElementNS("http://www.w3.org/2000/svg","rect"):i.createElement("div");b.init(c),t.myParent.appendChild(c),p.each(["overflow","overflowX","overflowY"],function(t,e){b.CSS.setPropertyValue(c,e,"hidden")}),b.CSS.setPropertyValue(c,"position",t.position),b.CSS.setPropertyValue(c,"fontSize",t.fontSize),b.CSS.setPropertyValue(c,"boxSizing","content-box"),p.each(["minWidth","maxWidth","width","minHeight","maxHeight","height"],function(t,e){b.CSS.setPropertyValue(c,e,s+"%")}),b.CSS.setPropertyValue(c,"paddingLeft",s+"em"),l.percentToPxWidth=I.lastPercentToPxWidth=(parseFloat(k.getPropertyValue(c,"width",null,!0))||1)/s,l.percentToPxHeight=I.lastPercentToPxHeight=(parseFloat(k.getPropertyValue(c,"height",null,!0))||1)/s,l.emToPx=I.lastEmToPx=(parseFloat(k.getPropertyValue(c,"paddingLeft"))||1)/s,t.myParent.removeChild(c)}return null===I.remToPx&&(I.remToPx=parseFloat(k.getPropertyValue(i.body,"fontSize"))||16),null===I.vwToPx&&(I.vwToPx=parseFloat(e.innerWidth)/100,I.vhToPx=parseFloat(e.innerHeight)/100),l.remToPx=I.remToPx,l.vwToPx=I.vwToPx,l.vhToPx=I.vhToPx,b.debug>=1&&console.log("Unit ratios: "+JSON.stringify(l),a),l}();var X=/margin|padding|left|right|width|text|word|letter/i.test(q)||/X$/.test(q)||"x"===q?"x":"y";switch(F){case"%":L*="x"===X?o.percentToPxWidth:o.percentToPxHeight;break;case"px":break;default:L*=o[F+"ToPx"]}switch(W){case"%":L*=1/("x"===X?o.percentToPxWidth:o.percentToPxHeight);break;case"px":break;default:L*=1/o[W+"ToPx"]}}switch(Q){case"+":V=L+V;break;case"-":V=L-V;break;case"*":V*=L;break;case"/":V=L/V}l[q]={rootPropertyValue:$,startValue:L,currentValue:L,endValue:V,unitType:W,easing:H},b.debug&&console.log("tweensContainer ("+q+"): "+JSON.stringify(l[q]),a)}else b.debug&&console.log("Skipping ["+j+"] due to a lack of browser support.")}l.element=a}l.element&&(k.Values.addClass(a,"velocity-animating"),D.push(l),""===s.queue&&(r(a).tweensContainer=l,r(a).opts=s),r(a).isAnimating=!0,T===C-1?(b.State.calls.push([D,f,s,null,P.resolver]),!1===b.State.isTicking&&(b.State.isTicking=!0,u())):T++)}var o,a=this,s=p.extend({},b.defaults,y),l={};switch(r(a)===n&&b.init(a),parseFloat(s.delay)&&!1!==s.queue&&p.queue(a,s.queue,function(t){b.velocityQueueEntryFlag=!0,r(a).delayTimer={setTimeout:setTimeout(t,parseFloat(s.delay)),next:t}}),s.duration.toString().toLowerCase()){case"fast":s.duration=200;break;case"normal":s.duration=g;break;case"slow":s.duration=600;break;default:s.duration=parseFloat(s.duration)||1}!1!==b.mock&&(!0===b.mock?s.duration=s.delay=1:(s.duration*=parseFloat(b.mock)||1,s.delay*=parseFloat(b.mock)||1)),s.easing=c(s.easing,s.duration),s.begin&&!v.isFunction(s.begin)&&(s.begin=null),s.progress&&!v.isFunction(s.progress)&&(s.progress=null),s.complete&&!v.isFunction(s.complete)&&(s.complete=null),s.display!==n&&null!==s.display&&(s.display=s.display.toString().toLowerCase(),"auto"===s.display&&(s.display=b.CSS.Values.getDisplayType(a))),s.visibility!==n&&null!==s.visibility&&(s.visibility=s.visibility.toString().toLowerCase()),s.mobileHA=s.mobileHA&&b.State.isMobile&&!b.State.isGingerbread,!1===s.queue?s.delay?setTimeout(t,s.delay):t():p.queue(a,s.queue,function(e,i){return!0===i?(P.promise&&P.resolver(f),!0):(b.velocityQueueEntryFlag=!0,void t(e))}),""!==s.queue&&"fx"!==s.queue||"inprogress"===p.queue(a)[0]||p.dequeue(a)}var s,l,h,f,m,y,w=arguments[0]&&(arguments[0].p||p.isPlainObject(arguments[0].properties)&&!arguments[0].properties.names||v.isString(arguments[0].properties));if(v.isWrapped(this)?(s=!1,h=0,f=this,l=this):(s=!0,h=1,f=w?arguments[0].elements||arguments[0].e:arguments[0]),f=a(f)){w?(m=arguments[0].properties||arguments[0].p,y=arguments[0].options||arguments[0].o):(m=arguments[h],y=arguments[h+1]);var C=f.length,T=0;if(!/^(stop|finish)$/i.test(m)&&!p.isPlainObject(y)){y={};for(var S=h+1;S<arguments.length;S++)v.isArray(arguments[S])||!/^(fast|normal|slow)$/i.test(arguments[S])&&!/^\d/.test(arguments[S])?v.isString(arguments[S])||v.isArray(arguments[S])?y.easing=arguments[S]:v.isFunction(arguments[S])&&(y.complete=arguments[S]):y.duration=arguments[S]}var P={promise:null,resolver:null,rejecter:null};s&&b.Promise&&(P.promise=new b.Promise(function(t,e){P.resolver=t,P.rejecter=e}));var A;switch(m){case"scroll":A="scroll";break;case"reverse":A="reverse";break;case"finish":case"stop":p.each(f,function(t,e){r(e)&&r(e).delayTimer&&(clearTimeout(r(e).delayTimer.setTimeout),r(e).delayTimer.next&&r(e).delayTimer.next(),delete r(e).delayTimer)});var O=[];return p.each(b.State.calls,function(t,e){e&&p.each(e[1],function(i,o){var a=y===n?"":y;return!0!==a&&e[2].queue!==a&&(y!==n||!1!==e[2].queue)||void p.each(f,function(i,n){n===o&&((!0===y||v.isString(y))&&(p.each(p.queue(n,v.isString(y)?y:""),function(t,e){v.isFunction(e)&&e(null,!0)}),p.queue(n,v.isString(y)?y:"",[])),"stop"===m?(r(n)&&r(n).tweensContainer&&!1!==a&&p.each(r(n).tweensContainer,function(t,e){e.endValue=e.currentValue}),O.push(t)):"finish"===m&&(e[2].duration=1))})})}),"stop"===m&&(p.each(O,function(t,e){d(e,!0)}),P.promise&&P.resolver(f)),t();default:if(!p.isPlainObject(m)||v.isEmptyObject(m)){if(v.isString(m)&&b.Redirects[m]){var E=(z=p.extend({},y)).duration,_=z.delay||0;return!0===z.backwards&&(f=p.extend(!0,[],f).reverse()),p.each(f,function(t,e){parseFloat(z.stagger)?z.delay=_+parseFloat(z.stagger)*t:v.isFunction(z.stagger)&&(z.delay=_+z.stagger.call(e,t,C)),z.drag&&(z.duration=parseFloat(E)||(/^(callout|transition)/.test(m)?1e3:g),z.duration=Math.max(z.duration*(z.backwards?1-t/C:(t+1)/C),.75*z.duration,200)),b.Redirects[m].call(e,e,z||{},t,C,f,P.promise?P:n)}),t()}var M="Velocity: First argument ("+m+") was not a property map, a known action, or a registered redirect. Aborting.";return P.promise?P.rejecter(new Error(M)):console.log(M),t()}A="start"}var I={lastParent:null,lastPosition:null,lastFontSize:null,lastPercentToPxWidth:null,lastPercentToPxHeight:null,lastEmToPx:null,remToPx:null,vwToPx:null,vhToPx:null},D=[];p.each(f,function(t,e){v.isNode(e)&&o.call(e)});var q,z=p.extend({},b.defaults,y);if(z.loop=parseInt(z.loop),q=2*z.loop-1,z.loop)for(var V=0;q>V;V++){var H={delay:z.delay,progress:z.progress};V===q-1&&(H.display=z.display,H.visibility=z.visibility,H.complete=z.complete),x(f,"reverse",H)}return t()}};(b=p.extend(x,b)).animate=x;var C=e.requestAnimationFrame||f;return b.State.isMobile||i.hidden===n||i.addEventListener("visibilitychange",function(){i.hidden?(C=function(t){return setTimeout(function(){t(!0)},16)},u()):C=e.requestAnimationFrame||f}),t.Velocity=b,t!==e&&(t.fn.velocity=x,t.fn.velocity.defaults=b.defaults),p.each(["Down","Up"],function(t,e){b.Redirects["slide"+e]=function(t,i,o,a,r,s){var l=p.extend({},i),c=l.begin,u=l.complete,d={height:"",marginTop:"",marginBottom:"",paddingTop:"",paddingBottom:""},h={};l.display===n&&(l.display="Down"===e?"inline"===b.CSS.Values.getDisplayType(t)?"inline-block":"block":"none"),l.begin=function(){c&&c.call(r,r);for(var i in d){h[i]=t.style[i];var n=b.CSS.getPropertyValue(t,i);d[i]="Down"===e?[n,0]:[0,n]}h.overflow=t.style.overflow,t.style.overflow="hidden"},l.complete=function(){for(var e in h)t.style[e]=h[e];u&&u.call(r,r),s&&s.resolver(r)},b(t,d,l)}}),p.each(["In","Out"],function(t,e){b.Redirects["fade"+e]=function(t,i,o,a,r,s){var l=p.extend({},i),c={opacity:"In"===e?1:0},u=l.complete;l.complete=o!==a-1?l.begin=null:function(){u&&u.call(r,r),s&&s.resolver(r)},l.display===n&&(l.display="In"===e?"auto":"none"),b(this,c,l)}}),b}jQuery.fn.velocity=jQuery.fn.animate}}(window.jQuery||window.Zepto||window,window,document)})),function(t,e,i,n){"use strict";function o(t,e,i){return setTimeout(u(t,i),e)}function a(t,e,i){return!!Array.isArray(t)&&(r(t,i[e],i),!0)}function r(t,e,i){var o;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==n)for(o=0;o<t.length;)e.call(i,t[o],o,t),o++;else for(o in t)t.hasOwnProperty(o)&&e.call(i,t[o],o,t)}function s(t,e,i){for(var o=Object.keys(e),a=0;a<o.length;)(!i||i&&t[o[a]]===n)&&(t[o[a]]=e[o[a]]),a++;return t}function l(t,e){return s(t,e,!0)}function c(t,e,i){var n,o=e.prototype;(n=t.prototype=Object.create(o)).constructor=t,n._super=o,i&&s(n,i)}function u(t,e){return function(){return t.apply(e,arguments)}}function d(t,e){return typeof t==ut?t.apply(e?e[0]||n:n,e):t}function p(t,e){return t===n?e:t}function h(t,e,i){r(g(e),function(e){t.addEventListener(e,i,!1)})}function f(t,e,i){r(g(e),function(e){t.removeEventListener(e,i,!1)})}function v(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function m(t,e){return t.indexOf(e)>-1}function g(t){return t.trim().split(/\s+/g)}function y(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function b(t){return Array.prototype.slice.call(t,0)}function w(t,e,i){for(var n=[],o=[],a=0;a<t.length;){var r=e?t[a][e]:t[a];y(o,r)<0&&n.push(t[a]),o[a]=r,a++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}function k(t,e){for(var i,o,a=e[0].toUpperCase()+e.slice(1),r=0;r<lt.length;){if(i=lt[r],(o=i?i+a:e)in t)return o;r++}return n}function x(){return ft++}function C(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow}function T(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){d(t.options.enable,[t])&&i.handler(e)},this.init()}function S(t){var e=t.options.inputClass;return new(e||(gt?j:yt?W:mt?Q:L))(t,P)}function P(t,e,i){var n=i.pointers.length,o=i.changedPointers.length,a=e&xt&&0==n-o,r=e&(Tt|St)&&0==n-o;i.isFirst=!!a,i.isFinal=!!r,a&&(t.session={}),i.eventType=e,A(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function A(t,e){var i=t.session,n=e.pointers,o=n.length;i.firstInput||(i.firstInput=_(e)),o>1&&!i.firstMultiple?i.firstMultiple=_(e):1===o&&(i.firstMultiple=!1);var a=i.firstInput,r=i.firstMultiple,s=r?r.center:a.center,l=e.center=M(n);e.timeStamp=ht(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=z(s,l),e.distance=q(s,l),O(i,e),e.offsetDirection=D(e.deltaX,e.deltaY),e.scale=r?H(r.pointers,n):1,e.rotation=r?V(r.pointers,n):0,E(i,e);var c=t.element;v(e.srcEvent.target,c)&&(c=e.srcEvent.target),e.target=c}function O(t,e){var i=e.center,n=t.offsetDelta||{},o=t.prevDelta||{},a=t.prevInput||{};(e.eventType===xt||a.eventType===Tt)&&(o=t.prevDelta={x:a.deltaX||0,y:a.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=o.x+(i.x-n.x),e.deltaY=o.y+(i.y-n.y)}function E(t,e){var i,o,a,r,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(e.eventType!=St&&(l>kt||s.velocity===n)){var c=s.deltaX-e.deltaX,u=s.deltaY-e.deltaY,d=I(l,c,u);o=d.x,a=d.y,i=pt(d.x)>pt(d.y)?d.x:d.y,r=D(c,u),t.lastInterval=e}else i=s.velocity,o=s.velocityX,a=s.velocityY,r=s.direction;e.velocity=i,e.velocityX=o,e.velocityY=a,e.direction=r}function _(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:dt(t.pointers[i].clientX),clientY:dt(t.pointers[i].clientY)},i++;return{timeStamp:ht(),pointers:e,center:M(e),deltaX:t.deltaX,deltaY:t.deltaY}}function M(t){var e=t.length;if(1===e)return{x:dt(t[0].clientX),y:dt(t[0].clientY)};for(var i=0,n=0,o=0;e>o;)i+=t[o].clientX,n+=t[o].clientY,o++;return{x:dt(i/e),y:dt(n/e)}}function I(t,e,i){return{x:e/t||0,y:i/t||0}}function D(t,e){return t===e?Pt:pt(t)>=pt(e)?t>0?At:Ot:e>0?Et:_t}function q(t,e,i){i||(i=qt);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return Math.sqrt(n*n+o*o)}function z(t,e,i){i||(i=qt);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return 180*Math.atan2(o,n)/Math.PI}function V(t,e){return z(e[1],e[0],zt)-z(t[1],t[0],zt)}function H(t,e){return q(e[0],e[1],zt)/q(t[0],t[1],zt)}function L(){this.evEl=Ht,this.evWin=Lt,this.allow=!0,this.pressed=!1,T.apply(this,arguments)}function j(){this.evEl=Nt,this.evWin=Wt,T.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function $(){this.evTarget=Qt,this.evWin=Xt,this.started=!1,T.apply(this,arguments)}function N(t,e){var i=b(t.touches),n=b(t.changedTouches);return e&(Tt|St)&&(i=w(i.concat(n),"identifier",!0)),[i,n]}function W(){this.evTarget=Yt,this.targetIds={},T.apply(this,arguments)}function F(t,e){var i=b(t.touches),n=this.targetIds;if(e&(xt|Ct)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var o,a,r=b(t.changedTouches),s=[],l=this.target;if(a=i.filter(function(t){return v(t.target,l)}),e===xt)for(o=0;o<a.length;)n[a[o].identifier]=!0,o++;for(o=0;o<r.length;)n[r[o].identifier]&&s.push(r[o]),e&(Tt|St)&&delete n[r[o].identifier],o++;return s.length?[w(a.concat(s),"identifier",!0),s]:void 0}function Q(){T.apply(this,arguments);var t=u(this.handler,this);this.touch=new W(this.manager,t),this.mouse=new L(this.manager,t)}function X(t,e){this.manager=t,this.set(e)}function R(t){if(m(t,Kt))return Kt;var e=m(t,te),i=m(t,ee);return e&&i?te+" "+ee:e||i?e?te:ee:m(t,Jt)?Jt:Zt}function Y(t){this.id=x(),this.manager=null,this.options=l(t||{},this.defaults),this.options.enable=p(this.options.enable,!0),this.state=ie,this.simultaneous={},this.requireFail=[]}function B(t){return t&se?"cancel":t&ae?"end":t&oe?"move":t&ne?"start":""}function U(t){return t==_t?"down":t==Et?"up":t==At?"left":t==Ot?"right":""}function G(t,e){var i=e.manager;return i?i.get(t):t}function Z(){Y.apply(this,arguments)}function J(){Z.apply(this,arguments),this.pX=null,this.pY=null}function K(){Z.apply(this,arguments)}function tt(){Y.apply(this,arguments),this._timer=null,this._input=null}function et(){Z.apply(this,arguments)}function it(){Z.apply(this,arguments)}function nt(){Y.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ot(t,e){return e=e||{},e.recognizers=p(e.recognizers,ot.defaults.preset),new at(t,e)}function at(t,e){e=e||{},this.options=l(e,ot.defaults),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=S(this),this.touchAction=new X(this,this.options.touchAction),rt(this,!0),r(e.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function rt(t,e){var i=t.element;r(t.options.cssProps,function(t,n){i.style[k(i.style,n)]=e?t:""})}function st(t,i){var n=e.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=i,i.target.dispatchEvent(n)}var lt=["","webkit","moz","MS","ms","o"],ct=e.createElement("div"),ut="function",dt=Math.round,pt=Math.abs,ht=Date.now,ft=1,vt=/mobile|tablet|ip(ad|hone|od)|android/i,mt="ontouchstart"in t,gt=k(t,"PointerEvent")!==n,yt=mt&&vt.test(navigator.userAgent),bt="touch",wt="mouse",kt=25,xt=1,Ct=2,Tt=4,St=8,Pt=1,At=2,Ot=4,Et=8,_t=16,Mt=At|Ot,It=Et|_t,Dt=Mt|It,qt=["x","y"],zt=["clientX","clientY"];T.prototype={handler:function(){},init:function(){this.evEl&&h(this.element,this.evEl,this.domHandler),this.evTarget&&h(this.target,this.evTarget,this.domHandler),this.evWin&&h(C(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(C(this.element),this.evWin,this.domHandler)}};var Vt={mousedown:xt,mousemove:Ct,mouseup:Tt},Ht="mousedown",Lt="mousemove mouseup";c(L,T,{handler:function(t){var e=Vt[t.type];e&xt&&0===t.button&&(this.pressed=!0),e&Ct&&1!==t.which&&(e=Tt),this.pressed&&this.allow&&(e&Tt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:wt,srcEvent:t}))}});var jt={pointerdown:xt,pointermove:Ct,pointerup:Tt,pointercancel:St,pointerout:St},$t={2:bt,3:"pen",4:wt,5:"kinect"},Nt="pointerdown",Wt="pointermove pointerup pointercancel";t.MSPointerEvent&&(Nt="MSPointerDown",Wt="MSPointerMove MSPointerUp MSPointerCancel"),c(j,T,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),o=jt[n],a=$t[t.pointerType]||t.pointerType,r=a==bt,s=y(e,t.pointerId,"pointerId");o&xt&&(0===t.button||r)?0>s&&(e.push(t),s=e.length-1):o&(Tt|St)&&(i=!0),0>s||(e[s]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:a,srcEvent:t}),i&&e.splice(s,1))}});var Ft={touchstart:xt,touchmove:Ct,touchend:Tt,touchcancel:St},Qt="touchstart",Xt="touchstart touchmove touchend touchcancel";c($,T,{handler:function(t){var e=Ft[t.type];if(e===xt&&(this.started=!0),this.started){var i=N.call(this,t,e);e&(Tt|St)&&0==i[0].length-i[1].length&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:bt,srcEvent:t})}}});var Rt={touchstart:xt,touchmove:Ct,touchend:Tt,touchcancel:St},Yt="touchstart touchmove touchend touchcancel";c(W,T,{handler:function(t){var e=Rt[t.type],i=F.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:bt,srcEvent:t})}}),c(Q,T,{handler:function(t,e,i){var n=i.pointerType==bt,o=i.pointerType==wt;if(n)this.mouse.allow=!1;else if(o&&!this.mouse.allow)return;e&(Tt|St)&&(this.mouse.allow=!0),this.callback(t,e,i)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Bt=k(ct.style,"touchAction"),Ut=Bt!==n,Gt="compute",Zt="auto",Jt="manipulation",Kt="none",te="pan-x",ee="pan-y";X.prototype={set:function(t){t==Gt&&(t=this.compute()),Ut&&(this.manager.element.style[Bt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return r(this.manager.recognizers,function(e){d(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),R(t.join(" "))},preventDefaults:function(t){if(!Ut){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var n=this.actions,o=m(n,Kt),a=m(n,ee),r=m(n,te);return o||a&&i&Mt||r&&i&It?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var ie=1,ne=2,oe=4,ae=8,re=ae,se=16;Y.prototype={defaults:{},set:function(t){return s(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(a(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=G(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return a(t,"dropRecognizeWith",this)?this:(t=G(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(a(t,"requireFailure",this))return this;var e=this.requireFail;return t=G(t,this),-1===y(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(a(t,"dropRequireFailure",this))return this;t=G(t,this);var e=y(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){i.manager.emit(i.options.event+(e?B(n):""),t)}var i=this,n=this.state;ae>n&&e(!0),e(),n>=ae&&e(!0)},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=32)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|ie)))return!1;t++}return!0},recognize:function(t){var e=s({},t);return d(this.options.enable,[this,e])?(this.state&(re|se|32)&&(this.state=ie),this.state=this.process(e),void(this.state&(ne|oe|ae|se)&&this.tryEmit(e))):(this.reset(),void(this.state=32))},process:function(){},getTouchAction:function(){},reset:function(){}},c(Z,Y,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(ne|oe),o=this.attrTest(t);return n&&(i&St||!o)?e|se:n||o?i&Tt?e|ae:e&ne?e|oe:ne:32}}),c(J,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Dt},getTouchAction:function(){var t=this.options.direction,e=[];return t&Mt&&e.push(ee),t&It&&e.push(te),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,o=t.direction,a=t.deltaX,r=t.deltaY;return o&e.direction||(e.direction&Mt?(o=0===a?Pt:0>a?At:Ot,i=a!=this.pX,n=Math.abs(t.deltaX)):(o=0===r?Pt:0>r?Et:_t,i=r!=this.pY,n=Math.abs(t.deltaY))),t.direction=o,i&&n>e.threshold&&o&e.direction},attrTest:function(t){return Z.prototype.attrTest.call(this,t)&&(this.state&ne||!(this.state&ne)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=U(t.direction);e&&this.manager.emit(this.options.event+e,t),this._super.emit.call(this,t)}}),c(K,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Kt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ne)},emit:function(t){if(this._super.emit.call(this,t),1!==t.scale){var e=t.scale<1?"in":"out";this.manager.emit(this.options.event+e,t)}}}),c(tt,Y,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[Zt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,a=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(Tt|St)&&!a)this.reset();else if(t.eventType&xt)this.reset(),this._timer=o(function(){this.state=re,this.tryEmit()},e.time,this);else if(t.eventType&Tt)return re;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===re&&(t&&t.eventType&Tt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=ht(),this.manager.emit(this.options.event,this._input)))}}),c(et,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Kt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ne)}}),c(it,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Mt|It,pointers:1},getTouchAction:function(){return J.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(Mt|It)?e=t.velocity:i&Mt?e=t.velocityX:i&It&&(e=t.velocityY),this._super.attrTest.call(this,t)&&i&t.direction&&t.distance>this.options.threshold&&pt(e)>this.options.velocity&&t.eventType&Tt},emit:function(t){var e=U(t.direction);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),c(nt,Y,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[Jt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,a=t.deltaTime<e.time;if(this.reset(),t.eventType&xt&&0===this.count)return this.failTimeout();if(n&&a&&i){if(t.eventType!=Tt)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||q(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&r?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=o(function(){this.state=re,this.tryEmit()},e.interval,this),ne):re}return 32},failTimeout:function(){return this._timer=o(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==re&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ot.VERSION="2.0.4",ot.defaults={domEvents:!1,touchAction:Gt,enable:!0,inputTarget:null,inputClass:null,preset:[[et,{enable:!1}],[K,{enable:!1},["rotate"]],[it,{direction:Mt}],[J,{direction:Mt},["swipe"]],[nt],[nt,{event:"doubletap",taps:2},["tap"]],[tt]],cssProps:{userSelect:"default",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};at.prototype={set:function(t){return s(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,n=this.recognizers,o=e.curRecognizer;(!o||o&&o.state&re)&&(o=e.curRecognizer=null);for(var a=0;a<n.length;)i=n[a],2===e.stopped||o&&i!=o&&!i.canRecognizeWith(o)?i.reset():i.recognize(t),!o&&i.state&(ne|oe|ae)&&(o=e.curRecognizer=i),a++}},get:function(t){if(t instanceof Y)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(a(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(a(t,"remove",this))return this;var e=this.recognizers;return t=this.get(t),e.splice(y(e,t),1),this.touchAction.update(),this},on:function(t,e){var i=this.handlers;return r(g(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},off:function(t,e){var i=this.handlers;return r(g(t),function(t){e?i[t].splice(y(i[t],e),1):delete i[t]}),this},emit:function(t,e){this.options.domEvents&&st(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&rt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(ot,{INPUT_START:xt,INPUT_MOVE:Ct,INPUT_END:Tt,INPUT_CANCEL:St,STATE_POSSIBLE:ie,STATE_BEGAN:ne,STATE_CHANGED:oe,STATE_ENDED:ae,STATE_RECOGNIZED:re,STATE_CANCELLED:se,STATE_FAILED:32,DIRECTION_NONE:Pt,DIRECTION_LEFT:At,DIRECTION_RIGHT:Ot,DIRECTION_UP:Et,DIRECTION_DOWN:_t,DIRECTION_HORIZONTAL:Mt,DIRECTION_VERTICAL:It,DIRECTION_ALL:Dt,Manager:at,Input:T,TouchAction:X,TouchInput:W,MouseInput:L,PointerEventInput:j,TouchMouseInput:Q,SingleTouchInput:$,Recognizer:Y,AttrRecognizer:Z,Tap:nt,Pan:J,Swipe:it,Pinch:K,Rotate:et,Press:tt,on:h,off:f,each:r,merge:l,extend:s,inherit:c,bindFn:u,prefixed:k}),typeof define==ut&&define.amd?define(function(){return ot}):"undefined"!=typeof module&&module.exports?module.exports=ot:t.Hammer=ot}(window,document),function(t){"function"==typeof define&&define.amd?define(["jquery","hammerjs"],t):"object"==typeof exports?t(require("jquery"),require("hammerjs")):t(jQuery,Hammer)}(function(t,e){function i(i,n){var o=t(i);o.data("hammer")||o.data("hammer",new e(o[0],n))}t.fn.hammer=function(t){return this.each(function(){i(this,t)})},e.Manager.prototype.emit=function(e){return function(i,n){e.call(this,i,n),t(this.element).trigger({type:i,gesture:n})}}(e.Manager.prototype.emit)}),function(t){t.Package?Materialize={}:t.Materialize={}}(window),"undefined"==typeof exports||exports.nodeType||("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=Materialize),exports.default=Materialize),function(t){for(var e=0,i=["webkit","moz"],n=t.requestAnimationFrame,o=t.cancelAnimationFrame,a=i.length;--a>=0&&!n;)n=t[i[a]+"RequestAnimationFrame"],o=t[i[a]+"CancelRequestAnimationFrame"];n&&o||(n=function(t){var i=+Date.now(),n=Math.max(e+16,i);return setTimeout(function(){t(e=n)},n-i)},o=clearTimeout),t.requestAnimationFrame=n,t.cancelAnimationFrame=o}(window),Materialize.objectSelectorString=function(t){return((t.prop("tagName")||"")+(t.attr("id")||"")+(t.attr("class")||"")).replace(/\s/g,"")},Materialize.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}(),Materialize.escapeHash=function(t){return t.replace(/(:|\.|\[|\]|,|=)/g,"\\$1")},Materialize.elementOrParentIsFixed=function(t){var e=$(t),i=!1;return e.add(e.parents()).each(function(){if("fixed"===$(this).css("position"))return i=!0,!1}),i};var getTime=Date.now||function(){return(new Date).getTime()};Materialize.throttle=function(t,e,i){var n,o,a,r=null,s=0;i||(i={});var l=function(){s=!1===i.leading?0:getTime(),r=null,a=t.apply(n,o),n=o=null};return function(){var c=getTime();s||!1!==i.leading||(s=c);var u=e-(c-s);return n=this,o=arguments,u<=0?(clearTimeout(r),r=null,s=c,a=t.apply(n,o),n=o=null):r||!1===i.trailing||(r=setTimeout(l,u)),a}};var Vel;Vel=jQuery?jQuery.Velocity:$?$.Velocity:Velocity,Materialize.Vel=Vel||Velocity,function(t){t.fn.collapsible=function(e,i){var n={accordion:void 0,onOpen:void 0,onClose:void 0},o=e;return e=t.extend(n,e),this.each(function(){function n(e){p=d.find("> li > .collapsible-header"),e.hasClass("active")?e.parent().addClass("active"):e.parent().removeClass("active"),e.parent().hasClass("active")?e.siblings(".collapsible-body").stop(!0,!1).slideDown({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height","")}}):e.siblings(".collapsible-body").stop(!0,!1).slideUp({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height","")}}),p.not(e).removeClass("active").parent().removeClass("active"),p.not(e).parent().children(".collapsible-body").stop(!0,!1).each(function(){t(this).is(":visible")&&t(this).slideUp({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height",""),s(t(this).siblings(".collapsible-header"))}})})}function a(e){e.hasClass("active")?e.parent().addClass("active"):e.parent().removeClass("active"),e.parent().hasClass("active")?e.siblings(".collapsible-body").stop(!0,!1).slideDown({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height","")}}):e.siblings(".collapsible-body").stop(!0,!1).slideUp({duration:350,easing:"easeOutQuart",queue:!1,complete:function(){t(this).css("height","")}})}function r(t,i){i||t.toggleClass("active"),e.accordion||"accordion"===h||void 0===h?n(t):a(t),s(t)}function s(t){t.hasClass("active")?"function"==typeof e.onOpen&&e.onOpen.call(this,t.parent()):"function"==typeof e.onClose&&e.onClose.call(this,t.parent())}function l(t){return c(t).length>0}function c(t){return t.closest("li > .collapsible-header")}function u(){d.off("click.collapse","> li > .collapsible-header")}var d=t(this),p=t(this).find("> li > .collapsible-header"),h=d.data("collapsible");if("destroy"!==o)if(i>=0&&i<p.length){var f=p.eq(i);f.length&&("open"===o||"close"===o&&f.hasClass("active"))&&r(f)}else u(),d.on("click.collapse","> li > .collapsible-header",function(e){var i=t(e.target);l(i)&&(i=c(i)),r(i)}),e.accordion||"accordion"===h||void 0===h?r(p.filter(".active").first(),!0):p.filter(".active").each(function(){r(t(this),!0)});else u()})},t(document).ready(function(){t(".collapsible").collapsible()})}(jQuery),function(t){t.fn.scrollTo=function(e){return t(this).scrollTop(t(this).scrollTop()-t(this).offset().top+t(e).offset().top),this},t.fn.dropdown=function(e){var i={inDuration:300,outDuration:225,constrainWidth:!0,hover:!1,gutter:0,belowOrigin:!1,alignment:"left",stopPropagation:!1};return"open"===e?(this.each(function(){t(this).trigger("open")}),!1):"close"===e?(this.each(function(){t(this).trigger("close")}),!1):void this.each(function(){function n(){void 0!==r.data("induration")&&(s.inDuration=r.data("induration")),void 0!==r.data("outduration")&&(s.outDuration=r.data("outduration")),void 0!==r.data("constrainwidth")&&(s.constrainWidth=r.data("constrainwidth")),void 0!==r.data("hover")&&(s.hover=r.data("hover")),void 0!==r.data("gutter")&&(s.gutter=r.data("gutter")),void 0!==r.data("beloworigin")&&(s.belowOrigin=r.data("beloworigin")),void 0!==r.data("alignment")&&(s.alignment=r.data("alignment")),void 0!==r.data("stoppropagation")&&(s.stopPropagation=r.data("stoppropagation"))}function o(e){"focus"===e&&(l=!0),n(),c.addClass("active"),r.addClass("active");var i=r[0].getBoundingClientRect().width;!0===s.constrainWidth?c.css("width",i):c.css("white-space","nowrap");var o=window.innerHeight,u=r.innerHeight(),d=r.offset().left,p=r.offset().top-t(window).scrollTop(),h=s.alignment,f=0,v=0,m=0;!0===s.belowOrigin&&(m=u);var g=0,y=0,b=r.parent();if(b.is("body")||(b[0].scrollHeight>b[0].clientHeight&&(g=b[0].scrollTop),b[0].scrollWidth>b[0].clientWidth&&(y=b[0].scrollLeft)),d+c.innerWidth()>t(window).width()?h="right":d-c.innerWidth()+r.innerWidth()<0&&(h="left"),p+c.innerHeight()>o)if(p+u-c.innerHeight()<0){var w=o-p-m;c.css("max-height",w)}else m||(m+=u),m-=c.innerHeight();"left"===h?(f=s.gutter,v=r.position().left+f):"right"===h&&(c.stop(!0,!0).css({opacity:0,left:0}),v=r.position().left+i-c.width()+(f=-s.gutter)),c.css({position:"absolute",top:r.position().top+m+g,left:v+y}),c.slideDown({queue:!1,duration:s.inDuration,easing:"easeOutCubic",complete:function(){t(this).css("height","")}}).animate({opacity:1},{queue:!1,duration:s.inDuration,easing:"easeOutSine"}),setTimeout(function(){t(document).on("click."+c.attr("id"),function(e){a(),t(document).off("click."+c.attr("id"))})},0)}function a(){l=!1,c.fadeOut(s.outDuration),c.removeClass("active"),r.removeClass("active"),t(document).off("click."+c.attr("id")),setTimeout(function(){c.css("max-height","")},s.outDuration)}var r=t(this),s=t.extend({},i,e),l=!1,c=t("#"+r.attr("data-activates"));if(n(),r.after(c),s.hover){var u=!1;r.off("click."+r.attr("id")),r.on("mouseenter",function(t){!1===u&&(o(),u=!0)}),r.on("mouseleave",function(e){var i=e.toElement||e.relatedTarget;t(i).closest(".dropdown-content").is(c)||(c.stop(!0,!0),a(),u=!1)}),c.on("mouseleave",function(e){var i=e.toElement||e.relatedTarget;t(i).closest(".dropdown-button").is(r)||(c.stop(!0,!0),a(),u=!1)})}else r.off("click."+r.attr("id")),r.on("click."+r.attr("id"),function(e){l||(r[0]!=e.currentTarget||r.hasClass("active")||0!==t(e.target).closest(".dropdown-content").length?r.hasClass("active")&&(a(),t(document).off("click."+c.attr("id"))):(e.preventDefault(),s.stopPropagation&&e.stopPropagation(),o("click")))});r.on("open",function(t,e){o(e)}),r.on("close",a)})},t(document).ready(function(){t(".dropdown-button").dropdown()})}(jQuery),function(t,e){"use strict";var i={opacity:.5,inDuration:250,outDuration:250,ready:void 0,complete:void 0,dismissible:!0,startingTop:"4%",endingTop:"10%"},n=function(){function n(e,i){_classCallCheck(this,n),e[0].M_Modal&&e[0].M_Modal.destroy(),this.$el=e,this.options=t.extend({},n.defaults,i),this.isOpen=!1,this.$el[0].M_Modal=this,this.id=e.attr("id"),this.openingTrigger=void 0,this.$overlay=t('<div class="modal-overlay"></div>'),n._increment++,n._count++,this.$overlay[0].style.zIndex=1e3+2*n._increment,this.$el[0].style.zIndex=1e3+2*n._increment+1,this.setupEventHandlers()}return _createClass(n,[{key:"getInstance",value:function(){return this}},{key:"destroy",value:function(){this.removeEventHandlers(),this.$el[0].removeAttribute("style"),this.$overlay[0].parentNode&&this.$overlay[0].parentNode.removeChild(this.$overlay[0]),this.$el[0].M_Modal=void 0,n._count--}},{key:"setupEventHandlers",value:function(){this.handleOverlayClickBound=this.handleOverlayClick.bind(this),this.handleModalCloseClickBound=this.handleModalCloseClick.bind(this),1===n._count&&document.body.addEventListener("click",this.handleTriggerClick),this.$overlay[0].addEventListener("click",this.handleOverlayClickBound),this.$el[0].addEventListener("click",this.handleModalCloseClickBound)}},{key:"removeEventHandlers",value:function(){0===n._count&&document.body.removeEventListener("click",this.handleTriggerClick),this.$overlay[0].removeEventListener("click",this.handleOverlayClickBound),this.$el[0].removeEventListener("click",this.handleModalCloseClickBound)}},{key:"handleTriggerClick",value:function(e){var i=t(e.target).closest(".modal-trigger");if(e.target&&i.length){var n=i[0].getAttribute("href");n=n?n.slice(1):i[0].getAttribute("data-target");var o=document.getElementById(n).M_Modal;o&&o.open(i),e.preventDefault()}}},{key:"handleOverlayClick",value:function(){this.options.dismissible&&this.close()}},{key:"handleModalCloseClick",value:function(e){var i=t(e.target).closest(".modal-close");e.target&&i.length&&this.close()}},{key:"handleKeydown",value:function(t){27===t.keyCode&&this.options.dismissible&&this.close()}},{key:"animateIn",value:function(){var i=this;t.extend(this.$el[0].style,{display:"block",opacity:0}),t.extend(this.$overlay[0].style,{display:"block",opacity:0}),e(this.$overlay[0],{opacity:this.options.opacity},{duration:this.options.inDuration,queue:!1,ease:"easeOutCubic"});var n={duration:this.options.inDuration,queue:!1,ease:"easeOutCubic",complete:function(){"function"==typeof i.options.ready&&i.options.ready.call(i,i.$el,i.openingTrigger)}};this.$el[0].classList.contains("bottom-sheet")?e(this.$el[0],{bottom:0,opacity:1},n):(e.hook(this.$el[0],"scaleX",.7),this.$el[0].style.top=this.options.startingTop,e(this.$el[0],{top:this.options.endingTop,opacity:1,scaleX:1},n))}},{key:"animateOut",value:function(){var t=this;e(this.$overlay[0],{opacity:0},{duration:this.options.outDuration,queue:!1,ease:"easeOutQuart"});var i={duration:this.options.outDuration,queue:!1,ease:"easeOutCubic",complete:function(){t.$el[0].style.display="none","function"==typeof t.options.complete&&t.options.complete.call(t,t.$el),t.$overlay[0].parentNode.removeChild(t.$overlay[0])}};this.$el[0].classList.contains("bottom-sheet")?e(this.$el[0],{bottom:"-100%",opacity:0},i):e(this.$el[0],{top:this.options.startingTop,opacity:0,scaleX:.7},i)}},{key:"open",value:function(t){if(!this.isOpen){this.isOpen=!0;var e=document.body;return e.style.overflow="hidden",this.$el[0].classList.add("open"),e.appendChild(this.$overlay[0]),this.openingTrigger=t||void 0,this.options.dismissible&&(this.handleKeydownBound=this.handleKeydown.bind(this),document.addEventListener("keydown",this.handleKeydownBound)),this.animateIn(),this}}},{key:"close",value:function(){if(this.isOpen)return this.isOpen=!1,this.$el[0].classList.remove("open"),document.body.style.overflow="",this.options.dismissible&&document.removeEventListener("keydown",this.handleKeydownBound),this.animateOut(),this}}],[{key:"init",value:function(e,i){var o=[];return e.each(function(){o.push(new n(t(this),i))}),o}},{key:"defaults",get:function(){return i}}]),n}();n._increment=0,n._count=0,Materialize.Modal=n,t.fn.modal=function(e){return n.prototype[e]?"get"===e.slice(0,3)?this.first()[0].M_Modal[e]():this.each(function(){this.M_Modal[e]()}):"object"!=typeof e&&e?void t.error("Method "+e+" does not exist on jQuery.modal"):(n.init(this,arguments[0]),this)}}(jQuery,Materialize.Vel),function(t){t.fn.materialbox=function(){return this.each(function(){function e(){a=!1;var e=s.parent(".material-placeholder"),n=(window.innerWidth,window.innerHeight,s.data("width")),l=s.data("height");s.velocity("stop",!0),t("#materialbox-overlay").velocity("stop",!0),t(".materialbox-caption").velocity("stop",!0),t(window).off("scroll.materialbox"),t(document).off("keyup.materialbox"),t(window).off("resize.materialbox"),t("#materialbox-overlay").velocity({opacity:0},{duration:r,queue:!1,easing:"easeOutQuad",complete:function(){o=!1,t(this).remove()}}),s.velocity({width:n,height:l,left:0,top:0},{duration:r,queue:!1,easing:"easeOutQuad",complete:function(){e.css({height:"",width:"",position:"",top:"",left:""}),s.removeAttr("style"),s.attr("style",c),s.removeClass("active"),a=!0,i&&i.css("overflow","")}}),t(".materialbox-caption").velocity({opacity:0},{duration:r,queue:!1,easing:"easeOutQuad",complete:function(){t(this).remove()}})}if(!t(this).hasClass("initialized")){t(this).addClass("initialized");var i,n,o=!1,a=!0,r=200,s=t(this),l=t("<div></div>").addClass("material-placeholder"),c=s.attr("style");s.wrap(l),s.on("click",function(){var r=s.parent(".material-placeholder"),l=window.innerWidth,c=window.innerHeight,u=s.width(),d=s.height();if(!1===a)return e(),!1;if(o&&!0===a)return e(),!1;a=!1,s.addClass("active"),o=!0,r.css({width:r[0].getBoundingClientRect().width,height:r[0].getBoundingClientRect().height,position:"relative",top:0,left:0}),i=void 0,n=r[0].parentNode;for(;null!==n&&!t(n).is(document);){var p=t(n);"visible"!==p.css("overflow")&&(p.css("overflow","visible"),i=void 0===i?p:i.add(p)),n=n.parentNode}s.css({position:"absolute","z-index":1e3,"will-change":"left, top, width, height"}).data("width",u).data("height",d);var h=t('<div id="materialbox-overlay"></div>').css({opacity:0}).click(function(){!0===a&&e()});s.before(h);var f=h[0].getBoundingClientRect();if(h.css({width:l,height:c,left:-1*f.left,top:-1*f.top}),h.velocity({opacity:1},{duration:275,queue:!1,easing:"easeOutQuad"}),""!==s.data("caption")){var v=t('<div class="materialbox-caption"></div>');v.text(s.data("caption")),t("body").append(v),v.css({display:"inline"}),v.velocity({opacity:1},{duration:275,queue:!1,easing:"easeOutQuad"})}var m=0,g=0;u/l>d/c?(m=.9*l,g=.9*l*(d/u)):(m=.9*c*(u/d),g=.9*c),s.hasClass("responsive-img")?s.velocity({"max-width":m,width:u},{duration:0,queue:!1,complete:function(){s.css({left:0,top:0}).velocity({height:g,width:m,left:t(document).scrollLeft()+l/2-s.parent(".material-placeholder").offset().left-m/2,top:t(document).scrollTop()+c/2-s.parent(".material-placeholder").offset().top-g/2},{duration:275,queue:!1,easing:"easeOutQuad",complete:function(){a=!0}})}}):s.css("left",0).css("top",0).velocity({height:g,width:m,left:t(document).scrollLeft()+l/2-s.parent(".material-placeholder").offset().left-m/2,top:t(document).scrollTop()+c/2-s.parent(".material-placeholder").offset().top-g/2},{duration:275,queue:!1,easing:"easeOutQuad",complete:function(){a=!0}}),t(window).on("scroll.materialbox",function(){o&&e()}),t(window).on("resize.materialbox",function(){o&&e()}),t(document).on("keyup.materialbox",function(t){27===t.keyCode&&!0===a&&o&&e()})})}})},t(document).ready(function(){t(".materialboxed").materialbox()})}(jQuery),function(t){t.fn.parallax=function(){var e=t(window).width();return this.each(function(i){function n(i){var n;n=e<601?o.height()>0?o.height():o.children("img").height():o.height()>0?o.height():500;var a=o.children("img").first(),r=a.height()-n,s=o.offset().top+n,l=o.offset().top,c=t(window).scrollTop(),u=window.innerHeight,d=(c+u-l)/(n+u),p=Math.round(r*d);i&&a.css("display","block"),s>c&&l<c+u&&a.css("transform","translate3D(-50%,"+p+"px, 0)")}var o=t(this);o.addClass("parallax"),o.children("img").one("load",function(){n(!0)}).each(function(){this.complete&&t(this).trigger("load")}),t(window).scroll(function(){e=t(window).width(),n(!1)}),t(window).resize(function(){e=t(window).width(),n(!1)})})}}(jQuery),function(t){var e={init:function(e){var i={onShow:null,swipeable:!1,responsiveThreshold:1/0};e=t.extend(i,e);var n=Materialize.objectSelectorString(t(this));return this.each(function(i){var o,a,r,s,l,c=n+i,u=t(this),d=t(window).width(),p=u.find("li.tab a"),h=u.width(),f=t(),v=Math.max(h,u[0].scrollWidth)/p.length,m=0,g=0,y=!1,b=function(t){return Math.ceil(h-t.position().left-t[0].getBoundingClientRect().width-u.scrollLeft())},w=function(t){return Math.floor(t.position().left+u.scrollLeft())},k=function(t){m-t>=0?(s.velocity({right:b(o)},{duration:300,queue:!1,easing:"easeOutQuad"}),s.velocity({left:w(o)},{duration:300,queue:!1,easing:"easeOutQuad",delay:90})):(s.velocity({left:w(o)},{duration:300,queue:!1,easing:"easeOutQuad"}),s.velocity({right:b(o)},{duration:300,queue:!1,easing:"easeOutQuad",delay:90}))};e.swipeable&&d>e.responsiveThreshold&&(e.swipeable=!1),0===(o=t(p.filter('[href="'+location.hash+'"]'))).length&&(o=t(this).find("li.tab a.active").first()),0===o.length&&(o=t(this).find("li.tab a").first()),o.addClass("active"),(m=p.index(o))<0&&(m=0),void 0!==o[0]&&(a=t(o[0].hash)).addClass("active"),u.find(".indicator").length||u.append('<li class="indicator"></li>'),s=u.find(".indicator"),u.append(s),u.is(":visible")&&setTimeout(function(){s.css({right:b(o)}),s.css({left:w(o)})},0),t(window).off("resize.tabs-"+c).on("resize.tabs-"+c,function(){h=u.width(),v=Math.max(h,u[0].scrollWidth)/p.length,m<0&&(m=0),0!==v&&0!==h&&(s.css({right:b(o)}),s.css({left:w(o)}))}),e.swipeable?(p.each(function(){var e=t(Materialize.escapeHash(this.hash));e.addClass("carousel-item"),f=f.add(e)}),r=f.wrapAll('<div class="tabs-content carousel"></div>'),f.css("display",""),t(".tabs-content.carousel").carousel({fullWidth:!0,noWrap:!0,onCycleTo:function(t){if(!y){var i=m;m=r.index(t),o.removeClass("active"),(o=p.eq(m)).addClass("active"),k(i),"function"==typeof e.onShow&&e.onShow.call(u[0],a)}}})):p.not(o).each(function(){t(Materialize.escapeHash(this.hash)).hide()}),u.off("click.tabs").on("click.tabs","a",function(i){if(t(this).parent().hasClass("disabled"))i.preventDefault();else if(!t(this).attr("target")){y=!0,h=u.width(),v=Math.max(h,u[0].scrollWidth)/p.length,o.removeClass("active");var n=a;o=t(this),a=t(Materialize.escapeHash(this.hash)),p=u.find("li.tab a");o.position();o.addClass("active"),g=m,(m=p.index(t(this)))<0&&(m=0),e.swipeable?f.length&&f.carousel("set",m,function(){"function"==typeof e.onShow&&e.onShow.call(u[0],a)}):(void 0!==a&&(a.show(),a.addClass("active"),"function"==typeof e.onShow&&e.onShow.call(this,a)),void 0===n||n.is(a)||(n.hide(),n.removeClass("active"))),l=setTimeout(function(){y=!1},300),k(g),i.preventDefault()}})})},select_tab:function(t){this.find('a[href="#'+t+'"]').trigger("click")}};t.fn.tabs=function(i){return e[i]?e[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?void t.error("Method "+i+" does not exist on jQuery.tabs"):e.init.apply(this,arguments)},t(document).ready(function(){t("ul.tabs").tabs()})}(jQuery),function(t){t.fn.tooltip=function(i){var n={delay:350,tooltip:"",position:"bottom",html:!1};return"remove"===i?(this.each(function(){t("#"+t(this).attr("data-tooltip-id")).remove(),t(this).removeAttr("data-tooltip-id"),t(this).off("mouseenter.tooltip mouseleave.tooltip")}),!1):(i=t.extend(n,i),this.each(function(){var n=Materialize.guid(),o=t(this);o.attr("data-tooltip-id")&&t("#"+o.attr("data-tooltip-id")).remove(),o.attr("data-tooltip-id",n);var a,r,s,l,c,u,d=function(){a=o.attr("data-html")?"true"===o.attr("data-html"):i.html,r=o.attr("data-delay"),r=void 0===r||""===r?i.delay:r,s=o.attr("data-position"),s=void 0===s||""===s?i.position:s,l=o.attr("data-tooltip"),l=void 0===l||""===l?i.tooltip:l};d();c=function(){var e=t('<div class="material-tooltip"></div>');return l=a?t("<span></span>").html(l):t("<span></span>").text(l),e.append(l).appendTo(t("body")).attr("id",n),(u=t('<div class="backdrop"></div>')).appendTo(e),e}(),o.off("mouseenter.tooltip mouseleave.tooltip");var p,h=!1;o.on({"mouseenter.tooltip":function(t){p=setTimeout(function(){d(),h=!0,c.velocity("stop"),u.velocity("stop"),c.css({visibility:"visible",left:"0px",top:"0px"});var t,i,n,a=o.outerWidth(),r=o.outerHeight(),l=c.outerHeight(),p=c.outerWidth(),f="0px",v="0px",m=u[0].offsetWidth,g=u[0].offsetHeight,y=8,b=8,w=0;"top"===s?(t=o.offset().top-l-5,i=o.offset().left+a/2-p/2,n=e(i,t,p,l),f="-10px",u.css({bottom:0,left:0,borderRadius:"14px 14px 0 0",transformOrigin:"50% 100%",marginTop:l,marginLeft:p/2-m/2})):"left"===s?(t=o.offset().top+r/2-l/2,i=o.offset().left-p-5,n=e(i,t,p,l),v="-10px",u.css({top:"-7px",right:0,width:"14px",height:"14px",borderRadius:"14px 0 0 14px",transformOrigin:"95% 50%",marginTop:l/2,marginLeft:p})):"right"===s?(t=o.offset().top+r/2-l/2,i=o.offset().left+a+5,n=e(i,t,p,l),v="+10px",u.css({top:"-7px",left:0,width:"14px",height:"14px",borderRadius:"0 14px 14px 0",transformOrigin:"5% 50%",marginTop:l/2,marginLeft:"0px"})):(t=o.offset().top+o.outerHeight()+5,i=o.offset().left+a/2-p/2,n=e(i,t,p,l),f="+10px",u.css({top:0,left:0,marginLeft:p/2-m/2})),c.css({top:n.y,left:n.x}),y=Math.SQRT2*p/parseInt(m),b=Math.SQRT2*l/parseInt(g),w=Math.max(y,b),c.velocity({translateY:f,translateX:v},{duration:350,queue:!1}).velocity({opacity:1},{duration:300,delay:50,queue:!1}),u.css({visibility:"visible"}).velocity({opacity:1},{duration:55,delay:0,queue:!1}).velocity({scaleX:w,scaleY:w},{duration:300,delay:0,queue:!1,easing:"easeInOutQuad"})},r)},"mouseleave.tooltip":function(){h=!1,clearTimeout(p),setTimeout(function(){!0!==h&&(c.velocity({opacity:0,translateY:0,translateX:0},{duration:225,queue:!1}),u.velocity({opacity:0,scaleX:1,scaleY:1},{duration:225,queue:!1,complete:function(){u.css({visibility:"hidden"}),c.css({visibility:"hidden"}),h=!1}}))},225)}})}))};var e=function(e,i,n,o){var a=e,r=i;return a<0?a=4:a+n>window.innerWidth&&(a-=a+n-window.innerWidth),r<0?r=4:r+o>window.innerHeight+t(window).scrollTop&&(r-=r+o-window.innerHeight),{x:a,y:r}};t(document).ready(function(){t(".tooltipped").tooltip()})}(jQuery),function(t){"use strict";function e(t){return null!==t&&t===t.window}function i(t){return e(t)?t:9===t.nodeType&&t.defaultView}function n(t){var e,n,o={top:0,left:0},a=t&&t.ownerDocument;return e=a.documentElement,void 0!==t.getBoundingClientRect&&(o=t.getBoundingClientRect()),n=i(a),{top:o.top+n.pageYOffset-e.clientTop,left:o.left+n.pageXOffset-e.clientLeft}}function o(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e+=i+":"+t[i]+";");return e}function a(t){if(!1===u.allowEvent(t))return null;for(var e=null,i=t.target||t.srcElement;null!==i.parentNode;){if(!(i instanceof SVGElement)&&-1!==i.className.indexOf("waves-effect")){e=i;break}i=i.parentNode}return e}function r(e){var i=a(e);null!==i&&(c.show(e,i),"ontouchstart"in t&&(i.addEventListener("touchend",c.hide,!1),i.addEventListener("touchcancel",c.hide,!1)),i.addEventListener("mouseup",c.hide,!1),i.addEventListener("mouseleave",c.hide,!1),i.addEventListener("dragend",c.hide,!1))}var s=s||{},l=document.querySelectorAll.bind(document),c={duration:750,show:function(t,e){if(2===t.button)return!1;var i=e||this,a=document.createElement("div");a.className="waves-ripple",i.appendChild(a);var r=n(i),s=t.pageY-r.top,l=t.pageX-r.left,u="scale("+i.clientWidth/100*10+")";"touches"in t&&(s=t.touches[0].pageY-r.top,l=t.touches[0].pageX-r.left),a.setAttribute("data-hold",Date.now()),a.setAttribute("data-scale",u),a.setAttribute("data-x",l),a.setAttribute("data-y",s);var d={top:s+"px",left:l+"px"};a.className=a.className+" waves-notransition",a.setAttribute("style",o(d)),a.className=a.className.replace("waves-notransition",""),d["-webkit-transform"]=u,d["-moz-transform"]=u,d["-ms-transform"]=u,d["-o-transform"]=u,d.transform=u,d.opacity="1",d["-webkit-transition-duration"]=c.duration+"ms",d["-moz-transition-duration"]=c.duration+"ms",d["-o-transition-duration"]=c.duration+"ms",d["transition-duration"]=c.duration+"ms",d["-webkit-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",d["-moz-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",d["-o-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",d["transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",a.setAttribute("style",o(d))},hide:function(t){u.touchup(t);var e=this,i=(e.clientWidth,null),n=e.getElementsByClassName("waves-ripple");if(!(n.length>0))return!1;var a=(i=n[n.length-1]).getAttribute("data-x"),r=i.getAttribute("data-y"),s=i.getAttribute("data-scale"),l=350-(Date.now()-Number(i.getAttribute("data-hold")));l<0&&(l=0),setTimeout(function(){var t={top:r+"px",left:a+"px",opacity:"0","-webkit-transition-duration":c.duration+"ms","-moz-transition-duration":c.duration+"ms","-o-transition-duration":c.duration+"ms","transition-duration":c.duration+"ms","-webkit-transform":s,"-moz-transform":s,"-ms-transform":s,"-o-transform":s,transform:s};i.setAttribute("style",o(t)),setTimeout(function(){try{e.removeChild(i)}catch(t){return!1}},c.duration)},l)},wrapInput:function(t){for(var e=0;e<t.length;e++){var i=t[e];if("input"===i.tagName.toLowerCase()){var n=i.parentNode;if("i"===n.tagName.toLowerCase()&&-1!==n.className.indexOf("waves-effect"))continue;var o=document.createElement("i");o.className=i.className+" waves-input-wrapper";var a=i.getAttribute("style");a||(a=""),o.setAttribute("style",a),i.className="waves-button-input",i.removeAttribute("style"),n.replaceChild(o,i),o.appendChild(i)}}}},u={touches:0,allowEvent:function(t){var e=!0;return"touchstart"===t.type?u.touches+=1:"touchend"===t.type||"touchcancel"===t.type?setTimeout(function(){u.touches>0&&(u.touches-=1)},500):"mousedown"===t.type&&u.touches>0&&(e=!1),e},touchup:function(t){u.allowEvent(t)}};s.displayEffect=function(e){"duration"in(e=e||{})&&(c.duration=e.duration),c.wrapInput(l(".waves-effect")),"ontouchstart"in t&&document.body.addEventListener("touchstart",r,!1),document.body.addEventListener("mousedown",r,!1)},s.attach=function(e){"input"===e.tagName.toLowerCase()&&(c.wrapInput([e]),e=e.parentNode),"ontouchstart"in t&&e.addEventListener("touchstart",r,!1),e.addEventListener("mousedown",r,!1)},t.Waves=s,document.addEventListener("DOMContentLoaded",function(){s.displayEffect()},!1)}(window),function(t,e){"use strict";var i={displayLength:1/0,inDuration:300,outDuration:375,className:void 0,completeCallback:void 0,activationPercent:.8},n=function(){function n(e,i,o,a){if(_classCallCheck(this,n),e){this.options={displayLength:i,className:o,completeCallback:a},this.options=t.extend({},n.defaults,this.options),this.message=e,this.panning=!1,this.timeRemaining=this.options.displayLength,0===n._toasts.length&&n._createContainer(),n._toasts.push(this);var r=this.createToast();r.M_Toast=this,this.el=r,this._animateIn(),this.setTimer()}}return _createClass(n,[{key:"createToast",value:function(){var e=document.createElement("div");if(e.classList.add("toast"),this.options.className){var i=this.options.className.split(" "),o=void 0,a=void 0;for(o=0,a=i.length;o<a;o++)e.classList.add(i[o])}return("object"==typeof HTMLElement?this.message instanceof HTMLElement:this.message&&"object"==typeof this.message&&null!==this.message&&1===this.message.nodeType&&"string"==typeof this.message.nodeName)?e.appendChild(this.message):this.message instanceof jQuery?t(e).append(this.message):e.innerHTML=this.message,n._container.appendChild(e),e}},{key:"_animateIn",value:function(){e(this.el,{top:0,opacity:1},{duration:300,easing:"easeOutCubic",queue:!1})}},{key:"setTimer",value:function(){var t=this;this.timeRemaining!==1/0&&(this.counterInterval=setInterval(function(){t.panning||(t.timeRemaining-=20),t.timeRemaining<=0&&t.remove()},20))}},{key:"remove",value:function(){var t=this;window.clearInterval(this.counterInterval);var i=this.el.offsetWidth*this.options.activationPercent;this.wasSwiped&&(this.el.style.transition="transform .05s, opacity .05s",this.el.style.transform="translateX("+i+"px)",this.el.style.opacity=0),e(this.el,{opacity:0,marginTop:"-40px"},{duration:this.options.outDuration,easing:"easeOutExpo",queue:!1,complete:function(){"function"==typeof t.options.completeCallback&&t.options.completeCallback(),t.el.parentNode.removeChild(t.el),n._toasts.splice(n._toasts.indexOf(t),1),0===n._toasts.length&&n._removeContainer()}})}}],[{key:"_createContainer",value:function(){var t=document.createElement("div");t.setAttribute("id","toast-container"),t.addEventListener("touchstart",n._onDragStart),t.addEventListener("touchmove",n._onDragMove),t.addEventListener("touchend",n._onDragEnd),t.addEventListener("mousedown",n._onDragStart),document.addEventListener("mousemove",n._onDragMove),document.addEventListener("mouseup",n._onDragEnd),document.body.appendChild(t),n._container=t}},{key:"_removeContainer",value:function(){document.removeEventListener("mousemove",n._onDragMove),document.removeEventListener("mouseup",n._onDragEnd),n._container.parentNode.removeChild(n._container),n._container=null}},{key:"_onDragStart",value:function(e){if(e.target&&t(e.target).closest(".toast").length){var i=t(e.target).closest(".toast")[0].M_Toast;i.panning=!0,n._draggedToast=i,i.el.classList.add("panning"),i.el.style.transition="",i.startingXPos=n._xPos(e),i.time=Date.now(),i.xPos=n._xPos(e)}}},{key:"_onDragMove",value:function(t){if(n._draggedToast){t.preventDefault();var e=n._draggedToast;e.deltaX=Math.abs(e.xPos-n._xPos(t)),e.xPos=n._xPos(t),e.velocityX=e.deltaX/(Date.now()-e.time),e.time=Date.now();var i=e.xPos-e.startingXPos,o=e.el.offsetWidth*e.options.activationPercent;e.el.style.transform="translateX("+i+"px)",e.el.style.opacity=1-Math.abs(i/o)}}},{key:"_onDragEnd",value:function(t){if(n._draggedToast){var e=n._draggedToast;e.panning=!1,e.el.classList.remove("panning");var i=e.xPos-e.startingXPos,o=e.el.offsetWidth*e.options.activationPercent;Math.abs(i)>o||e.velocityX>1?(e.wasSwiped=!0,e.remove()):(e.el.style.transition="transform .2s, opacity .2s",e.el.style.transform="",e.el.style.opacity=""),n._draggedToast=null}}},{key:"_xPos",value:function(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}},{key:"removeAll",value:function(){for(var t in n._toasts)n._toasts[t].remove()}},{key:"defaults",get:function(){return i}}]),n}();n._toasts=[],n._container=null,n._draggedToast=null,Materialize.Toast=n,Materialize.toast=function(t,e,i,o){return new n(t,e,i,o)}}(jQuery,Materialize.Vel),function(t){var e={init:function(e){var i={menuWidth:300,edge:"left",closeOnClick:!1,draggable:!0,onOpen:null,onClose:null};e=t.extend(i,e),t(this).each(function(){var i=t(this),n=i.attr("data-activates"),o=t("#"+n);300!=e.menuWidth&&o.css("width",e.menuWidth);var a=t('.drag-target[data-sidenav="'+n+'"]');e.draggable?(a.length&&a.remove(),a=t('<div class="drag-target"></div>').attr("data-sidenav",n),t("body").append(a)):a=t(),"left"==e.edge?(o.css("transform","translateX(-100%)"),a.css({left:0})):(o.addClass("right-aligned").css("transform","translateX(100%)"),a.css({right:0})),o.hasClass("fixed")&&window.innerWidth>992&&o.css("transform","translateX(0)"),o.hasClass("fixed")&&t(window).resize(function(){window.innerWidth>992?0!==t("#sidenav-overlay").length&&l?r(!0):o.css("transform","translateX(0%)"):!1===l&&("left"===e.edge?o.css("transform","translateX(-100%)"):o.css("transform","translateX(100%)"))}),!0===e.closeOnClick&&o.on("click.itemclick","a:not(.collapsible-header)",function(){window.innerWidth>992&&o.hasClass("fixed")||r()});var r=function(i){s=!1,l=!1,t("body").css({overflow:"",width:""}),t("#sidenav-overlay").velocity({opacity:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){t(this).remove()}}),"left"===e.edge?(a.css({width:"",right:"",left:"0"}),o.velocity({translateX:"-100%"},{duration:200,queue:!1,easing:"easeOutCubic",complete:function(){!0===i&&(o.removeAttr("style"),o.css("width",e.menuWidth))}})):(a.css({width:"",right:"0",left:""}),o.velocity({translateX:"100%"},{duration:200,queue:!1,easing:"easeOutCubic",complete:function(){!0===i&&(o.removeAttr("style"),o.css("width",e.menuWidth))}})),"function"==typeof e.onClose&&e.onClose.call(this,o)},s=!1,l=!1;e.draggable&&(a.on("click",function(){l&&r()}),a.hammer({prevent_default:!1}).on("pan",function(i){if("touch"==i.gesture.pointerType){i.gesture.direction;var n=i.gesture.center.x,a=i.gesture.center.y;i.gesture.velocityX;if(0===n&&0===a)return;var s=t("body"),c=t("#sidenav-overlay"),u=s.innerWidth();if(s.css("overflow","hidden"),s.width(u),0===c.length&&((c=t('<div id="sidenav-overlay"></div>')).css("opacity",0).click(function(){r()}),"function"==typeof e.onOpen&&e.onOpen.call(this,o),t("body").append(c)),"left"===e.edge&&(n>e.menuWidth?n=e.menuWidth:n<0&&(n=0)),"left"===e.edge)n<e.menuWidth/2?l=!1:n>=e.menuWidth/2&&(l=!0),o.css("transform","translateX("+(n-e.menuWidth)+"px)");else{n<window.innerWidth-e.menuWidth/2?l=!0:n>=window.innerWidth-e.menuWidth/2&&(l=!1);var d=n-e.menuWidth/2;d<0&&(d=0),o.css("transform","translateX("+d+"px)")}var p;"left"===e.edge?(p=n/e.menuWidth,c.velocity({opacity:p},{duration:10,queue:!1,easing:"easeOutQuad"})):(p=Math.abs((n-window.innerWidth)/e.menuWidth),c.velocity({opacity:p},{duration:10,queue:!1,easing:"easeOutQuad"}))}}).on("panend",function(i){if("touch"==i.gesture.pointerType){var n=t("#sidenav-overlay"),r=i.gesture.velocityX,c=i.gesture.center.x,u=c-e.menuWidth,d=c-e.menuWidth/2;u>0&&(u=0),d<0&&(d=0),s=!1,"left"===e.edge?l&&r<=.3||r<-.5?(0!==u&&o.velocity({translateX:[0,u]},{duration:300,queue:!1,easing:"easeOutQuad"}),n.velocity({opacity:1},{duration:50,queue:!1,easing:"easeOutQuad"}),a.css({width:"50%",right:0,left:""}),l=!0):(!l||r>.3)&&(t("body").css({overflow:"",width:""}),o.velocity({translateX:[-1*e.menuWidth-10,u]},{duration:200,queue:!1,easing:"easeOutQuad"}),n.velocity({opacity:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){"function"==typeof e.onClose&&e.onClose.call(this,o),t(this).remove()}}),a.css({width:"10px",right:"",left:0})):l&&r>=-.3||r>.5?(0!==d&&o.velocity({translateX:[0,d]},{duration:300,queue:!1,easing:"easeOutQuad"}),n.velocity({opacity:1},{duration:50,queue:!1,easing:"easeOutQuad"}),a.css({width:"50%",right:"",left:0}),l=!0):(!l||r<-.3)&&(t("body").css({overflow:"",width:""}),o.velocity({translateX:[e.menuWidth+10,d]},{duration:200,queue:!1,easing:"easeOutQuad"}),n.velocity({opacity:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){"function"==typeof e.onClose&&e.onClose.call(this,o),t(this).remove()}}),a.css({width:"10px",right:0,left:""}))}})),i.off("click.sidenav").on("click.sidenav",function(){if(!0===l)l=!1,s=!1,r();else{var i=t("body"),n=t('<div id="sidenav-overlay"></div>'),c=i.innerWidth();i.css("overflow","hidden"),i.width(c),t("body").append(a),"left"===e.edge?(a.css({width:"50%",right:0,left:""}),o.velocity({translateX:[0,-1*e.menuWidth]},{duration:300,queue:!1,easing:"easeOutQuad"})):(a.css({width:"50%",right:"",left:0}),o.velocity({translateX:[0,e.menuWidth]},{duration:300,queue:!1,easing:"easeOutQuad"})),n.css("opacity",0).click(function(){l=!1,s=!1,r(),n.velocity({opacity:0},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){t(this).remove()}})}),t("body").append(n),n.velocity({opacity:1},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){l=!0,s=!1}}),"function"==typeof e.onOpen&&e.onOpen.call(this,o)}return!1})})},destroy:function(){var e=t("#sidenav-overlay"),i=t('.drag-target[data-sidenav="'+t(this).attr("data-activates")+'"]');e.trigger("click"),i.remove(),t(this).off("click"),e.remove()},show:function(){this.trigger("click")},hide:function(){t("#sidenav-overlay").trigger("click")}};t.fn.sideNav=function(i){return e[i]?e[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?void t.error("Method "+i+" does not exist on jQuery.sideNav"):e.init.apply(this,arguments)}}(jQuery),function(t){function e(e,i,n,o){var r=t();return t.each(a,function(t,a){if(a.height()>0){var s=a.offset().top,l=a.offset().left,c=l+a.width(),u=s+a.height();!(l>i||c<o||s>n||u<e)&&r.push(a)}}),r}function i(i){++l;var n=o.scrollTop(),a=o.scrollLeft(),s=a+o.width(),u=n+o.height(),d=e(n+c.top+i||200,s+c.right,u+c.bottom,a+c.left);t.each(d,function(t,e){"number"!=typeof e.data("scrollSpy:ticks")&&e.triggerHandler("scrollSpy:enter"),e.data("scrollSpy:ticks",l)}),t.each(r,function(t,e){var i=e.data("scrollSpy:ticks");"number"==typeof i&&i!==l&&(e.triggerHandler("scrollSpy:exit"),e.data("scrollSpy:ticks",null))}),r=d}function n(){o.trigger("scrollSpy:winSize")}var o=t(window),a=[],r=[],s=!1,l=0,c={top:0,right:0,bottom:0,left:0};t.scrollSpy=function(e,n){var r={throttle:100,scrollOffset:200,activeClass:"active",getActiveElement:function(t){return'a[href="#'+t+'"]'}};n=t.extend(r,n);var l=[];(e=t(e)).each(function(e,i){a.push(t(i)),t(i).data("scrollSpy:id",e),t('a[href="#'+t(i).attr("id")+'"]').click(function(e){e.preventDefault();var i=t(Materialize.escapeHash(this.hash)).offset().top+1;t("html, body").animate({scrollTop:i-n.scrollOffset},{duration:400,queue:!1,easing:"easeOutCubic"})})}),c.top=n.offsetTop||0,c.right=n.offsetRight||0,c.bottom=n.offsetBottom||0,c.left=n.offsetLeft||0;var u=Materialize.throttle(function(){i(n.scrollOffset)},n.throttle||100),d=function(){t(document).ready(u)};return s||(o.on("scroll",d),o.on("resize",d),s=!0),setTimeout(d,0),e.on("scrollSpy:enter",function(){l=t.grep(l,function(t){return 0!=t.height()});var e=t(this);l[0]?(t(n.getActiveElement(l[0].attr("id"))).removeClass(n.activeClass),e.data("scrollSpy:id")<l[0].data("scrollSpy:id")?l.unshift(t(this)):l.push(t(this))):l.push(t(this)),t(n.getActiveElement(l[0].attr("id"))).addClass(n.activeClass)}),e.on("scrollSpy:exit",function(){if((l=t.grep(l,function(t){return 0!=t.height()}))[0]){t(n.getActiveElement(l[0].attr("id"))).removeClass(n.activeClass);var e=t(this);(l=t.grep(l,function(t){return t.attr("id")!=e.attr("id")}))[0]&&t(n.getActiveElement(l[0].attr("id"))).addClass(n.activeClass)}}),e},t.winSizeSpy=function(e){return t.winSizeSpy=function(){return o},e=e||{throttle:100},o.on("resize",Materialize.throttle(n,e.throttle||100))},t.fn.scrollSpy=function(e){return t.scrollSpy(t(this),e)}}(jQuery),function(t){t(document).ready(function(){function e(e){var i=e.css("font-family"),o=e.css("font-size"),a=e.css("line-height"),r=e.css("padding");o&&n.css("font-size",o),i&&n.css("font-family",i),a&&n.css("line-height",a),r&&n.css("padding",r),e.data("original-height")||e.data("original-height",e.height()),"off"===e.attr("wrap")&&n.css("overflow-wrap","normal").css("white-space","pre"),n.text(e.val()+"\n");var s=n.html().replace(/\n/g,"<br>");n.html(s),e.is(":visible")?n.css("width",e.width()):n.css("width",t(window).width()/2),e.data("original-height")<=n.height()?e.css("height",n.height()):e.val().length<e.data("previous-length")&&e.css("height",e.data("original-height")),e.data("previous-length",e.val().length)}Materialize.updateTextFields=function(){t("input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], textarea").each(function(e,i){var n=t(this);t(i).val().length>0||t(i).is(":focus")||i.autofocus||void 0!==n.attr("placeholder")?n.siblings("label").addClass("active"):t(i)[0].validity?n.siblings("label").toggleClass("active",!0===t(i)[0].validity.badInput):n.siblings("label").removeClass("active")})};var i="input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], textarea";t(document).on("change",i,function(){0===t(this).val().length&&void 0===t(this).attr("placeholder")||t(this).siblings("label").addClass("active"),validate_field(t(this))}),t(document).ready(function(){Materialize.updateTextFields()}),t(document).on("reset",function(e){var n=t(e.target);n.is("form")&&(n.find(i).removeClass("valid").removeClass("invalid"),n.find(i).each(function(){""===t(this).attr("value")&&t(this).siblings("label").removeClass("active")}),n.find("select.initialized").each(function(){var t=n.find("option[selected]").text();n.siblings("input.select-dropdown").val(t)}))}),t(document).on("focus",i,function(){t(this).siblings("label, .prefix").addClass("active")}),t(document).on("blur",i,function(){var e=t(this),i=".prefix";0===e.val().length&&!0!==e[0].validity.badInput&&void 0===e.attr("placeholder")&&(i+=", label"),e.siblings(i).removeClass("active"),validate_field(e)}),window.validate_field=function(t){var e=void 0!==t.attr("data-length"),i=parseInt(t.attr("data-length")),n=t.val().length;0!==t.val().length||!1!==t[0].validity.badInput||t.is(":required")?t.hasClass("validate")&&(t.is(":valid")&&e&&n<=i||t.is(":valid")&&!e?(t.removeClass("invalid"),t.addClass("valid")):(t.removeClass("valid"),t.addClass("invalid"))):t.hasClass("validate")&&(t.removeClass("valid"),t.removeClass("invalid"))};t(document).on("keyup.radio","input[type=radio], input[type=checkbox]",function(e){if(9===e.which)return t(this).addClass("tabbed"),void t(this).one("blur",function(e){t(this).removeClass("tabbed")})});var n=t(".hiddendiv").first();n.length||(n=t('<div class="hiddendiv common"></div>'),t("body").append(n));t(".materialize-textarea").each(function(){var e=t(this);e.data("original-height",e.height()),e.data("previous-length",e.val().length)}),t("body").on("keyup keydown autoresize",".materialize-textarea",function(){e(t(this))}),t(document).on("change",'.file-field input[type="file"]',function(){for(var e=t(this).closest(".file-field").find("input.file-path"),i=t(this)[0].files,n=[],o=0;o<i.length;o++)n.push(i[o].name);e.val(n.join(", ")),e.trigger("change")});var o="input[type=range]",a=!1;t(o).each(function(){var e=t('<span class="thumb"><span class="value"></span></span>');t(this).after(e)});var r=function(t){var e=-7+parseInt(t.parent().css("padding-left"))+"px";t.velocity({height:"30px",width:"30px",top:"-30px",marginLeft:e},{duration:300,easing:"easeOutExpo"})},s=function(t){var e=t.width()-15,i=parseFloat(t.attr("max")),n=parseFloat(t.attr("min"));return(parseFloat(t.val())-n)/(i-n)*e};t(document).on("change",o,function(e){var i=t(this).siblings(".thumb");i.find(".value").html(t(this).val()),i.hasClass("active")||r(i);var n=s(t(this));i.addClass("active").css("left",n)}),t(document).on("mousedown touchstart",o,function(e){var i=t(this).siblings(".thumb");if(i.length<=0&&(i=t('<span class="thumb"><span class="value"></span></span>'),t(this).after(i)),i.find(".value").html(t(this).val()),a=!0,t(this).addClass("active"),i.hasClass("active")||r(i),"input"!==e.type){var n=s(t(this));i.addClass("active").css("left",n)}}),t(document).on("mouseup touchend",".range-field",function(){a=!1,t(this).removeClass("active")}),t(document).on("input mousemove touchmove",".range-field",function(e){var i=t(this).children(".thumb"),n=t(this).find(o);if(a){i.hasClass("active")||r(i);var l=s(n);i.addClass("active").css("left",l),i.find(".value").html(i.siblings(o).val())}}),t(document).on("mouseout touchleave",".range-field",function(){if(!a){var e=t(this).children(".thumb"),i=7+parseInt(t(this).css("padding-left"))+"px";e.hasClass("active")&&e.velocity({height:"0",width:"0",top:"10px",marginLeft:i},{duration:100}),e.removeClass("active")}}),t.fn.autocomplete=function(e){var i={data:{},limit:1/0,onAutocomplete:null,minLength:1};return e=t.extend(i,e),this.each(function(){var i,n=t(this),o=e.data,a=0,r=-1,s=n.closest(".input-field");if(t.isEmptyObject(o))n.off("keyup.autocomplete focus.autocomplete");else{var l,c=t('<ul class="autocomplete-content dropdown-content"></ul>');s.length?(l=s.children(".autocomplete-content.dropdown-content").first()).length||s.append(c):(l=n.next(".autocomplete-content.dropdown-content")).length||n.after(c),l.length&&(c=l);var u=function(t,e){var i=e.find("img"),n=e.text().toLowerCase().indexOf(""+t.toLowerCase()),o=n+t.length-1,a=e.text().slice(0,n),r=e.text().slice(n,o+1),s=e.text().slice(o+1);e.html("<span>"+a+"<span class='highlight'>"+r+"</span>"+s+"</span>"),i.length&&e.prepend(i)},d=function(){r=-1,c.find(".active").removeClass("active")},p=function(){c.empty(),d(),i=void 0};n.off("blur.autocomplete").on("blur.autocomplete",function(){p()}),n.off("keyup.autocomplete focus.autocomplete").on("keyup.autocomplete focus.autocomplete",function(r){a=0;var s=n.val().toLowerCase();if(13!==r.which&&38!==r.which&&40!==r.which){if(i!==s&&(p(),s.length>=e.minLength))for(var l in o)if(o.hasOwnProperty(l)&&-1!==l.toLowerCase().indexOf(s)){if(a>=e.limit)break;var d=t("<li></li>");o[l]?d.append('<img src="'+o[l]+'" class="right circle"><span>'+l+"</span>"):d.append("<span>"+l+"</span>"),c.append(d),u(s,d),a++}i=s}}),n.off("keydown.autocomplete").on("keydown.autocomplete",function(t){var e,i=t.which,n=c.children("li").length,o=c.children(".active").first();13===i&&r>=0?(e=c.children("li").eq(r)).length&&(e.trigger("mousedown.autocomplete"),t.preventDefault()):38!==i&&40!==i||(t.preventDefault(),38===i&&r>0&&r--,40===i&&r<n-1&&r++,o.removeClass("active"),r>=0&&c.children("li").eq(r).addClass("active"))}),c.off("mousedown.autocomplete touchstart.autocomplete").on("mousedown.autocomplete touchstart.autocomplete","li",function(){var i=t(this).text().trim();n.val(i),n.trigger("change"),p(),"function"==typeof e.onAutocomplete&&e.onAutocomplete.call(this,i)})}})}}),t.fn.material_select=function(e){function i(t,e,i){var o=t.indexOf(e),a=-1===o;return a?t.push(e):t.splice(o,1),i.siblings("ul.dropdown-content").find("li:not(.optgroup)").eq(e).toggleClass("active"),i.find("option").eq(e).prop("selected",a),n(t,i),a}function n(t,e){for(var i="",n=0,o=t.length;n<o;n++){var a=e.find("option").eq(t[n]).text();i+=0===n?a:", "+a}""===i&&(i=e.find("option:disabled").eq(0).text()),e.siblings("input.select-dropdown").val(i)}t(this).each(function(){var n=t(this);if(!n.hasClass("browser-default")){var o=!!n.attr("multiple"),a=n.attr("data-select-id");if(a&&(n.parent().find("span.caret").remove(),n.parent().find("input").remove(),n.unwrap(),t("ul#select-options-"+a).remove()),"destroy"===e)return n.removeAttr("data-select-id").removeClass("initialized"),void t(window).off("click.select");var r=Materialize.guid();n.attr("data-select-id",r);var s=t('<div class="select-wrapper"></div>');s.addClass(n.attr("class")),n.is(":disabled")&&s.addClass("disabled");var l=t('<ul id="select-options-'+r+'" class="dropdown-content select-dropdown '+(o?"multiple-select-dropdown":"")+'"></ul>'),c=n.children("option, optgroup"),u=[],d=!1,p=n.find("option:selected").html()||n.find("option:first").html()||"",h=function(e,i,n){var a=i.is(":disabled")?"disabled ":"",r="optgroup-option"===n?"optgroup-option ":"",s=o?'<input type="checkbox"'+a+"/><label></label>":"",c=i.data("icon"),u=i.attr("class");if(c){var d="";return u&&(d=' class="'+u+'"'),l.append(t('<li class="'+a+r+'"><img alt="" src="'+c+'"'+d+"><span>"+s+i.html()+"</span></li>")),!0}l.append(t('<li class="'+a+r+'"><span>'+s+i.html()+"</span></li>"))};c.length&&c.each(function(){if(t(this).is("option"))o?h(0,t(this),"multiple"):h(0,t(this));else if(t(this).is("optgroup")){var e=t(this).children("option");l.append(t('<li class="optgroup"><span>'+t(this).attr("label")+"</span></li>")),e.each(function(){h(0,t(this),"optgroup-option")})}}),l.find("li:not(.optgroup)").each(function(a){t(this).click(function(r){if(!t(this).hasClass("disabled")&&!t(this).hasClass("optgroup")){var s=!0;o?(t('input[type="checkbox"]',this).prop("checked",function(t,e){return!e}),s=i(u,a,n),m.trigger("focus")):(l.find("li").removeClass("active"),t(this).toggleClass("active"),m.val(t(this).text())),g(l,t(this)),n.find("option").eq(a).prop("selected",s),n.trigger("change"),void 0!==e&&e()}r.stopPropagation()})}),n.wrap(s);var f=t('<span class="caret">&#9660;</span>'),v=p.replace(/"/g,"&quot;"),m=t('<input type="text" class="select-dropdown" readonly="true" '+(n.is(":disabled")?"disabled":"")+' data-activates="select-options-'+r+'" value="'+v+'"/>');n.before(m),m.before(f),m.after(l),n.is(":disabled")||m.dropdown({hover:!1}),n.attr("tabindex")&&t(m[0]).attr("tabindex",n.attr("tabindex")),n.addClass("initialized"),m.on({focus:function(){if(t("ul.select-dropdown").not(l[0]).is(":visible")&&(t("input.select-dropdown").trigger("close"),t(window).off("click.select")),!l.is(":visible")){t(this).trigger("open",["focus"]);var e=t(this).val();o&&e.indexOf(",")>=0&&(e=e.split(",")[0]);var i=l.find("li").filter(function(){return t(this).text().toLowerCase()===e.toLowerCase()})[0];g(l,i,!0),t(window).off("click.select").on("click.select",function(){o&&(d||m.trigger("close")),t(window).off("click.select")})}},click:function(t){t.stopPropagation()}}),m.on("blur",function(){o||(t(this).trigger("close"),t(window).off("click.select")),l.find("li.selected").removeClass("selected")}),l.hover(function(){d=!0},function(){d=!1}),o&&n.find("option:selected:not(:disabled)").each(function(){var t=this.index;i(u,t,n),l.find("li:not(.optgroup)").eq(t).find(":checkbox").prop("checked",!0)});var g=function(e,i,n){if(i){e.find("li.selected").removeClass("selected");var a=t(i);a.addClass("selected"),o&&!n||l.scrollTo(a)}},y=[];m.on("keydown",function(e){if(9!=e.which)if(40!=e.which||l.is(":visible")){if(13!=e.which||l.is(":visible")){e.preventDefault();var i=String.fromCharCode(e.which).toLowerCase(),n=[9,13,27,38,40];if(i&&-1===n.indexOf(e.which)){y.push(i);var a=y.join(""),r=l.find("li").filter(function(){return 0===t(this).text().toLowerCase().indexOf(a)})[0];r&&g(l,r)}if(13==e.which){var s=l.find("li.selected:not(.disabled)")[0];s&&(t(s).trigger("click"),o||m.trigger("close"))}40==e.which&&(r=l.find("li.selected").length?l.find("li.selected").next("li:not(.disabled)")[0]:l.find("li:not(.disabled)")[0],g(l,r)),27==e.which&&m.trigger("close"),38==e.which&&(r=l.find("li.selected").prev("li:not(.disabled)")[0])&&g(l,r),setTimeout(function(){y=[]},1e3)}}else m.trigger("open");else m.trigger("close")})}})}}(jQuery),function(t){var e={init:function(e){var i={indicators:!0,height:400,transition:500,interval:6e3};return e=t.extend(i,e),this.each(function(){function i(t,e){t.hasClass("center-align")?t.velocity({opacity:0,translateY:-100},{duration:e,queue:!1}):t.hasClass("right-align")?t.velocity({opacity:0,translateX:100},{duration:e,queue:!1}):t.hasClass("left-align")&&t.velocity({opacity:0,translateX:-100},{duration:e,queue:!1})}function n(t){t>=c.length?t=0:t<0&&(t=c.length-1),(u=l.find(".active").index())!=t&&(o=c.eq(u),$caption=o.find(".caption"),o.removeClass("active"),o.velocity({opacity:0},{duration:e.transition,queue:!1,easing:"easeOutQuad",complete:function(){c.not(".active").velocity({opacity:0,translateX:0,translateY:0},{duration:0,queue:!1})}}),i($caption,e.transition),e.indicators&&a.eq(u).removeClass("active"),c.eq(t).velocity({opacity:1},{duration:e.transition,queue:!1,easing:"easeOutQuad"}),c.eq(t).find(".caption").velocity({opacity:1,translateX:0,translateY:0},{duration:e.transition,delay:e.transition,queue:!1,easing:"easeOutQuad"}),c.eq(t).addClass("active"),e.indicators&&a.eq(t).addClass("active"))}var o,a,r,s=t(this),l=s.find("ul.slides").first(),c=l.find("> li"),u=l.find(".active").index();-1!=u&&(o=c.eq(u)),s.hasClass("fullscreen")||(e.indicators?s.height(e.height+40):s.height(e.height),l.height(e.height)),c.find(".caption").each(function(){i(t(this),0)}),c.find("img").each(function(){var e="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";t(this).attr("src")!==e&&(t(this).css("background-image",'url("'+t(this).attr("src")+'")'),t(this).attr("src",e))}),e.indicators&&(a=t('<ul class="indicators"></ul>'),c.each(function(i){var o=t('<li class="indicator-item"></li>');o.click(function(){n(l.parent().find(t(this)).index()),clearInterval(r),r=setInterval(function(){u=l.find(".active").index(),c.length==u+1?u=0:u+=1,n(u)},e.transition+e.interval)}),a.append(o)}),s.append(a),a=s.find("ul.indicators").find("li.indicator-item")),o?o.show():(c.first().addClass("active").velocity({opacity:1},{duration:e.transition,queue:!1,easing:"easeOutQuad"}),u=0,o=c.eq(u),e.indicators&&a.eq(u).addClass("active")),o.find("img").each(function(){o.find(".caption").velocity({opacity:1,translateX:0,translateY:0},{duration:e.transition,queue:!1,easing:"easeOutQuad"})}),r=setInterval(function(){n((u=l.find(".active").index())+1)},e.transition+e.interval);var d=!1,p=!1,h=!1;s.hammer({prevent_default:!1}).on("pan",function(t){if("touch"===t.gesture.pointerType){clearInterval(r);var e=t.gesture.direction,i=t.gesture.deltaX,n=t.gesture.velocityX,o=t.gesture.velocityY;$curr_slide=l.find(".active"),Math.abs(n)>Math.abs(o)&&$curr_slide.velocity({translateX:i},{duration:50,queue:!1,easing:"easeOutQuad"}),4===e&&(i>s.innerWidth()/2||n<-.65)?h=!0:2===e&&(i<-1*s.innerWidth()/2||n>.65)&&(p=!0);var a;p&&(0===(a=$curr_slide.next()).length&&(a=c.first()),a.velocity({opacity:1},{duration:300,queue:!1,easing:"easeOutQuad"})),h&&(0===(a=$curr_slide.prev()).length&&(a=c.last()),a.velocity({opacity:1},{duration:300,queue:!1,easing:"easeOutQuad"}))}}).on("panend",function(t){"touch"===t.gesture.pointerType&&($curr_slide=l.find(".active"),d=!1,curr_index=l.find(".active").index(),!h&&!p||c.length<=1?$curr_slide.velocity({translateX:0},{duration:300,queue:!1,easing:"easeOutQuad"}):p?(n(curr_index+1),$curr_slide.velocity({translateX:-1*s.innerWidth()},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){$curr_slide.velocity({opacity:0,translateX:0},{duration:0,queue:!1})}})):h&&(n(curr_index-1),$curr_slide.velocity({translateX:s.innerWidth()},{duration:300,queue:!1,easing:"easeOutQuad",complete:function(){$curr_slide.velocity({opacity:0,translateX:0},{duration:0,queue:!1})}})),p=!1,h=!1,clearInterval(r),r=setInterval(function(){u=l.find(".active").index(),c.length==u+1?u=0:u+=1,n(u)},e.transition+e.interval))}),s.on("sliderPause",function(){clearInterval(r)}),s.on("sliderStart",function(){clearInterval(r),r=setInterval(function(){u=l.find(".active").index(),c.length==u+1?u=0:u+=1,n(u)},e.transition+e.interval)}),s.on("sliderNext",function(){n((u=l.find(".active").index())+1)}),s.on("sliderPrev",function(){n((u=l.find(".active").index())-1)})})},pause:function(){t(this).trigger("sliderPause")},start:function(){t(this).trigger("sliderStart")},next:function(){t(this).trigger("sliderNext")},prev:function(){t(this).trigger("sliderPrev")}};t.fn.slider=function(i){return e[i]?e[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?void t.error("Method "+i+" does not exist on jQuery.tooltip"):e.init.apply(this,arguments)}}(jQuery),function(t){t(document).ready(function(){t(document).on("click.card",".card",function(e){if(t(this).find("> .card-reveal").length){var i=t(e.target).closest(".card");void 0===i.data("initialOverflow")&&i.data("initialOverflow",void 0===i.css("overflow")?"":i.css("overflow")),t(e.target).is(t(".card-reveal .card-title"))||t(e.target).is(t(".card-reveal .card-title i"))?t(this).find(".card-reveal").velocity({translateY:0},{duration:225,queue:!1,easing:"easeInOutQuad",complete:function(){t(this).css({display:"none"}),i.css("overflow",i.data("initialOverflow"))}}):(t(e.target).is(t(".card .activator"))||t(e.target).is(t(".card .activator i")))&&(i.css("overflow","hidden"),t(this).find(".card-reveal").css({display:"block"}).velocity("stop",!1).velocity({translateY:"-100%"},{duration:300,queue:!1,easing:"easeInOutQuad"}))}})})}(jQuery),function(t){var e={data:[],placeholder:"",secondaryPlaceholder:"",autocompleteOptions:{}};t(document).ready(function(){t(document).on("click",".chip .close",function(e){t(this).closest(".chips").attr("data-initialized")||t(this).closest(".chip").remove()})}),t.fn.material_chip=function(i){var n=this;if(this.$el=t(this),this.$document=t(document),this.SELS={CHIPS:".chips",CHIP:".chip",INPUT:"input",DELETE:".material-icons",SELECTED_CHIP:".selected"},"data"===i)return this.$el.data("chips");var o=t.extend({},e,i);n.hasAutocomplete=!t.isEmptyObject(o.autocompleteOptions.data),this.init=function(){var e=0;n.$el.each(function(){var i=t(this),a=Materialize.guid();n.chipId=a,o.data&&o.data instanceof Array||(o.data=[]),i.data("chips",o.data),i.attr("data-index",e),i.attr("data-initialized",!0),i.hasClass(n.SELS.CHIPS)||i.addClass("chips"),n.chips(i,a),e++})},this.handleEvents=function(){var e=n.SELS;n.$document.off("click.chips-focus",e.CHIPS).on("click.chips-focus",e.CHIPS,function(i){t(i.target).find(e.INPUT).focus()}),n.$document.off("click.chips-select",e.CHIP).on("click.chips-select",e.CHIP,function(i){var o=t(i.target);if(o.length){var a=o.hasClass("selected"),r=o.closest(e.CHIPS);t(e.CHIP).removeClass("selected"),a||n.selectChip(o.index(),r)}}),n.$document.off("keydown.chips").on("keydown.chips",function(i){if(!t(i.target).is("input, textarea")){var o,a=n.$document.find(e.CHIP+e.SELECTED_CHIP),r=a.closest(e.CHIPS),s=a.siblings(e.CHIP).length;if(a.length)if(8===i.which||46===i.which){i.preventDefault(),o=a.index(),n.deleteChip(o,r);var l=null;o+1<s?l=o:o!==s&&o+1!==s||(l=s-1),l<0&&(l=null),null!==l&&n.selectChip(l,r),s||r.find("input").focus()}else if(37===i.which){if((o=a.index()-1)<0)return;t(e.CHIP).removeClass("selected"),n.selectChip(o,r)}else if(39===i.which){if(o=a.index()+1,t(e.CHIP).removeClass("selected"),o>s)return void r.find("input").focus();n.selectChip(o,r)}}}),n.$document.off("focusin.chips",e.CHIPS+" "+e.INPUT).on("focusin.chips",e.CHIPS+" "+e.INPUT,function(i){var n=t(i.target).closest(e.CHIPS);n.addClass("focus"),n.siblings("label, .prefix").addClass("active"),t(e.CHIP).removeClass("selected")}),n.$document.off("focusout.chips",e.CHIPS+" "+e.INPUT).on("focusout.chips",e.CHIPS+" "+e.INPUT,function(i){var n=t(i.target).closest(e.CHIPS);n.removeClass("focus"),void 0!==n.data("chips")&&n.data("chips").length||n.siblings("label").removeClass("active"),n.siblings(".prefix").removeClass("active")}),n.$document.off("keydown.chips-add",e.CHIPS+" "+e.INPUT).on("keydown.chips-add",e.CHIPS+" "+e.INPUT,function(i){var o=t(i.target),a=o.closest(e.CHIPS),r=a.children(e.CHIP).length;if(13===i.which){if(n.hasAutocomplete&&a.find(".autocomplete-content.dropdown-content").length&&a.find(".autocomplete-content.dropdown-content").children().length)return;return i.preventDefault(),n.addChip({tag:o.val()},a),void o.val("")}if((8===i.keyCode||37===i.keyCode)&&""===o.val()&&r)return i.preventDefault(),n.selectChip(r-1,a),void o.blur()}),n.$document.off("click.chips-delete",e.CHIPS+" "+e.DELETE).on("click.chips-delete",e.CHIPS+" "+e.DELETE,function(i){var o=t(i.target),a=o.closest(e.CHIPS),r=o.closest(e.CHIP);i.stopPropagation(),n.deleteChip(r.index(),a),a.find("input").focus()})},this.chips=function(e,i){e.empty(),e.data("chips").forEach(function(t){e.append(n.renderChip(t))}),e.append(t('<input id="'+i+'" class="input" placeholder="">')),n.setPlaceholder(e);var a=e.next("label");a.length&&(a.attr("for",i),void 0!==e.data("chips")&&e.data("chips").length&&a.addClass("active"));var r=t("#"+i);n.hasAutocomplete&&(o.autocompleteOptions.onAutocomplete=function(t){n.addChip({tag:t},e),r.val(""),r.focus()},r.autocomplete(o.autocompleteOptions))},this.renderChip=function(e){if(e.tag){var i=t('<div class="chip"></div>');return i.text(e.tag),e.image&&i.prepend(t("<img />").attr("src",e.image)),i.append(t('<i class="material-icons close">close</i>')),i}},this.setPlaceholder=function(t){void 0!==t.data("chips")&&!t.data("chips").length&&o.placeholder?t.find("input").prop("placeholder",o.placeholder):(void 0===t.data("chips")||t.data("chips").length)&&o.secondaryPlaceholder&&t.find("input").prop("placeholder",o.secondaryPlaceholder)},this.isValid=function(t,e){for(var i=t.data("chips"),n=!1,o=0;o<i.length;o++)if(i[o].tag===e.tag)return void(n=!0);return""!==e.tag&&!n},this.addChip=function(t,e){if(n.isValid(e,t)){for(var i=n.renderChip(t),o=[],a=e.data("chips"),r=0;r<a.length;r++)o.push(a[r]);o.push(t),e.data("chips",o),i.insertBefore(e.find("input")),e.trigger("chip.add",t),n.setPlaceholder(e)}},this.deleteChip=function(t,e){var i=e.data("chips")[t];e.find(".chip").eq(t).remove();for(var o=[],a=e.data("chips"),r=0;r<a.length;r++)r!==t&&o.push(a[r]);e.data("chips",o),e.trigger("chip.delete",i),n.setPlaceholder(e)},this.selectChip=function(t,e){var i=e.find(".chip").eq(t);i&&!1===i.hasClass("selected")&&(i.addClass("selected"),e.trigger("chip.select",e.data("chips")[t]))},this.getChipsElement=function(t,e){return e.eq(t)},this.init(),this.handleEvents()}}(jQuery),function(t){t.fn.pushpin=function(e){var i={top:0,bottom:1/0,offset:0};return"remove"===e?(this.each(function(){(id=t(this).data("pushpin-id"))&&(t(window).off("scroll."+id),t(this).removeData("pushpin-id").removeClass("pin-top pinned pin-bottom").removeAttr("style"))}),!1):(e=t.extend(i,e),$index=0,this.each(function(){function i(t){t.removeClass("pin-top"),t.removeClass("pinned"),t.removeClass("pin-bottom")}function n(n,o){n.each(function(){e.top<=o&&e.bottom>=o&&!t(this).hasClass("pinned")&&(i(t(this)),t(this).css("top",e.offset),t(this).addClass("pinned")),o<e.top&&!t(this).hasClass("pin-top")&&(i(t(this)),t(this).css("top",0),t(this).addClass("pin-top")),o>e.bottom&&!t(this).hasClass("pin-bottom")&&(i(t(this)),t(this).addClass("pin-bottom"),t(this).css("top",e.bottom-r))})}var o=Materialize.guid(),a=t(this),r=t(this).offset().top;t(this).data("pushpin-id",o),n(a,t(window).scrollTop()),t(window).on("scroll."+o,function(){var i=t(window).scrollTop()+e.offset;n(a,i)})}))}}(jQuery),function(t){t(document).ready(function(){t.fn.reverse=[].reverse,t(document).on("mouseenter.fixedActionBtn",".fixed-action-btn:not(.click-to-toggle):not(.toolbar)",function(i){var n=t(this);e(n)}),t(document).on("mouseleave.fixedActionBtn",".fixed-action-btn:not(.click-to-toggle):not(.toolbar)",function(e){var n=t(this);i(n)}),t(document).on("click.fabClickToggle",".fixed-action-btn.click-to-toggle > a",function(n){var o=t(this).parent();o.hasClass("active")?i(o):e(o)}),t(document).on("click.fabToolbar",".fixed-action-btn.toolbar > a",function(e){var i=t(this).parent();n(i)})}),t.fn.extend({openFAB:function(){e(t(this))},closeFAB:function(){i(t(this))},openToolbar:function(){n(t(this))},closeToolbar:function(){o(t(this))}});var e=function(e){var i=e;if(!1===i.hasClass("active")){var n,o;!0===i.hasClass("horizontal")?o=40:n=40,i.addClass("active"),i.find("ul .btn-floating").velocity({scaleY:".4",scaleX:".4",translateY:n+"px",translateX:o+"px"},{duration:0});var a=0;i.find("ul .btn-floating").reverse().each(function(){t(this).velocity({opacity:"1",scaleX:"1",scaleY:"1",translateY:"0",translateX:"0"},{duration:80,delay:a}),a+=40})}},i=function(t){var e,i,n=t;!0===n.hasClass("horizontal")?i=40:e=40,n.removeClass("active");n.find("ul .btn-floating").velocity("stop",!0),n.find("ul .btn-floating").velocity({opacity:"0",scaleX:".4",scaleY:".4",translateY:e+"px",translateX:i+"px"},{duration:80})},n=function(e){if("true"!==e.attr("data-open")){var i,n,a,r=window.innerWidth,s=window.innerHeight,l=e[0].getBoundingClientRect(),c=e.find("> a").first(),u=e.find("> ul").first(),d=t('<div class="fab-backdrop"></div>'),p=c.css("background-color");c.append(d),i=l.left-r/2+l.width/2,n=s-l.bottom,a=r/d.width(),e.attr("data-origin-bottom",l.bottom),e.attr("data-origin-left",l.left),e.attr("data-origin-width",l.width),e.addClass("active"),e.attr("data-open",!0),e.css({"text-align":"center",width:"100%",bottom:0,left:0,transform:"translateX("+i+"px)",transition:"none"}),c.css({transform:"translateY("+-n+"px)",transition:"none"}),d.css({"background-color":p}),setTimeout(function(){e.css({transform:"",transition:"transform .2s cubic-bezier(0.550, 0.085, 0.680, 0.530), background-color 0s linear .2s"}),c.css({overflow:"visible",transform:"",transition:"transform .2s"}),setTimeout(function(){e.css({overflow:"hidden","background-color":p}),d.css({transform:"scale("+a+")",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"}),u.find("> li > a").css({opacity:1}),t(window).on("scroll.fabToolbarClose",function(){o(e),t(window).off("scroll.fabToolbarClose"),t(document).off("click.fabToolbarClose")}),t(document).on("click.fabToolbarClose",function(i){t(i.target).closest(u).length||(o(e),t(window).off("scroll.fabToolbarClose"),t(document).off("click.fabToolbarClose"))})},100)},0)}},o=function(t){if("true"===t.attr("data-open")){var e,i,n=window.innerWidth,o=window.innerHeight,a=t.attr("data-origin-width"),r=t.attr("data-origin-bottom"),s=t.attr("data-origin-left"),l=t.find("> .btn-floating").first(),c=t.find("> ul").first(),u=t.find(".fab-backdrop"),d=l.css("background-color");e=s-n/2+a/2,i=o-r,n/u.width(),t.removeClass("active"),t.attr("data-open",!1),t.css({"background-color":"transparent",transition:"none"}),l.css({transition:"none"}),u.css({transform:"scale(0)","background-color":d}),c.find("> li > a").css({opacity:""}),setTimeout(function(){u.remove(),t.css({"text-align":"",width:"",bottom:"",left:"",overflow:"","background-color":"",transform:"translate3d("+-e+"px,0,0)"}),l.css({overflow:"",transform:"translate3d(0,"+i+"px,0)"}),setTimeout(function(){t.css({transform:"translate3d(0,0,0)",transition:"transform .2s"}),l.css({transform:"translate3d(0,0,0)",transition:"transform .2s cubic-bezier(0.550, 0.055, 0.675, 0.190)"})},20)},200)}}}(jQuery),function(t){Materialize.fadeInImage=function(e){var i;if("string"==typeof e)i=t(e);else{if("object"!=typeof e)return;i=e}i.css({opacity:0}),t(i).velocity({opacity:1},{duration:650,queue:!1,easing:"easeOutSine"}),t(i).velocity({opacity:1},{duration:1300,queue:!1,easing:"swing",step:function(e,i){i.start=100;var n=e/100,o=150-(100-e)/1.75;o<100&&(o=100),e>=0&&t(this).css({"-webkit-filter":"grayscale("+n+")brightness("+o+"%)",filter:"grayscale("+n+")brightness("+o+"%)"})}})},Materialize.showStaggeredList=function(e){var i;if("string"==typeof e)i=t(e);else{if("object"!=typeof e)return;i=e}var n=0;i.find("li").velocity({translateX:"-100px"},{duration:0}),i.find("li").each(function(){t(this).velocity({opacity:"1",translateX:"0"},{duration:800,delay:n,easing:[60,10]}),n+=120})},t(document).ready(function(){var e=!1,i=!1;t(".dismissable").each(function(){t(this).hammer({prevent_default:!1}).on("pan",function(n){if("touch"===n.gesture.pointerType){var o=t(this),a=n.gesture.direction,r=n.gesture.deltaX,s=n.gesture.velocityX;o.velocity({translateX:r},{duration:50,queue:!1,easing:"easeOutQuad"}),4===a&&(r>o.innerWidth()/2||s<-.75)&&(e=!0),2===a&&(r<-1*o.innerWidth()/2||s>.75)&&(i=!0)}}).on("panend",function(n){if(Math.abs(n.gesture.deltaX)<t(this).innerWidth()/2&&(i=!1,e=!1),"touch"===n.gesture.pointerType){var o=t(this);if(e||i){var a;a=e?o.innerWidth():-1*o.innerWidth(),o.velocity({translateX:a},{duration:100,queue:!1,easing:"easeOutQuad",complete:function(){o.css("border","none"),o.velocity({height:0,padding:0},{duration:200,queue:!1,easing:"easeOutQuad",complete:function(){o.remove()}})}})}else o.velocity({translateX:0},{duration:100,queue:!1,easing:"easeOutQuad"});e=!1,i=!1}})})})}(jQuery),function(t){var e=!1;Materialize.scrollFire=function(t){var i=function(){for(var e=window.pageYOffset+window.innerHeight,i=0;i<t.length;i++){var n=t[i],o=n.selector,a=n.offset,r=n.callback,s=document.querySelector(o);null!==s&&e>s.getBoundingClientRect().top+window.pageYOffset+a&&!0!==n.done&&("function"==typeof r?r.call(this,s):"string"==typeof r&&new Function(r)(s),n.done=!0)}},n=Materialize.throttle(function(){i()},t.throttle||100);e||(window.addEventListener("scroll",n),window.addEventListener("resize",n),e=!0),setTimeout(n,0)}}(jQuery),function(t){Materialize.Picker=t(jQuery)}(function(t){function e(a,s,u,d){function p(){return e._.node("div",e._.node("div",e._.node("div",e._.node("div",T.component.nodes(b.open),k.box),k.wrap),k.frame),k.holder)}function h(){x.data(s,T).addClass(k.input).attr("tabindex",-1).val(x.data("value")?T.get("select",w.format):a.value),w.editable||x.on("focus."+b.id+" click."+b.id,function(t){t.preventDefault(),T.$root.eq(0).focus()}).on("keydown."+b.id,m),o(a,{haspopup:!0,expanded:!1,readonly:!1,owns:a.id+"_root"})}function f(){T.$root.on({keydown:m,focusin:function(t){T.$root.removeClass(k.focused),t.stopPropagation()},"mousedown click":function(e){var i=e.target;i!=T.$root.children()[0]&&(e.stopPropagation(),"mousedown"!=e.type||t(i).is("input, select, textarea, button, option")||(e.preventDefault(),T.$root.eq(0).focus()))}}).on({focus:function(){x.addClass(k.target)},blur:function(){x.removeClass(k.target)}}).on("focus.toOpen",g).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=t(this),i=e.data(),n=e.hasClass(k.navDisabled)||e.hasClass(k.disabled),o=r();o=o&&(o.type||o.href)&&o,(n||o&&!t.contains(T.$root[0],o))&&T.$root.eq(0).focus(),!n&&i.nav?T.set("highlight",T.component.item.highlight,{nav:i.nav}):!n&&"pick"in i?(T.set("select",i.pick),w.closeOnSelect&&T.close(!0)):i.clear?(T.clear(),w.closeOnSelect&&T.close(!0)):i.close&&T.close(!0)}),o(T.$root[0],"hidden",!0)}function v(){var e;!0===w.hiddenName?(e=a.name,a.name=""):e=(e=["string"==typeof w.hiddenPrefix?w.hiddenPrefix:"","string"==typeof w.hiddenSuffix?w.hiddenSuffix:"_submit"])[0]+a.name+e[1],T._hidden=t('<input type=hidden name="'+e+'"'+(x.data("value")||a.value?' value="'+T.get("select",w.formatSubmit)+'"':"")+">")[0],x.on("change."+b.id,function(){T._hidden.value=a.value?T.get("select",w.formatSubmit):""}),w.container?t(w.container).append(T._hidden):x.before(T._hidden)}function m(t){var e=t.keyCode,i=/^(8|46)$/.test(e);if(27==e)return T.close(),!1;(32==e||i||!b.open&&T.component.key[e])&&(t.preventDefault(),t.stopPropagation(),i?T.clear().close():T.open())}function g(t){t.stopPropagation(),"focus"==t.type&&T.$root.addClass(k.focused),T.open()}if(!a)return e;var y=!1,b={id:a.id||"P"+Math.abs(~~(Math.random()*new Date))},w=u?t.extend(!0,{},u.defaults,d):d||{},k=t.extend({},e.klasses(),w.klass),x=t(a),C=function(){return this.start()},T=C.prototype={constructor:C,$node:x,start:function(){return b&&b.start?T:(b.methods={},b.start=!0,b.open=!1,b.type=a.type,a.autofocus=a==r(),a.readOnly=!w.editable,a.id=a.id||b.id,"text"!=a.type&&(a.type="text"),T.component=new u(T,w),T.$root=t(e._.node("div",p(),k.picker,'id="'+a.id+'_root" tabindex="0"')),f(),w.formatSubmit&&v(),h(),w.container?t(w.container).append(T.$root):x.before(T.$root),T.on({start:T.component.onStart,render:T.component.onRender,stop:T.component.onStop,open:T.component.onOpen,close:T.component.onClose,set:T.component.onSet}).on({start:w.onStart,render:w.onRender,stop:w.onStop,open:w.onOpen,close:w.onClose,set:w.onSet}),y=i(T.$root.children()[0]),a.autofocus&&T.open(),T.trigger("start").trigger("render"))},render:function(t){return t?T.$root.html(p()):T.$root.find("."+k.box).html(T.component.nodes(b.open)),T.trigger("render")},stop:function(){return b.start?(T.close(),T._hidden&&T._hidden.parentNode.removeChild(T._hidden),T.$root.remove(),x.removeClass(k.input).removeData(s),setTimeout(function(){x.off("."+b.id)},0),a.type=b.type,a.readOnly=!1,T.trigger("stop"),b.methods={},b.start=!1,T):T},open:function(i){return b.open?T:(x.addClass(k.active),o(a,"expanded",!0),setTimeout(function(){T.$root.addClass(k.opened),o(T.$root[0],"hidden",!1)},0),!1!==i&&(b.open=!0,y&&c.css("overflow","hidden").css("padding-right","+="+n()),T.$root.eq(0).focus(),l.on("click."+b.id+" focusin."+b.id,function(t){var e=t.target;e!=a&&e!=document&&3!=t.which&&T.close(e===T.$root.children()[0])}).on("keydown."+b.id,function(i){var n=i.keyCode,o=T.component.key[n],a=i.target;27==n?T.close(!0):a!=T.$root[0]||!o&&13!=n?t.contains(T.$root[0],a)&&13==n&&(i.preventDefault(),a.click()):(i.preventDefault(),o?e._.trigger(T.component.key.go,T,[e._.trigger(o)]):T.$root.find("."+k.highlighted).hasClass(k.disabled)||(T.set("select",T.component.item.highlight),w.closeOnSelect&&T.close(!0)))})),T.trigger("open"))},close:function(t){return t&&(T.$root.off("focus.toOpen").eq(0).focus(),setTimeout(function(){T.$root.on("focus.toOpen",g)},0)),x.removeClass(k.active),o(a,"expanded",!1),setTimeout(function(){T.$root.removeClass(k.opened+" "+k.focused),o(T.$root[0],"hidden",!0)},0),b.open?(b.open=!1,y&&c.css("overflow","").css("padding-right","-="+n()),l.off("."+b.id),T.trigger("close")):T},clear:function(t){return T.set("clear",null,t)},set:function(e,i,n){var o,a,r=t.isPlainObject(e),s=r?e:{};if(n=r&&t.isPlainObject(i)?i:n||{},e){r||(s[e]=i);for(o in s)a=s[o],o in T.component.item&&(void 0===a&&(a=null),T.component.set(o,a,n)),"select"!=o&&"clear"!=o||x.val("clear"==o?"":T.get(o,w.format)).trigger("change");T.render()}return n.muted?T:T.trigger("set",s)},get:function(t,i){if(t=t||"value",null!=b[t])return b[t];if("valueSubmit"==t){if(T._hidden)return T._hidden.value;t="value"}if("value"==t)return a.value;if(t in T.component.item){if("string"==typeof i){var n=T.component.get(t);return n?e._.trigger(T.component.formats.toString,T.component,[i,n]):""}return T.component.get(t)}},on:function(e,i,n){var o,a,r=t.isPlainObject(e),s=r?e:{};if(e){r||(s[e]=i);for(o in s)a=s[o],n&&(o="_"+o),b.methods[o]=b.methods[o]||[],b.methods[o].push(a)}return T},off:function(){var t,e,i=arguments;for(t=0,namesCount=i.length;t<namesCount;t+=1)(e=i[t])in b.methods&&delete b.methods[e];return T},trigger:function(t,i){var n=function(t){var n=b.methods[t];n&&n.map(function(t){e._.trigger(t,T,[i])})};return n("_"+t),n(t),T}};return new C}function i(t){var e;return t.currentStyle?e=t.currentStyle.position:window.getComputedStyle&&(e=getComputedStyle(t).position),"fixed"==e}function n(){if(c.height()<=s.height())return 0;var e=t('<div style="visibility:hidden;width:100px" />').appendTo("body"),i=e[0].offsetWidth;e.css("overflow","scroll");var n=t('<div style="width:100%" />').appendTo(e)[0].offsetWidth;return e.remove(),i-n}function o(e,i,n){if(t.isPlainObject(i))for(var o in i)a(e,o,i[o]);else a(e,i,n)}function a(t,e,i){t.setAttribute(("role"==e?"":"aria-")+e,i)}function r(){try{return document.activeElement}catch(t){}}var s=t(window),l=t(document),c=t(document.documentElement);return e.klasses=function(t){return t=t||"picker",{picker:t,opened:t+"--opened",focused:t+"--focused",input:t+"__input",active:t+"__input--active",target:t+"__input--target",holder:t+"__holder",frame:t+"__frame",wrap:t+"__wrap",box:t+"__box"}},e._={group:function(t){for(var i,n="",o=e._.trigger(t.min,t);o<=e._.trigger(t.max,t,[o]);o+=t.i)i=e._.trigger(t.item,t,[o]),n+=e._.node(t.node,i[0],i[1],i[2]);return n},node:function(e,i,n,o){return i?(i=t.isArray(i)?i.join(""):i,n=n?' class="'+n+'"':"",o=o?" "+o:"","<"+e+n+o+">"+i+"</"+e+">"):""},lead:function(t){return(t<10?"0":"")+t},trigger:function(t,e,i){return"function"==typeof t?t.apply(e,i||[]):t},digits:function(t){return/\d/.test(t[1])?2:1},isDate:function(t){return{}.toString.call(t).indexOf("Date")>-1&&this.isInteger(t.getDate())},isInteger:function(t){return{}.toString.call(t).indexOf("Number")>-1&&t%1==0},ariaAttr:function(e,i){t.isPlainObject(e)||(e={attribute:i}),i="";for(var n in e){var o=("role"==n?"":"aria-")+n;i+=null==e[n]?"":o+'="'+e[n]+'"'}return i}},e.extend=function(i,n){t.fn[i]=function(o,a){var r=this.data(i);return"picker"==o?r:r&&"string"==typeof o?e._.trigger(r[o],r,[a]):this.each(function(){t(this).data(i)||new e(this,i,n,o)})},t.fn[i].defaults=n.defaults},e}),function(t){t(Materialize.Picker,jQuery)}(function(t,e){function i(t,e){var i=this,n=t.$node[0],o=n.value,a=t.$node.data("value"),r=a||o,s=a?e.formatSubmit:e.format,l=function(){return n.currentStyle?"rtl"==n.currentStyle.direction:"rtl"==getComputedStyle(t.$root[0]).direction};i.settings=e,i.$node=t.$node,i.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},i.item={},i.item.clear=null,i.item.disable=(e.disable||[]).slice(0),i.item.enable=-function(t){return!0===t[0]?t.shift():-1}(i.item.disable),i.set("min",e.min).set("max",e.max).set("now"),r?i.set("select",r,{format:s}):i.set("select",null).set("highlight",i.item.now),i.key={40:7,38:-7,39:function(){return l()?-1:1},37:function(){return l()?1:-1},go:function(t){var e=i.item.highlight,n=new Date(e.year,e.month,e.date+t);i.set("highlight",n,{interval:t}),this.render()}},t.on("render",function(){t.$root.find("."+e.klass.selectMonth).on("change",function(){var i=this.value;i&&(t.set("highlight",[t.get("view").year,i,t.get("highlight").date]),t.$root.find("."+e.klass.selectMonth).trigger("focus"))}),t.$root.find("."+e.klass.selectYear).on("change",function(){var i=this.value;i&&(t.set("highlight",[i,t.get("view").month,t.get("highlight").date]),t.$root.find("."+e.klass.selectYear).trigger("focus"))})},1).on("open",function(){var n="";i.disabled(i.get("now"))&&(n=":not(."+e.klass.buttonToday+")"),t.$root.find("button"+n+", select").attr("disabled",!1)},1).on("close",function(){t.$root.find("button, select").attr("disabled",!0)},1)}var n=t._;i.prototype.set=function(t,e,i){var n=this,o=n.item;return null===e?("clear"==t&&(t="select"),o[t]=e,n):(o["enable"==t?"disable":"flip"==t?"enable":t]=n.queue[t].split(" ").map(function(o){return e=n[o](t,e,i)}).pop(),"select"==t?n.set("highlight",o.select,i):"highlight"==t?n.set("view",o.highlight,i):t.match(/^(flip|min|max|disable|enable)$/)&&(o.select&&n.disabled(o.select)&&n.set("select",o.select,i),o.highlight&&n.disabled(o.highlight)&&n.set("highlight",o.highlight,i)),n)},i.prototype.get=function(t){return this.item[t]},i.prototype.create=function(t,i,o){var a,r=this;return i=void 0===i?t:i,i==-1/0||i==1/0?a=i:e.isPlainObject(i)&&n.isInteger(i.pick)?i=i.obj:e.isArray(i)?(i=new Date(i[0],i[1],i[2]),i=n.isDate(i)?i:r.create().obj):i=n.isInteger(i)||n.isDate(i)?r.normalize(new Date(i),o):r.now(t,i,o),{year:a||i.getFullYear(),month:a||i.getMonth(),date:a||i.getDate(),day:a||i.getDay(),obj:a||i,pick:a||i.getTime()}},i.prototype.createRange=function(t,i){var o=this,a=function(t){return!0===t||e.isArray(t)||n.isDate(t)?o.create(t):t};return n.isInteger(t)||(t=a(t)),n.isInteger(i)||(i=a(i)),n.isInteger(t)&&e.isPlainObject(i)?t=[i.year,i.month,i.date+t]:n.isInteger(i)&&e.isPlainObject(t)&&(i=[t.year,t.month,t.date+i]),{from:a(t),to:a(i)}},i.prototype.withinRange=function(t,e){return t=this.createRange(t.from,t.to),e.pick>=t.from.pick&&e.pick<=t.to.pick},i.prototype.overlapRanges=function(t,e){var i=this;return t=i.createRange(t.from,t.to),e=i.createRange(e.from,e.to),i.withinRange(t,e.from)||i.withinRange(t,e.to)||i.withinRange(e,t.from)||i.withinRange(e,t.to)},i.prototype.now=function(t,e,i){return e=new Date,i&&i.rel&&e.setDate(e.getDate()+i.rel),this.normalize(e,i)},i.prototype.navigate=function(t,i,n){var o,a,r,s,l=e.isArray(i),c=e.isPlainObject(i),u=this.item.view;if(l||c){for(c?(a=i.year,r=i.month,s=i.date):(a=+i[0],r=+i[1],s=+i[2]),n&&n.nav&&u&&u.month!==r&&(a=u.year,r=u.month),a=(o=new Date(a,r+(n&&n.nav?n.nav:0),1)).getFullYear(),r=o.getMonth();new Date(a,r,s).getMonth()!==r;)s-=1;i=[a,r,s]}return i},i.prototype.normalize=function(t){return t.setHours(0,0,0,0),t},i.prototype.measure=function(t,e){var i=this;return e?"string"==typeof e?e=i.parse(t,e):n.isInteger(e)&&(e=i.now(t,e,{rel:e})):e="min"==t?-1/0:1/0,e},i.prototype.viewset=function(t,e){return this.create([e.year,e.month,1])},i.prototype.validate=function(t,i,o){var a,r,s,l,c=this,u=i,d=o&&o.interval?o.interval:1,p=-1===c.item.enable,h=c.item.min,f=c.item.max,v=p&&c.item.disable.filter(function(t){if(e.isArray(t)){var o=c.create(t).pick;o<i.pick?a=!0:o>i.pick&&(r=!0)}return n.isInteger(t)}).length;if((!o||!o.nav)&&(!p&&c.disabled(i)||p&&c.disabled(i)&&(v||a||r)||!p&&(i.pick<=h.pick||i.pick>=f.pick)))for(p&&!v&&(!r&&d>0||!a&&d<0)&&(d*=-1);c.disabled(i)&&(Math.abs(d)>1&&(i.month<u.month||i.month>u.month)&&(i=u,d=d>0?1:-1),i.pick<=h.pick?(s=!0,d=1,i=c.create([h.year,h.month,h.date+(i.pick===h.pick?0:-1)])):i.pick>=f.pick&&(l=!0,d=-1,i=c.create([f.year,f.month,f.date+(i.pick===f.pick?0:1)])),!s||!l);)i=c.create([i.year,i.month,i.date+d]);return i},i.prototype.disabled=function(t){var i=this,o=i.item.disable.filter(function(o){return n.isInteger(o)?t.day===(i.settings.firstDay?o:o-1)%7:e.isArray(o)||n.isDate(o)?t.pick===i.create(o).pick:e.isPlainObject(o)?i.withinRange(o,t):void 0});return o=o.length&&!o.filter(function(t){return e.isArray(t)&&"inverted"==t[3]||e.isPlainObject(t)&&t.inverted}).length,-1===i.item.enable?!o:o||t.pick<i.item.min.pick||t.pick>i.item.max.pick},i.prototype.parse=function(t,e,i){var o=this,a={};return e&&"string"==typeof e?(i&&i.format||((i=i||{}).format=o.settings.format),o.formats.toArray(i.format).map(function(t){var i=o.formats[t],r=i?n.trigger(i,o,[e,a]):t.replace(/^!/,"").length;i&&(a[t]=e.substr(0,r)),e=e.substr(r)}),[a.yyyy||a.yy,+(a.mm||a.m)-1,a.dd||a.d]):e},i.prototype.formats=function(){function t(t,e,i){var n=t.match(/\w+/)[0];return i.mm||i.m||(i.m=e.indexOf(n)+1),n.length}function e(t){return t.match(/\w+/)[0].length}return{d:function(t,e){return t?n.digits(t):e.date},dd:function(t,e){return t?2:n.lead(e.date)},ddd:function(t,i){return t?e(t):this.settings.weekdaysShort[i.day]},dddd:function(t,i){return t?e(t):this.settings.weekdaysFull[i.day]},m:function(t,e){return t?n.digits(t):e.month+1},mm:function(t,e){return t?2:n.lead(e.month+1)},mmm:function(e,i){var n=this.settings.monthsShort;return e?t(e,n,i):n[i.month]},mmmm:function(e,i){var n=this.settings.monthsFull;return e?t(e,n,i):n[i.month]},yy:function(t,e){return t?2:(""+e.year).slice(2)},yyyy:function(t,e){return t?4:e.year},toArray:function(t){return t.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(t,e){var i=this;return i.formats.toArray(t).map(function(t){return n.trigger(i.formats[t],i,[0,e])||t.replace(/^!/,"")}).join("")}}}(),i.prototype.isDateExact=function(t,i){var o=this;return n.isInteger(t)&&n.isInteger(i)||"boolean"==typeof t&&"boolean"==typeof i?t===i:(n.isDate(t)||e.isArray(t))&&(n.isDate(i)||e.isArray(i))?o.create(t).pick===o.create(i).pick:!(!e.isPlainObject(t)||!e.isPlainObject(i))&&(o.isDateExact(t.from,i.from)&&o.isDateExact(t.to,i.to))},i.prototype.isDateOverlap=function(t,i){var o=this,a=o.settings.firstDay?1:0;return n.isInteger(t)&&(n.isDate(i)||e.isArray(i))?(t=t%7+a)===o.create(i).day+1:n.isInteger(i)&&(n.isDate(t)||e.isArray(t))?(i=i%7+a)===o.create(t).day+1:!(!e.isPlainObject(t)||!e.isPlainObject(i))&&o.overlapRanges(t,i)},i.prototype.flipEnable=function(t){var e=this.item;e.enable=t||(-1==e.enable?1:-1)},i.prototype.deactivate=function(t,i){var o=this,a=o.item.disable.slice(0);return"flip"==i?o.flipEnable():!1===i?(o.flipEnable(1),a=[]):!0===i?(o.flipEnable(-1),a=[]):i.map(function(t){for(var i,r=0;r<a.length;r+=1)if(o.isDateExact(t,a[r])){i=!0;break}i||(n.isInteger(t)||n.isDate(t)||e.isArray(t)||e.isPlainObject(t)&&t.from&&t.to)&&a.push(t)}),a},i.prototype.activate=function(t,i){var o=this,a=o.item.disable,r=a.length;return"flip"==i?o.flipEnable():!0===i?(o.flipEnable(1),a=[]):!1===i?(o.flipEnable(-1),a=[]):i.map(function(t){var i,s,l,c;for(l=0;l<r;l+=1){if(s=a[l],o.isDateExact(s,t)){i=a[l]=null,c=!0;break}if(o.isDateOverlap(s,t)){e.isPlainObject(t)?(t.inverted=!0,i=t):e.isArray(t)?(i=t)[3]||i.push("inverted"):n.isDate(t)&&(i=[t.getFullYear(),t.getMonth(),t.getDate(),"inverted"]);break}}if(i)for(l=0;l<r;l+=1)if(o.isDateExact(a[l],t)){a[l]=null;break}if(c)for(l=0;l<r;l+=1)if(o.isDateOverlap(a[l],t)){a[l]=null;break}i&&a.push(i)}),a.filter(function(t){return null!=t})},i.prototype.nodes=function(t){var e=this,i=e.settings,o=e.item,a=o.now,r=o.select,s=o.highlight,l=o.view,c=o.disable,u=o.min,d=o.max,p=function(t,e){return i.firstDay&&(t.push(t.shift()),e.push(e.shift())),n.node("thead",n.node("tr",n.group({min:0,max:6,i:1,node:"th",item:function(n){return[t[n],i.klass.weekdays,'scope=col title="'+e[n]+'"']}})))}((i.showWeekdaysFull?i.weekdaysFull:i.weekdaysLetter).slice(0),i.weekdaysFull.slice(0)),h=function(t){return n.node("div"," ",i.klass["nav"+(t?"Next":"Prev")]+(t&&l.year>=d.year&&l.month>=d.month||!t&&l.year<=u.year&&l.month<=u.month?" "+i.klass.navDisabled:""),"data-nav="+(t||-1)+" "+n.ariaAttr({role:"button",controls:e.$node[0].id+"_table"})+' title="'+(t?i.labelMonthNext:i.labelMonthPrev)+'"')},f=function(o){var a=i.showMonthsShort?i.monthsShort:i.monthsFull;return"short_months"==o&&(a=i.monthsShort),i.selectMonths&&void 0==o?n.node("select",n.group({min:0,max:11,i:1,node:"option",item:function(t){return[a[t],0,"value="+t+(l.month==t?" selected":"")+(l.year==u.year&&t<u.month||l.year==d.year&&t>d.month?" disabled":"")]}}),i.klass.selectMonth+" browser-default",(t?"":"disabled")+" "+n.ariaAttr({controls:e.$node[0].id+"_table"})+' title="'+i.labelMonthSelect+'"'):"short_months"==o?null!=r?a[r.month]:a[l.month]:n.node("div",a[l.month],i.klass.month)},v=function(o){var a=l.year,s=!0===i.selectYears?5:~~(i.selectYears/2);if(s){var c=u.year,p=d.year,h=a-s,f=a+s;if(c>h&&(f+=c-h,h=c),p<f){var v=h-c,m=f-p;h-=v>m?m:v,f=p}if(i.selectYears&&void 0==o)return n.node("select",n.group({min:h,max:f,i:1,node:"option",item:function(t){return[t,0,"value="+t+(a==t?" selected":"")]}}),i.klass.selectYear+" browser-default",(t?"":"disabled")+" "+n.ariaAttr({controls:e.$node[0].id+"_table"})+' title="'+i.labelYearSelect+'"')}return"raw"===o&&null!=r?n.node("div",r.year):n.node("div",a,i.klass.year)};return createDayLabel=function(){return null!=r?r.date:a.date},createWeekdayLabel=function(){var t;return t=null!=r?r.day:a.day,i.weekdaysShort[t]},n.node("div",n.node("div",v("raw"),i.klass.year_display)+n.node("span",createWeekdayLabel()+", ","picker__weekday-display")+n.node("span",f("short_months")+" ",i.klass.month_display)+n.node("span",createDayLabel(),i.klass.day_display),i.klass.date_display)+n.node("div",n.node("div",n.node("div",(i.selectYears,f()+v()+h()+h(1)),i.klass.header)+n.node("table",p+n.node("tbody",n.group({min:0,max:5,i:1,node:"tr",item:function(t){var o=i.firstDay&&0===e.create([l.year,l.month,1]).day?-7:0;return[n.group({min:7*t-l.day+o+1,max:function(){return this.min+7-1},i:1,node:"td",item:function(t){t=e.create([l.year,l.month,t+(i.firstDay?1:0)]);var o=r&&r.pick==t.pick,p=s&&s.pick==t.pick,h=c&&e.disabled(t)||t.pick<u.pick||t.pick>d.pick,f=n.trigger(e.formats.toString,e,[i.format,t]);return[n.node("div",t.date,function(e){return e.push(l.month==t.month?i.klass.infocus:i.klass.outfocus),a.pick==t.pick&&e.push(i.klass.now),o&&e.push(i.klass.selected),p&&e.push(i.klass.highlighted),h&&e.push(i.klass.disabled),e.join(" ")}([i.klass.day]),"data-pick="+t.pick+" "+n.ariaAttr({role:"gridcell",label:f,selected:!(!o||e.$node.val()!==f)||null,activedescendant:!!p||null,disabled:!!h||null})+" "+(h?"":'tabindex="0"')),"",n.ariaAttr({role:"presentation"})]}})]}})),i.klass.table,'id="'+e.$node[0].id+'_table" '+n.ariaAttr({role:"grid",controls:e.$node[0].id,readonly:!0})),i.klass.calendar_container)+n.node("div",n.node("button",i.today,"btn-flat picker__today waves-effect","type=button data-pick="+a.pick+(t&&!e.disabled(a)?"":" disabled")+" "+n.ariaAttr({controls:e.$node[0].id}))+n.node("button",i.clear,"btn-flat picker__clear waves-effect","type=button data-clear=1"+(t?"":" disabled")+" "+n.ariaAttr({controls:e.$node[0].id}))+n.node("button",i.close,"btn-flat picker__close waves-effect","type=button data-close=true "+(t?"":" disabled")+" "+n.ariaAttr({controls:e.$node[0].id})),i.klass.footer),"picker__container__wrapper")},i.defaults=function(t){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdaysLetter:["S","M","T","W","T","F","S"],today:"Today",clear:"Clear",close:"Ok",closeOnSelect:!1,format:"d mmmm, yyyy",klass:{table:t+"table",header:t+"header",date_display:t+"date-display",day_display:t+"day-display",month_display:t+"month-display",year_display:t+"year-display",calendar_container:t+"calendar-container",navPrev:t+"nav--prev",navNext:t+"nav--next",navDisabled:t+"nav--disabled",month:t+"month",year:t+"year",selectMonth:t+"select--month",selectYear:t+"select--year",weekdays:t+"weekday",day:t+"day",disabled:t+"day--disabled",selected:t+"day--selected",highlighted:t+"day--highlighted",now:t+"day--today",infocus:t+"day--infocus",outfocus:t+"day--outfocus",footer:t+"footer",buttonClear:t+"button--clear",buttonToday:t+"button--today",buttonClose:t+"button--close"}}}(t.klasses().picker+"__"),t.extend("pickadate",i)}),function(t){function e(t){return document.createElementNS(l,t)}function i(t){return(t<10?"0":"")+t}function n(t){var e=++m+"";return t?t+e:e}function o(o,r){function l(t,e){var i=d.offset(),n=/^touch/.test(t.type),o=i.left+g,a=i.top+g,l=(n?t.originalEvent.touches[0]:t).pageX-o,c=(n?t.originalEvent.touches[0]:t).pageY-a,u=Math.sqrt(l*l+c*c),p=!1;if(!e||!(u<y-w||u>y+w)){t.preventDefault();var v=setTimeout(function(){E.popover.addClass("clockpicker-moving")},200);E.setHand(l,c,!e,!0),s.off(h).on(h,function(t){t.preventDefault();var e=/^touch/.test(t.type),i=(e?t.originalEvent.touches[0]:t).pageX-o,n=(e?t.originalEvent.touches[0]:t).pageY-a;(p||i!==l||n!==c)&&(p=!0,E.setHand(i,n,!1,!0))}),s.off(f).on(f,function(t){s.off(f),t.preventDefault();var i=/^touch/.test(t.type),n=(i?t.originalEvent.changedTouches[0]:t).pageX-o,u=(i?t.originalEvent.changedTouches[0]:t).pageY-a;(e||p)&&n===l&&u===c&&E.setHand(n,u),"hours"===E.currentView?E.toggleView("minutes",x/2):r.autoclose&&(E.minutesView.addClass("clockpicker-dial-out"),setTimeout(function(){E.done()},x/2)),d.prepend(z),clearTimeout(v),E.popover.removeClass("clockpicker-moving"),s.off(h)})}}var u=t(C),d=u.find(".clockpicker-plate"),v=u.find(".picker__holder"),m=u.find(".clockpicker-hours"),T=u.find(".clockpicker-minutes"),S=u.find(".clockpicker-am-pm-block"),P="INPUT"===o.prop("tagName"),A=P?o:o.find("input"),O=t("label[for="+A.attr("id")+"]"),E=this;this.id=n("cp"),this.element=o,this.holder=v,this.options=r,this.isAppended=!1,this.isShown=!1,this.currentView="hours",this.isInput=P,this.input=A,this.label=O,this.popover=u,this.plate=d,this.hoursView=m,this.minutesView=T,this.amPmBlock=S,this.spanHours=u.find(".clockpicker-span-hours"),this.spanMinutes=u.find(".clockpicker-span-minutes"),this.spanAmPm=u.find(".clockpicker-span-am-pm"),this.footer=u.find(".picker__footer"),this.amOrPm="PM",r.twelvehour&&(r.ampmclickable?(this.spanAmPm.empty(),t('<div id="click-am">AM</div>').on("click",function(){E.spanAmPm.children("#click-am").addClass("text-primary"),E.spanAmPm.children("#click-pm").removeClass("text-primary"),E.amOrPm="AM"}).appendTo(this.spanAmPm),t('<div id="click-pm">PM</div>').on("click",function(){E.spanAmPm.children("#click-pm").addClass("text-primary"),E.spanAmPm.children("#click-am").removeClass("text-primary"),E.amOrPm="PM"}).appendTo(this.spanAmPm)):(this.spanAmPm.empty(),t('<div id="click-am">AM</div>').appendTo(this.spanAmPm),t('<div id="click-pm">PM</div>').appendTo(this.spanAmPm))),t('<button type="button" class="btn-flat picker__clear" tabindex="'+(r.twelvehour?"3":"1")+'">'+r.cleartext+"</button>").click(t.proxy(this.clear,this)).appendTo(this.footer),t('<button type="button" class="btn-flat picker__close" tabindex="'+(r.twelvehour?"3":"1")+'">'+r.canceltext+"</button>").click(t.proxy(this.hide,this)).appendTo(this.footer),t('<button type="button" class="btn-flat picker__close" tabindex="'+(r.twelvehour?"3":"1")+'">'+r.donetext+"</button>").click(t.proxy(this.done,this)).appendTo(this.footer),this.spanHours.click(t.proxy(this.toggleView,this,"hours")),this.spanMinutes.click(t.proxy(this.toggleView,this,"minutes")),A.on("focus.clockpicker click.clockpicker",t.proxy(this.show,this));var _,M,I,D,q=t('<div class="clockpicker-tick"></div>');if(r.twelvehour)for(_=1;_<13;_+=1)M=q.clone(),I=_/6*Math.PI,D=y,M.css({left:g+Math.sin(I)*D-w,top:g-Math.cos(I)*D-w}),M.html(0===_?"00":_),m.append(M),M.on(p,l);else for(_=0;_<24;_+=1)M=q.clone(),I=_/6*Math.PI,D=_>0&&_<13?b:y,M.css({left:g+Math.sin(I)*D-w,top:g-Math.cos(I)*D-w}),M.html(0===_?"00":_),m.append(M),M.on(p,l);for(_=0;_<60;_+=5)M=q.clone(),I=_/30*Math.PI,M.css({left:g+Math.sin(I)*y-w,top:g-Math.cos(I)*y-w}),M.html(i(_)),T.append(M),M.on(p,l);if(d.on(p,function(e){0===t(e.target).closest(".clockpicker-tick").length&&l(e,!0)}),c){var z=u.find(".clockpicker-canvas"),V=e("svg");V.setAttribute("class","clockpicker-svg"),V.setAttribute("width",k),V.setAttribute("height",k);var H=e("g");H.setAttribute("transform","translate("+g+","+g+")");var L=e("circle");L.setAttribute("class","clockpicker-canvas-bearing"),L.setAttribute("cx",0),L.setAttribute("cy",0),L.setAttribute("r",4);var j=e("line");j.setAttribute("x1",0),j.setAttribute("y1",0);var $=e("circle");$.setAttribute("class","clockpicker-canvas-bg"),$.setAttribute("r",w),H.appendChild(j),H.appendChild($),H.appendChild(L),V.appendChild(H),z.append(V),this.hand=j,this.bg=$,this.bearing=L,this.g=H,this.canvas=z}a(this.options.init)}function a(t){t&&"function"==typeof t&&t()}var r=t(window),s=t(document),l="http://www.w3.org/2000/svg",c="SVGAngle"in window&&function(){var t,e=document.createElement("div");return e.innerHTML="<svg/>",t=(e.firstChild&&e.firstChild.namespaceURI)==l,e.innerHTML="",t}(),u=function(){var t=document.createElement("div").style;return"transition"in t||"WebkitTransition"in t||"MozTransition"in t||"msTransition"in t||"OTransition"in t}(),d="ontouchstart"in window,p="mousedown"+(d?" touchstart":""),h="mousemove.clockpicker"+(d?" touchmove.clockpicker":""),f="mouseup.clockpicker"+(d?" touchend.clockpicker":""),v=navigator.vibrate?"vibrate":navigator.webkitVibrate?"webkitVibrate":null,m=0,g=135,y=105,b=70,w=20,k=2*g,x=u?350:1,C=['<div class="clockpicker picker">','<div class="picker__holder">','<div class="picker__frame">','<div class="picker__wrap">','<div class="picker__box">','<div class="picker__date-display">','<div class="clockpicker-display">','<div class="clockpicker-display-column">','<span class="clockpicker-span-hours text-primary"></span>',":",'<span class="clockpicker-span-minutes"></span>',"</div>",'<div class="clockpicker-display-column clockpicker-display-am-pm">','<div class="clockpicker-span-am-pm"></div>',"</div>","</div>","</div>",'<div class="picker__container__wrapper">','<div class="picker__calendar-container">','<div class="clockpicker-plate">','<div class="clockpicker-canvas"></div>','<div class="clockpicker-dial clockpicker-hours"></div>','<div class="clockpicker-dial clockpicker-minutes clockpicker-dial-out"></div>',"</div>",'<div class="clockpicker-am-pm-block">',"</div>","</div>",'<div class="picker__footer">',"</div>","</div>","</div>","</div>","</div>","</div>","</div>"].join("");o.DEFAULTS={default:"",fromnow:0,donetext:"Ok",cleartext:"Clear",canceltext:"Cancel",autoclose:!1,ampmclickable:!0,darktheme:!1,twelvehour:!0,vibrate:!0},o.prototype.toggle=function(){this[this.isShown?"hide":"show"]()},o.prototype.locate=function(){var t=this.element,e=this.popover;t.offset(),t.outerWidth(),t.outerHeight(),this.options.align;e.show()},o.prototype.show=function(e){if(!this.isShown){a(this.options.beforeShow),t(":input").each(function(){t(this).attr("tabindex",-1)});var n=this;this.input.blur(),this.popover.addClass("picker--opened"),this.input.addClass("picker__input picker__input--active"),t(document.body).css("overflow","hidden");var o=((this.input.prop("value")||this.options.default||"")+"").split(":");if(this.options.twelvehour&&void 0!==o[1]&&(o[1].indexOf("AM")>0?this.amOrPm="AM":this.amOrPm="PM",o[1]=o[1].replace("AM","").replace("PM","")),"now"===o[0]){var l=new Date(+new Date+this.options.fromnow);o=[l.getHours(),l.getMinutes()],this.options.twelvehour&&(this.amOrPm=o[0]>=12&&o[0]<24?"PM":"AM")}if(this.hours=+o[0]||0,this.minutes=+o[1]||0,this.spanHours.html(this.hours),this.spanMinutes.html(i(this.minutes)),!this.isAppended){var c=document.querySelector(this.options.container);this.options.container&&c?c.appendChild(this.popover[0]):this.popover.insertAfter(this.input),this.options.twelvehour&&("PM"===this.amOrPm?(this.spanAmPm.children("#click-pm").addClass("text-primary"),this.spanAmPm.children("#click-am").removeClass("text-primary")):(this.spanAmPm.children("#click-am").addClass("text-primary"),this.spanAmPm.children("#click-pm").removeClass("text-primary"))),r.on("resize.clockpicker"+this.id,function(){n.isShown&&n.locate()}),this.isAppended=!0}this.toggleView("hours"),this.locate(),this.isShown=!0,s.on("click.clockpicker."+this.id+" focusin.clockpicker."+this.id,function(e){var i=t(e.target);0===i.closest(n.popover.find(".picker__wrap")).length&&0===i.closest(n.input).length&&n.hide()}),s.on("keyup.clockpicker."+this.id,function(t){27===t.keyCode&&n.hide()}),a(this.options.afterShow)}},o.prototype.hide=function(){a(this.options.beforeHide),this.input.removeClass("picker__input picker__input--active"),this.popover.removeClass("picker--opened"),t(document.body).css("overflow","visible"),this.isShown=!1,t(":input").each(function(e){t(this).attr("tabindex",e+1)}),s.off("click.clockpicker."+this.id+" focusin.clockpicker."+this.id),s.off("keyup.clockpicker."+this.id),this.popover.hide(),a(this.options.afterHide)},o.prototype.toggleView=function(e,i){var n=!1;"minutes"===e&&"visible"===t(this.hoursView).css("visibility")&&(a(this.options.beforeHourSelect),n=!0);var o="hours"===e,r=o?this.hoursView:this.minutesView,s=o?this.minutesView:this.hoursView;this.currentView=e,this.spanHours.toggleClass("text-primary",o),this.spanMinutes.toggleClass("text-primary",!o),s.addClass("clockpicker-dial-out"),r.css("visibility","visible").removeClass("clockpicker-dial-out"),this.resetClock(i),clearTimeout(this.toggleViewTimer),this.toggleViewTimer=setTimeout(function(){s.css("visibility","hidden")},x),n&&a(this.options.afterHourSelect)},o.prototype.resetClock=function(t){var e=this.currentView,i=this[e],n="hours"===e,o=i*(Math.PI/(n?6:30)),a=n&&i>0&&i<13?b:y,r=Math.sin(o)*a,s=-Math.cos(o)*a,l=this;c&&t?(l.canvas.addClass("clockpicker-canvas-out"),setTimeout(function(){l.canvas.removeClass("clockpicker-canvas-out"),l.setHand(r,s)},t)):this.setHand(r,s)},o.prototype.setHand=function(e,n,o,a){var r,s=Math.atan2(e,-n),l="hours"===this.currentView,u=Math.PI/(l||o?6:30),d=Math.sqrt(e*e+n*n),p=this.options,h=l&&d<(y+b)/2,f=h?b:y;if(p.twelvehour&&(f=y),s<0&&(s=2*Math.PI+s),r=Math.round(s/u),s=r*u,p.twelvehour?l?0===r&&(r=12):(o&&(r*=5),60===r&&(r=0)):l?(12===r&&(r=0),r=h?0===r?12:r:0===r?0:r+12):(o&&(r*=5),60===r&&(r=0)),this[this.currentView]!==r&&v&&this.options.vibrate&&(this.vibrateTimer||(navigator[v](10),this.vibrateTimer=setTimeout(t.proxy(function(){this.vibrateTimer=null},this),100))),this[this.currentView]=r,l?this.spanHours.html(r):this.spanMinutes.html(i(r)),c){var m=Math.sin(s)*(f-w),g=-Math.cos(s)*(f-w),k=Math.sin(s)*f,x=-Math.cos(s)*f;this.hand.setAttribute("x2",m),this.hand.setAttribute("y2",g),this.bg.setAttribute("cx",k),this.bg.setAttribute("cy",x)}else this[l?"hoursView":"minutesView"].find(".clockpicker-tick").each(function(){var e=t(this);e.toggleClass("active",r===+e.html())})},o.prototype.done=function(){a(this.options.beforeDone),this.hide(),this.label.addClass("active");var t=this.input.prop("value"),e=i(this.hours)+":"+i(this.minutes);this.options.twelvehour&&(e+=this.amOrPm),this.input.prop("value",e),e!==t&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur"),a(this.options.afterDone)},o.prototype.clear=function(){this.hide(),this.label.removeClass("active");var t=this.input.prop("value");this.input.prop("value",""),""!==t&&(this.input.triggerHandler("change"),this.isInput||this.element.trigger("change")),this.options.autoclose&&this.input.trigger("blur")},o.prototype.remove=function(){this.element.removeData("clockpicker"),this.input.off("focus.clockpicker click.clockpicker"),this.isShown&&this.hide(),this.isAppended&&(r.off("resize.clockpicker"+this.id),this.popover.remove())},t.fn.pickatime=function(e){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=t(this),a=n.data("clockpicker");if(a)"function"==typeof a[e]&&a[e].apply(a,i);else{var r=t.extend({},o.DEFAULTS,n.data(),"object"==typeof e&&e);n.data("clockpicker",new o(n,r))}})}}(jQuery),function(t){function e(){var e=+t(this).attr("data-length"),i=+t(this).val().length,n=i<=e;t(this).parent().find('span[class="character-counter"]').html(i+"/"+e),o(n,t(this))}function i(e){var i=e.parent().find('span[class="character-counter"]');i.length||(i=t("<span/>").addClass("character-counter").css("float","right").css("font-size","12px").css("height",1),e.parent().append(i))}function n(){t(this).parent().find('span[class="character-counter"]').html("")}function o(t,e){var i=e.hasClass("invalid");t&&i?e.removeClass("invalid"):t||i||(e.removeClass("valid"),e.addClass("invalid"))}t.fn.characterCounter=function(){return this.each(function(){var o=t(this);o.parent().find('span[class="character-counter"]').length||void 0!==o.attr("data-length")&&(o.on("input",e),o.on("focus",e),o.on("blur",n),i(o))})},t(document).ready(function(){t("input, textarea").characterCounter()})}(jQuery),function(t){var e={init:function(e){var i={duration:200,dist:-100,shift:0,padding:0,fullWidth:!1,indicators:!1,noWrap:!1,onCycleTo:null};e=t.extend(i,e);var n=Materialize.objectSelectorString(t(this));return this.each(function(i){function o(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientX:t.clientX}function a(t){return t.targetTouches&&t.targetTouches.length>=1?t.targetTouches[0].clientY:t.clientY}function r(t){return t>=C?t%C:t<0?r(C+t%C):t}function s(i){E=!0,j.hasClass("scrolling")||j.addClass("scrolling"),null!=H&&window.clearTimeout(H),H=window.setTimeout(function(){E=!1,j.removeClass("scrolling")},e.duration);var n,o,a,s,l,c,u,d=w;if(b="number"==typeof i?i:b,w=Math.floor((b+x/2)/x),a=b-w*x,s=a<0?1:-1,l=-s*a*2/x,o=C>>1,e.fullWidth?u="translateX(0)":(u="translateX("+(j[0].clientWidth-m)/2+"px) ",u+="translateY("+(j[0].clientHeight-g)/2+"px)"),N){var p=w%C,h=V.find(".indicator-item.active");h.index()!==p&&(h.removeClass("active"),V.find(".indicator-item").eq(p).addClass("active"))}for((!W||w>=0&&w<C)&&(c=v[r(w)],t(c).hasClass("active")||(j.find(".carousel-item").removeClass("active"),t(c).addClass("active")),c.style[_]=u+" translateX("+-a/2+"px) translateX("+s*e.shift*l*n+"px) translateZ("+e.dist*l+"px)",c.style.zIndex=0,e.fullWidth?tweenedOpacity=1:tweenedOpacity=1-.2*l,c.style.opacity=tweenedOpacity,c.style.display="block"),n=1;n<=o;++n)e.fullWidth?(zTranslation=e.dist,tweenedOpacity=n===o&&a<0?1-l:1):(zTranslation=e.dist*(2*n+l*s),tweenedOpacity=1-.2*(2*n+l*s)),(!W||w+n<C)&&((c=v[r(w+n)]).style[_]=u+" translateX("+(e.shift+(x*n-a)/2)+"px) translateZ("+zTranslation+"px)",c.style.zIndex=-n,c.style.opacity=tweenedOpacity,c.style.display="block"),e.fullWidth?(zTranslation=e.dist,tweenedOpacity=n===o&&a>0?1-l:1):(zTranslation=e.dist*(2*n-l*s),tweenedOpacity=1-.2*(2*n-l*s)),(!W||w-n>=0)&&((c=v[r(w-n)]).style[_]=u+" translateX("+(-e.shift+(-x*n-a)/2)+"px) translateZ("+zTranslation+"px)",c.style.zIndex=-n,c.style.opacity=tweenedOpacity,c.style.display="block");if((!W||w>=0&&w<C)&&((c=v[r(w)]).style[_]=u+" translateX("+-a/2+"px) translateX("+s*e.shift*l+"px) translateZ("+e.dist*l+"px)",c.style.zIndex=0,e.fullWidth?tweenedOpacity=1:tweenedOpacity=1-.2*l,c.style.opacity=tweenedOpacity,c.style.display="block"),d!==w&&"function"==typeof e.onCycleTo){var f=j.find(".carousel-item").eq(r(w));e.onCycleTo.call(this,f,q)}"function"==typeof L&&(L.call(this,f,q),L=null)}function l(){var t,e,i;e=(t=Date.now())-I,I=t,i=b-M,M=b,O=.8*(1e3*i/(1+e))+.2*O}function c(){var t,i;P&&(t=Date.now()-I,(i=P*Math.exp(-t/e.duration))>2||i<-2?(s(A-i),requestAnimationFrame(c)):s(A))}function u(i){if(q)return i.preventDefault(),i.stopPropagation(),!1;if(!e.fullWidth){var n=t(i.target).closest(".carousel-item").index();0!==r(w)-n&&(i.preventDefault(),i.stopPropagation()),d(n)}}function d(t){var e=w%C-t;W||(e<0?Math.abs(e+C)<Math.abs(e)&&(e+=C):e>0&&Math.abs(e-C)<e&&(e-=C)),e<0?j.trigger("carouselNext",[Math.abs(e)]):e>0&&j.trigger("carouselPrev",[e])}function p(e){"mousedown"===e.type&&t(e.target).is("img")&&e.preventDefault(),k=!0,q=!1,z=!1,T=o(e),S=a(e),O=P=0,M=b,I=Date.now(),clearInterval(D),D=setInterval(l,100)}function h(t){var e,i;if(k)if(e=o(t),y=a(t),i=T-e,Math.abs(S-y)<30&&!z)(i>2||i<-2)&&(q=!0,T=e,s(b+i));else{if(q)return t.preventDefault(),t.stopPropagation(),!1;z=!0}if(q)return t.preventDefault(),t.stopPropagation(),!1}function f(t){if(k)return k=!1,clearInterval(D),A=b,(O>10||O<-10)&&(A=b+(P=.9*O)),A=Math.round(A/x)*x,W&&(A>=x*(C-1)?A=x*(C-1):A<0&&(A=0)),P=A-b,I=Date.now(),requestAnimationFrame(c),q&&(t.preventDefault(),t.stopPropagation()),!1}var v,m,g,b,w,k,x,C,T,S,P,A,O,E,_,M,I,D,q,z,V=t('<ul class="indicators"></ul>'),H=null,L=null,j=t(this),$=j.find(".carousel-item").length>1,N=(j.attr("data-indicators")||e.indicators)&&$,W=j.attr("data-no-wrap")||e.noWrap||!$,F=j.attr("data-namespace")||n+i;j.attr("data-namespace",F);var Q=function(e){var i=j.find(".carousel-item.active").length?j.find(".carousel-item.active").first():j.find(".carousel-item").first(),n=i.find("img").first();if(n.length)if(n[0].complete)if(n.height()>0)j.css("height",n.height());else{var o=n[0].naturalWidth,a=n[0].naturalHeight,r=j.width()/o*a;j.css("height",r)}else n.on("load",function(){j.css("height",t(this).height())});else if(!e){var s=i.height();j.css("height",s)}};if(e.fullWidth&&(e.dist=0,Q(),N&&j.find(".carousel-fixed-item").addClass("with-indicators")),j.hasClass("initialized"))return t(window).trigger("resize"),j.trigger("carouselNext",[1e-6]),!0;j.addClass("initialized"),k=!1,b=A=0,v=[],m=j.find(".carousel-item").first().innerWidth(),g=j.find(".carousel-item").first().innerHeight(),x=2*m+e.padding,j.find(".carousel-item").each(function(e){if(v.push(t(this)[0]),N){var i=t('<li class="indicator-item"></li>');0===e&&i.addClass("active"),i.click(function(e){e.stopPropagation(),d(t(this).index())}),V.append(i)}}),N&&j.append(V),C=v.length,_="transform",["webkit","Moz","O","ms"].every(function(t){var e=t+"Transform";return void 0===document.body.style[e]||(_=e,!1)});var X=Materialize.throttle(function(){if(e.fullWidth){m=j.find(".carousel-item").first().innerWidth();j.find(".carousel-item.active").height();x=2*m+e.padding,A=b=2*w*m,Q(!0)}else s()},200);t(window).off("resize.carousel-"+F).on("resize.carousel-"+F,X),void 0!==window.ontouchstart&&(j.on("touchstart.carousel",p),j.on("touchmove.carousel",h),j.on("touchend.carousel",f)),j.on("mousedown.carousel",p),j.on("mousemove.carousel",h),j.on("mouseup.carousel",f),j.on("mouseleave.carousel",f),j.on("click.carousel",u),s(b),t(this).on("carouselNext",function(t,e,i){void 0===e&&(e=1),"function"==typeof i&&(L=i),A=x*Math.round(b/x)+x*e,b!==A&&(P=A-b,I=Date.now(),requestAnimationFrame(c))}),t(this).on("carouselPrev",function(t,e,i){void 0===e&&(e=1),"function"==typeof i&&(L=i),A=x*Math.round(b/x)-x*e,b!==A&&(P=A-b,I=Date.now(),requestAnimationFrame(c))}),t(this).on("carouselSet",function(t,e,i){void 0===e&&(e=0),"function"==typeof i&&(L=i),d(e)})})},next:function(e,i){t(this).trigger("carouselNext",[e,i])},prev:function(e,i){t(this).trigger("carouselPrev",[e,i])},set:function(e,i){t(this).trigger("carouselSet",[e,i])},destroy:function(){var e=t(this).attr("data-namespace");t(this).removeAttr("data-namespace"),t(this).removeClass("initialized"),t(this).find(".indicators").remove(),t(this).off("carouselNext carouselPrev carouselSet"),t(window).off("resize.carousel-"+e),void 0!==window.ontouchstart&&t(this).off("touchstart.carousel touchmove.carousel touchend.carousel"),t(this).off("mousedown.carousel mousemove.carousel mouseup.carousel mouseleave.carousel click.carousel")}};t.fn.carousel=function(i){return e[i]?e[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?void t.error("Method "+i+" does not exist on jQuery.carousel"):e.init.apply(this,arguments)}}(jQuery),function(t){var e={init:function(e){return this.each(function(){var i=t("#"+t(this).attr("data-activates")),n=(t("body"),t(this)),o=n.parent(".tap-target-wrapper"),a=o.find(".tap-target-wave"),r=o.find(".tap-target-origin"),s=n.find(".tap-target-content");o.length||(o=n.wrap(t('<div class="tap-target-wrapper"></div>')).parent()),s.length||(s=t('<div class="tap-target-content"></div>'),n.append(s)),a.length||(a=t('<div class="tap-target-wave"></div>'),r.length||((r=i.clone(!0,!0)).addClass("tap-target-origin"),r.removeAttr("id"),r.removeAttr("style"),a.append(r)),o.append(a));var l=function(){o.is(".open")&&(o.removeClass("open"),r.off("click.tapTarget"),t(document).off("click.tapTarget"),t(window).off("resize.tapTarget"))},c=function(){var e="fixed"===i.css("position");if(!e)for(var r=i.parents(),l=0;l<r.length&&!(e="fixed"==t(r[l]).css("position"));l++);var c=i.outerWidth(),u=i.outerHeight(),d=e?i.offset().top-t(document).scrollTop():i.offset().top,p=e?i.offset().left-t(document).scrollLeft():i.offset().left,h=t(window).width(),f=t(window).height(),v=h/2,m=f/2,g=p<=v,y=p>v,b=d<=m,w=d>m,k=p>=.25*h&&p<=.75*h,x=n.outerWidth(),C=n.outerHeight(),T=d+u/2-C/2,S=p+c/2-x/2,P=e?"fixed":"absolute",A=k?x:x/2+c,O=C/2,E=b?C/2:0,_=g&&!k?x/2-c:0,M=c,I=w?"bottom":"top",D=2*c,q=D,z=C/2-q/2,V=x/2-D/2,H={};H.top=b?T:"",H.right=y?h-S-x:"",H.bottom=w?f-T-C:"",H.left=g?S:"",H.position=P,o.css(H),s.css({width:A,height:O,top:E,right:0,bottom:0,left:_,padding:M,verticalAlign:I}),a.css({top:z,left:V,width:D,height:q})};"open"==e&&(c(),o.is(".open")||(o.addClass("open"),setTimeout(function(){r.off("click.tapTarget").on("click.tapTarget",function(t){l(),r.off("click.tapTarget")}),t(document).off("click.tapTarget").on("click.tapTarget",function(e){l(),t(document).off("click.tapTarget")});var e=Materialize.throttle(function(){c()},200);t(window).off("resize.tapTarget").on("resize.tapTarget",e)},0))),"close"==e&&l()})},open:function(){},close:function(){}};t.fn.tapTarget=function(i){if(e[i]||"object"==typeof i)return e.init.apply(this,arguments);t.error("Method "+i+" does not exist on jQuery.tap-target")}}(jQuery);
;// JavaScript autoComplete v1.0.4
// https://github.com/Pixabay/JavaScript-autoComplete
var autoComplete=function(){function e(e){function t(e,t){return e.classList?e.classList.contains(t):new RegExp("\\b"+t+"\\b").test(e.className)}function o(e,t,o){e.attachEvent?e.attachEvent("on"+t,o):e.addEventListener(t,o)}function s(e,t,o){e.detachEvent?e.detachEvent("on"+t,o):e.removeEventListener(t,o)}function n(e,s,n,l){o(l||document,s,function(o){for(var s,l=o.target||o.srcElement;l&&!(s=t(l,e));)l=l.parentElement;s&&n.call(l,o)})}if(document.querySelector){var l={selector:0,source:0,minChars:3,delay:150,offsetLeft:0,offsetTop:1,cache:1,menuClass:"",renderItem:function(e,t){t=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var o=new RegExp("("+t.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" data-val="'+e+'">'+e.replace(o,"<b>$1</b>")+"</div>"},onSelect:function(){}};for(var c in e)e.hasOwnProperty(c)&&(l[c]=e[c]);for(var a="object"==typeof l.selector?[l.selector]:document.querySelectorAll(l.selector),u=0;u<a.length;u++){var i=a[u];i.sc=document.createElement("div"),i.sc.className="autocomplete-suggestions "+l.menuClass,i.autocompleteAttr=i.getAttribute("autocomplete"),i.setAttribute("autocomplete","off"),i.cache={},i.last_val="",i.updateSC=function(e,t){var o=i.getBoundingClientRect();if(i.sc.style.left=Math.round(o.left+(window.pageXOffset||document.documentElement.scrollLeft)+l.offsetLeft)+"px",i.sc.style.top=Math.round(o.bottom+(window.pageYOffset||document.documentElement.scrollTop)+l.offsetTop)+"px",i.sc.style.width=Math.round(o.right-o.left)+"px",!e&&(i.sc.style.display="block",i.sc.maxHeight||(i.sc.maxHeight=parseInt((window.getComputedStyle?getComputedStyle(i.sc,null):i.sc.currentStyle).maxHeight)),i.sc.suggestionHeight||(i.sc.suggestionHeight=i.sc.querySelector(".autocomplete-suggestion").offsetHeight),i.sc.suggestionHeight))if(t){var s=i.sc.scrollTop,n=t.getBoundingClientRect().top-i.sc.getBoundingClientRect().top;n+i.sc.suggestionHeight-i.sc.maxHeight>0?i.sc.scrollTop=n+i.sc.suggestionHeight+s-i.sc.maxHeight:0>n&&(i.sc.scrollTop=n+s)}else i.sc.scrollTop=0},o(window,"resize",i.updateSC),document.body.appendChild(i.sc),n("autocomplete-suggestion","mouseleave",function(){var e=i.sc.querySelector(".autocomplete-suggestion.selected");e&&setTimeout(function(){e.className=e.className.replace("selected","")},20)},i.sc),n("autocomplete-suggestion","mouseover",function(){var e=i.sc.querySelector(".autocomplete-suggestion.selected");e&&(e.className=e.className.replace("selected","")),this.className+=" selected"},i.sc),n("autocomplete-suggestion","mousedown",function(e){if(t(this,"autocomplete-suggestion")){var o=this.getAttribute("data-val");i.value=o,l.onSelect(e,o,this),i.sc.style.display="none"}},i.sc),i.blurHandler=function(){try{var e=document.querySelector(".autocomplete-suggestions:hover")}catch(t){var e=0}e?i!==document.activeElement&&setTimeout(function(){i.focus()},20):(i.last_val=i.value,i.sc.style.display="none",setTimeout(function(){i.sc.style.display="none"},350))},o(i,"blur",i.blurHandler);var r=function(e){var t=i.value;if(i.cache[t]=e,e.length&&t.length>=l.minChars){for(var o="",s=0;s<e.length;s++)o+=l.renderItem(e[s],t);i.sc.innerHTML=o,i.updateSC(0)}else i.sc.style.display="none"};i.keydownHandler=function(e){var t=window.event?e.keyCode:e.which;if((40==t||38==t)&&i.sc.innerHTML){var o,s=i.sc.querySelector(".autocomplete-suggestion.selected");return s?(o=40==t?s.nextSibling:s.previousSibling,o?(s.className=s.className.replace("selected",""),o.className+=" selected",i.value=o.getAttribute("data-val")):(s.className=s.className.replace("selected",""),i.value=i.last_val,o=0)):(o=40==t?i.sc.querySelector(".autocomplete-suggestion"):i.sc.childNodes[i.sc.childNodes.length-1],o.className+=" selected",i.value=o.getAttribute("data-val")),i.updateSC(0,o),!1}if(27==t)i.value=i.last_val,i.sc.style.display="none";else if(13==t||9==t){var s=i.sc.querySelector(".autocomplete-suggestion.selected");s&&"none"!=i.sc.style.display&&(l.onSelect(e,s.getAttribute("data-val"),s),setTimeout(function(){i.sc.style.display="none"},20))}},o(i,"keydown",i.keydownHandler),i.keyupHandler=function(e){var t=window.event?e.keyCode:e.which;if(!t||(35>t||t>40)&&13!=t&&27!=t){var o=i.value;if(o.length>=l.minChars){if(o!=i.last_val){if(i.last_val=o,clearTimeout(i.timer),l.cache){if(o in i.cache)return void r(i.cache[o]);for(var s=1;s<o.length-l.minChars;s++){var n=o.slice(0,o.length-s);if(n in i.cache&&!i.cache[n].length)return void r([])}}i.timer=setTimeout(function(){l.source(o,r)},l.delay)}}else i.last_val=o,i.sc.style.display="none"}},o(i,"keyup",i.keyupHandler),i.focusHandler=function(e){i.last_val="\n",i.keyupHandler(e)},l.minChars||o(i,"focus",i.focusHandler)}this.destroy=function(){for(var e=0;e<a.length;e++){var t=a[e];s(window,"resize",t.updateSC),s(t,"blur",t.blurHandler),s(t,"focus",t.focusHandler),s(t,"keydown",t.keydownHandler),s(t,"keyup",t.keyupHandler),t.autocompleteAttr?t.setAttribute("autocomplete",t.autocompleteAttr):t.removeAttribute("autocomplete"),document.body.removeChild(t.sc),t=null}}}}return e}();!function(){"function"==typeof define&&define.amd?define("autoComplete",function(){return autoComplete}):"undefined"!=typeof module&&module.exports?module.exports=autoComplete:window.autoComplete=autoComplete}();

;//
//     KeyLines v5.2.1-23282 eval
//     Licensed to Graphmantics for TBD expires on Wed Mar 27 2019
//
//     Copyright  2011-2019 Cambridge Intelligence Limited.
//     All rights reserved.
//
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.KeyLines=t()}(this,function(){"use strict";var e,t=function(e,t){if(e&&"object"==typeof e)if(Array.isArray(e))e.forEach(t);else for(var n=Object.keys(e),r=n.length,i=0;i<r;i++){var a=n[i];t(e[a],a)}};function n(){if("undefined"!=typeof window)return window.devicePixelRatio||1}function r(e){return"rtl"===window.getComputedStyle(e).direction}function i(e){if(null===e)return null;switch(typeof e){case"object":if(Array.isArray(e))return e.slice();if(f(e))return u(e);if(e instanceof Date)return new Date(e.getTime());var n={};t(e,function(e,t){n[t]=e});return n;case"boolean":case"string":case"number":return e;default:return}}function a(e){return e*(Math.PI/180)}function o(e,n,r){var i,a=n,s=r;if(2===arguments.length&&"string"==typeof a){s=a;a=!0}if(null===e)return null;function l(e,t){a&&"_"===t.charAt(0)||(i[t]=o(e,a&&t!==s))}switch(typeof e){case"object":if(Array.isArray(e)){for(var c=[],d=0;d<e.length;d++)c.push(o(e[d],a,s));return c}if(f(e))return u(e,!0);if(e instanceof Date)return new Date(e.getTime());i={};t(e,l);return i;case"boolean":case"string":case"number":return e;default:return}}function u(e,t){var n,r=Object.getPrototypeOf(e).constructor;if(t){n=new r;o(Array.from(e)).forEach(function(e){n.add?n.add(e):n.set(e[0],e[1])})}else n=new r(e);return n}function s(){return Object.isPrototypeOf&&Array.from&&"undefined"!=typeof Set&&"undefined"!=typeof Map}function f(t){null==e&&s&&(e=s());return!!e&&(Object.prototype.isPrototypeOf.call(Map.prototype,t)||Object.prototype.isPrototypeOf.call(Set.prototype,t))}function l(e,t){if(y(e))return setTimeout(e,t)}function c(e,t){if(y(e))return setInterval(e,t)}function d(){KeyLines._loggerDisabled||console.log([].slice.call(arguments).join(" "))}var h=Number.isNaN||v;function v(e){return e!=e}var g=Number.isFinite||p;function p(e){return"number"==typeof e&&isFinite(e)}function m(e){return e>>>0===parseFloat(e)}function y(e){return"function"==typeof e}function b(e,t){var n=t||"";return n.slice(Math.max(n.length-5,0))==="."+e}function x(e){return!("object"!=typeof e||e instanceof Date||Array.isArray(e)||G(e))}function w(e){return"[object Date]"===Object.prototype.toString.call(e)&&!h(e.getTime())}function A(e,t){return void 0===e&&void 0===t||(!(!h(e)||!h(t)||"number"!=typeof e||"number"!=typeof t)||(Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every(function(e,n){return M(e,t[n])}):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e===t))}function M(e,t){return x(e)&&x(t)?Object.keys(t).every(function(n){return M(e[n],t[n])}):A(e,t)}function I(e,t){e&&y(e)&&l(function(){e(t)})}function E(e,t){e&&y(e)&&e(t)}var C=Number.isInteger||k;function k(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function S(e,t){try{t(null,e())}catch(e){t(e)}}function T(e){return e&&!Array.isArray(e)&&e.items?e.items:e}function R(e){return Array.isArray(e)?e:[e]}function B(e,n){var r=o(e)||{};if("string"==typeof e)return e;t(n,function(e,t){O(r,t)&&!G(r[t])||(r[t]=e)});return r}function Z(e){return void 0!==e}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function G(e){return null==e}function F(){return""}function D(e){return e.lastIndexOf(F())}function z(e){if(G(e))return null;var t=e+"",n=D(t);-1!==n&&(t=t.substring(0,n));return t}function V(e){if(G(e))return null;var t=e+"",n=D(t);return-1!==n?t.substring(n+1):null}function Y(e,t){return e.indexOf(t)>-1}var P=Object.values||W;function W(e){return Object.keys(e).map(function(t){return e[t]})}function X(e){return Object.keys(e).length>0}function U(e){return R(e).reduce(function(e,t){e[z(t)]=1;return e},{})}function N(e){return R(e).reduce(function(e,t){e.set(z(t),1);return e},new Map)}function j(e){var t={};e.forEach(function(e){t[e.id]=e});return t}function _(e){var t={};e.forEach(function(e){t[e]=e});return t}function H(e){return e.map(function(e){return e.id})}function K(e,n){if(e){t(n,function(t,n){e[n]=t});return e}return n}var Q=Object.assign||J;function J(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n}function q(e,t){return Math.max(1e-4,Math.sqrt(e*e+t*t))}function $(e,t){var n=e,r=t,i=q(n,r);return[n/=i,r/=i]}function ee(e,t,n,r){var i=$(e,t),a=$(n,r);return i[0]*a[0]+i[1]*a[1]}function te(){}function ne(e,t,n){var r=!e();function i(){r||(r=t())||(r=!e());return r?n():l(i,0)}i()}function re(e,t){var n,r,i,a;return function(){var o=Date.now();i=this;a=arguments;function u(){r=Date.now();e.apply(i,a)}if(!n)if(!r||o-r>=t)u();else{n=l(function(){n=null;u()},t-(o-r))}}}function ie(e){var t=e,n=48271,r=2147483647,i=r/n,a=r%n,o=1/r;return{setSeed:function(e){t=e},next:function(){if(t){var e=n*(t%i)-a*(t/i);return(t=e>0?e:e+r)*o}return Math.random()}}}var oe={};function ue(e){if(!oe[e]){var t=e;e.match(/'/)&&(t=e.replace(/'/g,"\\'"));t.match(/\s/)&&(t="'"+t+"'");oe[e]=t}return oe[e]}function se(e){return fe(e,e.target.id)}function fe(e,t){var n=le(t);return{x:Math.floor(e.pageX-n.left),y:Math.floor(e.pageY-n.top)}}function le(e){var t=document.getElementById(e),n={top:0,left:0};t&&(n=t.getBoundingClientRect());return{top:n.top+window.pageYOffset-document.documentElement.clientTop,left:n.left+window.pageXOffset-document.documentElement.clientLeft}}function ce(e,t,n){var r=void 0===n?function(e){return e}:n,i=new Map,a=[],o=[];e.forEach(function(e){var t=r(e);t&&i.set(t,{item:e,inDegree:0})});e.forEach(function(e){var n=t(e),a=r(e);n&&n.forEach(function(e){i.has(e)&&e!==a&&i.get(e).inDegree++})});e.forEach(function(e){var t=r(e);t&&0===i.get(t).inDegree&&o.push(e)});for(;o.length>0;){var u=o.shift();a.push(u);var s=t(u);if(s)for(var f=0;f<s.length;f++){var l=i.get(s[f]);l&&1==l.inDegree--&&o.push(l.item)}}if(a.length<i.size)throw new Error("Cycle detected");return a}function de(e){return x(e.pos)&&!G(e.pos.lat)&&!G(e.pos.lng)}function he(e){e.stopPropagation&&e.stopPropagation();e.preventDefault?e.preventDefault():e.returnValue=!1;e.preventCapture&&e.preventCapture();e.preventBubble&&e.preventBubble()}function ve(e,t){for(var n=e.split("."),r=t.split("."),i=0;i<n.length&&i<r.length;i++){var a=parseInt(n[i],10),o=parseInt(r[i],10);if(a!==o)return a-o}return n.length!==r.length?n.length-r.length:0}function ge(e){for(var t=0,n=e.length;t<n;t++){var r=e.charCodeAt(t);if(r>=1536&&(r<=1791||r>=64336&&r<=65023||r>=65136&&r<=65279||r>=1872&&r<=1919||r>=2208&&r<=2303))return!0}return!1}function pe(e){return Math.floor(e*(11/14))}function me(e){var t=e.charCodeAt(0);return t<=55295||t>=57344?t:1024*(t-55296)+(e.charCodeAt(1)-56320)+65536}function ye(e){return[[169,169],[174,174],[8252,8252],[8265,8265],[8419,8419],[8482,8482],[8505,8505],[8596,8601],[8617,8618],[8986,8987],[9e3,9e3],[9096,9096],[9167,9167],[9193,9203],[9208,9210],[9410,9410],[9642,9643],[9654,9654],[9664,9664],[9723,9726],[9728,9733],[9735,9746],[9748,9861],[9872,9989],[9992,10002],[10004,10004],[10006,10006],[10013,10013],[10017,10017],[10024,10024],[10035,10036],[10052,10052],[10055,10055],[10060,10060],[10062,10062],[10067,10069],[10071,10071],[10083,10087],[10133,10135],[10145,10145],[10160,10160],[10175,10175],[10548,10549],[11013,11015],[11035,11036],[11088,11088],[11093,11093],[12336,12336],[12349,12349],[12951,12951],[12953,12953],[65039,65039],[126976,127231],[127245,127247],[127279,127279],[127340,127345],[127358,127359],[127374,127374],[127377,127386],[127405,127487],[127489,127503],[127514,127514],[127535,127535],[127538,127546],[127548,127551],[127561,128317],[128326,128591],[128640,128767],[128884,128895],[128981,129023],[129036,129039],[129096,129103],[129114,129119],[129160,129167],[129198,129279],[129292,129338],[129340,129349],[129351,131069],[917536,917631]].some(function(t){return e>=t[0]&&e<=t[1]})}function be(e){return xe(e).some(function(e){return ye(me(e))})}function xe(e){for(var t,n=0,r=e.length,i=[];n<r;++n){t=!1;var a=e.charCodeAt(n);if(a>=55296&&a<=56319&&n+1<r&&(a=e.charCodeAt(n+1))>=56320&&a<=57343){i.push(e.slice(n,n+2));++n;t=!0}t||i.push(e.charAt(n))}return i}function we(e){var t,n,r,i=[],a=e.length;for(t=0;t<a;t++){r=me(n=e[t]);if(0===t)i.push(n);else if(s(r))i[i.length-1]+=n;else if(65038===r||65039===r)i[i.length-1]+=n;else if(o(r))i[i.length-1]+=n;else if(u(r)&&2===i[i.length-1].length&&u(me(i[i.length-1])))i[i.length-1]+=n;else if(8205===r&&be(i[i.length-1])&&t<a-1&&ye(me(e[t+1]))){i[i.length-1]+=n;i[i.length-1]+=e[++t]}else r>=917536&&r<=917631?i[i.length-1]+=n:i.push(n)}function o(e){return e>=127995&&e<=127999}function u(e){return e>=127462&&e<=127487}function s(e){return e>=768&&e<=879||e>=8400&&e<=8447}return i}var Ae={},Me=0,Ie=1,Ee=2,Ce=3,ke=4,Se=5,Te=6,Re=7,Le=8,Be=9,Ze=10,Oe=11,Ge=12,Fe=13,De=14,ze=15,Ve=16,Ye=17,Pe=18,We=2,Xe=5,Ue=[9,Pe,10,Te,11,Se,12,Te,13,Le,14,Se,28,Pe,31,Se,32,Te,33,Le,35,ke,38,Oe,43,ke,44,Ze,45,Be,46,Ze,48,Be,58,Ee,59,Be,65,ke,91,Me,97,ke,123,Me,127,ke,133,Pe,134,Se,160,Pe,161,Be,162,ke,166,Oe,170,ke,171,Me,173,ke,174,Pe,176,ke,178,Oe,180,Ee,181,ke,182,Me,185,ke,186,Ee,187,Me,192,ke,215,Me,216,ke,247,Me,248,ke,697,Me,699,ke,706,Me,720,ke,722,Me,736,ke,741,Me,750,ke,751,Me,768,ke,880,Ge,884,Me,886,ke,894,Me,895,ke,900,Me,902,ke,903,Me,904,ke,1014,Me,1015,ke,1155,Me,1162,Ge,1418,Me,1423,ke,1425,Oe,1470,Ge,1471,Ie,1472,Ge,1473,Ie,1475,Ge,1476,Ie,1478,Ge,1479,Ie,1488,Ge,1536,Ie,1542,Ce,1544,ke,1545,Re,1547,Oe,1548,Re,1549,Be,1550,Re,1552,ke,1563,Ge,1611,Re,1632,Ge,1642,Ce,1643,Oe,1645,Ce,1648,Re,1649,Ge,1750,Re,1757,Ge,1758,Ce,1759,ke,1765,Ge,1767,Re,1769,Ge,1770,ke,1774,Ge,1776,Re,1786,Ee,1809,Re,1810,Ge,1840,Re,1869,Ge,1958,Re,1969,Ge,1984,Re,2027,Ie,2036,Ge,2038,Ie,2042,ke,2070,Ie,2074,Ge,2075,Ie,2084,Ge,2085,Ie,2088,Ge,2089,Ie,2096,Ge,2137,Ie,2142,Ge,2208,Ie,2260,Re,2274,Ge,2275,Ce,2307,Ge,2362,Me,2363,Ge,2364,Me,2365,Ge,2369,Me,2377,Ge,2381,Me,2382,Ge,2385,Me,2392,Ge,2402,Me,2404,Ge,2433,Me,2434,Ge,2492,Me,2493,Ge,2497,Me,2503,Ge,2509,Me,2510,Ge,2530,Me,2534,Ge,2546,Me,2548,Oe,2555,Me,2561,Oe,2563,Ge,2620,Me,2622,Ge,2625,Me,2649,Ge,2672,Me,2674,Ge,2677,Me,2691,Ge,2748,Me,2749,Ge,2753,Me,2761,Ge,2765,Me,2768,Ge,2786,Me,2790,Ge,2801,Me,2809,Oe,2817,Me,2818,Ge,2876,Me,2877,Ge,2879,Me,2880,Ge,2881,Me,2887,Ge,2893,Me,2903,Ge,2914,Me,2918,Ge,2946,Me,2947,Ge,3008,Me,3009,Ge,3021,Me,3024,Ge,3059,Me,3065,ke,3066,Oe,3072,ke,3073,Ge,3134,Me,3137,Ge,3142,Me,3160,Ge,3170,Me,3174,Ge,3192,Me,3199,ke,3201,Me,3202,Ge,3260,Me,3261,Ge,3276,Me,3285,Ge,3298,Me,3302,Ge,3329,Me,3330,Ge,3393,Me,3398,Ge,3405,Me,3406,Ge,3426,Me,3430,Ge,3530,Me,3535,Ge,3538,Me,3544,Ge,3633,Me,3634,Ge,3636,Me,3647,Ge,3648,Oe,3655,Me,3663,Ge,3761,Me,3762,Ge,3764,Me,3773,Ge,3784,Me,3792,Ge,3864,Me,3866,Ge,3893,Me,3894,Ge,3895,Me,3896,Ge,3897,Me,3898,Ge,3902,ke,3953,Me,3967,Ge,3968,Me,3973,Ge,3974,Me,3976,Ge,3981,Me,4030,Ge,4038,Me,4039,Ge,4141,Me,4145,Ge,4146,Me,4152,Ge,4153,Me,4155,Ge,4157,Me,4159,Ge,4184,Me,4186,Ge,4190,Me,4193,Ge,4209,Me,4213,Ge,4226,Me,4227,Ge,4229,Me,4231,Ge,4237,Me,4238,Ge,4253,Me,4254,Ge,4957,Me,4960,Ge,5008,Me,5024,ke,5120,Me,5121,ke,5760,Me,5761,Le,5787,Me,5792,ke,5906,Me,5920,Ge,5938,Me,5941,Ge,5970,Me,5984,Ge,6002,Me,6016,Ge,6068,Me,6070,Ge,6071,Me,6078,Ge,6086,Me,6087,Ge,6089,Me,6100,Ge,6107,Me,6108,Oe,6109,Me,6112,Ge,6128,Me,6155,ke,6158,Ge,6160,Pe,6277,Me,6279,Ge,6313,Me,6314,Ge,6432,Me,6435,Ge,6439,Me,6441,Ge,6450,Me,6451,Ge,6457,Me,6464,Ge,6470,ke,6622,Me,6656,ke,6679,Me,6681,Ge,6683,Me,6686,Ge,6742,Me,6743,Ge,6744,Me,6753,Ge,6754,Me,6755,Ge,6757,Me,6765,Ge,6771,Me,6784,Ge,6832,Me,6916,Ge,6964,Me,6965,Ge,6966,Me,6971,Ge,6972,Me,6973,Ge,6978,Me,6979,Ge,7019,Me,7028,Ge,7040,Me,7042,Ge,7074,Me,7078,Ge,7080,Me,7082,Ge,7083,Me,7086,Ge,7142,Me,7143,Ge,7144,Me,7146,Ge,7149,Me,7150,Ge,7151,Me,7154,Ge,7212,Me,7220,Ge,7222,Me,7227,Ge,7376,Me,7379,Ge,7380,Me,7393,Ge,7394,Me,7401,Ge,7405,Me,7406,Ge,7412,Me,7413,Ge,7416,Me,7424,Ge,7616,Me,7680,Ge,8125,Me,8126,ke,8127,Me,8130,ke,8141,Me,8144,ke,8157,Me,8160,ke,8173,Me,8178,ke,8189,Me,8192,ke,8203,Le,8206,Pe,8207,Me,8208,Ie,8232,ke,8233,Le,8234,Se,8235,Fe,8236,De,8237,ze,8238,Ve,8239,Ye,8240,Be,8245,Oe,8260,ke,8261,Be,8287,ke,8288,Le,8294,Pe,8298,null,8304,Pe,8305,Ee,8308,Me,8314,Ee,8316,Ze,8319,ke,8320,Me,8330,Ee,8332,Ze,8336,ke,8352,Me,8400,Oe,8448,Ge,8450,ke,8451,Me,8455,ke,8456,Me,8458,ke,8468,Me,8469,ke,8470,Me,8473,ke,8478,Me,8484,ke,8485,Me,8486,ke,8487,Me,8488,ke,8489,Me,8490,ke,8494,Me,8495,Oe,8506,Me,8508,ke,8512,Me,8517,ke,8522,Me,8526,ke,8528,Me,8544,ke,8585,Me,8722,ke,8723,Ze,8724,Oe,9014,ke,9083,Me,9109,ke,9110,Me,9352,ke,9372,Ee,9450,Me,9900,ke,9901,Me,10240,ke,10496,Me,11264,ke,11493,Me,11499,ke,11503,Me,11506,Ge,11513,Me,11520,ke,11647,Me,11648,Ge,11744,Me,11776,Ge,12288,ke,12289,Le,12293,ke,12296,Me,12321,ke,12330,Me,12334,Ge,12336,Me,12337,ke,12342,Me,12344,ke,12349,Me,12353,ke,12441,Me,12443,Ge,12445,ke,12448,Me,12449,ke,12539,Me,12540,ke,12736,Me,12784,ke,12829,Me,12832,ke,12880,Me,12896,ke,12924,Me,12927,ke,12977,Me,12992,ke,13004,Me,13008,ke,13175,Me,13179,ke,13278,Me,13280,ke,13311,Me,13312,ke,19904,Me,19968,ke,42128,Me,42192,ke,42509,Me,42512,ke,42607,Me,42611,Ge,42612,ke,42622,Ge,42624,ke,42654,Me,42656,Ge,42736,Me,42738,Ge,42752,Me,42786,ke,42888,Me,42889,ke,43010,Me,43011,Ge,43014,Me,43015,Ge,43019,Me,43020,Ge,43045,Me,43047,Ge,43048,Me,43056,ke,43064,Me,43072,Oe,43124,Me,43136,ke,43204,Me,43214,Ge,43232,Me,43250,Ge,43302,Me,43310,Ge,43335,Me,43346,Ge,43392,Me,43395,Ge,43443,Me,43444,Ge,43446,Me,43450,Ge,43452,Me,43453,Ge,43493,Me,43494,Ge,43561,Me,43567,Ge,43569,Me,43571,Ge,43573,Me,43584,Ge,43587,Me,43588,Ge,43596,Me,43597,Ge,43644,Me,43645,Ge,43696,Me,43697,Ge,43698,Me,43701,Ge,43703,Me,43705,Ge,43710,Me,43712,Ge,43713,Me,43714,Ge,43756,Me,43758,Ge,43766,Me,43777,Ge,44005,Me,44006,Ge,44008,Me,44009,Ge,44013,Me,44016,Ge,64285,Me,64286,Ie,64287,Ge,64297,Ie,64298,Ze,64336,Ie,64830,Re,64848,ke,65021,Re,65024,ke,65040,Ge,65056,ke,65072,Ge,65104,ke,65105,Be,65106,ke,65108,Be,65109,ke,65110,Be,65119,ke,65120,Oe,65122,ke,65124,Ze,65129,ke,65131,Oe,65136,ke,65279,Re,65281,Pe,65283,ke,65286,Oe,65291,ke,65292,Ze,65293,Be,65294,Ze,65296,Be,65306,Ee,65307,Be,65313,ke,65339,Me,65345,ke,65371,Me,65382,ke,65504,Me,65506,Oe,65509,ke,65512,Oe,1114109,ke],Ne={1536:{t:4},1537:{t:4},1538:{t:4},1539:{t:4},1540:{t:4},1541:{t:4},1544:{t:4},1547:{t:4},1568:{t:2},1569:{t:4,isolated:65152},1570:{t:1,isolated:65153,initial:65154},1571:{t:1,isolated:65155,initial:65156},1572:{t:1,isolated:65157,initial:65158},1573:{t:1,isolated:65159,initial:65160},1574:{t:2,isolated:65161,final:65163,median:65164,initial:65162},1575:{t:1,isolated:65165,initial:65166},1576:{t:2,isolated:65167,final:65169,median:65170,initial:65168},1577:{t:1,isolated:65171,initial:65172},1578:{t:2,isolated:65173,final:65175,median:65176,initial:65174},1579:{t:2,isolated:65177,final:65179,median:65180,initial:65178},1580:{t:2,isolated:65181,final:65183,median:65184,initial:65182},1581:{t:2,isolated:65185,final:65187,median:65188,initial:65186},1582:{t:2,isolated:65189,final:65191,median:65192,initial:65190},1583:{t:1,isolated:65193,initial:65194},1584:{t:1,isolated:65195,initial:65196},1585:{t:1,isolated:65197,initial:65198},1586:{t:1,isolated:65199,initial:65200},1587:{t:2,isolated:65201,final:65203,median:65204,initial:65202},1588:{t:2,isolated:65205,final:65207,median:65208,initial:65206},1589:{t:2,isolated:65209,final:65211,median:65212,initial:65210},1590:{t:2,isolated:65213,final:65215,median:65216,initial:65214},1591:{t:2,isolated:65217,final:65219,median:65220,initial:65218},1592:{t:2,isolated:65221,final:65223,median:65224,initial:65222},1593:{t:2,isolated:65225,final:65227,median:65228,initial:65226},1594:{t:2,isolated:65229,final:65231,median:65232,initial:65230},1595:{t:2},1596:{t:2},1597:{t:2},1598:{t:2},1599:{t:2},1600:{t:3,isolated:1600,final:1600,median:1600,initial:1600},1601:{t:2,isolated:65233,final:65235,median:65236,initial:65234},1602:{t:2,isolated:65237,final:65239,median:65240,initial:65238},1603:{t:2,isolated:65241,final:65243,median:65244,initial:65242},1604:{t:2,isolated:65245,final:65247,median:65248,initial:65246},1605:{t:2,isolated:65249,final:65251,median:65252,initial:65250},1606:{t:2,isolated:65253,final:65255,median:65256,initial:65254},1607:{t:2,isolated:65257,final:65259,median:65260,initial:65258},1608:{t:1,isolated:65261,initial:65262},1609:{t:2,isolated:65263,initial:65264},1610:{t:2,isolated:65265,final:65267,median:65268,initial:65266},1646:{t:2},1647:{t:2},1649:{t:1},1650:{t:1},1651:{t:1},1652:{t:4},1653:{t:1},1654:{t:1},1655:{t:1},1656:{t:2},1657:{t:2},1658:{t:2},1659:{t:2},1660:{t:2},1661:{t:2},1662:{t:2,isolated:64342,final:64344,median:64345,initial:64343},1663:{t:2},1664:{t:2},1665:{t:2},1666:{t:2},1667:{t:2},1668:{t:2},1669:{t:2},1670:{t:2,isolated:64378,final:64380,median:64381,initial:64379},1671:{t:2},1672:{t:1},1673:{t:1},1674:{t:1},1675:{t:1},1676:{t:1},1677:{t:1},1678:{t:1},1679:{t:1},1680:{t:1},1681:{t:1},1682:{t:1},1683:{t:1},1684:{t:1},1685:{t:1},1686:{t:1},1687:{t:1},1688:{t:1,isolated:64394,initial:64395},1689:{t:1},1690:{t:2},1691:{t:2},1692:{t:2},1693:{t:2},1694:{t:2},1695:{t:2},1696:{t:2},1697:{t:2},1698:{t:2},1699:{t:2},1700:{t:2},1701:{t:2},1702:{t:2},1703:{t:2},1704:{t:2},1705:{t:2,isolated:64398,final:64400,median:64401,initial:64399},1706:{t:2},1707:{t:2},1708:{t:2},1709:{t:2},1710:{t:2},1711:{t:2,isolated:64402,final:64404,median:64405,initial:64403},1712:{t:2},1713:{t:2},1714:{t:2},1715:{t:2},1716:{t:2},1717:{t:2},1718:{t:2},1719:{t:2},1720:{t:2},1721:{t:2},1722:{t:2},1723:{t:2},1724:{t:2},1725:{t:2},1726:{t:2},1727:{t:2},1728:{t:1},1729:{t:2},1730:{t:2},1731:{t:1},1732:{t:1},1733:{t:1},1734:{t:1},1735:{t:1},1736:{t:1},1737:{t:1},1738:{t:1},1739:{t:1},1740:{t:2,isolated:64508,final:64510,median:64511,initial:64509},1741:{t:1},1742:{t:2},1743:{t:1},1744:{t:2},1745:{t:2},1746:{t:1},1747:{t:1},1749:{t:1},1757:{t:4},1774:{t:1},1775:{t:1},1786:{t:2},1787:{t:2},1788:{t:2},1791:{t:2},1808:{t:1},1810:{t:2},1811:{t:2},1812:{t:2},1813:{t:1},1814:{t:1},1815:{t:1},1816:{t:1},1817:{t:1},1818:{t:2},1819:{t:2},1820:{t:2},1821:{t:2},1822:{t:1},1823:{t:2},1824:{t:2},1825:{t:2},1826:{t:2},1827:{t:2},1828:{t:2},1829:{t:2},1830:{t:2},1831:{t:2},1832:{t:1},1833:{t:2},1834:{t:1},1835:{t:2},1836:{t:1},1837:{t:2},1838:{t:2},1839:{t:1},1869:{t:1},1870:{t:2},1871:{t:2},1872:{t:2},1873:{t:2},1874:{t:2},1875:{t:2},1876:{t:2},1877:{t:2},1878:{t:2},1879:{t:2},1880:{t:2},1881:{t:1},1882:{t:1},1883:{t:1},1884:{t:2},1885:{t:2},1886:{t:2},1887:{t:2},1888:{t:2},1889:{t:2},1890:{t:2},1891:{t:2},1892:{t:2},1893:{t:2},1894:{t:2},1895:{t:2},1896:{t:2},1897:{t:2},1898:{t:2},1899:{t:1},1900:{t:1},1901:{t:2},1902:{t:2},1903:{t:2},1904:{t:2},1905:{t:1},1906:{t:2},1907:{t:1},1908:{t:1},1909:{t:2},1910:{t:2},1911:{t:2},1912:{t:1},1913:{t:1},1914:{t:2},1915:{t:2},1916:{t:2},1917:{t:2},1918:{t:2},1919:{t:2},2208:{t:2},2209:{t:2},2210:{t:2},2211:{t:2},2212:{t:2},2213:{t:2},2214:{t:2},2215:{t:2},2216:{t:2},2217:{t:2},2218:{t:1},2219:{t:1},2220:{t:1},2221:{t:4},2222:{t:1},2223:{t:2},2224:{t:2},2225:{t:1},2226:{t:1},2227:{t:2},2228:{t:2},2230:{t:2},2231:{t:2},2232:{t:2},2233:{t:1},2234:{t:2},2235:{t:2},2236:{t:2},2237:{t:2},2274:{t:4},8204:{t:4},8205:{t:3},8239:{t:4},8294:{t:4},8295:{t:4},8296:{t:4},8297:{t:4},65269:{t:1,isolated:65269,initial:65270},65271:{t:1,isolated:65271,initial:65272},65273:{t:1,isolated:65273,initial:65274},65275:{t:1,isolated:65275,initial:65276}},je={1611:1,1612:1,1613:1,1614:1,1615:1,1616:1,1617:1,1618:1,1619:1,1620:1,1621:1,1648:1},_e={1456:1,1457:1,1458:1,1459:1,1460:1,1461:1,1462:1,1463:1,1464:1,1465:1,1466:1,1467:1,1473:1,1474:1},He={"":{"":"","":"","":"","":""},"":{"":{"":{"":""}}}},Ke={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{",">":"<","<":">"},Qe=63;function Je(e,t){if(Ae[t])return Ae[t];var n={characters:[],logicalOrder:e,result:[]},r=qe(e),i=nt(e,r),a=i.length;i.forEach(function(e,t){rt(e);tt(e);if(0!==e.characters.length){$e(e);et(e);ht(e);vt(e);yt(e);bt(e);gt(e);wt(e,_e,!1);xt(e);n.result=n.result.concat(e.reorderedCharacters);t<a-1&&n.result.push({text:"\n",level:0,type:Se});n.characters=n.characters.concat(e.characters)}});n.types=r;Ae[t]=n;return n}function qe(e){return e.map(function(e){return kt(e)||0})}function $e(e){it(e);at(e);ot(e);ut(e);st(e);ft(e);lt(e)}function et(e){ct(e);dt(e)}function tt(e){var t=0,n=1,r=2,i=e.level,a=[];a.push({level:e.level,override:t});var o=0,u=a[0],s=u.level,f=[];function l(e,t){if(e<Qe){a.push({level:e,override:t});return e}}e.characters.forEach(function(e){var c=e.type;if(c===De){s+=Tt(s)?2:1;i=l(s,t)}else if(c===Fe){s+=St(s)?2:1;i=l(s,t)}else if(c===Ye){s+=Tt(s)?2:1;i=l(s,r)}else if(c===Ve){s+=St(s)?2:1;i=l(s,n)}c===ze?a.length>1&&(u=a.pop()):u=a[a.length-1];i=u.level;s=i;if(-1===[Pe,De,Fe,Ye,Ve,ze].indexOf(c)){u.override>t&&(e.type=u.override===r?Ie:Me);e.embeddingLevel=i;e.index=o++;f.push(e)}});e.characters=f}function nt(e,t){var n=0,r=[],i=[];t.forEach(function(e){if(e!==Se)i.push(e);else if(i.length>0){a(i);n++;i.length=0}});i.length>0&&a(i);function a(t){var i=n,a=t.map(function(t){return{text:e[n++],level:0,embeddingLevel:null,type:t}}),o=e.slice(i,i+t.length);r.push({symbols:o,level:0,characters:a})}return r}function rt(e){e.level=1}function it(e){e.characters.filter(Rt(Ge)).forEach(function(t){t.isNSM=!0;if(t.index>0){var n=e.characters[t.index-1].type;n===Re&&(t.type=Re);Ie===n&&(t.type=Ie)}})}function at(e){e.characters.filter(Rt(Ee)).forEach(function(t){for(var n=t.index-1;n>=0;n--){var r=e.characters[n].type;if(r===Re){t.type=Ce;break}if([Ie,Me].indexOf(r)>-1)break}})}function ot(e){e.characters.filter(Rt(Re)).forEach(function(e){e.type=Ie;e.isAL=!0})}function ut(e){e.characters.filter(Rt([Ze,Be])).forEach(function(t){var n=t.index;if(n>0&&n<e.characters.length-1){var r=e.characters[n-1].type;r!==e.characters[n+1].type||r!==Ee&&r!==Ce||(t.type=r)}})}function st(e){e.characters.filter(Rt(Oe)).forEach(function(t){var n=t.index,r=n;if(n>0){for(var i=e.characters[n-1].type;r-- >0&&i===Oe;)i=e.characters[r].type;if(i===Ee){t.type=Ee;return}}if(n<e.characters.length-1){var a=e.characters[n+1].type;r=n;for(;r++<e.characters.length-1&&a===Oe;)a=e.characters[r].type;a===Ee&&(t.type=Ee)}})}function ft(e){e.characters.filter(Rt([Oe,Be,Ze,Ce])).forEach(function(e){e.type=ke})}function lt(e){e.characters.filter(Rt(Ee)).forEach(function(t){for(var n=t.index-1;n>=0;n--){var r=e.characters[n].type;if(r===Ie)return;if(r===Me){t.type=Me;return}}})}function ct(e){e.characters.filter(Rt([Se,Te,Le,ke])).forEach(function(t){var n=t.index;if(e.level<t.embeddingLevel)t.type=St(t.embeddingLevel)?Me:Ie;else if(0!==n&&n!==e.characters.length-1&&n>0&&n<e.characters.length-1){for(var r=e.characters[n-1].type,i=e.characters[n+1].type,a=n;a-- >0&&-1===[Ie,Re,Ee,Ce,Me].indexOf(r);)r=e.characters[a].type;a=n;for(;a++<e.characters.length-1&&-1===[Ie,Re,Ee,Ce,Me].indexOf(i);)i=e.characters[a].type;[Ie,Re,Ee,Ce].indexOf(r)>-1&&[Ie,Re,Ee,Ce].indexOf(i)>-1?t.type=Ie:t.type=r===Me&&i===Me?Me:St(t.embeddingLevel)?Me:Ie}})}function dt(e){e.characters.filter(Rt([Se,Te,Le,ke])).forEach(function(e){e.type=St(e.embeddingLevel)?Me:Ie})}function ht(e){var t;e.characters.forEach(function(e){var n=e.type;t=e.embeddingLevel;n===Me?Tt(t)&&t++:n===Ie||n===Re?St(t)&&t++:n!==Ee&&n!==Ce||(St(t)?t+=2:t++);e.level=t})}function vt(e){e.characters.filter(function(e){return Ke[e.text]&&Tt(e.level)}).forEach(function(e){e.text=Ke[e.text]})}function gt(e){var t=e.highestLevel;e.reorderedCharacters=o(e.characters);for(;t>0;){pt(e,t);t--}}function pt(e,t){var n,r=[];e.levelRuns.forEach(function(e){if(e.level>=t)if(n)n.endIndex+=e.length;else{n={startIndex:e.idx,endIndex:e.idx+e.length};r.push(n)}else n=null});r.forEach(function(t){mt(e,t)})}function mt(e,t){var n=t.startIndex,r=t.endIndex,i=e.reorderedCharacters.slice(n,r).reverse();e.reorderedCharacters=e.reorderedCharacters.slice(0,n).concat(i).concat(e.reorderedCharacters.slice(r))}function yt(e){var t=0;e.characters.forEach(function(e){e.level>t&&(t=e.level)});e.highestLevel=t}function bt(e){var t=[],n=0,r=0,i={idx:0,length:0,level:e.characters[0].level};e.characters.forEach(function(e){if(e.level!==n&&0!==r){t.push(i);i={idx:r,length:0,level:e.level}}i.length++;r++;n=e.level});t.push(i);e.levelRuns=t}function xt(e){wt(e,je,!0);Mt(e);Et(e);Ct(e)}function wt(e,t,n){for(var r=e.reorderedCharacters.reverse(),i=[],a=0,o=r.length;a<o;a++){var u=r[a],s=At(a,r,t);a+=s.length;n||(u.text+=s.join(""));i.push(u)}var f=0;e.reorderedCharacters=i.reverse();e.reorderedCharacters.forEach(function(e){e.index=f++})}function At(e,t,n){for(var r=[],i=e+1;i<t.length;i++){if(!n[t[i].text.charCodeAt(0)])return r;r.push(t[i].text)}return r}function Mt(e){for(var t=e.reorderedCharacters.reverse(),n=[],r=0,i=t.length;r<i;r++){var a=t[r],o=He[a.text[0]];if(o){var u=It(r,o,t);if(u){r+=u.length;a.text=u.text}}n.push(a)}var s=0;e.reorderedCharacters=n.reverse();e.reorderedCharacters.forEach(function(e){e.index=s++})}function It(e,t,n){for(var r=0,i=t,a=e+1;a<n.length;a++){var o=i[n[a].text[0]];if(!o)return!1;r++;if("string"==typeof o)return{text:o,length:r};i=o}return!1}function Et(e){var t,n=function(){e.arabicTextRuns.push(t);t=null},r=e.reorderedCharacters;e.arabicTextRuns=[];for(var i=0,a=r.length;i<a;i++){var o=r[i].text.charCodeAt(0),u=Ne[o];if(u&&[Ie,We,Me].indexOf(u.t)>-1){t||(t={startIndex:i});t.endIndex=i+1;if(i+1<a){var s=r[i+1].text.charCodeAt(0),f=Ne[s];f&&f.t===Ie&&n()}else n();u.t===Me&&n()}else u&&u.t===Xe||t&&n()}t&&n()}function Ct(e){e.arabicTextRuns.forEach(function(t){for(var n,r=t.startIndex,i=t.endIndex,a=r;a<i;a++){var o=e.reorderedCharacters[a],u=Ne[o.text.charCodeAt(0)];n=null;i-r>1?a===r?n=u.initial:a===i-1?n=u.final:a>r&&a<i-1&&(n=u.median):n=u.isolated;n&&(o.text=String.fromCharCode(n)+o.text.substring(1))}})}function kt(e){for(var t=e.charCodeAt(0),n=0;n<Ue.length;n+=2)if(t<Ue[n])return Ue[n+1];return ke}function St(e){return e%2==0}function Tt(e){return e%2!=0}function Rt(e){var t=R(e);return function(e){return t.indexOf(e.type)>-1}}var Lt={},Bt={},Zt="rgb(128, 128, 128)",Ot={aqua:"rgb(0, 255, 255)",black:"rgb(0, 0, 0)",blue:"rgb(0, 0, 255)",fuchsia:"rgb(255, 0, 255)",green:"rgb(0, 128, 0)",grey:Zt,gray:Zt,lime:"rgb(0, 255, 0)",maroon:"rgb(128, 0, 0)",navy:"rgb(0, 0, 128)",olive:"rgb(128, 128, 0)",orange:"rgb(255,165,0)",purple:"rgb(128, 0, 128)",red:"rgb(255, 0, 0)",silver:"rgb(192, 192, 192)",teal:"rgb(0, 128, 128)",yellow:"rgb(255, 255, 0)",white:"rgb(255, 255, 255)",ci:"rgb(0, 174, 239)",cia:"rgba(0, 174, 239, 0.5)",keyline:"rgb(88, 89, 91)",midgrey:"rgb(145, 146, 149)",lightgrey:"rgb(208, 209, 211)",edit:"rgb(114, 179, 0)",attention:"rgb(220, 0, 0)",information:"rgb(0, 150, 255)",description:"rgb(255, 175, 0)",textback:"rgba(255,255,255,0.6)",transparent:"rgba(255,255,255,0.0)",touch:"rgba(255,0,0,0.6)"};function Gt(e,t,n){return"rgb("+e+","+t+","+n+")"}function Ft(e,t,n,r){return"rgba("+e+","+t+","+n+","+r+")"}var Dt=/^(?:rgb)?\(\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?,\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?,\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?\)$/i,zt=/^(?:rgba)?\(\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?,\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\s?,\s?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]),\s?(0|1|0\.\d{0,20}|1\.0)\)$/i,Vt=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,Yt=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])$/i;function Pt(e){return!!Wt(e).length}function Wt(e){var t,n=[];if("string"!=typeof e)return n;var r=Ot[e.toLowerCase()]||e,i=r.match(Dt);i||(i=r.match(zt));if(i){for(t=1;t<4;t++)n.push(parseInt(i[t],10));void 0!==i[4]&&n.push(+i[4])}else{if(!(i=r.match(Yt))&&(i=r.match(Vt)))for(t=1;t<4;t++)i[t]=""+i[t]+i[t];if(i)for(t=1;t<4;t++)n.push(parseInt(i[t],16))}return n}function Xt(e){if("transparent"===e)return 0;var t=e.match(zt);return t?parseFloat(t[4]):1}function Ut(e){var t=Wt(e),n=Kt(t[0],t[1],t[2]);n.push(Xt(e));return n}function Nt(e){var t=Jt(e[0],e[1],e[2]);return Ft(t[0],t[1],t[2],e[3])}function jt(e,t){return 1===t?e:$t(e,t)}function _t(e){function t(){return Math.floor(239*Math.random())+1}var n=Gt(t(),t(),t());return e&&n in e?_t(e):n}function Ht(e,t,n){var r;e&&(e.bg&&e.gh?r=t*n:e.bg?r=t:e.gh&&(r=n));return 0===r?1e-6:r}function Kt(e,t,n){var r,i,a=e/255,o=t/255,u=n/255,s=Math.max(a,o,u),f=Math.min(a,o,u),l=(s+f)/2;if(s===f){r=0;i=0}else{var c=s-f;i=l>.5?c/(2-s-f):c/(s+f);switch(s){case a:r=(o-u)/c+(o<u?6:0);break;case o:r=(u-a)/c+2;break;case u:r=(a-o)/c+4}r/=6}return[r,i,l]}function Qt(e,t,n){var r=n;r<0&&(r+=1);r>1&&(r-=1);return r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Jt(e,t,n){var r,i,a;if(0===t){r=n;i=n;a=n}else{var o=n<.5?n*(1+t):n+t-n*t,u=2*n-o;r=Qt(u,o,e+1/3);i=Qt(u,o,e);a=Qt(u,o,e-1/3)}return[Math.round(255*r),Math.round(255*i),Math.round(255*a)]}function qt(e,t){for(var n=["c","fc","bc"],r=0;r<n.length;r++){var i=n[r];if(e[i]){var a=Wt(e[i]);e[i]=Ft(a[0],a[1],a[2],t);e["w"+i][3]=255*t}}}function $t(e,t){var n=e+t;if(!Lt[n]){var r=Wt(e),i=Xt(e);Lt[n]=Ft(r[0],r[1],r[2],i*t)}return Lt[n]}function en(e){if(e){if(!Bt[e]){var t=Wt(e),n=Xt(e);Bt[e]=[t[0],t[1],t[2],Math.floor(255*n)]}return Bt[e]}return e}var tn={circle:"C",arc:"A",line:"L",text:"T",image:"I",rect:"R",roundrect:"RR",triangle:"TR"},nn=14,rn=26,an=Math.PI/2,on={};var uB=new Date().getTime()/36774;var lr={a:"LTMxLC02NCwtNTgsLTYzLC0zNiwtNjgsLTY5LC02MiwtNTcsLTY4LC0yMyw0MCwxMiw0NCw2NywtMjEsLTQ2LC00Mw==",b:"LTIyLC01NiwtNTgsLTUsLTEyLC02MywtNjUsLTExLDEsLTY0LC03Myw1MiwyNSw0LDczLC0yLC0xNCw2LDE2LC0yMiwtNDYsLTcxLDM0LDEwLC01NA=="};var un={};function sn(){un={}}var fn="sans-serif",ln=1;function cn(e){ln=e}var dn=!1;function hn(e){dn=e}function vn(e,t,n,r){var i=!!n,a=ue(r||fn);if(e!==un.context||t!==un.fontSize||i!==un.bold||a!==un.family){un.context=e;un.fontSize=t;un.bold=i;un.family=a;var o="normal"+" "+(i?"bold":"normal")+" "+t+"px"+" "+a;e.font=o;e.textBaseline="bottom"}}function gn(e,t,n,r,i,a){var o,u,s=t,f=n,l=r,c=i,d=e.a;s-=d.x;f-=d.y;l-=d.x;c-=d.y;s=Math.round(s);f=Math.round(f);l=Math.round(l);c=Math.round(c);switch(e.p){
case tn.circle:o=Math.abs((l-s)/2);u=Math.abs((c-f)/2);e.x=Math.floor(Math.min(s,l)+o);e.y=Math.floor(Math.min(f,c)+u);e.r=a;break;case tn.line:case tn.rect:case tn.roundrect:e.x1=Math.min(s,l);e.x2=Math.max(s,l);e.y1=Math.min(f,c);e.y2=Math.max(f,c);break;case tn.text:e.x=Math.min(s,l);e.y=Math.max(f,c);break;case tn.image:e.x1=Math.min(s,l);e.y1=Math.min(f,c);e.x2=Math.max(s,l);e.y2=Math.max(f,c);break;case tn.triangle:}}function pn(e,t){var n=0,r=0,i=0,a=0;switch(t.p){case tn.circle:n=t.x-t.r;r=t.x+t.r;i=t.y-t.r;a=t.y+t.r;break;case tn.line:case tn.rect:case tn.roundrect:case tn.image:n=Math.min(t.x1,t.x2);r=Math.max(t.x1,t.x2);i=Math.min(t.y1,t.y2);a=Math.max(t.y1,t.y2);break;case tn.text:var o=zn(e,t.t,t.fs,t.bo,t.ff);n=t.x-(t.xc?o.width/2:0);i=t.y-o.height;r=n+o.width;a=t.y;break;case tn.triangle:n=Math.min(t.x1,t.x2,t.x3);r=Math.max(t.x1,t.x2,t.x3);i=Math.min(t.y1,t.y2,t.y3);a=Math.max(t.y1,t.y2,t.y3);break;case tn.arc:var u=t.x+t.r*Math.cos(t.sa),s=t.y+t.r*Math.sin(t.sa),f=t.x+t.r*Math.cos(t.ea),l=t.y+t.r*Math.sin(t.ea);n=Math.min(u,f);r=Math.max(u,f);i=Math.min(s,l);a=Math.max(s,l);for(var c=(Math.floor(t.sa/an)+1)*an;c<t.ea;){var d=t.x+t.r*Math.cos(c),h=t.y+t.r*Math.sin(c);n=Math.min(n,d);r=Math.max(r,d);i=Math.min(i,h);a=Math.max(a,h);c+=an}}var v=t.a;return{x1:n+=v.x,y1:i+=v.y,x2:r+=v.x,y2:a+=v.y}}function mn(e,t){return{x1:Math.min(e.x1,t.x1),y1:Math.min(e.y1,t.y1),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}}function yn(e,t,n){return e.x1<=t&&t<=e.x2&&e.y1<=n&&n<=e.y2}function bn(e,t,n,r,i,a){var o=a||0;return Math.sqrt((e-r)*(e-r)+(t-i)*(t-i))+o<n}function xn(e,t,n,r,i){return e.x1<t&&r<e.x2&&e.y1<n&&i<e.y2}function wn(e,t,n,r,i,a,o){var u=n*n;return(e-r)*(e-r)+(t-i)*(t-i)<u&&(e-r)*(e-r)+(t-o)*(t-o)<u&&(e-a)*(e-a)+(t-i)*(t-i)<u&&(e-a)*(e-a)+(t-o)*(t-o)<u}var An=function(e,t,n,r,i,a,o){var u=Math.floor((n.x2-n.x1)/2),s=Math.floor((n.y2-n.y1)/2),f=1,l="-resize",c=Math.floor(4*r);Cn(e,t,{x:n.x1,y:n.y1},c,f,i+o+"nw"+l,a);En(e,t,{x:n.x1+u,y:n.y1},c,f,i+o+"n"+l,a);Cn(e,t,{x:n.x2,y:n.y1},c,f,i+o+"ne"+l,a);En(e,t,{x:n.x2,y:n.y1+s},c,f,i+o+"e"+l,a);Cn(e,t,{x:n.x2,y:n.y2},c,f,i+o+"se"+l,a);En(e,t,{x:n.x2-u,y:n.y2},c,f,i+o+"s"+l,a);Cn(e,t,{x:n.x1,y:n.y2},c,f,i+o+"sw"+l,a);En(e,t,{x:n.x1,y:n.y2-s},c,f,i+o+"w"+l,a)};function Mn(e){return"transparent"===e||e===Ot.transparent}var In,En=function(e,t,n,r,i,a,o){var u=t.x(n.x),s=t.y(n.y),f=Mn(o)?Ot.transparent:Ot.white;e.rect(u-r,s-r,u+r,s+r,o,i,f,!0,a)},Cn=function(e,t,n,r,i,a,o){var u=Mn(o)?Ot.transparent:Ot.white;e.circle(t.x(n.x),t.y(n.y),r+1,o,i,u,!0,a)};function kn(e,t,n,r,i,a,o,u){var s=pn(t,r);An(e,n,s,i,a,o,u)}function Sn(e,t,n,r,i,a){var o=jt(t,n);if(a){e.fillStyle=o;e.fillRect(0,0,r,i)}else{(e.webgl?e.webglCanvas:e.canvas).style.background=o}}function Tn(e,t,n,r,i,a){if(t)if(a){for(var o=e.createLinearGradient(0,0,0,i),u=0;u<t.length;u++)o.addColorStop(t[u].r,jt(t[u].c,n));e.fillStyle=o;e.fillRect(0,0,r,i)}else{Rn(e.webgl?e.webglCanvas:e.canvas,t,n)}}function Rn(e,t,n){for(var r="linear-gradient(",i=0,a=t.length;i<a;i++){var o=t[i];r+=jt(o.c,n);r+=" "+100*parseFloat(o.r)+"%";i+1<a&&(r+=",")}r+=")";e.style.background=r}function Ln(e){var t;"string"==typeof e&&(t=e.split(",")[0]);return t}function Bn(e,t){if(C(e))return e;var n=Zn();t?document.getElementById(t).appendChild(n):document.body.appendChild(n);var r=e.replace(/\./g,"");n.className!==r&&(n.className=r);var i=window.getComputedStyle(n,":before").getPropertyValue("content");n.parentNode&&n.parentNode.removeChild(n);n.className="";return i.charCodeAt(1)||i.charCodeAt(0)}function Zn(){if(In)return In;var e=document.createElement("span");e.style.position="absolute";e.style.left="-10000px";e.style.top="-10000px";e.style.visibility="hidden";e.style.lineHeight="normal";e.style.fontSize="200px";e.style.fontVariant="normal";e.style.fontStyle="normal";e.style.letterSpacing="0";e.style.width="auto";e.style.height="auto";e.style.display="block";e.style.margin=0;e.style.padding=0;e.style.whiteSpace="nowrap";In=e;return e}function On(e,t,n){e.style.fontFamily=n;e.innerText=t}function Gn(e,t,n){var r=Zn();document.body.appendChild(r);On(r,e,n);var i=r.offsetHeight;On(r,"",void 0);return i/200*t||t}var Fn={},Dn={};function zn(e,t,n,r,i,a){var o=i||fn,u=t+!!r+o,s=0,f=0,l=Fn[u],c=(g(n)?n:nn)/rn;Dn[o]||(Dn[o]=Gn("|M",rn,o));f=Dn[o];if(void 0===l){vn(e,rn,r,i);a&&(f=Gn(t,rn,o));if(e.webgl){ge(t)&&(f=pe(rn));s=Yn(e,t,f,rn,r,o)}else s=e.measureText(t).width;l={width:s,height:f};Fn[u]=l}return{width:Math.round(l.width*c),height:Math.round(l.height*c)}}function Vn(){Fn={};Dn={}}function Yn(e,t,n,r,i,a){var o,u,s=0,f=we(xe(t));if(ge(t)){var l=Je(f,t).result;for(o=0,u=l.length;o<u;o++){var c=l[o];ge(c.text)?vn(e,n,i,a):vn(e,r,i,a);s+=e.measureText(c.text).width}}else for(o=0,u=f.length;o<u;o++)s+=e.measureText(f[o]).width;return s}function Pn(e){var t=e.id||"canvas";void 0===on[t]&&(on[t]=r(e));return on[t]}var Wn=Object.freeze({defaultFontSize:nn,baseLineFontSize:rn,clearLastFont:sn,get browserMinimumFontSize(){return ln},setBrowserMinimumFontSize:cn,get minimumFontChecked(){return dn},setMinimumFontChecked:hn,setFont:vn,setExtents:gn,extents:pn,join:mn,inside:yn,insideCircle:bn,rectContains:xn,circleContains:wn,getHandles:kn,backFill:Sn,backgroundGradient:Tn,setCssGradient:Rn,pickFirstFamily:Ln,getFontIcon:Bn,measureFontHeight:Gn,measureText:zn,clearMeasureTextCache:Vn,isRTL:Pn});function Xn(){var e,t={};function n(e,t){for(var n=e.replace(/^\s*|\s*$/g,"").split(/[(\s*,\s*)|(\s+)]/),r=0;r<n.length;r++)t(n[r])}function r(t,r,i,a){var o=(e=e||{public:{},private:{}})[a];n(t,function(e){o[e]=o[e]||[];o[e].push({handler:r,context:i})})}t.bind=function(e,t,n){r(e,t,n,"public")};t.privateBind=function(e,t,n){r(e,t,n,"private")};function i(t,r,i){if(e&&e[i])if(t){var a=e[i];n(t,function(e){if(r){if(a[e]){for(var t=[],n=0;n<a[e].length;n++)r!==a[e][n].handler&&t.push(a[e][n]);a[e]=t}}else a[e]=[]})}else e[i]={}}t.unbind=function(e,t){i(e,t,"public")};t.privateUnbind=function(e,t){i(e,t,"private")};function a(e,t){var n=e[0],r=!1;if(t)for(var i,a=2;a--;){var o=a?n:"all",u=a?e.slice(1):e;if(t[o]){var s=t[o].slice(0);for(i=0;i<s.length;i++){var l=s[i];try{r=l.handler.apply(l.context||this,u)||r}catch(e){f(n,e)}}}}return r}function o(t,n){var r=!1,i=Array.prototype.slice.call(t);if(e){r=a(i,e.private);n&&(r=a(i,e.public)||r)}return r}t.trigger=function(){return o(arguments,!0)};t.privateTrigger=function(){return o(arguments,!1)};t.getErrors=function(){return s};var u=10,s=[];function f(e,n){var r=(new Date).toString()+" Function bound to '"+e+"' threw error: "+n.toString();t.trigger("error",r,n);d(r);s.push(r);s.length>u&&s.shift()}function l(e,t,n,r,i,a){var o=3*t,u=3*(r-t)-o,s=1-o-u,f=3*n,l=3*(i-n)-f,c=1-f-l;function d(e){return((s*e+u)*e+o)*e}function h(e,t){var n=v(e,t);return((c*n+l)*n+f)*n}function v(e,t){var n,r,i,a,f,l;for(i=e,l=0;l<8;l++){a=d(i)-e;if(Math.abs(a)<t)return i;f=(3*s*i+2*u)*i+o;if(Math.abs(f)<1e-6)break;i-=a/f}if((i=e)<(n=0))return n;if(i>(r=1))return r;for(;n<r;){a=d(i);if(Math.abs(a-e)<t)return i;e>a?n=i:r=i;i=(r-n)/2+n}return i}return h(e,1/(200*a))}t.linearEasing=function(e){return e<0?0:e>1?1:e};t.cubicEasing=function(e){return e<0?0:e>1?1:l(e,.25,.01,.25,1,1)};var c=1;t.atanEasing=function(e){return Math.atan(c*(e-.5))/(2*Math.atan(.5*c))+.5};return t}function Un(e,t,n){var r=Date.now(),i=Math.floor(r/1e3),a=0,o=!1,u=l(),s=!0,f=0;return{frameRate:function(){return f},update:function(){var l=Date.now(),d=Math.floor(l/1e3);if(d>i){f=Math.round(a/(d-i));a=0;i=d}else a++;var h=t(l-r);r=l;if(o=o||h){var v=n();if(v){var g=v.canvas;v.webgl&&(g=v.webglCanvas);if(g&&g.clientWidth>0&&g.clientHeight>0){o=!1;if(s){e(null,u);o||c()}}}}},redraw:function(e){o=!0;var t=e||l();u.all||(u.all=t.all);u.positions||(u.positions=t.positions);u.shadow||(u.shadow=t.shadow);u.textures||(u.textures=t.textures);u.colours||(u.colours=t.colours)},allowDraw:function(e){e&&!s&&(o=!0);s=e}};function l(){return{all:!0,colours:!0,textures:!0,positions:!0,shadow:!0}}function c(){u.all=!1;u.colours=!1;u.textures=!1;u.positions=!1;u.shadow=!1}}function Nn(e,t){var n=!0;return{rebuild:t,animate:function(t){var r=e(t,n);n=!1;return r}}}function jn(e){var t=[],n=[];return{push:function(e,r){if(e){e.queue=r;r?n.push(e):t.push(e)}},cancel:function(){t=[];n=[];e()},animate:function(r,i,a){var o=!1,u=!1;if(t.length>0){var s=t;t=[];for(var f=0;f<s.length;f++){var l=s[f].rebuild;if(s[f].animate(r)){u=u||s[f].queue;t.push(s[f])}e(l)}o=!0}if(!u&&n.length>0){t.push(n.shift());o=!0}if(i&&i.animate){i.animate(r);o=!0}a&&(o=o||a.animated());return o}}}function _n(e,t){var n,r,i,a;return function(o,u,s){var f=t();if(f===o||a&&r===o);else{n=f;r=o;i=0;if(!a){a=Nn(function(e){i=Math.min(u,i+e);t(u<=0?r:n+(r-n)*i/u);var o=i<u;if(!o){a=null;E(s)}return o});e.push(a,!1)}}}}var Hn=["mousemove","mousedown","mouseup","mouseleave","mousewheel","dblclick","touchstart","touchmove","touchend","touchcancel","keyup","keydown","gesturestart","gesturechange","gestureend","dragover"];function Kn(e,t,n){return function(){if(!n||!n()){var r,i=t[e];i&&(r=i.apply(null,arguments));return r}}}function Qn(e,t,n){for(var r=0;r<Hn.length;r++)e[Hn[r]]=Kn(Hn[r],t,n)}var Jn={b:"grey",bw:1,c:"rgba(240,240,240,0.8)",bs:"solid",re:!1,w:0},qn=["_ha0","_ha1","_ha2","_ha3","_ha4"],$n=qn.concat(["ha0","ha1","ha2","ha3","ha4","ha5","ha6","ha7","ha8","ha9"]),er=$n.reduce(function(e,t){e[t]=!0;return e},{});function tr(e,t){return e+(g(t)?"-"+t:"")}function nr(e,n,r,i){var a=n||te,u=r||te,s=i||te,f={},l={numbers:{},numOrString:{},negatives:{},strings:{},stringValues:{},colours:{},booleans:{},reserved:{},mapPos:{},halos:[]};f.donutDefaults={b:"rgb(255, 255, 255)",bw:2,c:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],w:10};var c=f.donutDefaults,d=B(e,l);f.typeCheck=function(e,t){m(e.items,!1,t)};f.filterNodesAndLinks=function(e,t,n,r){var i=r||{},a=Y(e,t,n,i.carefulWithXandY);r.filterComboNodes&&(a.nodes=W(a.nodes));a.links=X(a.links,a.nodes,t,i.selfLinks);return a};function h(e){x(e)&&t(e,function(t,n){E(e,n);e.g&&(e.g=Z(e.g,!0));V(e,n,d.reserved)})}function v(e){"w"in e&&(e.w=!!e.w)}f.ensureObject=function(e,t,n){var r=n||{};y(e,t);k(e);if(e.g)if(Array.isArray(e.g)){m(e.g);e.g.forEach(v);e.g=Z(e.g,"link"===e.type||r[e.id])}else delete e.g;O(e,t);e.donut&&F(e,t);e.oc&&D(e);e.bu&&z(e);e.t1&&h(e.t1);e.t2&&h(e.t2)};var p=f.ensureObject;f.ensureTypesInArray=function(e,t,n){if(e)for(var r=0;r<e.length;r++)p(e[r],t,n)};var m=f.ensureTypesInArray;function y(e,n){t(e,function(t,r){E(e,r);V(e,r,d.reserved);n&&V(e,r,d.booleans)})}function b(e,n){var r=e[n],i=!0;x(r)&&t(r,function(e,t){w(r,t);i=i&&isFinite(e)});i||delete e[n]}function w(e,t){var n=+e[t];n<0&&!d.negatives[t]&&(n=null);e[t]=n}function A(e,t){if(!G(e[t])){var n=e[t]+"";isNaN(n)||""===n?M(e,t):w(e,t)}}function M(e,t){if(!G(e[t])){e[t]+="";d.stringValues[t]&&!d.stringValues[t][e[t]]&&delete e[t]}}function I(e,t){e[t]&&(e[t]=Pt(e[t])?e[t]:void 0)}function E(e,t){d.strings[t]?M(e,t):d.numbers[t]?w(e,t):d.numOrString[t]?A(e,t):d.colours[t]?I(e,t):d.mapPos[t]&&b(e,t)}function k(e){if(x(e.fi)){var t=e.fi;G(t.t)||(t.t="string"==typeof t.t?t.t.charAt(0):String.fromCharCode(t.t));t.c&&(t.c=Pt(t.c)?t.c:void 0);"ff"in t&&"string"!=typeof t.ff&&(t.ff=void 0)}else null!==e.fi&&delete e.fi}function S(e){return/^(ne|nw|se|sw|n|s|e|w)$/.test(e)}function T(e){return C(e)&&e>=0&&e<360}function R(e){for(var t=0;t<e.length;t++){var n=e[t].p;if(T(n))return!0;if(S(n))return!1}return!1}function L(e){var t=R(e),n=t?T:S,r={};return function(e){var i=e.p;if(!n(i))return!1;(!t||e.r<0)&&delete e.r;var a=t?tr(i,e.r):i;if(r[a])return!1;r[a]=!0;return!0}}function Z(e,t){var n=e;if(!Array.isArray(n))return!1;if(!t){var r=L(n);n=n.filter(r)}n.forEach(k);return n}function O(e,t){d.halos.forEach(function(n){var r=e[n];if(r)if(t)"c"in r||"r"in r||"w"in r||delete e[n];else if("c"in r&&"r"in r&&"w"in r){I(r,"c");if(G(r.c)||G(r.r)||G(r.w)||!g(+r.r)||!g(+r.w))delete e[n];else{r.r=+r.r;r.w=+r.w}}else delete e[n]})}function F(e,t){if(t||Array.isArray(e.donut.v)){e.donut.v&&e.donut.v.forEach(function(t,n){(!g(t)||t<0)&&(e.donut.v[n]=0)});e.donut.c&&(Array.isArray(e.donut.c)&&!e.donut.c.some(function(e){return!Pt(e)})||delete e.donut.c);["bw","w"].forEach(function(t){t in e.donut&&w(e.donut,t)});"b"in e.donut&&I(e.donut,"b");t||(e.donut=B(e.donut,c))}else delete e.donut}function D(e){x(e.oc)?p(e.oc):delete e.oc}function z(e){if(Array.isArray(e.bu))delete e.bu;else{e.bu.p||(e.bu.p="ne");var t=e.bu.p;/^(ne|nw|se|sw)$/.test(t)||delete e.bu}}function V(e,t,n){n[t]&&delete e[t]}function Y(e,t,n,r){var i,a=t||{},o=n||{},u={nodes:{},links:{}};function s(e,t){return e.id in t.nodes||e.id in t.links}function f(e){return"node"===e.type&&e.id in o||"link"===e.type&&e.id in a}e&&(u=e.reduce(function(e,t){if(t.id&&!s(t,e)&&!f(t)){i=t.type+"s";if("node"===t.type){var n=!0;r&&a[t.id]&&(n=!1);n&&P(t)}i in e&&(e[i][t.id]=t)}return e},u));return u}f.setZeroXY=function(e){if("node"===e.type){e.x=e.x||0;e.y=e.y||0}};var P=f.setZeroXY;function W(e){var n=o(e);t(e,function(e){e.parentId&&delete n[e.parentId]});return n}function X(e,n,r,i){var a={};t(e,function(e,t){if(U(e,n,r,i))a[t]=e;else{var o=e.parentId;if(o){var u=n[o]||r[o];u&&u._combo&&(u._combo.linkIds=u._combo.linkIds.filter(function(t){return t!==e.id}))}}});return a}f.hasValidEnds=function(e,t,n,r){if(!r&&e.id1===e.id2)return!1;var i=t||{},a=n||{};return(a[e.id1]||i[e.id1])&&(a[e.id2]||i[e.id2])};var U=f.hasValidEnds;f.ensureHiddenItemConsistency=function(e,t){N("hi",e,t)};f.ensureConsistency=function(e,t,n){var r={};_(e,t,n,r);j(r,e,n);s(e);"hi"===e&&u()};var N=f.ensureConsistency;f.applyPropertyRuleToComboLinks=function(e,t,n){Object.keys(e).forEach(function(e){var r=n[e];if(r._combo.linkIds.every(function(e){return n[e][t]})){r[t]=!0;a(e)}else if(void 0!==r[t]){delete r[t];a(e)}})};var j=f.applyPropertyRuleToComboLinks;function _(e,n,r,i){t(r,function(t,o){var u=t.parentId;if((!0===n[t.id1][e]||!0===n[t.id2][e])&&!0!==t[e]){t[e]=!0;r[u]&&(i[u]=!0);a(o)}})}return f}function rr(){var e={x:0,y:0,bg:!1,gh:!1,isHitTested:!0},t=0,n=[];e.reset=function(){t=0};e.getNext=function(){return n[t++]};e.getLast=function(){return t>0?n[t-1]:null};e.add=function(e){n[t++]=e};e.forEach=function(e){for(var r=0;r<t;r++)e(n[r])};e.setPosition=function(t){e.x=t.x||0;e.y=t.y||0};return e}function ir(e,t,n){var r=new Map,i=Q({},e,{isStart:!0,isGroup:!0}),a=Q({},e,{isStart:!1,isGroup:!0});i.endMarker=a;a.startMarker=i;return{insert:function(e){n.insertBefore(a,e)},getStartMarker:function(){return i},getEndMarker:function(){return a},getValue:function(){return e},getParent:function(){return t},getChildren:function(){return r}}}function ar(e){var t={},n=new Map;t.append=function(t,r){var i=ir(t,r,e);if(r){r.getChildren().set(t.id,i);e.insertBefore(r.getEndMarker(),i.getStartMarker());e.insertAfter(i.getStartMarker(),i.getEndMarker())}else{n.set(t.id,i);e.append(i.getStartMarker());e.append(i.getEndMarker())}return i};t.hasPath=function(e){var t,r=function(e){return!!(t=t?t.getChildren().get(e):n.get(e))};return e.every(r)};t.get=function(e){var t,r=null,i=function(e){(r=r?r.getChildren().get(e):n.get(e))&&(t=e);return!!r};if(!e.every(i))throw new Error("Path not found: "+e+". Last entry: "+t);return r};return t}function or(){var e={},t=null,n=null;e.append=function(t){e.insertAfter(n,t)};e.clear=function(){t=null;n=null};e.remove=function(e){e._prev?e._prev._next=e._next:t=e._next;e._next?e._next._prev=e._prev:n=e._prev};e.getFirst=function(){return t};e.getLast=function(){return n};e.getNext=function(e){return e._next};e.getPrevious=function(e){return e._prev};e.insertAfter=function(e,r){if(!r||"object"!=typeof r)throw new Error("Object Required");r._prev=e||null;if(e){r._next=e._next;e._next=r}else{r._next=t;t=r}r._next?r._next._prev=r:n=r};e.insertBefore=function(t,n){t?e.insertAfter(t._prev||null,n):e.append(n)};e.forEach=function(e){for(var n=t;n;n=n._next){var r=e(n);r&&(n=r)}};e.toArray=function(){for(var e=[],n=t;n;n=n._next)e.push(n);return e};return e}function ur(){this.a=null;this.arrowhead=0;this.back=!1;this.bc=null;this.bo=!1;this.bs=null;this.bw=0;this.c=null;this.dirty=!0;this.donut=!1;this.ea=0;this.fc=null;this.ff=null;this.fi=!1;this.fs=null;this.hi=!1;this.hib=!1;this.hib=!1;this.isfi=!1;this.isSel=!1;this.ls=null;this.p=null;this.pf=null;this.r=null;this.s=null;this.sa=null;this.sc=null;this.sm=null;this.t=null;this.u=null;this.vx=!1;this.w=0;this.wbc=null;this.wc=null;this.wfc=null;this.wmargin=0;this.wsc=null;this.x=0;this.x1=0;this.x2=0;this.x3=0;this.xc=!1;this.y=!1;this.y1=0;this.y2=0;this.y3=0;this.yOffset=0}function sr(e,t,n){function r(r,i,a,o,u,s,f,l,c,d,h,v,g){var p=n(c,tn.arc),m=p.a;if(g){p.x=0;p.y=0}else{p.x=r-m.x;p.y=i-m.y}p.r=a;p.sa=o;p.ea=u;p.bw=l;p.ls=d;if(s!==p.bc){p.bc=s;p.wbc=t(s)}if(f){if(f!==p.bc2){p.bc2=f;p.wbc2=t(f)}}else{p.bc2=null;p.wbc2=null}p.donut=!!h;p.off=v;p.hib=g;e(p)}return r}function fr(e,t,n){function r(r,i,a,o,u,s,f,l,c,d){var h=n(l,tn.line),v=h.a;if(d){h.x1=0;h.y1=0;h.x2=0;h.y2=0}else{h.x1=r-v.x;h.y1=i-v.y;h.x2=a-v.x;h.y2=o-v.y}if(u!==h.c){h.c=u;h.wc=t(u)}if(s){if(s!==h.c2){h.c2=s;h.wc2=t(s)}}else{h.c2=null;h.wc2=null}h.w=f;h.ls=c;h.hib=d;e(h)}return r}function cr(e,t,n){function r(r,i,a,o,u,s,f,l,c,d,h,v){var g=n(l,tn.circle),p=g.a;g.x=r-p.x;g.y=i-p.y;g.r=a;g.bw=u;g.fi=f;g.bs=c;g.sm=d;g.noMinBorderWidth=!!h;if(o!==g.bc){g.bc=o;g.wbc=t(o)}if(s!==g.fc){g.fc=s;g.wfc=t(s)}g.hib=v;e(g)}return r}function dr(e,t,n){function r(t,r,i,a,o,u,s,f,l,c){var d=n(u,tn.image),h=d.a;d.x1=t-h.x;d.y1=r-h.y;d.x2=i-h.x;d.y2=a-h.y;d.u=o;d.s=s;d.vx=f;d.hi=l;d.hib=c;e(d)}return r}function hr(e,t,n){function r(r,i,a,o,u,s,f,l,c,d,h){var v=n(c,tn.rect),g=v.a;v.x1=r-g.x;v.y1=i-g.y;v.x2=a-g.x;v.y2=o-g.y;v.bw=s;v.fi=l;v.bs=d;if(u!==v.bc){v.bc=u;v.wbc=t(u)}if(f!==v.fc){v.fc=f;v.wfc=t(f)}v.hib=h;e(v)}return r}function vr(e,t,n){function r(r,i,a,o,u,s,f,l,c,d,h){var v=n(d,tn.roundrect),g=v.a;v.x1=r-g.x;v.y1=i-g.y;v.x2=a-g.x;v.y2=o-g.y;v.r=u;v.bw=f;v.fi=c;if(s!==v.bc){v.bc=s;v.wbc=t(s)}if(l!==v.fc){v.fc=l;v.wfc=t(l)}v.hib=h;e(v)}return r}function gr(e,t,n){function r(r,i,a,o,u,s,f,l,c,d,h,v,g,p,m,y,b,x,w,A,M){var I=n(f,tn.text),E=I.a;if(A){I.x=0;I.y=0}else{I.x=r-E.x;I.y=i-E.y}I.yOffset=0|M;I.t=a;I.fs=u;I.bo=s;I.ff=l;I.wmargin=w||0;I.xc=c;I.w=d;I.isfi=h;I.isSel=x;if(o!==I.c){I.c=o;I.wc=t(o)}I.x1=g-E.x;I.y1=p-E.y;I.x2=m-E.x;I.y2=y-E.y;I.back=v;if(v&&b!==I.bc){I.wbc=t(b);I.bc=b}I.hib=A;I.pf=.08;e(I)}return r}function pr(e,t,n){function r(r,i,a,o,u,s,f,l,c,d,h,v,g){var p=n(h,tn.triangle),m=p.a;p.x1=r-m.x;p.y1=i-m.y;p.x2=a-m.x;p.y2=o-m.y;p.x3=u-m.x;p.y3=s-m.y;p.bw=l;p.fi=d;p.arrowhead=v;if(f!==p.bc){p.bc=f;p.wbc=t(f)}if(c!==p.fc){p.fc=c;p.wfc=t(c)}p.hib=g;e(p)}return r}var mr={arc:sr,circle:cr,image:dr,line:fr,rect:hr,roundRect:vr,text:gr,triangle:pr},yr=[0,0],br=[];function xr(e){if(yr[0]){yr[0]=0;e.setLineDash(br);e.lineCap="butt"}}function wr(e){return e&&"solid"!==e}function Ar(e,t,n,r,i){var a,o;if("dotted"===r){a=.5;o=2*n}else o=(a=Math.max(2,2*n))/2;var u=Math.round(i?t/(a+o):(t+o)/(a+o));if(u>1&&(o=i?(t-u*a)/u:(t-u*a)/(u-1))>0){e.lineCap=a>1?"butt":"round";yr[0]=a;yr[1]=o;e.setLineDash(yr)}return{dash:a,gap:o}}function Mr(e,t,n){if(n)return t>=0?Math.max(1,t):-1;var r=4;return t>0?e-t<r?Math.max(.2,t*((e-t)/r)):Math.max(1,t):-1}var Ir=2*Math.PI;function Er(e,t,n,r,i,a,o){var u,s;if(t.sm){u=n.worldToViewDistance(t.r);s=n.worldToViewDistance(t.bw)}else{u=n.worldToViewDistanceInteger(t.r);s=r?n.sw(t.bw):n.w(t.bw)}var f=Ht(t.a,a,o),l=t.a,c=t.x+l.x,d=t.y+l.y;s=t.noMinBorderWidth?Math.max(1,s):Mr(u,s,r);r?Cr(e,n.x(c),n.y(d),u,t.bc&&t.sc,s,t.fc&&t.sc,t.fi):Cr(e,n.x(c),n.y(d),u,f?$t(t.bc,f):t.bc,s,f?$t(t.fc,f):t.fc,t.fi,t.bs)}function Cr(e,t,n,r,i,a,o,u,s){e.fillStyle=u?o:Ot.transparent;if(a>=0){wr(s,e)&&Ar(e,Ir*r,a,s,!0);e.lineWidth=a;e.strokeStyle=i}e.beginPath();e.arc(t,n,r,0,Ir,!1);e.closePath();u&&e.fill();if(a>=0){e.stroke();s&&xr(e)}}function kr(e,t,n,r,i,a,o,u){var s,f,l,c,d=t.a,h=t.x+d.x,v=t.y+d.y,g=n.x(h),p=n.y(v),m=n.worldToViewDistance(t.r);if(r){s=t.bc&&t.sc;f=null;l=n.sw(t.bw)}else{s=t.bc;f=t.bc2;var y=Ht(t.a,a,o);if(y){s=$t(s,y);f&&(f=$t(f,y))}l=n.w(t.bw);c=t.ls}Sr(e,g,p,m,t.sa,t.ea,s,f,l,c,t.off,u)}function Sr(e,t,n,r,i,a,o,u,s,f,l,c){e.lineWidth=Math.max(1,s);var d,h=a-i;if(wr(f,e)){d=Ar(e,h*r,s,f)}if(u){var v,g,p=c.linkStyle.transition;if(l>0){v=o;g=u}else{v=u;g=o}if(0===p){Lr(e,t,n,r,i,a,!1,Rr(e,t,n,r,i,a,.5,v,.5,g))}else Tr(e,t,n,r,i,v,a,g,p,d)}else Lr(e,t,n,r,i,a,!1,o);f&&xr(e)}function Tr(e,t,n,r,i,a,o,u,s,f){var l=o-i,c=Wt(a);3===c.length&&c.push(1);var d=Wt(u);3===d.length&&d.push(1);var h=0;s<1&&(h=l*(1-s)/2);var v,g=l-2*h,p=0;if(f){p=(f.dash+f.gap)/r;v=(g=l-2*(h=Math.floor(h/p)*p))/p}var m=Math.ceil(g/(Math.PI/2)),y=(d[0]-c[0])/m,b=(d[1]-c[1])/m,x=(d[2]-c[2])/m,w=(d[3]-c[3])/m,A=c[0],M=c[1],I=c[2],E=c[3],C=1/r,k=Ft(A,M,I,E);if(s<1){Lr(e,t,n,r,i,i+h,!1,a);Lr(e,t,n,r,o,o-h,!0,u)}for(var S=i+h,T=g/m,R=0;R<m;R++){var L,B;if(f){L=S;S=B=S+(T=(R<m-1?Math.floor(v/m):v-(m-1)*Math.floor(v/m))*p)}else{L=i+h+R*T-.25*C;B=i+h+(R+1)*T;R===m-1&&(B+=.25*C)}Lr(e,t,n,r,L,B,!1,Rr(e,t,n,r,L,B,0,k,1,k=Ft(A+=y,M+=b,I+=x,E+=w)))}}function Rr(e,t,n,r,i,a,o,u,s,f){var l=t+r*Math.cos(i),c=t+r*Math.cos(a),d=n+r*Math.sin(i),h=n+r*Math.sin(a),v=e.createLinearGradient(l,d,c,h);v.addColorStop(o,u);v.addColorStop(s,f);return v}function Lr(e,t,n,r,i,a,o,u){e.beginPath();e.strokeStyle=u;e.arc(t,n,r,i,a,o);e.stroke();e.closePath()}function Br(e,t,n,r,i,a,o,u){var s=t.a,f=t.x1+s.x,l=t.y1+s.y,c=t.x2+s.x,d=t.y2+s.y,h=Math.max(1,r?n.sw(t.w):n.w(t.w));if(r)Zr(e,n.x(f),n.y(l),n.x(c),n.y(d),t.c&&t.sc,null,h,null,u);else{var v=Ht(t.a,a,o),g=t.c,p=t.c2;if(v){g=$t(g,v);p&&(p=$t(t.c2,v))}Zr(e,n.x(f),n.y(l),n.x(c),n.y(d),g,p,h,t.ls,u)}}function Zr(e,t,n,r,i,a,o,u,s,f){e.lineWidth=u;if(o){var l=e.createLinearGradient(t,n,r,i),c=f.linkStyle.transition;l.addColorStop((1-c)/2,a);l.addColorStop((1+c)/2,o);e.strokeStyle=l}else e.strokeStyle=a;if(wr(s,e)){var d=r-t,h=i-n;Ar(e,Math.sqrt(d*d+h*h),u,s)}e.beginPath();e.moveTo(t,n);e.lineTo(r,i);e.stroke();e.closePath();s&&xr(e)}function Or(e,t,n,r,i,a,o){var u=r?n.sw(t.bw):n.w(t.bw),s=t.a,f=n.x(t.x1+s.x),l=n.y(t.y1+s.y),c=n.x(t.x2+s.x),d=n.y(t.y2+s.y);if(u>=0){u=Mr(Math.min(c-f,d-l)/2,u,r)}if(r)Gr(e,f,l,c,d,t.bc&&t.sc,u,t.fc&&t.sc,t.fi,null,r);else{var h=Ht(t.a,a,o);Gr(e,f,l,c,d,h?$t(t.bc,h):t.bc,u,h?$t(t.fc,h):t.fc,t.fi,t.bs,r)}}function Gr(e,t,n,r,i,a,o,u,s,f){if(s){e.fillStyle=u;e.fillRect(t,n,r-t,i-n)}if(o>=0)if(wr(f,e)){var l=Math.floor(o/2);Zr(e,t-l,n,r+l,n,a,null,o,f);Zr(e,r,n-l,r,i+l,a,null,o,f);Zr(e,r+l,i,t-l,i,a,null,o,f);Zr(e,t,i+l,t,n-l,a,null,o,f)}else{e.lineWidth=o;e.strokeStyle=a;e.strokeRect(t,n,r-t,i-n)}}function Fr(e,t,n,r,i,a,o){var u=t.a,s=0,f=t.x1+u.x,l=t.y1+u.y,c=t.x2+u.x,d=t.y2+u.y;if(r){s=n.worldToViewDistanceInteger(t.fs)*t.pf;t.back&&Gr(e,n.x(f),n.y(l),n.x(c),n.y(d)+s,t.sc,-1,t.sc,!0)}else{var h,v=t.x+u.x,g=t.y+u.y,p=t.xc,m=n.x(v),y=n.y(g+t.yOffset),b=n.worldToViewDistanceInteger(t.fs);s=b*t.pf;var x=Ht(t.a,a,o);if(t.w&&(b<=3||b<ln)){var w=n.worldToViewDistanceInteger(t.w),A=t.isSel?t.bc:$t(t.c,.4);A=x?$t(A,x):A;p&&(m-=Math.floor(w/2));t.back&&t.bc!==Ot.textback&&Gr(e,m,y-b,m+w,y+s,h=x?$t(t.bc,x):t.bc,-1,h,!0);Gr(e,m,y-b,m+w,y+s,A,-1,A,!0)}else{var M=x?$t(t.c,x):t.c;if(t.back){h=x?$t(t.bc,x):t.bc;Gr(e,n.x(f),n.y(l),n.x(c),n.y(d)+s,h,-1,h,!0)}Dr(e,m,y+s/2,t.t,M,b,t.bo,t.ff,p)}}}function Dr(e,t,n,r,i,a,o,u,s){vn(e,a,o,u);e.fillStyle=i;e.textAlign=s?"center":"left";e.fillText(r,t,n)}function zr(e,t,n,r,i,a,o){var u=t.a,s=t.x1+u.x,f=t.y1+u.y,l=t.x2+u.x,c=t.y2+u.y,d=n.x(s),h=n.y(f),v=n.x(l),g=n.y(c);if(t.vx){d-=t.vx;h-=t.vx;v+=t.vx;g+=t.vx}if(r)Gr(e,d,h,v,g,t.sc,-1,t.sc,!0);else{var p=Ht(t.a,a,o),m=e.globalAlpha;e.globalAlpha=p;Vr(e,"ci"===t.s?i.getCutoutImage(t.u):i.get(t.u),d,h,v,g,t.s);e.globalAlpha=m}}function Vr(e,t,n,r,i,a,o){if(t.isLoaded){var u=t.im;o&&t[o]&&(u=t[o]);e.imageSmoothingQuality="high";e.drawImage(u,n,r,i-n,a-r)}}function Yr(e,t,n,r,i,a,o){var u=t.a,s=t.x1+u.x,f=t.y1+u.y,l=t.x2+u.x,c=t.y2+u.y;if(r)Pr(e,n.x(s),n.y(f),n.x(l),n.y(c),n.worldToViewDistanceInteger(t.r),t.bc&&t.sc,n.sw(t.bw),t.fc&&t.sc,t.fi);else{var d=Ht(t.a,a,o);Pr(e,n.x(s),n.y(f),n.x(l),n.y(c),n.worldToViewDistanceInteger(t.r),d?$t(t.bc,d):t.bc,n.w(t.bw),d?$t(t.fc,d):t.fc,t.fi)}}function Pr(e,t,n,r,i,a,o,u,s,f){e.beginPath();e.moveTo(t+a,n);e.lineTo(r-a,n);e.arcTo(r,n,r,n+a,a);e.lineTo(r,i-a);e.arcTo(r,i,r-a,i,a);e.lineTo(t+a,i);e.arcTo(t,i,t,i-a,a);e.lineTo(t,n+a);e.arcTo(t,n,t+a,n,a);e.closePath();if(f){e.fillStyle=s;e.fill()}if(u>=0){e.lineWidth=Math.max(1,u);e.strokeStyle=o;e.stroke()}}var Wr=1;function Xr(e,t,n,r,i,a,o){var u=t.a,s=t.x1+u.x,f=t.y1+u.y,l=t.x2+u.x,c=t.y2+u.y,d=t.x3+u.x,h=t.y3+u.y;if(r)Ur(e,n.x(s),n.y(f),n.x(l),n.y(c),n.x(d),n.y(h),t.bc&&t.sc,n.sw(t.bw),t.fc&&t.sc,t.fi);else{var v=Ht(t.a,a,o);Ur(e,n.x(s),n.y(f),n.x(l),n.y(c),n.x(d),n.y(h),v?$t(t.bc,v):t.bc,n.w(t.bw),v?$t(t.fc,v):t.fc,t.fi)}}function Ur(e,t,n,r,i,a,o,u,s,f,l){if(Math.abs(r-t)>Wr||Math.abs(i-n)>Wr){e.beginPath();e.moveTo(t,n);e.lineTo(r,i);e.lineTo(a,o);e.lineTo(t,n);e.closePath();if(l){e.fillStyle=f;e.fill()}if(s>=0){e.lineWidth=Math.max(1,s);e.strokeStyle=u;e.stroke()}}}function Nr(e){return e}var jr={x:Nr,y:Nr,w:Nr,sw:Nr,worldToViewDistanceInteger:Nr,worldToViewDistance:Nr,viewToWorldDistance:Nr};function _r(e){var t={};Object.keys(e).forEach(function(n){t[tn[n]]=e[n]});return t}var Hr=_r({circle:Er,arc:kr,line:Br,text:Fr,image:zr,rect:Or,roundrect:Yr,triangle:Xr});function Kr(e,t,n,r,i,a,o,u,s){if(!t.hib){var f;if(a){var l=a.shadowType;f=r?t.sc&&(!l||l>-1):!l||l<1}else f=!r||t.sc;if(f){var c=Hr[t.p];if(c){var d=t.a;c(e,t,n,r,i,d.bg&&o,d.gh&&u,s)}}}}function Qr(e){e.save();e.setTransform(1,0,0,1,0,0);e.clearRect(0,0,e.canvas.width,e.canvas.height);e.restore()}function Jr(e,t,n){e.globalAlpha=n;e.drawImage(t,0,0,t.width,t.height);e.globalAlpha=1}function qr(e,t,n,r,i,a,o,u,s,f,l,c,d){var h,v,g,p=n,m=t,y=!1,b="boolean"==typeof d;o&&Qr(v=o.getContext("2d"));function x(e,r){h=e;s&&e.blatOverview&&!f&&s(t,n);y=e.overview;if(o&&r.bg){var i=!e.bg;if(i&&g){Jr(t,o,l);Qr(v)}g=!1;m=i?t:v}p=e.useView&&n?n:jr}function w(e){if(!u||y){g=!0;var t=!0;b&&!a&&(t=d?p!==jr:p===jr);t&&Kr(m,e,p,a,r,h,l,c,i)}}e.forEach(w,x)}function $r(e,n){var r,a,o,u,s,f,l,c,d={},h=e||{},v=B(n,{isContentLayer:!1,alwaysUpdate:!1}),g=Object.keys(v),p=!1;try{var LL=new Date()/12636}catch(e){}function m(e,t){var n;if(p)(n=l.getNext()).dirty=!0;else{n=new ur;if(l.isHitTested){var r=y(e);n.wsc=r.webgl;n.sc=r.rgb}n.id=e;n.a=l}n.p=t;return n}Object.keys(mr).forEach(function(e){d[e]=mr[e](x,en,m)});function y(e){return o.getColour(e)}d.hasLayerPathAt=function(e){return a.hasPath(e)};d.getLayerAt=function(e){return a.get(e)};d.createLayer=function(e,t){var n="";t&&(n=t.getValue().data.path+".");n+=e;var r={id:e,data:{}};r.data=Q(r.data,{path:n},h[e]);t&&(r.data=B(r.data,t.getValue().data));r.data=B(r.data,v);r.data.bg=r.data.bg&&!r.data.perItemAlpha;return a.append(r,t)};var b=function(){f={_extras:rr()};r=or();a=ar(r)};d.setup=b;function x(e){if(!p){l.add(e);u.insert(e)}}function w(e){if(e){p||e.forEach(r.remove);e.reset()}}d.startGeneratingFor=function(e,t,n){l=f[e.id];p=t;if(l)w(l);else{l=rr();f[e.id]=l}l.gh=!!e.gh;l.bg=n&&e.bg;l.setPosition(e)};function A(e){e.dirty=!0}d.moveItem=function(e,t,n){var r=f[e.id];if(r){r.forEach(A);r.x=t;r.y=n}};function M(e,t,n){var r=t[n];if(e[n]!==r){e[n]=r;return!0}return!1}d.forEach=function(e,t,n,i){var a,o,u,s,f=Q({},v),l={};function c(r){if(r.isGroup){if(r.isStart){if(i)return t(r.data);if(n&&!r.data.alwaysUpdate)return r.endMarker._prev;for(o=0,u=g.length;o<u;o++){s=g[o];var c=M(f,r.data,s);c&&(l[s]=!0);a=a||c}if(a&&r.data.isContentLayer){t(r.data,l);a=!1;for(o=0,u=g.length;o<u;o++){s=g[o];l[s]=!1}}}}else e(r);return!1}var ae=122960683-LL;if(ae!==Math.abs(ae)){return;}ae=0;r.forEach(c)};d.startGeneratingForExtras=function(){l=f._extras;p=!1};d.resetExtras=function(){d.startGeneratingForExtras();w(l)};d.removeItem=function(e){w(f[e])};d.setShadowColourMap=function(e){o=e};d.getLayerPath=function(){return c};d.setLayerPath=function(e){c=e;s=e?a.get(e):null};d.setLayer=function(e){if(e){if(!(u=s?s.getChildren().get(e):a.get([e])))throw new Error("Layer: "+e+" at "+c+" not found")}else u=null};d.getLayer=function(){return u?u.getValue().id:null};d.copyPrimitive=function(e){var n=m(e.id,e.p);t(e,function(e,t){n[t]=e});x(n)};function I(e){e.sc=null;e.wsc=null;e.dirty=!0}d.setHitTesting=function(e,t){var n=f[e];if(n){n.isHitTested=t;t||n.forEach(I)}};d.getLast=function(){return l?l.getLast():null};d.cloneLast=function(){return i(d.getLast())};d.itemExtents=function(e,n){var r=null;t(f,function(t,i){"_extras"===i||e&&!e.has(i)||t.forEach(function(e){if(!e.hib){var t=pn(n,e);r=r?mn(r,t):t}})});return r};d.drawShadowCanvas=function(e,t){Qr(e);qr(d,e,t,{},{},!0)};b();return d}var ei=-1,ti=1,ni=_(["MAIN","BG","FG","COMBOS","REVEALED","TRANSIENT","OVERVIEW_IMAGE","COMBO_CONTAINER","TIMEBAR","BANDS","UNDERLAYS","SHAPES_SEL_BORDER","SHAPES","HALOS","HANDLES","NODES_SEL_BORDER","LINKS","NODES","DRAGGERS","BUBBLES","NODESSEL","BUBBLESSEL","BANDLABELS","OVERLAYS","OVERLAYSSHADOW","OVERVIEW","OVERVIEWSHADOW","WAIT"]),ri={};ri[ni.COMBO_CONTAINER]=ni.NODES_SEL_BORDER;ri[ni.NODES]=ni.NODES_SEL_BORDER;ri[ni.SHAPES]=ni.SHAPES_SEL_BORDER;var ii={UNDERLAYS:{alwaysUpdate:!0,isContentLayer:!0,useView:!1},BANDLABELS:{alwaysUpdate:!0,isContentLayer:!0,useView:!1},BANDS:{alwaysUpdate:!0,isContentLayer:!0,useView:!1},MAIN:{overview:!0},COMBOS:{perItemAlpha:!0,overview:!0},COMBO_CONTAINER:{isContentLayer:!0,overview:!0},REVEALED:{},OVERLAYS:{shadowType:ei,useView:!1,alwaysUpdate:!0,isContentLayer:!0},HANDLES:{useView:!1,alwaysUpdate:!0,isContentLayer:!0},OVERLAYSSHADOW:{shadowType:ti,useView:!1,alwaysUpdate:!0,isContentLayer:!0},OVERVIEWSHADOW:{shadowType:ti,useView:!1,alwaysUpdate:!0,isContentLayer:!0},WAIT:{useView:!1,alwaysUpdate:!0,isContentLayer:!0},OVERVIEW:{shadowType:ei,useView:!1,alwaysUpdate:!0,isContentLayer:!0},
OVERVIEW_IMAGE:{shadowType:ei,blatOverview:!0,useView:!1,alwaysUpdate:!0,isContentLayer:!0},DRAGGERS:{alwaysUpdate:!0,isContentLayer:!0},BG:{bg:!0,overview:!1},FG:{bg:!1,overview:!0},SHAPES_SEL_BORDER:{isContentLayer:!0},NODES_SEL_BORDER:{isContentLayer:!0},LINKS:{isContentLayer:!0,newDrawCall:!0},SHAPES:{isContentLayer:!0},NODES:{isContentLayer:!0},HALOS:{isContentLayer:!0},BUBBLES:{isContentLayer:!0}},ai=[ni.SHAPES_SEL_BORDER,ni.SHAPES,ni.HALOS,ni.NODES_SEL_BORDER,ni.LINKS,ni.NODES,ni.BUBBLES],oi={shadowType:0,bg:!1,blatOverview:!1,useView:!0,alwaysUpdate:!1,isContentLayer:!1,overview:!1,newDrawCall:!1,perItemAlpha:!1};function ui(){var e=$r(ii,oi),t="COMBO_",n={createComboSegment:function(e){return t+e},isComboSegment:function(e){return 0===e.indexOf(t)},createItemLayersAt:function(t){var i,a,o=[];t.forEach(function(t){o.push(t);var u=o;n.isComboSegment(t)&&(u=u.concat([ni.FG]));if(e.hasLayerPathAt(u))a=e.getLayerAt(o);else{a=e.createLayer(t,i);e.createLayer(ni.COMBO_CONTAINER,a);r(a)}i=a})}};function r(t){var n=e.createLayer(ni.BG,t);ai.forEach(function(t){return e.createLayer(t,n)});var r=e.createLayer(ni.FG,t);ai.forEach(function(t){return e.createLayer(t,r)})}function i(){e.setup();e.createLayer(ni.BANDS);e.createLayer(ni.UNDERLAYS);r(e.createLayer(ni.MAIN));e.createLayer(ni.COMBOS);var t=e.createLayer(ni.TRANSIENT);r(e.createLayer(ni.MAIN,t));e.createLayer(ni.COMBOS,t);var n=e.createLayer(ni.REVEALED);r(e.createLayer(ni.MAIN,n));e.createLayer(ni.COMBOS,n);[ni.DRAGGERS,ni.HANDLES,ni.BANDLABELS,ni.OVERLAYS,ni.OVERVIEW_IMAGE,ni.OVERVIEW,ni.OVERLAYSSHADOW,ni.OVERVIEWSHADOW,ni.WAIT].forEach(function(t){e.createLayer(t)})}n.setShadowColourMap=function(t){e.setShadowColourMap(t);i()};n.hasPath=e.hasLayerPathAt;n.removeAllItems=i;i();var a=Q({},e);return Q(a,n)}function si(e){return Math.abs(e)<1e-5}function fi(e){return Array.isArray(e)&&e.length>0}function li(e){return fi(e.g)}function ci(e){return isFinite(e.w)&&isFinite(e.h)||e._combo&&e._combo.open}function di(e){return e._combo&&e._combo.open}function hi(e,t){return e.oc?void 0===e.oc.bw?t.defaultOpenComboStyle.bw:e.oc.bw:0}function vi(e,t,n,r){return Math.sqrt((n-e)*(n-e)+(r-t)*(r-t))}var gi=34,pi={MOVED:1,DIRTY:2},mi={small:6,normal:10,large:20,xlarge:30};function yi(e,t,n,r){return t*(1.7*e+n*(g(mi[r])?mi[r]:mi.normal))}var bi=Math.PI/7,xi=Math.cos(bi);function wi(e,t,n,r){return xi*yi(e,t,n,r)}function Ai(e,t,n,r,i,a,o,u,s,f,l){var c=yi(r,i,f,l.arrows),d=a+Math.PI;e.triangle(t+c*Math.cos(d+bi),n+c*Math.sin(d+bi),t+c*Math.cos(d-bi),n+c*Math.sin(d-bi),t,n,o,-1,o,!0,u,s,!1)}function Mi(e,t,n){var r,i,a=ci(e);if(t&&n.selectedNode){r=n.selectedNode.b||e.b;i=n.selectedNode.c||e.c}else{r=e.b;i=e.c}return!(!r&&!i||a)}var Ii={t:.5,t1:.15,t2:.85},Ei={line:1,arc:2},Ci=F();function ki(e,t,n,r,i,a,o,u,s,f,l,c,d){f?e.arc(0,0,0,0,0,o,u,s,t,l,!1,c,!0):e.line(0,0,0,0,o,u,s,t,l,!0);var h=f?Ei.arc:Ei.line;n&&e.triangle(0,0,0,0,0,0,o,-1,o,!0,t+Ci+"a1",h,!0);r&&e.triangle(0,0,0,0,0,0,u||o,-1,u||o,!0,t+Ci+"a2",h,!0);d.hib=!0;d.pos.t.lx=(i._sx+a._sx)/2;d.pos.t.ly=(i._sy+a._sy)/2}function Si(e,t,n,r,i,a,o){return{x:((a-r)*n-(o-i)*t)/e,y:((a-r)*t+(o-i)*n)/e}}function Ti(e,t,n,r,i,a,o,u,s,f){var l=Si(t,n,r,i,a,o,u),c=Si(t,n,r,i,a,s,f),d=e/t/2;if(l.y>d&&c.y>d||l.y<-d&&c.y<-d)return-1/0;if(si(c.y-l.y))return Math.max(l.x,c.x);var h,v,g=l.y>c.y?l:c,p=l.y>c.y?c:l;h=d<g.y?g.x-(g.y-d)*(g.x-p.x)/(g.y-p.y):g.x;v=p.y<-d?p.x-(p.y- -d)*(p.x-g.x)/(p.y-g.y):p.x;return Math.max(h,v)}function Ri(e,t,n,r,i,a){function o(i,o,u,s){return Ti(e,t,n,r,a._sx,a._sy,i+a._sx,o+a._sy,u+a._sx,s+a._sy)}return Math.max(o(i.x1,i.y1,i.x2,i.y1),o(i.x2,i.y1,i.x2,i.y2),o(i.x2,i.y2,i.x1,i.y2),o(i.x1,i.y2,i.x1,i.y1))}function Li(e,t,n,r){var i=-1/0,a=r.cx,o=r.cy,u=e*e,s=-2*e*(a*n-o*t),f=s*s-4*u*(a*a+o*o-r.r*r.r);f>=0&&(i=(-s+Math.sqrt(f))/(2*u));return i}function Bi(e,t,n,r){for(var i,a=-1/0,o=Math.sin(-n),u=Math.cos(-n),s=r._cl,f=0;f<s.length;f++){var l=s[f];i=l.r?Li(t,o,u,l):Ri(e,t,o,u,l,r);a=Math.max(a,i)}return a}function Zi(e,t,n,r){var i=0;r._c&&(i=r._c/t);r._cl&&(i=Math.max(i,Bi(e,t,n,r)));return i}var Oi=F();function Gi(e,t,n,r,i,a,o,u,s,f,l,c,d,h){var v={},g=n-e,p=r-t,m=Math.sqrt(g*g+p*p);if(si(m))v.skip=!0;else{var y=Math.atan2(p,g),b=Zi(h.tight&&s?0:i,m,y,o),x=Zi(h.tight&&f?0:i,m,y+Math.PI,u),w=l||0,A=c||0,M=1-((b=Math.max(w,b))+(x=Math.max(A,x))),I=0;if(s||f){I=wi(i,a,d.unzoom,h.arrows)/m;s&&f&&(I*=1.5)}v.skip=M<Math.max(Math.min(6/m,.1),I);if(!v.skip){v.cx1=e+b*g;v.cy1=t+b*p;v.cx2=n+x*-g;v.cy2=r+x*-p}}return v}function Fi(e,t,n,r,i,a){var o=e,u=t,s=Math.ceil(a/8),f=vi(o,u,n,r);return{x:o+=(o-n)/f*(s-i),y:u+=(u-r)/f*(s-i)}}function Di(e,n,r,i,a,o,u,s,f,l,c,d,h,v,g,p,m){var y=Gi(u._sx,u._sy,s._sx,s._sy,c,d,u,s,n,r,i,a,p,m);if(y.skip)ki(e,o,n,r,u,s,f,l,c,!1,h,null,g);else{var b,x,w,A,M,I,E,C,k,S,T,R,L=y.cx1,B=y.cy1,Z=y.cx2,O=y.cy2,G=Z-L,F=O-B,D=Math.max(.001,F*F+G*G),z=Math.sqrt(D),V=.25;(n||r)&&(E=wi(c,d,p.unzoom,m.arrows));var Y=!1;if(m.tight){n||(Y=Mi(u,v,m)||di(u));r||Y||(Y=Mi(s,v,m)||di(s));if(Y){k=G/z;S=F/z;R=V*c}}if(n){b=Math.atan2(F,G);w=L;A=B;C=Fi(L,B,Z,O,E,c);L=C.x;B=C.y}else if(m.tight&&Mi(u,v,m)){L-=R*k;B-=R*S}else if(m.tight&&di(u)){T=hi(u,m);L-=k*T;B-=S*T}if(r){x=Math.atan2(F,G);M=Z;I=O;C=Fi(Z,O,L,B,E,c);Z=C.x;O=C.y}else if(m.tight&&Mi(s,v,m)){Z+=R*k;O+=R*S}else if(m.tight&&di(s)){T=hi(s,m);Z+=k*T;O+=S*T}e.line(L,B,Z,O,f,l,c,o,h);n&&Ai(e,w,A,c,d,b+Math.PI,f,o+Oi+"a1",Ei.line,p.unzoom,m);r&&Ai(e,M,I,c,d,x,l||f,o+Oi+"a2",Ei.line,p.unzoom,m);t(g.pos,function(e,t){if("t"===t||g.present[t]){var n=Ii[t],r=s._sx-u._sx,i=s._sy-u._sy;if(0===r&&0===i){r=1;i=-1}var a=q(r,i);e.lx=L+n*(Z-L);e.ly=B+n*(O-B);e.tdx=r/a;e.tdy=i/a;e.tangent=Math.atan2(i,r);e.R=0}})}}function zi(e,t,n,r,i,a){var o=r-t;if(Math.abs(o)>n)return[];var u=Math.max(i,a),s=Math.min(i,a);if(u<e-n||e+n<s)return[];var f=Math.asin(o/n),l=n*Math.cos(f),c=[];s<=e-l&&e-l<=u&&c.push(o>0?Math.PI-f:-Math.PI-f);s<=e+l&&e+l<=u&&c.push(f);return c}function Vi(e,t,n,r,i,a){var o=r-e;if(Math.abs(o)>n)return[];var u=Math.max(i,a),s=Math.min(i,a);if(u<t-n||t+n<s)return[];var f=Math.acos(o/n),l=n*Math.sin(f),c=[];s<=t-l&&t-l<=u&&c.push(-f);s<=t+l&&t+l<=u&&c.push(f);return c}function Yi(e,t,n,r,i,a){var o=zi(e,t,n,r.y2+a,r.x1+i,r.x2+i),u=zi(e,t,n,r.y1+a,r.x1+i,r.x2+i),s=Vi(e,t,n,r.x1+i,r.y1+a,r.y2+a),f=Vi(e,t,n,r.x2+i,r.y1+a,r.y2+a);return o.concat(u,f,s)}function Pi(e,t,n,r,i,a){var o=r-e,u=i-t,s=Math.sqrt(o*o+u*u);if(s>n+a||s<Math.abs(n-a)||0===s)return[];var f=(n*n-a*a+s*s)/(2*s),l=Math.sqrt(n*n-f*f),c=e+f*o/s,d=t+f*u/s,h=c+l*(u/s),v=c-l*(u/s),g=d-l*(o/s),p=d+l*(o/s);return[Math.atan2(g-t,h-e),Math.atan2(p-t,v-e)]}function Wi(e,t,n,r,i){for(var a=Math.PI,o=e,u=0;u<t.length;u++){t[u]+2*Math.PI<r&&(t[u]+=2*Math.PI);n<t[u]&&t[u]<r&&(i?t[u]-o<a&&(o=Math.max(o,t[u])):o-t[u]<a&&(o=Math.min(o,t[u])))}return o}function Xi(e,t,n,r,i,a,o){var u=o?r:i,s=a._sx,f=a._sy;a._c&&(u=Wi(u,Pi(e,t,n,s,f,a._c),r,i,o));if(a._cl)for(var l=0;l<a._cl.length;l++){var c=a._cl[l];u=Wi(u,c.r?Pi(e,t,n,s+c.cx,f+c.cy,c.r):Yi(e,t,n,c,s,f),r,i,o)}return u}function Ui(e,t,n,r,i,a,o,u){var s=4;if(!u.length){var f=e+n*Math.cos(r),l=t+n*Math.sin(r),c=e+n*Math.cos(i),d=t+n*Math.sin(i);if(u.r){var h=a+u.cx,v=o+u.cy,g=vi(f,l,h,v),p=vi(c,d,h,v);if(g<=u.r+s&&p<=u.r+s)return!0}else{var m=a+u.x1-s,y=a+u.x2+s,b=o+u.y1-s,x=o+u.y2+s;if(m<=f&&f<=y&&b<=l&&l<=x&&(m<=c&&c<=y&&b<=d&&d<=x))return!0}}return!1}function Ni(e,t,n,r,i,a){var o=a.x,u=a.y;if(a._c){if(Ui(e,t,n,r,i,o,u,{cx:0,cy:0,r:a._c}))return!1}if(a._cl)for(var s=0;s<a._cl.length;s++){if(Ui(e,t,n,r,i,o,u,a._cl[s]))return!1}return!0}var ji=F();function _i(e,t,n,r,i,a,o,u,s,f,l,c,d){var h=Pi(i,a,wi(u,s,c,d.arrows),t,n,r);if(2===h.length){Ai(e,i,a,u,s,(o?h[0]:h[1])-Math.PI,f,l,Ei.arc,c,d)}else e.triangle(0,0,0,0,0,0,f,-1,f,!0,l,Ei.arc,!0)}function Hi(e,t,n,r,i){return.9*wi(e,t,r,i)/n}function Ki(e,n,r,i,a,o,u,s,f,l,c,d,h,v,g,p,m,y){var b=s===f,x=s._sx,w=s._sy,A=f._sx,M=f._sy,I=i||0,E=a||0,C=+(o||0)*h;b&&(C+=gi*s._sl.e);var k=C>0;if(b){var S=(s._sl.w?180:225)*(Math.PI/180),T=Math.cos(S),R=Math.sin(S),L=.5;A=x=s._sx+s._sl.x;M=w=s._sy+s._sl.y;var B=-s._sl.e*gi/2;x+=T*B+R*L;w+=R*B-T*L;A+=T*B-R*L;M+=R*B+T*L}var Z=(x+A)/2,O=(w+M)/2,G=A-x,F=M-w,D=Math.max(.001,F*F+G*G),z=Math.sqrt(D),V=+(D/4+C*C)/(2*Math.abs(C)),Y=V-Math.abs(C);if(V>1e5){m.useSlowPathRendering=!0;m.useSlowPathRenderingLastTime=!0;Di(e,n,r,I,E,u,s,f,l,c,d,h,v,g,p,m,y)}else{var P=k?1:-1,W=Z-F*P*Y/z,X=O+G*P*Y/z,U=Math.atan2(w-X,x-W),N=Math.atan2(M-X,A-W),j=k?U:N,_=k?N:U;j>_&&(_+=2*Math.PI);var H=j+(k?I:E)*(_-j),K=j+(k?1-E:1-I)*(_-j),Q=Xi(W,X,V,j,_,C>0?s:f,!0),J=Xi(W,X,V,Q,_,C>0?f:s,!1),q={startangle:0,endangle:0};if(s===f||Ni(W,X,V,Q,J,s)&&Ni(W,X,V,Q,J,f)){q.startangle=Q;q.endangle=J}else{q.startangle=2*Math.PI;q.endangle=2*Math.PI}q.startangle=Math.max(H,q.startangle);q.endangle=Math.min(K,q.endangle);if(q.startangle>=q.endangle)ki(e,u,n,r,s,f,l,c,d,!0,v,C,p);else{var $,ee,te,ne,re,ie,oe=0;(n||r)&&(oe=Hi(d,h,V,m.unzoom,y.arrows));var ue,se,fe,le=-.25;if(y.tight&&(!n||!r)){if(di(s)||di(f)){var ce=q.endangle-q.startangle;ue=ce/(ce*V)}(Mi(s,g,y)||Mi(f,g,y))&&(oe=Hi(d,h,V,m.unzoom,y.arrows))}if(n){$=k?q.startangle:q.endangle;ee=W+V*Math.cos($);te=X+V*Math.sin($);k?q.startangle+=oe:q.endangle-=oe}else if(y.tight)if(Mi(s,g,y))k?q.startangle+=le*oe:q.endangle-=le*oe;else if(di(s)&&(se=hi(s,y))){fe=se*ue;k?q.startangle-=fe:q.endangle+=fe}if(r){ne=k?q.endangle:q.startangle;re=W+V*Math.cos(ne);ie=X+V*Math.sin(ne);k?q.endangle-=oe:q.startangle+=oe}else if(y.tight)if(Mi(f,g,y))k?q.endangle-=le*oe:q.startangle+=le*oe;else if(di(f)&&(se=hi(f,y))){fe=se*ue;k?q.endangle+=fe:q.startangle-=fe}if(q.startangle>=q.endangle)ki(e,u,n,r,s,f,l,c,d,!0,v,C,p);else{e.arc(W,X,V,q.startangle,q.endangle,l,c,d,u,v,!1,C);n&&_i(e,W,X,V,ee,te,k,d,h,l,u+ji+"a1",m.unzoom,y);r&&_i(e,W,X,V,re,ie,!k,d,h,c||l,u+ji+"a2",m.unzoom,y);t(p.pos,function(e,t){if("t"===t||p.present[t]){var n=P>0?q.startangle:q.endangle,r=n+((P>0?q.endangle:q.startangle)-n)*Ii[t];e.lx=W+V*Math.cos(r);e.ly=X+V*Math.sin(r);e.tdx=-P*Math.sin(r);e.tdy=P*Math.cos(r);e.tangent=r;e.R=V;e.signf=P}})}}}}var Qi=Math.PI/256;function Ji(e,t,n,r,i,a,o){var u=i.bw*a,s=i.w*a;if(s>0){var f=i.v.filter(function(e){return e>0}).length;if(1===f){var l=0;i.v.forEach(function(e,t){e>0&&(l=t)});e.circle(t,n,r,i.c[l],s,Ot.white,!1,o+"do0",null,!0)}else{var c=i.v.reduce(function(e,t){return e+t},0),d=u/r,h=d*f,v=2*Math.PI-h,g=-Math.PI/2+d/2;v>0&&i.v.reduce(function(a,l,h){var g=a;if(0===l)return g;var p=g+v*l/c,m=p+d,y=i.c[h%i.c.length];0===u&&(0===h?g-=Qi:h!==f-1&&(p+=Qi));e.arc(t,n,r,g,p,y,null,s,o+"do"+h,null,!0,0);return m},g)}}}var qi=9,$i=2;function ea(e){return"b"in e?e.b:Ot.keyline}function ta(e){var t=qi;ea(e)&&(t+=$i/2);e.e&&(t*=e.e);return t}var na=3,ra=1;function ia(e){return ta(e)+na}function aa(e,t){return ta(e)+ra+ta(t)}function oa(e,t){return vi(e,t,0,0)}function ua(e,t,n,r,i,a,o,u,s,f,l){e.rect(i-o,a-o,i+o,a+o,Ot.transparent,-1,Ot.transparent,!0,r,null,l);var c=2*o,d=zn(n,u,c,!1,f||t.fontFamily,!0),h=oa(d.width,d.height),v=c-(h-c)/2;h=oa((d=zn(n,u,v,!1,f||t.fontFamily,!0)).width,d.height);var g=t.imageAlignment[u],p=0,m=0,y=1;if(g){p=g.dx/100*o;m=g.dy/100*o;y=g.e}var b=o*(5/6)*y,x=i-b+p,w=a-b+m,A=i+b+p,M=a+b+m;e.text(i+p,a+v*y/2+m,u,s,v*y,!1,r,f,!0,h,!0,null,x,w,A,M,null,null,null,l)}var sa=F();function fa(e,t,n,r,i,a,o,u,s,f,l,c,d,h,v,g,p,m,y,b,x,w){return la(e,t,n,r,i,a,o,u,s,f,l,c,d,h,zn(e,n,g,f,p).width,v,g,p,m,y,b,x,w)}function la(e,t,n,r,i,a,o,u,s,f,l,c,d,h,v,g,p,m,y,b,x,w,A){var M=!0;0===n.length&&(M=!1);var I=a+sa+(b||"t");if(M&&y){t.text(0,0,n,u,p,f,I,m,!0,v,!1,o,0,0,0,0,s,g,0,y);l&&(l._edit={hib:!0});return!0}if(c&&v>h)return fa(e,t,n,r,i,a,o,u,s,f,l,c,d,h,g,.85*p,m,y,b,x,w,A);var E,C=4*w,k=r-v/2,S={x1:k-C,y1:(E=d?i+(x||1)+p/2:i+(1+p)/2)-p,x2:k+v+C,y2:E};if(M){var T=d?A.labelOffset:0;t.text(r,E,n,u,p,f,I,m,!0,v,!1,o,S.x1,S.y1,S.x2,S.y2,s,g,C,!1,T)}if(l&&"node"===l.type){S.x1-=l._sx;S.y1-=l._sy;S.x2-=l._sx;S.y2-=l._sy}l&&ca(l,S,p,M,A);return M}function ca(e,t,n,r,i){if(e._edit){e._edit.hib=!1;e._edit.x1=Math.min(e._edit.x1,t.x1);e._edit.x2=Math.max(e._edit.x2,t.x2);e._edit.y1=Math.min(e._edit.y1,t.y1);e._edit.y2=Math.max(e._edit.y2,t.y2)}else e._edit={fs:n,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,hib:!1};i.avoidLabels&&r&&e._cl&&e._cl.push(t)}var da=[12,9,7,7];function ha(e,t,n,r){e._cl.push({cx:t,cy:n,r:r})}function va(e,t,n,r,i){e._cl.push({x1:t,x2:r,y1:n,y2:i})}function ga(e,t,n,r,i,a,o,u,s,f,l,c,d){var h=r,v=i,p=a,m=0;if(o&&!(u&&u._combo&&u._combo.open)){o.e&&(p*=o.e);var y,b=o.a?c.easingValue:1,x=qi*p*b,w=ea(o),A=w?$i*p:-1,M=!!(o.u||o.fi&&o.fi.t),I=0,E=0,C=1;m=x+(w?A/2:0);var k=u&&!g(o.r);if(o.c)if(o.t){var S,T,R,L,B=!O(o,"fb")||o.fb,Z=o.fc||Ot.white,G=o.ff||d.fontFamily;if(o.w&&f){S=p*da[1]*b;T=zn(t,R=(o.t+"").substring(0,25),S,B,G).width;var F,D,V=(L=Math.max(T,x))+x;switch(s){case"left":F=(D=h+x)-V;h=D-V/2;break;case"centre":F=h-V/2;D=h+V/2;break;default:D=(F=h-x)+V;h=F+V/2}var Y=v-x,P=v+x;e.roundRect(F,Y,D,P,x,w,A,o.c,!0,n,l);if(k){ha(u,F+x-u._sx,v-u._sy,m);ha(u,D-x-u._sx,v-u._sy,m);va(u,F+x-u._sx,Y-u._sy-A/2,D-x-u._sx,P-u._sy+A/2)}}else{e.circle(h,v,x,w,A,o.c,!0,n,null,null,!1,l);T=zn(t,R=(o.t+"").substring(0,4),S=p*da[R.length-1]*b,B,G).width;L=1.7*x;k&&ha(u,h-u._sx,v-u._sy,m)}la(t,e,R,h,v,n,!1,Z,Ot.white,B,null,!0,!1,L,T,!1,S,G,l,null,null,c.unzoom,d)}else{e.circle(h,v,x,w,A,o.c,!0,n,null,null,!1,l);k&&ha(u,h-u._sx,v-u._sy,m);if(M){var W=x/1.41421;if(o.u){if(y=d.imageAlignment[o.u]){I=y.dx/100*W;E=y.dy/100*W;C=y.e}var X=W*C;e.image(h-X+I,v-X+E,h+X+I,v+X+E,o.u,n,null,null,null,l)}else ua(e,d,t,n,h,v,W,o.fi.t,o.fi.c||Ot.black,o.fi.ff||d.iconFontFamily,l)}}else if(M){k&&ha(u,h-u._sx,v-u._sy,x);if(o.u){if(y=d.imageAlignment[o.u]){I=y.dx/100*x;E=y.dy/100*x;C=y.e}e.image(h-x*C+I,v-x*C+E,h+x*C+I,v+x*C+E,o.u,n,null,null,null,l)}else ua(e,d,t,n,h,v,x,o.fi.t,o.fi.c||Ot.black,o.fi.ff||d.iconFontFamily,l)}if(o.a){c.stillDirty=c.stillDirty||new Map;c.stillDirty.set(z(n),pi.DIRTY)}}return m}var pa=F();function ma(e,t,n,r,i,a,o,u,s,f,l,c,d,h,v){var g,p,m,y=n||[],b=r,x=i,w=0,A=function(e,t){return aa(e,t)*a},M=function(){return 0};if(o)if(c.R&&v.glyphsAlongLink){var I=0,E=c.signf,C=c.R;w=c.tangent;for(m=0;m<y.length-1;m++){p=aa(y[m],y[m+1]);I+=E*Math.asin(p/(2*C))}var k=w+I/2,S=2*E*C*Math.sin(I/2);b+=E*S*-Math.sin(k);x+=E*S*Math.cos(k);w+=I;A=function(e,t){g-=E*Math.asin(aa(e,t)/(2*C));var n=-E*Math.sin(g);return aa(e,t)*a*n};M=function(e,t){var n=E*Math.cos(g);g-=E*Math.asin(aa(e,t)/(2*C));return aa(e,t)*a*n}}else{var T=0;for(m=0;m<y.length-1;m++)T+=aa(y[m],y[m+1])*a;if(v.glyphsAlongLink){A=function(e,t){return aa(e,t)*a*c.tdx};M=function(e,t){return aa(e,t)*a*c.tdy};b+=T*c.tdx/2;x+=T*c.tdy/2}else b+=T/2}else y.length>0?b-=ia(y[y.length-1])*a:b-=ia({});function R(e){g=w;for(var t=y.length-1,n=b,r=x;t>=0;t--){e(y[t],n,r);if(t>0){n-=A(y[t-1],y[t]);r-=M(y[t-1],y[t])}}}o&&u&&R(function(t,n,r){e.circle(n,r,ta(t)*a*1.25,Ot.white,-1,d(),!0,s,null,null,!1,f)});var L=0;R(function(n,r,i){var o=s+pa+L;l&&(o+="-"+l);ga(e,t,o,r,i,a,n,null,!1,!1,f,h,v);L++})}var ya=F();function ba(e,t,n,r,i,a,o,u,s,f){var l,c,d,h=e.getLayer(),v="solid",g=qn;e.setLayer(ni.HALOS);for(var p=!0,m=0;m<g.length;m++){l=i[d=g[m]];c=t+ya+d;if(l){p=!1;i.off||n===r?Ki(e,!1,!1,i.b1,i.b2,i.off,c,n,r,l.c,null,l.w,a,v,o,u,s,f):Di(e,!1,!1,i.b1,i.b2,c,n,r,l.c,null,l.w,a,v,o,u,s,f)}}i._noHalos=p;e.setLayer(h)}var xa=F();function wa(e,t,n,r,i,a){var o=0,u=0,s="centre";if(-1!==e.indexOf("n")||-1!==e.indexOf("s")){u=-n;2===e.length&&(u-=r.dy);-1!==e.indexOf("s")&&(u*=-1)}if(-1!==e.indexOf("e")||-1!==e.indexOf("w")){o=t;s="right";2===e.length&&(o+=r.dx);if(-1!==e.indexOf("w")){o*=-1;s="left"}}!i&&a&&(-1!==["n","s"].indexOf(e)?u*=Math.sqrt(2):-1!==["e","w"].indexOf(e)&&(o*=Math.sqrt(2)));return{gdx:o,gdy:u,growDirection:s}}function Aa(e){var t="centre";e>0&&e<180?t="right":e>180&&(t="left");return t}function Ma(e,t,n,r,i){var o,u,s=a(e);switch(i){case"circle":o=Math.sin(s)*r;u=-Math.cos(s)*r;break;case"rectangle":var f,l=[Math.atan2(t,n),Math.atan2(t,-n),Math.atan2(-t,-n),Math.atan2(-t,n)];for(f=0;f<l.length;f++)l[f]<0&&(l[f]+=2*Math.PI);if(s<l[0]||s>l[3])o=-(u=-n)*Math.tan(s);else if(s<l[1]){o=t;u=s===Math.PI/2?0:-o/Math.tan(s)}else if(s<l[2])o=-(u=n)*Math.tan(s);else{o=-t;u=s===Math.PI/2*3?0:-o/Math.tan(s)}break;default:o=0;u=0}return{gdx:o,gdy:u}}function Ia(e,t){return{gdx:Math.sin(a(e))*t,gdy:-Math.cos(a(e))*t}}function Ea(e,t,n,r,i,a,o,u,s,f,l,c,d){var h,v=0,p=g(f.r);if(-1!==["n","ne","e","se","s","sw","w","nw"].indexOf(f.p))h=wa(f.p,n,r,l,s,u);else{var m="rectangle",y=0;if(u){m="circle";y=s?Math.min(n,r):Math.sqrt(2)*n}(h=p?Ia(f.p,f.r*a):Ma(f.p,n,r,y,m)).growDirection=Aa(f.p)}if(null!==h.gdx){h.gdx<0&&h.gdy<0&&f.e&&(i._sl.e=Math.max(i._sl.e,f.e));v=ga(e,t,o+xa+tr(f.p,f.r),i._sx+h.gdx,i._sy+h.gdy,a,f,i,h.growDirection,!0,null,c,d)}return i._sy+h.gdy+v}var Ca=F();function ka(e,t,n,r,i,a,o,u){for(var s,f=$n,l=!0,c=0;c<f.length;c++){var d=f[c];if(s=o&&u.selectedNode[d]||a[d]){l=!1;var h=t+Ca+d,v=s.r*i,g=s.w*i;g/2>=v?e.circle(n,r,v+g/2,Ot.white,-1,s.c,!0,h,null,!0):e.circle(n,r,v,s.c,g,Ot.white,!1,h,null,!0)}}a._noHalos=l&&!o}var Sa=F();function Ta(e,t,n,r,i,a,o,u,s,f,l,c,d){var h=n||[],v=r;if(o){for(var g=0,p=0;p<h.length-1;p++)g+=aa(h[p],h[p+1])*a;v+=g/2}else h.length>0?v-=ia(h[h.length-1])*a:v-=ia({});if(f){var m=v;if(h.length>0){b(function(e,t){m=t});var y=h[0].e||1;m-=y*a*gi/2;f._sl.e*=y}f._sl.x=m-f._sx;f._sl.y=i-f._sy;f._sl.w=!0}function b(e){for(var t=h.length-1,n=v;t>=0;t--){e(h[t],n);t>0&&(n-=aa(h[t-1],h[t])*a)}}o&&u&&b(function(t,n){e.circle(n,i,ta(t)*a*1.25,Ot.white,-1,l(),!0,s,null,null,!1,!1)});var x=0;b(function(n,r){ga(e,t,s+Sa+x,r,i,a,n,f,!1,!1,!1,c,d);x++})}function Ra(e,t){return e._combo&&e._combo.open?"circle":t?"circle"===e.sh?e.sh:"box":"box"===e.sh||"circle"===e.sh?e.sh:e.sq?"box":"circle"}function La(e,t,n,r,i,a,o,u){var s=r+a,f=i+a;if("circle"===e){o(Math.min(s,f))}else{u(t-s,n-f,t+s,n+f)}}function Ba(e,t,n,r,i,a,o,u,s,f,l,c,d,h){La(d,t,n,r,i,a,function(r){e.circle(t,n,r,o,u,f,l,c,s,!1,!1,h)},function(t,n,r,i){e.rect(t,n,r,i,o,u,f,l,c,s,h)})}function Za(e,t,n,r,i,a,o){La(o,t,n,r,i,a,function(t){e._c=t},function(r,i,a,o){e._cl.push({x1:r-t,y1:i-n,x2:a-t,y2:o-n})})}function Oa(e,t){return t&&t===e}function Ga(e,t,n,r){return n&&("node"===e.type||"link"===e.type)&&t.length>n&&!Oa(e.id,r)}function Fa(e,t,n,r){var i=t;""===i||i||(i=e.t);function a(){Ga(e,i,n,r)&&(i=i.substring(0,n-3)+"...");return i.split(/\r\n|\r|\n/)}return i?a():[""]}function Da(e,t,n,r,i,a){for(var o=[],u=0;u<e.length;u++)o[u]=zn(t,e[u],n,r,i||a).width;return o}var za=F();function Va(e){for(var t=0,n=0;n<e.length;n++)t=Math.max(t,e[n]);return t}function Ya(e,t,n,r,i,a,o,u,s,f,l,c,d){var h=o*f.unzoom;if(u.t){var v=r,g=i,p=e.getLayer();s||e.setLayer(ni.BUBBLES);var m=u.p?""+u.p:"ne",y="w"===m.substring(1,2),b="s"===m.substring(0,1),x=n+za+"bu",w=Number(u.fs?u.fs:d)*h,A=u.b?u.b:Ot.keyline,M=u.c?u.c:Ot.white,I=u.fc?u.fc:Ot.black,E=Fa(u,null,l.truncateLabel,c.showFullLabel),C=w+3*h,k=C*E.length,S=Da(E,t,w,u.fb,u.ff,l.fontFamily),T=Va(S),R=13*h,L=6*h,B=2*o,Z=9*h,O=13*h,G=10*h,F=a+O,D=k+2*L,z=2*h,V=Math.max(z/2,1),Y=3*h;u.g&&delete u.g.e;var P=u.g?17*h:0;y&&(v-=T+2*B+2*R+P);b&&(g+=(w+3)*E.length+2*F+2*L);var W=v+B+.5,X=v+B+2*R+T+P+.5,U=g-F-D+.5,N=g-F+.5;e.roundRect(W,U,X,N,8*h,A,z,M,!0,x);ga(e,t,x,v+P,(U+N)/2,h,u.g,null,null,null,null,f,l);var j,_=U-.5+L+C,H=W+R+P-.5;for(j=0;j<E.length;j++){var K=S[j];e.text(H,_,E[j],I,w,u.fb,x,u.ff||l.fontFamily,!1,K,!1,!1,H-1.5,_-w,X,N);_+=C}if(y){W=X;Z=-Z;G=-G;V=-V}if(b){N=U;O=-O;Y=-Y}e.triangle(W+Z,N,W+Z+G,N,W+Z,N+O,A,z,M,!0,x,0,!1);e.triangle(W+Z+V,N-Y,W+Z+G+V,N-Y,W+Z+V,N+O-Y,A,-1,M,!0,x,0,!1);e.setLayer(p)}}var Pa=4,Wa=27;function Xa(e,n){var r={},i=nn;r.fontSize=i;var a=F(),o={arrows:null,fontFamily:null,glyphsAlongLink:null,iconFontFamily:null,imageAlignment:null,editcolour:null,tight:null,avoidLabels:null,selectionFontColour:null,selectedNode:null,isNodeSelStyle:null,selectedLink:null,isLinkSelStyle:null,labelOffset:0,truncateLabel:null,defaultOpenComboStyle:Jn},u={},s={hib:!1,present:{t:!0,t1:!1,t2:!1},pos:{t:{lx:0,ly:0,tdx:1,tdy:0,tangent:0,R:0},t1:{lx:0,ly:0,tdx:1,tdy:0,tangent:0,R:0},t2:{lx:0,ly:0,tdx:1,tdy:0,tangent:0,R:0}}},f={unzoom:1,easingValue:null,resizeRect:null,resizePrimitive:null,stillDirty:null,useSlowPathRendering:!1,useSlowPathRenderingLastTime:!1};r.setSpecialOptions=function(e,t){u[e]=t};r.editColour=function(){return o.editcolour||Ot.edit};var l=r.editColour;function c(){return o.selectionFontColour||Ot.white}r.setOptions=function(e){o.arrows=e.arrows;g(e.labelOffset)&&(o.labelOffset=e.labelOffset);e.truncateLabels&&e.truncateLabels.maxLength&&g(e.truncateLabels.maxLength)?o.truncateLabel=e.truncateLabels.maxLength:o.truncateLabel=!1;e.selectionColour&&(o.editcolour=Pt(e.selectionColour)?e.selectionColour:void 0);o.fontFamily=e.fontFamily;o.glyphsAlongLink="along"===e.linkStyle.glyphs;o.iconFontFamily=e.iconFontFamily;o.imageAlignment=e.imageAlignment||{};o.avoidLabels=e.linkEnds.avoidLabels;o.tight="loose"!==e.linkEnds.spacing;e.selectionFontColour&&(o.selectionFontColour=Pt(e.selectionFontColour)?e.selectionFontColour:void 0);o.selectedNode=e.selectedNode;o.isNodeSelStyle=x(e.selectedNode);o.selectedLink=e.selectedLink;o.isLinkSelStyle=x(e.selectedLink)};r.arrowLength=function(e,t){return wi(e,t,f.unzoom,o.arrows)};function d(e,r,a,d,g,p,m,y){var b=y.isSelected,x=y.isRevealed,w=1;a._edit=null;var A=a.id,M=b&&!o.isLinkSelStyle,I=M,E=b&&o.isLinkSelStyle,C=E&&o.selectedLink.b1>=0?o.selectedLink.b1:a.b1,k=E&&o.selectedLink.b2>=0?o.selectedLink.b2:a.b2,S=E&&o.selectedLink.c||a.c,T=E&&o.selectedLink.c2||a.c2,R=E&&o.selectedLink.fb||a.fb,L=E&&o.selectedLink.fbc||a.fbc,B=E&&o.selectedLink.fc||a.fc,Z=E&&o.selectedLink.ff||a.ff,O=E&&o.selectedLink.fs||a.fs,G=E&&o.selectedLink.t1||a.t1,F=E&&o.selectedLink.t2||a.t2,D=E&&o.selectedLink.ls||a.ls,z=E&&o.selectedLink.w||a.w,V=!1;x&&(V=n.privateTopParentId(a.id1)!==n.privateTopParentId(a.id2));g.parentId&&(w=v(1,g.parentId,d));p.parentId&&(w=Math.min(w,v(1,p.parentId,d)));var Y=(z||1)*w*f.unzoom,P=S||Ot.midgrey,W=0;s.present.t=a.t||a.g&&a.g.length||m;s.present.t1=!!a.t1;s.present.t2=!!a.t2;var X=s.present.t||s.present.t1||s.present.t2;s.hib=!1;if(a.off||g===p){var U=a.off;V&&(U=a.off/w);Ki(r,a.a1,a.a2,C,k,U,A,g,p,P,T,Y,w,D,b,s,f,o)}else Di(r,a.a1,a.a2,C,k,A,g,p,P,T,Y,w,D,b,s,f,o);a._x=s.pos.t.lx;a._y=s.pos.t.ly;var N=s.hib;X&&t(s.pos,function(t,n){if(s.present[n]){var d,h,v,g,p,m,y=t.lx,b=t.ly,x={};if("t"===n||"string"==typeof a[n])m=a[n];else{x=a[n];"t1"===n&&(x=G);"t2"===n&&(x=F);m=x.t?x.t:a[n].t;d=x.fb?x.fb:a[n].fb;h=x.fbc?x.fbc:a[n].fbc;v=x.fc?x.fc:a[n].fc;g=x.ff?x.ff:a[n].ff;p=x.fs?x.fs:a[n].fs}var E=!1,C=y,k=b;p=Number(p||O||i)*w*f.unzoom;m=m||"";g=g||Z||o.fontFamily;var S=v||B||Ot.black,T=h||L||Ot.textback,D=void 0!==d?!!d:R;if(M){S=c();T=l()}var z=Fa(a,m,o.truncateLabel,u.showFullLabel),V=Da(z,e,p,D,g,o.fontFamily),P=p+3*f.unzoom;W=P*z.length;z.length>0&&(C-=V[0]/2);for(var X=(z.length-1)*P,U=x.above?b-(X+P/2+Y/2):b-X/2,j=0;j<z.length;j++){0===j&&(k=U);var _=la(e,r,z[j],y,U,A,!0,S,T,D,a,!1,!0,99,V[j],M,p,g,N,n,null,f.unzoom,o);E=E||_;U+=P}E&&(I=!1);var H="t"===n?a.g:x.g;if(fi(H)){ma(r,e,H,C,k,w,!E,M,A,N,"t"===n?null:n,t,l,f,o);I=!1}}});if(I){var j=Math.max(.66*(z||0),Number(O||i)*f.unzoom/2);r.circle(a._x,a._y,j,Ot.white,-1,l(),!0,A,null,null,!1,N)}a.bu&&Ya(r,e,A,a._x,a._y,W/2+4,w,a.bu,!1,f,o,u,i);g.du&&h(g,"id1",A,r,Y,P,N);p.du&&h(p,"id2",A,r,Y,P,N);a._noHalos||ba(r,A,g,p,a,w,b,s,f,o);N&&(a._edit={hib:!0})}function h(e,t,n,r,i,o,u){r.circle(e._sx,e._sy,1.5*i,o,i,Ot.white,!0,n+a+t,null,null,!1,u)}function v(e,t,n){var r=e,i=n[t];if(i){r*=i._combo.e;i.parentId&&(r=v(r,i.parentId,n))}return r}function p(e,t){for(var n=e,r=n.x,i=n.y;n.parentId;){r=(n=t[n.parentId]).x+(r-n.x)*n._combo.e;i=n.y+(i-n.y)*n._combo.e}return{x:r,y:i}}function m(e,t,n,r,i){if(!n.hi&&!n.du){var u,s,c,d,h,m,x,w,A,M,I,E=i.isOpenCombo,C=n.id,k=ci(n),S=Ra(n,k),T=i.isSelected,R=T&&o.isNodeSelStyle,L=T&&!o.isNodeSelStyle,B=R&&o.selectedNode.b||n.b,Z=R&&o.selectedNode.bs||n.bs,O=R&&o.selectedNode.c||n.c,G=(k?1:R&&o.selectedNode.e||n.e||1)*f.unzoom;s=!!k&&(R&&o.selectedNode.re||n.re);c=R&&o.selectedNode.u||n.u;d=R&&o.selectedNode.fi||n.fi;h=R&&g(o.selectedNode.bw)?o.selectedNode.bw:n.bw;m=R&&o.selectedNode.w||n.w;x=R&&o.selectedNode.h||n.h;w=n.x;A=n.y;var F,D=n.donut&&"circle"===S&&!E?n.donut:null;if(E){var z=n.oc;if(z){h=0;if(null===z.b)B=null;else{void 0===z.bw?h=o.defaultOpenComboStyle.bw:z.bw>0&&(h=z.bw);B=z.b||o.defaultOpenComboStyle.b}Z=z.bs||o.defaultOpenComboStyle.bs;O=z.c||o.defaultOpenComboStyle.c;s=z.re||o.defaultOpenComboStyle.re;m=z.w||o.defaultOpenComboStyle.w}else{B=o.defaultOpenComboStyle.b;h=o.defaultOpenComboStyle.bw;Z=o.defaultOpenComboStyle.bs;O=o.defaultOpenComboStyle.c;s=o.defaultOpenComboStyle.re;m=o.defaultOpenComboStyle.w}if(R){var V=o.selectedNode.oc;if(V){B=V.b||B;h=V.bw||h;Z=V.bs||Z;O=V.c||O}}d=null;c=null;S="circle";M=R&&o.selectedNode.e||n.e||1;x=m*=G=n._combo.e}var Y=1;if(n.parentId){Y=v(1,n.parentId,r);var P=p(n,r);m*=Y;x*=Y;G*=Y;w=P.x;A=P.y}n._sx=w;n._sy=A;if(D){F=!0;u=D.b;h=G*(D.w+2*D.bw);Z=null}else if(B&&(void 0===h||h>0)){F=!0;u=B;h=G*(h||Pa)}else{F=!1;u=Ot.white;h=0;Z=null}var W,X,U=!!O,N=!!c||!(!d||!d.t),j=U?O:Ot.white;n._c=0;n._cl=[];n._edit=null;n._sl={e:G};if(k){W=m/2;X=x/2}else X=W=G*Wa;var _,H,K,Q=W+h/2,J=X+h/2;if(D){_=G*D.w;H=h/2}else H=.75*(_=F?h:G*Pa);K=o.tight?F||U?h/2:H-_/2:H+_/2;if(N||F||U){Za(n,w,A,Q,J,K,S);if(T&&(!L&&s||L)){var q=ri[t.getLayer()];y(t,q,i,function(){var e=l();Ba(t,w,A,Q,J,H,e,_,null,e,!1,C,S,!L);s&&(f.resizeRect=t.getLast())})}}if(U){Ba(t,w,A,Q,J,0,u,-1,Z,j,U,C,S);T&&s&&!N&&(f.resizePrimitive=t.cloneLast())}if(N){if(c){var $=0,ee=0,te=1;if(I=o.imageAlignment[c]){$=I.dx/100*W;ee=I.dy/100*X;te=I.e}t.image(w-W*te+$,A-X*te+ee,w+W*te+$,A+X*te+ee,c,C,n.ci?"ci":void 0,1)}else{var ne=k?Math.min(W,X):W;ua(t,o,e,C,w,A,ne,d.t,d.c||Ot.black,d.ff||o.iconFontFamily)}T&&s&&(f.resizePrimitive=t.cloneLast())}if(F){var re=D&&0===D.bw?-1:h||-1;re>=0&&Ba(t,w,A,Q,J,0,u,re,Z,j,!1,C,S);T&&s&&!N&&!U&&(f.resizePrimitive=t.cloneLast())}D&&Ji(t,w,A,Math.min(Q,J),D,G,C+a);b(t,e,w,A,h,W,X,n,k,S,F,U,N,L,G,M,C,R,i)}}function y(e,t,n,r){var i,a=e.getLayerPath(),o=e.getLayer();if(t){if(n.isRevealed){n.isParentRevealed||(i=a.slice(1));if(n.isParentTransient){i||(i=a.slice(0));i.unshift(ni.TRANSIENT)}}!n.isTransient||n.isInCombo&&n.isParentTransient||(i=a.slice(1));if(n.isOpenCombo){(i=(i=i||a).slice(0,i.length-1))[i.length-1]===ni.COMBOS&&(i[i.length-1]=ni.MAIN);i.push(n.isInBackground?ni.BG:ni.FG)}if(i){e.hasPath(i)||e.createItemLayersAt(i);e.setLayerPath(i)}e.setLayer(t)}r();if(t){e.setLayerPath(a);e.setLayer(o)}}function b(e,t,n,r,a,s,d,h,v,p,m,b,x,w,A,M,I,E,C){var k,S,T,R,L,B,O,G=n,F=r,D=G,z=G,V=F,Y=li(h),P=!1,W=C.isOpenCombo,X=h._combo&&h._combo.open?M:A;if(E){S=o.selectedNode.fb||h.fb;T=o.selectedNode.fbc||h.fbc;R=o.selectedNode.fc||h.fc;L=o.selectedNode.ff||h.ff;B=(o.selectedNode.fs||h.fs||i)*X;O=o.selectedNode.tc||h.tc}else{S=h.fb;T=h.fbc;R=h.fc;L=h.ff;B=(h.fs||i)*X;O=h.tc}W&&(O=!1);var U=3*X+B/2,N=R||Ot.black,j=T||Ot.textback;if(w){N=c();j=l()}var _=F+d+U,H=Fa(h,null,o.truncateLabel,u.showFullLabel),K=Da(H,t,B,S,L,o.fontFamily),Q=B+3,J=Q,q=Q*H.length;H.length>0&&(z-=K[0]/2);var $=x||m||b,ee=Z(O)?!!O:!x&&!v,te=(H.length-1)*(J/2);if($)ee&&(_=F-te);else{if(Y){var ne=ia(h.g[h.g.length-1])*X;z=G+ne;G+=K[0]/2+ne}_=F;F+=te}H.length>0&&(V=_);m&&!ee&&(_+=a-3*X);if($){var re=3,ie=3,oe={dx:0,dy:x?-8:0},ue=2;if(!v&&"circle"===p){re+=ue;ie+=ue;if(x){oe.dx+=ue;oe.dy+=ue}}if(v&&!W){re++;ie++}var se=re*X,fe=ie*X;oe.dx*=X;oe.dy*=X;if(W){var le=((h.oc.w||o.defaultOpenComboStyle.w)+(h.oc.bw||o.defaultOpenComboStyle.bw))/2/Math.sqrt(2),ce=s/Wa;h._sl.e=ce;h._sl.x=-le*A-se/M;h._sl.y=-le*A-fe/M}else{h._sl.x=-s+(se-oe.dx);h._sl.y=-d+(fe-oe.dy)}if(Y){var de="circle"===p;for(k=0;k<h.g.length;k++){var he=Ea(e,t,s-se,d-fe,h,A,I,de,v,h.g[k],oe,f,o),ve=g(h.g[k].r);ee||ve||(_=Math.max(_,he+U))}}}for(var ge=0;ge<H.length;ge++){var pe=la(t,e,H[ge],G,_,I,!0,N,j,S,h,!1,!0,99,K[ge],w,B,L||o.fontFamily,null,null,X,f.unzoom,o);P=P||pe;_+=J}if(!$){var me=!h.t||!P;Ta(e,t,h.g,me?D:z,V,X,me,w,I,h,l,f,o)}var ye=!h._noHalos||E;!v&&ye&&y(e,ni.HALOS,C,function(){ka(e,I,G,F,X,h,E,o)});if(h.bu){var be=0;$?be=d:q>0?be=q/2+4:li(h)&&(be=13*X);Ya(e,t,I,G,F,be,X,h.bu,W,f,o,u,i)}}r.contains=function(e,n){var r=[],i=B(e,{sh:"box",x:0,y:0});function a(e,t){e&&r.push(t)}if(ci(i))if("circle"===i.sh){var o=Math.min(i.w,i.h)/2;t(n,function(e){ci(e)?"circle"===e.sh?a(bn(i.x,i.y,o,e.x,e.y,Math.min(e.w,e.h)/2),e.id):a(wn(i.x,i.y,o,e.x-e.w/2,e.y-e.h/2,e.x+e.w/2,e.y+e.h/2),e.id):a(bn(i.x,i.y,o,e.x,e.y),e.id)})}else{var u={x1:i.x-i.w/2,y1:i.y-i.h/2,x2:i.x+i.w/2,y2:i.y+i.h/2};t(n,function(e){if(ci(e))if("circle"===e.sh){var t=Math.min(e.w,e.h)/2;a(xn(u,e.x-t,e.y-t,e.x+t,e.y+t),e.id)}else a(xn(u,e.x-e.w/2,e.y-e.h/2,e.x+e.w/2,e.y+e.h/2),e.id);else a(yn(u,e.x,e.y),e.id)})}return r};r.getResizePrimitive=function(){return f.resizePrimitive};r.animated=function(){return!!f.stillDirty};r.generate=function(t,r,i,a,o,u,s,l,c,h,v,g,y,b){var x,w,A,M,I={isSelected:!1,isOpenCombo:!1,isInCombo:!1,isInBackground:!1,isTransient:!1,isParentTransient:!1,isRevealed:!1,isParentRevealed:!1};f.useSlowPathRendering=f.useSlowPathRenderingLastTime;f.useSlowPathRenderingLastTime=!1;var E=b&&!f.useSlowPathRendering&&!i,C=new Map;function k(e,t){var i=r[t];if(i){var a=n.privateFirstVisibleItemInAncestry(i.id1),o=n.privateFirstVisibleItemInAncestry(i.id2);!a||a._combo&&a._combo.open||C.set(a.id,!0);!o||o._combo&&o._combo.open||C.set(o.id,!0)}}h.forEach(k);if(f.resizePrimitive&&(i||o.get(f.resizePrimitive.id)===pi.DIRTY)){f.resizeRect=null;f.resizePrimitive=null}function S(e,n){var i=e.parentId,a=!1;if(i){if(!n&&c(i)||v(i))return!0;var o=t[i]||r[i];o&&o.parentId&&(a=S(o))}i=e.id;var u=n&&h.has(i)||C.has(i)||g(i),s=!n&&c(i),f=!n&&v(i);return a||!u&&(s||f)}function T(e){var r,i,a,o=[],f=!1,l=!!e._combo&&e._combo.open,d=e.parentId||l;I.isOpenCombo=l;I.isInBackground=e.bg;I.isSelected=c(e.id);I.isInCombo=e.parentId
;if(C.has(e.id)||g(e.id)){I.isRevealed=!0;C.set(e.id,!0);o.push(ni.REVEALED)}else I.isRevealed=!1;if(d){var h=n.privateGetAncestryIds(e.id);o.push(ni.COMBOS);r=!1;for(var v=0;v<h.length-1;v++){var p=h[v];o.push(u.createComboSegment(p));var y=t[p];r||(r=y&&y._combo&&S(y));if(!I.isRevealed&&!i&&(i=C.has(p)||g(p))){I.isRevealed=!0;C.set(e.id,!0);o.unshift(ni.REVEALED)}}I.isParentTransient=!!r;I.isParentRevealed=!!i;l&&o.push(u.createComboSegment(e.id))}else{o.push(ni.MAIN);I.isParentTransient=!1;I.isParentRevealed=!1}I.isRevealed||(f=S(e)&&(!ci(e)||d))&&o.unshift(ni.TRANSIENT);I.isTransient=f;u.startGeneratingFor(e,E,I.isInCombo||I.isOpenCombo);if(l)a=ni.COMBO_CONTAINER;else{a=ci(e)?ni.SHAPES:ni.NODES;o.push(e.bg?ni.BG:ni.FG)}d&&!u.hasPath(o)&&u.createItemLayersAt(o);u.setLayerPath(o);u.setLayer(a);m(s,u,e,t,I)}function R(e){var i,a,o,f,l=[],v=e.parentId&&(e._combo||t[e.parentId]),p=r[e.parentId];I.isInBackground=e.bg;I.isSelected=c(e.id);I.isInCombo=!!e.parentId;I.isRevealed=h.has(e.id)||g(e.id)||C.has(e.parentId);if(!I.isRevealed)if(f=S(e,!0)){l.push(ni.TRANSIENT);I.isTransient=!0}else I.isTransient=!1;u.startGeneratingFor(e,E,I.isInCombo);i=t[e.id1];a=t[e.id2];if(I.isRevealed){i=n.privateFirstVisibleItemInAncestry(e.id1);a=n.privateFirstVisibleItemInAncestry(e.id2);if(!i||!a||i===a&&i!==t[e.id1])return;l.push(ni.REVEALED)}if(v){for(var m=n.privateGetAncestryIds(e.id,!0),b=[],x=p?2:1,w=0;w<m.length-x;w++){var A=m[w];b.push(u.createComboSegment(A));if(!f){var M=t[A];o||I.isRevealed||(o=M&&M._combo&&S(M));o&&l.unshift(ni.TRANSIENT)}}I.isParentTransient=o;if(b.length>0){l.push(ni.COMBOS);l=l.concat(b);u.hasPath(l)||u.createItemLayersAt(l)}else l.push(ni.MAIN)}else l.push(ni.MAIN);l.push(e.bg?ni.BG:ni.FG);u.setLayerPath(l);u.setLayer(ni.LINKS);d(s,u,e,t,i,a,y,I)}f.stillDirty=null;f.easingValue=e.atanEasing(Date.now()%1e3/1e3);f.unzoom=l.getUnzoom();if(i){u.removeAllItems();M=Object.keys(t);A=Object.keys(r);for(x=0,w=M.length;x<w;x++)T(t[M[x]]);for(x=0,w=A.length;x<w;x++)R(r[A[x]])}else{var L=[],B=function(e,n){var i=t[n];if(i)if(i.parentId||i._combo)T(i);else if(e===pi.MOVED){if(i.parentId){var a=p(i,t);i._sx=a.x;i._sy=a.y}else{i._sx=i.x;i._sy=i.y}u.moveItem(i,i.x,i.y)}else{E=!1;T(i)}else if(r[n])L.push(n);else{E=!1;u.removeItem(n)}};o.forEach(B);if(a)for(x=0,w=(A=Object.keys(r)).length;x<w;x++)R(r[A[x]]);else{var Z=function(e){R(r[e])};L.forEach(Z)}}return{stillDirty:f.stillDirty,rebuildAll:f.useSlowPathRendering||!E}};r.generateHandles=function(e,t,n,r){var i=e.getLayerPath();e.setLayerPath(null);e.startGeneratingForExtras();e.setLayer(ni.HANDLES);if(f.resizeRect&&1===r.size){kn(e,t,n,f.resizeRect,1,f.resizeRect.id,l(),a);kn(e,t,n,f.resizeRect,4,f.resizeRect.id,Ot.transparent,a)}e.setLayerPath(i)};return r}function Ua(e){var n={primitiveMover:function(n,r,i,a,o,u,s,f,l,c,d){if(!e.trigger("dragstart","resize",a,f,l,null)){var h=n.extents(r,o),v=o.r,g={},p={};t(o,function(e,t){p[t]=e});b();qt(p,.5);return{rebuild:{all:!0},animate:void 0,scrollable:!0,getCursor:function(){return u?"crosshair":"move"},generate:function(e){e.copyPrimitive(p)},dragMove:function(e,t,n,r){A(p,e,t,n,r)},endDrag:function(t,n,r,u,s){i.cancelScroll();var f=e.trigger("dragend","resize",a,n,r);x();if(!f&&t){A(o,n,r,u,s);d(o)}e.trigger("dragcomplete","resize",a,n,r)}}}function m(e,t){return{dx:i.viewToWorldDistance(e-f),dy:i.viewToWorldDistance(t-l)}}function y(e,t,n,r){var i,a={},o=e,u=t;if(s.length>0||c){a.x1=0;a.x2=0;a.y1=0;a.y2=0;for(var f=0;f<s.length;f++){var l="x"===(i=s[f]).charAt(0)?o:u;a[i]=l}if(n||c){0!==a.x1&&(a.x2=-a.x1);0!==a.x2&&(a.x1=-a.x2);0!==a.y1&&(a.y2=-a.y1);0!==a.y2&&(a.y1=-a.y2)}}else{r&&(u=0!==(o=Math.abs(o)>Math.abs(u)?o:0)?0:u);a.x1=o;a.x2=o;a.y1=u;a.y2=u}for(var d={},v=["x1","y1","x2","y2"],g=0;g<v.length;g++)d[i=v[g]]=h[i]+a[i];if(r){var p=h.x2-h.x1,m=h.y2-h.y1;if(Math.abs(p)>0&&Math.abs(m)>0){var y,b=m/p,x=d.x2-d.x1,w=d.y2-d.y1;if(Math.abs(o)>Math.abs(u)){var A=Math.floor(b*(p+x)-m)-w;if(c||n||!Y(s,"y1")&&!Y(s,"y2")){y=Math.floor(A/2);d.y1-=y;d.y2+=y}else{Y(s,"y1")&&(d.y1-=A);Y(s,"y2")&&(d.y2+=A)}}else{var M=Math.floor((m+w)/b-p)-x;if(c||n||!Y(s,"x1")&&!Y(s,"x2")){y=Math.floor(M/2);d.x1-=y;d.x2+=y}else{Y(s,"x1")&&(d.x1-=M);Y(s,"x2")&&(d.x2+=M)}}}}return d}function b(){p.wc&&(g.c=p.wc[3]);p.wfc&&(g.fc=p.wfc[3]);p.wbc&&(g.bc=p.wbc[3])}function x(){p.wc&&(p.wc[3]=g.c);p.wfc&&(p.wfc[3]=g.fc);p.wbc&&(p.wbc[3]=g.bc)}function w(e,t,n){return"1"===n.charAt(1)?v-("x"===n.charAt(0)?e:t):v+("y"===n.charAt(0)?t:e)}function A(e,t,r,i,a){var u,f=m(t,r);if("C"===o.p)if(s.length>1){var l=w(f.dx,f.dy,s[0]),c=w(f.dx,f.dy,s[1]);u=Math.abs(Math.min(l,c))}else u=Math.abs(w(f.dx,f.dy,s[0]));var d=y(f.dx,f.dy,i,a);n.setExtents(e,d.x1,d.y1,d.x2,d.y2,u)}},createHandDragger:function(n,r,i,a){var o={x:!0,y:!0},u=n.offsetX(),s=n.offsetY(),f=0,l=0,c=!1,d="hand",h=e.trigger("dragstart",d,null,r,i);if(h){if(!x(h)){a();return}t(h,function(e,t){o[t]=e})}function v(e,t){c=c||Math.abs(r-e)>10||Math.abs(i-t)>10;f=e-r;l=t-i;if(o){o.x||(f=0);o.y||(l=0)}}function g(){if(c){n.offsetX(u+f);n.offsetY(s+l);e.trigger("viewchange")}}return{rebuild:{drawOnly:!0},animate:g,direction:o,dragMove:v,getCursor:function(){return"move"},endDrag:function(t,n,r){var i=e.trigger("dragend",d,null,n,r);if(c){if(!i&&t)v(n,r);else{f=0;l=0}g()}else a();e.trigger("dragcomplete",d,null,n,r)}}},createMapDragger:function(t,n,r,i){var a=n?"move":"hand",o=z(n);e.trigger("dragstart",a,o,r,i,V(n));return{rebuild:void 0,animate:void 0,direction:{},dragMove:function(){},getCursor:function(){return"move"},endDrag:function(t,n,r){e.trigger("dragend",a,o,n,r);e.trigger("dragcomplete",a,o,n,r)}}},createDefaultDragger:function(n,r,i,a,o,u,s,f,l){var c={x:!0,y:!0,add:null,combos:!0},d=z(s),h=r[d],v="move",g=e.trigger("dragstart",v,d,f,l,V(s));if(g)if(Array.isArray(g))c.add=U(g);else{if(!x(g))return;t(g,function(e,t){c[t]=e});Array.isArray(c.add)&&(c.add=U(c.add))}if(c.combos){var p=o();if(p.length){c.add=c.add||{};p.forEach(function(e){c.add[e]=1})}}function m(e){return c.add&&c.add[e]}var y,b=u?u.viewToWorldX(f):f,w=u?u.viewToWorldY(l):l,A=Object.keys(r),M=B(f,l),I={x:0,y:0},E=!0;h&&(y=h.w&&h.h);function C(){var e=M.dx-I.x,t=M.dy-I.y;I.x=M.dx;I.y=M.dy;var r=A.filter(function(e){return e!==d&&(a(e)||m(e))});a(d)&&(y?r.unshift(d):r.push(d));n.moveAllNodesBy(r,e,t);if(E){E=!1;n.setDirty(d)}n.drawInTransientLayer(r)}function k(){var e=A.filter(function(e){return a(e)||m(e)});n.moveAllNodesBy(e,-I.x,-I.y)}var S,T,R=!1,L=!1;function B(e,t){R=R||Math.abs(f-e)>10||Math.abs(l-t)>10;var n=u?u.viewToWorldX(e):e,r=u?u.viewToWorldY(t):t;if(c){c.x||(n=b);c.y||(r=w)}return{dx:R?n-b:0,dy:R?r-w:0}}return{rebuild:{positions:!0},scrollable:!0,direction:c,animate:C,generate:function(t){R&&t.setHitTesting(d,!1);if(R&&!L){L=!0;e.privateTrigger("redraw",{all:!0})}},getCursor:function(){return"move"},dragMove:function(e,t){M=B(e,t)},mouseMoved:function(e){e&&(S=!0);return S},afterDraw:function(t,n,r){S=!1;var i=z(t);if(d!==i)if(void 0===T)T=i;else if(i!==T){e.trigger("dragover",i,n,r,V(t));T=i}},endDrag:function(t,r,i,a,o,f){u.cancelScroll();if(e.trigger("dragend",v,z(s),r,i))k();else if(t&&R){k();M=B(r,i);I={x:0,y:0};e.trigger("prechange","move");C()}else k();f.setHitTesting(d,!0);n.setDirty(d);c.add&&Object.keys(c.add).forEach(n.setDirty);e.trigger("dragcomplete",v,z(s),r,i)}}},createLinkEndDragger:function(t,n,r,i,a,u,s,f,l){if(e.trigger("dragstart","dummy",l,s,f,null))return!1;var c=r?r.viewToWorldX(s):s,d=r?r.viewToWorldY(f):f,h=i[a[u]].x,v=i[a[u]].y;function g(e,t){n.moveNode(a[u],e,t)}var p,m,y=x(s,f),b=null;function x(e,t){var n=r?r.viewToWorldX(e):e,i=r?r.viewToWorldY(t):t;return{dx:n-c,dy:i-d}}function w(){return a["id1"===u?"id2":"id1"]}return{rebuild:{all:!0},scrollable:!0,animate:function(){g(h+y.dx,v+y.dy)},getCursor:function(){return"move"},dragMove:function(e,n){y=x(e,n);b=t.hittest(e,n,r)},mouseMoved:function(e){e&&(m=!0);return m},afterDraw:function(t,n,r){m=!1;var i=z(t),a=V(t);if(l===i){i=null;a=null}if(void 0===p)p=i;else if(i!==p){e.trigger("dragover",i,n,r,a);p=i}},endDrag:function(s,f,l){r.cancelScroll();if(!e.trigger("dragend","dummy",b,f,l))if(s){g(h,v);e.trigger("prechange","move");b=z(b);if(i[b]&&b!==w()){var c=o(a);c[u]=b;delete c.off;n.removeItem([a[u],a.id]);t.merge([c])}else{y=x(f,l);g(h+y.dx,v+y.dy);b=null}}else g(h,v);e.trigger("dragcomplete","dummy",b,f,l)}}},createLinkDragger:function(n,r,i,a,o,u,s,f){if(e.trigger("dragstart","offset",f,u,s,V(f)))return!1;function l(e,t,n,r,i,a){return((n-e)*(t-a)-(e-i)*(r-t))/Math.sqrt((n-e)*(n-e)+(r-t)*(r-t))}var c={},d={},h={};a.privateSelection().forEach(function(e,t){if(t){var n=a.getByID(t);if(n&&"link"===n.type){c[t]=n.off||0;d[t]=n.off||0;h[t]=!0}}});var v=!1;function g(e,t,r){var a=e===o,u=a?i.viewToWorldX(t):t,s=a?i.viewToWorldY(r):r,f=n(1,e),v=n(2,e),g=l(f.x,f.y,v.x,v.y,u,s);h[e.id]&&Math.abs(g-c[e.id])>8&&(h[e.id]=!1);if(!h[e.id]){Math.abs(a?g:g+c[e.id])<12&&(g=a?0:-c[e.id]);d[e.id]=a?g:g+c[e.id]}}function p(e){a.setLinkOffset(e,d[e])}return{rebuild:{all:!0},scrollable:!0,animate:function(){t(d,function(e,t){p(t)})},getCursor:function(){return"move"},dragMove:function(e,r){var f=i.viewToWorldX(e)-i.viewToWorldX(u),l=i.viewToWorldY(r)-i.viewToWorldY(s);t(d,function(t,i){var u=a.getByID(i);if(u)if(u===o){g(u,e,r);v=!0}else{var s=n(1,u),c=n(2,u),d=(s.x+c.x)/2,h=(s.y+c.y)/2;g(u,d+f,h+l)}})},endDrag:function(n,r,o){i.cancelScroll();if(!e.trigger("dragend","offset",f,r,o)&&a.getByID(f))if(n&&v){t(c,function(e,t){a.getByID(t).off=e});e.trigger("prechange","offset");t(d,function(e,t){a.getByID(t).off=e})}else{t(d,function(e,t){d[t]=c[t]});this.animate()}e.trigger("dragcomplete","offset",f,r,o)}}}};return n}function Na(e,t,n){}var ja,_a=1e-6;function Ha(e){return"number"==typeof e&&isFinite(e)}function Ka(e){return Ha(e)&&(0|e)===e}function Qa(e,t){return Math.sqrt(e*e+t*t)}function Ja(e,t,n,r){return Qa(e-n,t-r)}function qa(e,t,n){return e<t?t:e>n?n:e}function $a(e,t,n){return n*e+(1-n)*t}function eo(e,t,n,r,i,a,o){var u=1+Math.pow(a*Math.E,-r*(o-n));return e+(t-e)/Math.pow(u,1/i)}!function(e){e.randMax=2147483647;function t(t){void 0===t&&(t=1);var n=Math.round(t)%e.randMax,r=48271,i=e.randMax/r,a=e.randMax%r;return function(){var t=r*(n%i|0)-a*(n/i|0);return(n=t>0?t:t+e.randMax)-1}}e.createPRNGi32=t;function n(n,r,i){void 0===n&&(n=1);void 0===r&&(r=0);void 0===i&&(i=1);var a=i-r,o=t(n);return function(){return r+a*(o()/e.randMax)}}e.createPRNG=n;function r(e,t,n){void 0===e&&(e=0);void 0===t&&(t=1);void 0===n&&(n=Math.random);var r=-1,i=!1;return function(){if(i){i=!1;return e+t*r}var a,o,u;do{u=(a=2*n()-1)*a+(o=2*n()-1)*o}while(u>=1||0===u);var s=Math.sqrt(-2*Math.log(u)/u);r=o*s;i=!0;return e+t*a*s}}e.createGaussianRNG=r}(ja||(ja={}));var to;function no(e,t){Object.setPrototypeOf(e,t);function n(){this.constructor=e}if(null!==t){n.prototype=t.prototype;e.prototype=new n}else e.prototype=Object.create(e)}!function(e){function t(e){return 0===e.size||(0|e.begin)===e.begin&&(0|e.end)===e.end&&e.end>=e.begin&&e.end-e.begin+1===e.size}e.isContiguous=t;function n(e,t){return e.size>0&&e.begin<=t&&e.end>=t}e.isWithin=n;function r(e){if(!t(e))throw new Error("non-contiguous Keyspace")}e.ensureContiguous=r;function i(e){return e>0?{size:e,begin:0,end:e-1}:{size:e,begin:-1,end:-1}}e.fromSize=i}(to||(to={}));function ro(e,t,n){for(var r in t)void 0===e[r]?e[r]=t[r]:n&&"object"==typeof e[r]&&!Array.isArray(e[r])&&ro(e[r],t[r])}function io(){return{next:function(){return vo},size:0}}function ao(e){var t={value:e,done:!1};return{next:function(){var e=t;t=vo;return e},size:1}}function oo(e,t){var n,r={done:!1,value:null},i={size:0,next:function(){n=e.next();r.done=n.done;n.done||(r.value=t(n.value));return r}};"size"in e&&(i.size=e.size);return i}function uo(e,t){for(var n=0,r=e.next();!r.done;){t(r.value,n);e.next();n++}}function so(e){to.ensureContiguous(e);if(e.size<=0)return io();var t={value:e.begin-1,done:!1};return{size:e.size,next:function(){++t.value>e.end&&(t.done=!0);return t}}}function fo(e,t){var n={done:0===e.length,value:null,i:-1};return{size:e.length,next:function(){n.i++;n.i<e.length&&(n.value=t?t(e[n.i],n.i):e[n.i]);n.done=n.i>=e.length;return n}}}function lo(e,t){void 0===t&&(t=[]);for(var n=e.next();!n.done;){t.push(n.value);n=e.next()}return t}function co(e,t){var n={done:t<1,value:null,i:-1};return{size:t,next:function(){n.i++;if(n.i<t){var r=e.next().value;n.value=r}n.done=n.i>=t;return n}}}function ho(e,t,n){void 0===n&&(n=[0,0]);if(e===t)return io();var r=e,i=e,a={value:n,done:!1};return{size:(t-e+1)*(t-e)/2,next:function(){i===t?i=++r+1:i++;if(r===t)a.done=!0;else{a.value[0]=r;a.value[1]=i}return a}}}var vo={value:null,done:!0},go=Object.freeze({empty:io,single:ao,map:oo,forEach:uo,fromKeySpace:so,fromArray:fo,toArray:lo,firstn:co,allPairs:ho});function po(e){return e.buffer&&e.buffer instanceof ArrayBuffer}function mo(e,t){for(var n=0;n<e.length;n++)e[n]=t}function yo(e,t){return e<t}function bo(e,t,n){var r=e[t];e[t]=e[n];e[n]=r}function xo(e,t,n,r,i){void 0===n&&(n=yo);void 0===r&&(r=0);void 0===i&&(i=e.length-r);for(var a,o=0;i>0;){a=0|r;if(n(e[a+=o=i/2|0],t)){r=++a;i-=o+1}else i=o}return r}function wo(e,t){void 0===t&&(t=0);for(var n=t,r=0,i=e.length;r<i;r++)e[r]=n++}function Ao(e,t){for(var n=0;n<t.length;n++)if(t[n]<0)t[n]=~t[n];else for(var r=n,i=t[n];i!==n;){bo(e,r,i);i=t[r=i];t[r]=~i}}function Mo(e,t){void 0===t&&(t=Math.random);for(var n=e.length;0!==n;){bo(e,--n,Math.round(n*t()))}}var Io,Eo,Co=function(){function e(e,t,n,r,i,a){void 0===r&&(r=Io.sizeFromShape(e));void 0===i&&(i=0);void 0===a&&(a=Io.computeStrides(e));this.shape=e;this.dtype=t;this.values=n;this.size=r;this.offset=i;this.strides=a;this.rank=this.shape.length;this.lastIndex=Io.lastIndex(this);this.contiguous=this.lastIndex-i==r-1}e.prototype.getNextIndex=function(e){if(e<0)return this.offset;var t=e+this.strides[this.rank-1];return t>this.lastIndex?-1:t};return e}(),ko=function(e){no(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.rankType=0;return t}t.prototype.get=function(){return this.values[this.index()]};t.prototype.set=function(e){return this.values[this.index()]=e};t.prototype.index=function(){return 0|this.offset};return t}(Co),So=function(e){no(t,e);function t(t,n,r,i,a,o){var u=e.call(this,t,n,r,i,a,o)||this;u.rankType=1;u.stride0=u.strides[0];return u}t.prototype.get=function(e){return this.values[this.index(e)]};t.prototype.set=function(e,t){return this.values[this.index(t)]=e};t.prototype.index=function(e){return this.offset+e*this.stride0|0};return t}(Co),To=function(e){no(t,e);function t(t,n,r,i,a,o){var u=e.call(this,t,n,r,i,a,o)||this;u.rankType=2;u.stride0=u.strides[0];u.stride1=u.strides[1];return u}t.prototype.get=function(e,t){return this.values[this.index(e,t)]};t.prototype.set=function(e,t,n){return this.values[this.index(t,n)]=e};t.prototype.index=function(e,t){return this.offset+e*this.stride0+t*this.stride1|0};return t}(Co),Ro=function(e){no(t,e);function t(t,n,r,i,a,o){var u=e.call(this,t,n,r,i,a,o)||this;u.rankType=3;u.stride0=u.strides[0];u.stride1=u.strides[1];u.stride2=u.strides[2];return u}t.prototype.get=function(e,t,n){return this.values[this.index(e,t,n)]};t.prototype.set=function(e,t,n,r){return this.values[this.index(t,n,r)]=e};t.prototype.index=function(e,t,n){return this.offset+e*this.stride0+t*this.stride1+n*this.stride2|0};return t}(Co);function Lo(e,t,n){null==t&&(t=Io.inferShape(e));null==n&&(n=Io.inferDType(e,"f32"));var r=po(e)||Array.isArray(e)?e:[e],i=Io.asTypedArray(r,n),a=Io.getViewCtor(t.length);Na(Io.sizeFromShape(t),i.length);return new a(t,n,i)}function Bo(e,t,n){void 0===t&&(t="f32");var r=Io.sizeFromShape(e),i=Zo(t,r,n);return new(Io.getViewCtor(e.length))(e,t,i,r)}function Zo(e,t,n){var r;switch(e){case"f32":r=new Float32Array(t);break;case"i32":r=new Int32Array(t);break;case"bool":r=new Uint8Array(t);break;default:Io.throwUnknownDType(e)}void 0!==n&&mo(r,n);return r}function Oo(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=[],i=[],a=e.offset,o=0,u=t.length;o<u;o++){var s=e.strides[o];if(Ka(t[o]))a+=s*t[o];else{i.push(e.shape[o]);r.push(s)}}return new(Io.getViewCtor(i.length))(i,e.dtype,e.values,Io.sizeFromShape(i),a,r)}function Go(e,t){void 0===t&&(t=0);for(var n=e.rank,r=e.shape,i=new Array(n),a=0;a<n;a++)i[a]="all";var o=[];for(a=0;a<r[t];a++){i[t]=a;var u=[e].concat(i);o.push(Oo.apply(null,u))}return o}function Fo(e,t){void 0===t&&(t=[]);for(var n=Number.MAX_VALUE,r=Number.MIN_VALUE,i=-1,a=e.values;(i=e.getNextIndex(i))>=0;){a[i]>r&&(r=a[i]);a[i]<n&&(n=a[i])}t[0]=n;t[1]=r;return t}!function(e){function t(e){switch(e){case 0:return ko;case 1:return So;case 2:return To;case 3:return Ro}throw new Error(e+" views not implemented")}e.getViewCtor=t;function n(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}e.sizeFromShape=n;function r(e){for(var t=e.rank,n=e.offset,r=0;r<t;r++)n+=e.strides[r]*(e.shape[r]-1);return n}e.lastIndex=r;function i(e){throw new Error("Unknown data type "+e)}e.throwUnknownDType=i;function a(e,t){void 0===t&&(t=[]);if(Array.isArray(e))for(var n=0,r=e;n<r.length;n++){a(r[n],t)}else t.push(e);return t}function o(e){var t=e.length,n=new Array(t);n[t-1]=1;for(var r=t-2;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}e.computeStrides=o;function u(e){if(po(e))return[e.length];if(!Array.isArray(e))return[];for(var t=[];e instanceof Array;){t.push(e.length);e=e[0]}return t}e.inferShape=u;function s(e,t){return e instanceof Float32Array?"f32":e instanceof Int32Array?"i32":e instanceof Uint32Array?"bool":t}e.inferDType=s;function f(e,t){if(s(e)===t)return e;Array.isArray(e)&&(e=a(e));return l(e,t)}e.asTypedArray=f;function l(e,t){switch(t){case"f32":return new Float32Array(e);case"i32":return new Int32Array(e);case"bool":return new Uint8Array(e)}i(t);return null}e.copyToTypedArray=l}(Io||(Io={}));!function(e){function t(e){return a(e.tl.x,e.br.x,e.tl.y,e.br.y)}e.copy=t;function n(e,t){t.tl.x=e.tl.x;t.tl.y=e.tl.y;t.br.x=e.br.x;t.br.y=e.br.y}e.copyTo=n;function r(e){return e.br.x-e.tl.x}e.width=r;function i(e){return e.br.y-e.tl.y}e.height=i;function a(e,t,n,r){if(e>t){var i=t;t=e;e=i}if(n>r){i=r;r=n;n=i}return{tl:{x:e,y:n},br:{x:t,y:r}}}e.create=a;function o(e,t){void 0===t&&(t={x:0,y:0});t.x=e.tl.x+.5*(e.br.x-e.tl.x);t.y=e.tl.y+.5*(e.br.y-e.tl.y);return t}e.center=o;function u(e,t){return e.tl.x===t.tl.x&&e.tl.y===t.tl.y&&e.br.x===t.br.x&&e.br.y===t.br.y}e.equals=u;function s(e,t,n,r){return!(t+r>e.br.x||t-r<e.tl.x||n+r>e.br.y||n-r<e.tl.y)}e.contains=s;function f(e,t){return s(e,t.x,t.y,0)}e.containsPoint=f;function l(e,t){return e.tl.x<t.br.x&&e.br.x>t.tl.x&&e.tl.y<t.br.y&&e.br.y>t.tl.y}e.intersects=l;function c(e,t){return a(Math.min(e.tl.x,t.tl.x),Math.max(e.br.x,t.br.x),Math.min(e.tl.y,t.tl.y),Math.max(e.br.y,t.br.y))}e.union=c}(Eo||(Eo={}));var Do=function(){function e(e,t,n){this.parentIdx=e;this.beginIdx=t;this.endIdx=n;this.childIndices=null}return e}();function zo(e,t){if(null!==e.childIndices)for(;t<=3;t++)if(e.childIndices[t]>=0)return t;return-1}function Vo(e,t,n,r,i){var a=r-n+1;return a<=0?-1:1===a?t[e[n]]<=i?n:-1:xo(e,i,function(e,n){return t[e]<=n},n,a)-1}var Yo=new Uint32Array([1431655765,858993459,252645135,16711935]);function Po(e,t){e=((e=((e=((e=(e|e<<8)&Yo[3])|e<<4)&Yo[2])|e<<2)&Yo[1])|e<<1)&Yo[0];t=((t=((t=((t=(t|t<<8)&Yo[3])|t<<4)&Yo[2])|t<<2)&Yo[1])|t<<1)&Yo[0];return(e|(t<<=1))>>>0}var Wo=function(){function e(e,t){void 0===t&&(t=2);this.maxDepth=e;this.splitThreshold=t;this.zorder=null;this.tree=null;this.N=0;this.aabb=null}e.prototype.build=function(t,n,r){var i=t.size,a=this.zorder;this.maxDepth=void 0!==this.maxDepth?this.maxDepth:Math.min(e.MAX_DEPTH,Math.max(1,Math.ceil(Math.log(i+1))));if(!Ka(this.maxDepth)||this.maxDepth<1||this.maxDepth>e.MAX_DEPTH)throw new Error("Bad maxDepth "+this.maxDepth);if(void 0!==r)this.aabb=Eo.copy(r);else{var o=Fo(t),u=o[0],s=o[1],f=Fo(n),l=f[0],c=f[1];this.aabb=r=Eo.create(u,s,l,c)}null!==a&&a.length===i||wo(a=this.zorder=new Int32Array(i));for(var d=Eo.width(r),h=Eo.height(r),v=new Uint32Array(i),g=d>0?65535/d:0,p=h>0?65535/h:0,m=r.tl.x,y=r.tl.y,b=function(e,t){return Po((e-m)*g>>>0,(t-y)*p>>>0)},x=0;x<i;){var w=a[x],A=t.get(w),M=n.get(w);if(Eo.contains(r,A,M,0)){v[w]=b(A,M);x++}else bo(a,x,--i)}this.N=i;var I=a.subarray(0,this.N);Array.prototype.sort.call(I,function(e,t){return v[e]-v[t]});this.buildTree(r,I,v,this.maxDepth,this.splitThreshold,b)};e.prototype.buildTree=function(t,n,r,i,a,o){for(var u=new Xo(t),s=n.length,f=this.tree=[new Do(-1,0,s-1)],l={x:0,y:0},c=0;c>=0;){var d=f[c],h=-1;if(null===d.childIndices&&d.endIdx-d.beginIdx>=a-1&&u.depth<i){d.childIndices=[-1,-1,-1,-1];Eo.center(u,l);var v=o(l.x,l.y),g=o(u.br.x,l.y),p=o(l.x,u.br.y),m=d.beginIdx,y=d.endIdx,b=Vo(n,r,m,y,v);if(b>=m){d.childIndices[0]=f.push(new Do(c,m,b))-1;m=b+1}var x=Vo(n,r,m,y,g);if(x>=m){d.childIndices[1]=f.push(new Do(c,m,x))-1;m=x+1}var w=Vo(n,r,m,y,p);if(w>=m){d.childIndices[2]=f.push(new Do(c,m,w))-1;m=w+1}y>=m&&(d.childIndices[3]=f.push(new Do(c,m,y))-1)}else h=u.currentQuad;c=e.nextDFS(f,u,c,h+1)}};e.prototype.traverse=function(){if(null===this.tree||0===this.tree.length)return io();var t=this.tree,n=new Xo(this.aabb),r=0,i={value:null,done:!1};function a(){if(r>=0){var a=t[r];i.value={id:r,aabb:Eo.copy(n),count:a.endIdx-a.beginIdx+1};r=e.nextDFS(t,n,r,0)}else i.done=!0;return i}return{next:a,size:t.length}};e.nextDFS=function(e,t,n,r){var i=e[n];if(-1===(r=zo(i,r))){for(;i.parentIdx>=0&&-1===(r=zo(i=e[i.parentIdx],t.pop()+1)););if(-1===r)return-1}t.descend(r);return i.childIndices[r]};e.MAX_DEPTH=15;return e}(),Xo=function(){function e(e){this.tl={x:0,y:0};this.br={x:0,y:0};this.quadrants=new Int32Array(Wo.MAX_DEPTH);this.quadrants[0]=-1;this.reset(e)}Object.defineProperty(e.prototype,"currentQuad",{get:function(){return this.quadrants[this.depth]},enumerable:!0,configurable:!0});e.prototype.reset=function(e){Eo.copyTo(e,this);this.depth=0;this.w=Eo.width(e);this.h=Eo.height(e);this.longestSide=Math.max(this.w,this.h)};e.prototype.descend=function(e){this.w*=.5;this.h*=.5;this.longestSide*=.5;this.quadrants[++this.depth]=e;this.resize(e,this.w,this.h)};e.prototype.pop=function(){var e=this.quadrants[this.depth--];this.resize(e,-this.w,-this.h);this.w*=2;this.h*=2;this.longestSide*=2;return e};e.prototype.resize=function(e,t,n){var r=this,i=r.tl,a=r.br;switch(0|e){case 0:a.x-=t;a.y-=n;break;case 1:i.x+=t;a.y-=n;break;case 2:a.x-=t;i.y+=n;break;case 3:i.x+=t;i.y+=n}};return e}();function Uo(e,t,n){return e>=t&&e<=n}var No=function(e){no(t,e);function t(t,n,r){void 0===t&&(t="f32");var i=e.call(this,n,r)||this;i.dtype=t;i.outboundExpansions=null;return i}t.prototype.buildXYM=function(e,t,n,r){var i=r.length;if(void 0===this.zxs||this.zxs.length<i){this.zxs=Zo(this.dtype,i);this.zys=Zo(this.dtype,i);this.zms=Zo(this.dtype,i)}for(var a=this,o=a.zxs,u=a.zys,s=a.zms,f=0;f<i;f++){var l=r[f];o[f]=e.get(l);u[f]=t.get(l);s[f]=n.get(l)}this.index=r};t.prototype.build=function(t,n,r,i){e.prototype.build.call(this,t,n,r);this.buildXYM(t,n,i,this.zorder);this.computeExpansions()};t.prototype.buildSubset=function(t,n,r,i,a){this.buildXYM(n,r,a,t);e.prototype.build.call(this,Lo(this.zxs),Lo(this.zys),i);var o=this.zorder;Ao(this.zxs,o);Ao(this.zys,o);Ao(this.zms,o);Ao(t,o);this.computeExpansions()};t.prototype.computeExpansions=function(){for(var e=this,t=e.tree,n=e.N,r=e.zxs,i=e.zys,a=e.zms,o=this.outboundExpansions=Bo([t.length,3],this.dtype),u=o.values,s=t.length-1,f=n;f>0&&s>=0;s--){var l=t[s];if(null===l.childIndices){for(var c=0,d=0,h=0,v=l.endIdx;v>=l.beginIdx;v--){var g=a[v];d+=r[v]*g;h+=i[v]*g;c+=g;f--}for(var p=s;p>=0;){u[m=o.index(p,0)]+=c;u[m+1]+=d;u[m+2]+=h;l=t[p=l.parentIdx]}}}for(s=t.length-1;s>=0;s--){var m;g=1/u[m=o.index(s,0)];u[m+1]*=g;u[m+2]*=g}};t.prototype.runOnPoint=function(e,t,n,r,i,a){void 0===a&&(a=.5);null!==this.outboundExpansions&&0!==this.outboundExpansions.size&&this.runOnPointInternal(e,t,n,r,new Xo(this.aabb),i,a,-1)};t.prototype.runOnPoints=function(e,t,n,r){void 0===r&&(r=.5);if(null!==this.outboundExpansions&&0!==this.outboundExpansions.size)for(var i=new Xo(this.aabb),a=[0,0],o=this,u=o.zxs,s=o.zys,f=o.zms,l=o.N,c=o.index,d=t.values,h=n.values,v=0;v<l;v++){i.reset(this.aabb);a[0]=0;a[1]=0;this.runOnPointInternal(e,u[v],s[v],f[v],i,a,r,v);var g=c[v];d[t.index(g)]+=a[0];h[n.index(g)]+=a[1]}};t.prototype.runOnPointInternal=function(e,t,n,r,i,a,o,u){for(var s=this,f=s.tree,l=s.zxs,c=s.zys,d=s.zms,h=this.outboundExpansions,v=u>=0?d[u]:0,g=0,p=0;g>=0;){var m=f[g],y=h.get(g,1),b=h.get(g,2),x=Ja(t,n,y,b),w=m.beginIdx,A=m.endIdx;if(i.longestSide/x<o){e(t,n,r,y,b,h.get(g,0)-(Uo(u,w,A)?v:0),a)}else{if((p=zo(m,0))>=0){i.descend(p);g=m.childIndices[p];continue}for(;w<=A;){w!==u&&e(t,n,r,l[w],c[w],d[w],a);w++}}g=Wo.nextDFS(f,i,g,4)}};t.prototype.traverse=function(){var t=this.outboundExpansions;return oo(e.prototype.traverse.call(this),function(e){e.mass=t.get(e.id,0);e.x=t.get(e.id,1);e.y=t.get(e.id,2);return e})};return t}(Wo),jo=Object.freeze({BarnesHut:No});function _o(e,t){var n=Fo(e),r=n[0],i=n[1],a=Fo(t),o=a[0],u=i-r,s=a[1]-o,f=Math.max(u,s),l=r+.5*u,c=o+.5*s;return[{x:l-1e3*f,y:c-f,r:.1},{x:l,y:c+1e3*f,r:.1},{x:l+1e3*f,y:c-f,r:.1}]}function Ho(e,t,n){var r,i,a,o,u,s,f,l,c=Math.abs(e.y-t.y),d=Math.abs(t.y-n.y);if(c<_a&&d<_a)return null;if(c<_a){o=-(n.x-t.x)/(n.y-t.y);s=.5*(t.x+n.x);l=.5*(t.y+n.y);i=o*((r=.5*(t.x+e.x))-s)+l}else if(d<_a){a=-(t.x-e.x)/(t.y-e.y);u=.5*(e.x+t.x);f=.5*(e.y+t.y);i=a*((r=.5*(n.x+t.x))-u)+f}else{a=-(t.x-e.x)/(t.y-e.y);o=-(n.x-t.x)/(n.y-t.y);u=.5*(e.x+t.x);s=.5*(t.x+n.x);f=.5*(e.y+t.y);r=(a*u-o*s+(l=.5*(t.y+n.y))-f)/(a-o);i=c>d?a*(r-u)+f:o*(r-s)+l}var h=t.x-r,v=t.y-i;return{x:r,y:i,rSq:h*h+v*v}}function Ko(e,t,n,r,i,a){var o=Ho(r<0?e[~r]:{x:t.get(r),y:n.get(r)},i<0?e[~i]:{x:t.get(i),y:n.get(i)},a<0?e[~a]:{x:t.get(a),y:n.get(a)});if(null!==o){o.adx=r;o.bdx=i;o.cdx=a}return o}function Qo(e){for(var t=e.length;t>0;)for(var n=e[--t],r=e[--t],i=t;i>0;){var a=e[--i],o=e[--i];if(r===o&&n===a||r===a&&n===o){e.splice(t,2);e.splice(i,2);break}}}function Jo(e,t,n,r,i,a,o){void 0===a&&(a=0);for(var u=e.size,s=n.size,f=Bo([2,s+u],"f32"),l=0,c=0;c<u;c++,l++){f.set(e.get(c),0,l);f.set(t.get(c),1,l)}for(var d=0;d<s;d++,l++){f.set(n.get(d),0,l);f.set(r.get(d),1,l)}l=i.length;var h=Go(f,0),v=qo(h[0],h[1],i,a,o);if(v>=0)return v;for(;l<i.length;){i[l]>=u&&(i[l]=~(i[l]-u));l++}return-1}function qo(e,t,n,r,i){void 0===r&&(r=0);void 0===i&&(i=Math.random);var a=n.length,o=-1;do{if((o=$o(e,t,n))>=0){if(r--<=0)break;n.length=a;e.set(e.get(o)+i(),o);t.set(t.get(o)+i(),o)}}while(o>=0);return o}function $o(e,t,n){var r=e.size;if(r<3)return-1;var i=new Int32Array(r);wo(i);Array.prototype.sort.call(i,function(t,n){return e.get(n)-e.get(t)});for(var a=_o(e,t),o=[Ko(a,e,t,-1,-2,-3)],u=[],s=[],f=i.length;f--;){s.length=0;for(var l=i[f],c=o.length;c--;){var d=o[c],h=d.x,v=d.y,g=d.rSq,p=d.adx,m=d.bdx,y=d.cdx,b=e.get(l)-h;if(b>0&&b*b>g){u.push(o[c]);o.splice(c,1)}else{var x=t.get(l)-v;if(!(b*b+x*x-g>_a)){s.push(p,m,m,y,y,p);o.splice(c,1)}}}Qo(s);for(var w=s.length;w;){var A=Ko(a,e,t,s[--w],s[--w],l);if(null===A)return l;o.push(A)}}for(f=o.length;f--;)u.push(o[f]);n.length=0;for(f=u.length;f--;)u[f].adx>=0&&u[f].bdx>=0&&u[f].cdx>=0&&n.push(u[f].adx,u[f].bdx,u[f].cdx);return 0===n.length?0:-1}var eu=Object.freeze({triangulateSteiner:Jo,triangulate:qo});function tu(e,t){var n=Ja(e.x,e.y,t.x,t.y);if(n>e.r+t.r+_a||0===e.r||0===t.r)return 0;if(n+e.r<t.r)return e.r*e.r*Math.PI;if(n+t.r<e.r)return t.r*t.r*Math.PI;var r=n*n,i=e.r*e.r,a=t.r*t.r,o=2*Math.acos((i+r-a)/(2*e.r*n)),u=2*Math.acos((a+r-i)/(2*t.r*n));return.5*u*a-.5*a*Math.sin(u)+(.5*o*i-.5*i*Math.sin(o))}function nu(e,t,n,r){var i=ru(e,t,n),a=ru(e,t,r),o=ru(n,r,e),u=ru(n,r,t);if(0===i&&0===a&&0===o&&0===u){var s=Eo.create(e.x,t.x,e.y,t.y),f=Eo.create(n.x,r.x,n.y,r.y);if(Eo.intersects(s,f))return 2}else if(i*a<=0&&o*u<=0)return 1;return 0}function ru(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)}function iu(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function au(e,t){var n=Ja(e.x,e.y,t.x,t.y);return n>_a?{x:(t.x-e.x)/n,y:(t.y-e.y)/n}:{x:0,y:0}}function ou(e,t){var n=Qa(e,t);return n>_a?{x:e/n,y:t/n}:{x:e,y:t}}function uu(e,t){return e.x*t.x+e.y*t.y}function su(e,t,n){var r=t,i=t+1,a=t+2;n.get(e[r])>n.get(e[i])&&bo(e,r,i);n.get(e[i])>n.get(e[a])&&bo(e,i,a);n.get(e[r])>n.get(e[i])&&bo(e,r,i)}function fu(e,t){var n=e[2*t],r=e[2*t+1];return n<r?[n,r]:[r,n]}function lu(e,t){Array.prototype.sort.call(t,function(t,n){var r=fu(e,t),i=r[0],a=r[1],o=fu(e,n),u=o[0],s=o[1];return i!==u?i-u:a-s});for(var n=0,r=0;r<t.length;){var i=t[r],a=fu(e,i),o=a[0],u=a[1];t[n]=t[r];for(var s=r+1;s<t.length;){var f=fu(e,t[s]),l=f[0],c=f[1];if(o!==l||u!==c)break;s++}r=s;n++}return n}var cu=function(){function e(e,t){void 0===e&&(e=0);void 0===t&&(t=Math.PI/2);this.padding=e;this.rotation=t}e.prototype.apply=function(e,t,n,r){var i=Math.PI,a=t.size,o=new Int32Array(a);wo(o);Array.prototype.sort.call(o,function(e,t){return r.get(t)-r.get(e)});var u=0,s=0,f=o[u];t.set(e.x,f);n.set(e.y,f);s+=r.get(f)+this.padding;u++;for(;u<a;){var l=r.get(o[u])+.5*this.padding;s+=l;if(u+this.sizeRing(o,u,r,s,i)>=a){this.positionRing(e,t,n,r,o,u,2,0,i,s);this.positionRing(e,t,n,r,o,u,1,2*i,2*i,s,-1);break}var c=0;c+=this.positionRing(e,t,n,r,o,u,2,0,i,s);u+=c+=this.positionRing(e,t,n,r,o,u,1,i,2*i,s);s+=l}};e.prototype.sizeRing=function(e,t,n,r,i){void 0===i&&(i=2*Math.PI);for(var a=0;t<e.length;){var o=e[t++];if((i-=2*(n.get(o)+.5*this.padding)/r)<0)break;a++}return a};e.prototype.positionRing=function(e,t,n,r,i,a,o,u,s,f,l){void 0===l&&(l=1);for(var c=this.rotation,d=0;a<i.length;){var h=i[a];if(h>=0){var v=l*((r.get(h)+.5*this.padding)/f);if(u+2*v>s)break;t.set(e.x+Math.sin(u+v+c)*f,h);n.set(e.y+Math.cos(u+v+c)*f,h);i[a]=-1;u+=2*v;d++}a+=o}return d};return e}(),du=function(){function e(e,t,n){void 0===e&&(e=0);void 0===t&&(t=0);this.padding=e;this.maxPerturbations=t;this.rng=n}e.prototype.build=function(e,t,n,r){var i=[],a=qo(t,n,i,this.maxPerturbations,this.rng)
;if(a>=0)return a;var o=this.buildSteinerPoints(i,t,n,r);if(o.size>0){var u=Go(o,1),s=u[0],f=u[1];i.length=0;if((a=Jo(t,n,s,f,i,this.maxPerturbations,this.rng))>=0)return a}for(var l=new Int32Array(2*i.length),c=0,d=0;d<l.length;){var h=i[c++],v=i[c++],g=i[c++];h<0&&(h=o.get(~h,2));v<0&&(v=o.get(~v,2));g<0&&(g=o.get(~g,2));l[d++]=h;l[d++]=v;l[d++]=v;l[d++]=g;l[d++]=g;l[d++]=h}var p=new Int32Array(i.length);wo(p);p=p.subarray(0,lu(l,p));Array.prototype.sort.call(p,function(r,i){var a=l[2*r],o=l[2*r+1],u=l[2*i],s=l[2*i+1];return Ja(.5*(t.get(a)+t.get(o)),.5*(n.get(a)+n.get(o)),e.x,e.y)-Ja(.5*(t.get(u)+t.get(s)),.5*(n.get(u)+n.get(s)),e.x,e.y)});this.constraints={pairs:l,triangles:i,steinerPoints:o,pairIndices:p};return-1};e.prototype.buildSteinerPoints=function(e,t,n,r){for(var i=this.padding,a=e.length/3,o=[],u=0,s=0,f=0;s<a;s++,f+=3){su(e,f,r);var l=e[f],c=e[f+1],d=e[f+2],h=t.get(l),v=n.get(l),g=t.get(c),p=n.get(c),m=t.get(d),y=n.get(d),b=Ja(m,y,g,p),x=Ja(m,y,h,v),w=Ja(g,p,h,v),A=x*((x*x+w*w-b*b)/(2*x*w))/w,M=(1-A)*h+A*g,I=(1-A)*v+A*p,E=r.get(d);if(r.get(l)!==E&&Ja(M,I,m,y)<=E+i){var C=Math.atan2(I-y,M-m);o.push(m+E*Math.cos(C),y+E*Math.sin(C),d);u++}}return Lo(o,[u,3],"f32")};e.prototype.solve=function(e,t,n,r,i,a){var o=this.constraints,u=o.pairs,s=o.pairIndices,f=this.padding,l=Math.max(.01*f,_a),c=t.size,d=new Float32Array(c),h=new Float32Array(c),v=0;i/=a;for(;a-- >0;){v=0;for(var g=0;g<s.length;g++){var p=2*s[g],m=u[p],y=u[p+1],b=t.get(m)+d[m],x=n.get(m)+h[m],w=r.get(m),A=t.get(y)+d[y],M=n.get(y)+h[y],I=r.get(y),E=A-b,C=M-x,k=Qa(E,C),S=w+I+f;if(k>l){var T=.5*(1+qa(uu(ou(E,C),ou(e.x-b,e.y-x)),-1,1)),R=0;if(k>S){R=Math.min(i,S);E/=k;C/=k}else{R=(k-S)/k;v++}E*=R;C*=R;d[m]+=T*E;h[m]+=T*C;d[y]-=(1-T)*E;h[y]-=(1-T)*C}}}for(g=0;g<c;g++){t.set(t.get(g)+d[g],g);n.set(n.get(g)+h[g],g)}return v};return e}(),hu=Object.freeze({sortByRadius:su,removeDuplicatePairs:lu,InterleavingCircles:cu,CirclePackingSolver:du});function vu(e){for(var t={tl:{x:1/0,y:1/0},br:{x:-1/0,y:-1/0}},n=e.next();!n.done;){t.tl.x=Math.min(t.tl.x,n.value.x);t.tl.y=Math.min(t.tl.y,n.value.y);t.br.x=Math.max(t.br.x,n.value.x);t.br.y=Math.max(t.br.y,n.value.y);n=e.next()}return t}function gu(e){for(var t={tl:{x:1/0,y:1/0},br:{x:-1/0,y:-1/0}},n=e.next();!n.done;){t.tl.x=Math.min(t.tl.x,n.value.x-n.value.r);t.tl.y=Math.min(t.tl.y,n.value.y-n.value.r);t.br.x=Math.max(t.br.x,n.value.x+n.value.r);t.br.y=Math.max(t.br.y,n.value.y+n.value.r);n=e.next()}return t}function pu(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)<e.r-t.r+_a}function mu(e,t){var n=e.x,r=e.y,i=e.r,a=t.x,o=t.y,u=t.r,s=a-n,f=o-r,l=u-i,c=Math.sqrt(s*s+f*f);return{x:(n+a+s/c*l)/2,y:(r+o+f/c*l)/2,r:(c+i+u)/2}}function yu(e,t,n){var r=e.x,i=e.y,a=e.r,o=t.x,u=t.y,s=t.r,f=n.x,l=n.y,c=n.r,d=2*(r-o),h=2*(i-u),v=2*(s-a),g=r*r+(i*i-a*a-o*o-u*u)+s*s,p=2*(r-f),m=2*(i-l),y=2*(c-a),b=r*r+(i*i-a*a-f*f-l*l)+c*c,x=p*h-d*m,w=(h*b-m*g)/x-r,A=(m*v-h*y)/x,M=(p*g-d*b)/x-i,I=(d*y-p*v)/x,E=A*A+I*I-1,C=2*(w*A+M*I+a),k=w*w+M*M-a*a,S=(-C-Math.sqrt(C*C-4*E*k))/(2*E);return{r:S,x:w+A*S+r,y:M+I*S+i}}function bu(e,t){switch(t.length){case 0:return{x:0,y:0,r:0};case 1:return e[t[0]];case 2:return mu(e[t[0]],e[t[1]]);case 3:return yu(e[t[0]],e[t[1]],e[t[2]]);default:throw new Error("invalid number of circles")}}function xu(e){if(0===e.length)return null;for(var t=e.length,n={prev:null,i:0,R:[],c:null};;){var r=n.i,i=n.R,a=n.prev,o=n.c;if(r===t||3===i.length){a.c=bu(e,i);n=a}else if(null===o)n={R:i,prev:n,i:r+1,c:null};else if(pu(o,e[r])){if(null===a)return o;a.c=o;n=a}else n={prev:n,i:r+1,R:i.concat([r]),c:null}}}var wu=Object.freeze({nbody:jo,delaunay:eu,circlePacking:hu,radialExtents:xu,LinearQuadTree:Wo,get Rect(){return Eo},circularOverlap:tu,lineIntersection:nu,crossProduct:ru,lineAngle:iu,normalise:au,unit:ou,dot:uu,pointExtents:vu,circleExtents:gu}),Au=function(){function e(e,t){this.buffer=e;this.defaultValue=t}e.fromRange=function(t,n,r){to.ensureContiguous(t);return e.fromSize(t.size,n,r)};e.fromSize=function(t,n,r){var i=new Array(t);if(void 0===r)mo(i,n);else for(var a=0;a<t;a++)i[a]=r(a);return new e(i,n)};e.wrapArray=function(t,n){return new e(t,n)};e.prototype.keySpace=function(){return{begin:0,end:this.buffer.length-1,size:this.buffer.length}};e.prototype.get=function(e){return this.buffer[e]};e.prototype.set=function(e,t){this.buffer[e]=t};return e}(),Mu=function(){function e(e,t,n){this.buffer=e;this.inverse=t;this.defaultValue=n}e.fromValues=function(t){for(var n=[],r={},i=t.next(),a=0;!i.done;){var o=i.value;if(void 0===r[o]){r[o]=a;n.push(o);a++}i=t.next()}return new e(n,r,null)};e.fromKeyValuePairs=function(t){to.ensureContiguous(t);for(var n=[],r={},i=t.next();!i.done;){var a=i.value,o=a[0],u=a[1];if(void 0===r[u]){r[u]=o;n.push(u)}i=t.next()}return new e(n,r,null)};e.prototype.get=function(e){return this.buffer[e]};e.prototype.set=function(e,t){this.buffer[e]=t};e.prototype.getUniqueInverse=function(e){return this.inverse[e]};e.prototype.getInverse=function(e){return ao(this.inverse[e])};e.prototype.keySpace=function(){return to.fromSize(this.buffer.length)};return e}(),Iu=function(){function e(e,t){this.data=e;this.idAxis=t;this.data=e;this.sliceArgs=[e,"all","all"]}e.fromShape=function(t,n,r,i){void 0===r&&(r=0);return new e(Bo(t,n,i),r)};e.prototype.keySpace=function(){return to.fromSize(this.data.shape[this.idAxis])};e.prototype.get=function(e){var t=this.sliceArgs;t[this.idAxis+1]=e;return Oo.apply(null,t)};e.prototype.set=function(e,t){throw new Error("not impl")};return e}();function Eu(e,t,n){var r=Mu.fromValues(e),i=oo(t,function(e){return[r.getUniqueInverse(e[0]),r.getUniqueInverse(e[1]),e[2]]}),a=n.buildKeyed(i,e.size),o=Mu.fromKeyValuePairs(a);return{vertexMap:r,edgeMap:o}}function Cu(e){for(var t=e.vertexRange(),n=t.end-t.begin+1,r=Bo([n,n],"i32",0),i=e.iterateAdjacentPairs(),a=i.next();!a.done;){var o=a.value,u=o[0],s=o[1],f=r.get(u,s)+(u===s?2:1);r.set(f,u,s);r.set(f,s,u);a=i.next()}return r}function ku(e){to.ensureContiguous(e.vertexRange());for(var t=e.iterateAdjacentPairs(),n=new Int32Array(e.countVertices()),r=t.next();!r.done;){var i=r.value,a=i[0],o=i[1];n[a]++;n[o]++;r=t.next()}return Au.wrapArray(n,0)}var Su=function(){function e(e,t,n){this.tourStart=e;this.tours=t;this.nTours=n;this.defaultValue=-1}e.prototype.keySpace=function(){return to.fromSize(this.tourStart.length)};e.prototype.iterateGroups=function(){for(var e=this.tourStart,t=[],n=0,r=this.nTours;r>0;){if(e[n]===n){t.push(n);r--}n++}return fo(t)};e.prototype.iterateGroup=function(e){e=this.tourStart[e];var t=this.tours,n={done:!1,value:e},r=!1;return{next:function(){n.value=e;n.done=r;r||(t[e]>e?e=t[e]:r=!0);return n}}};e.prototype.groupSize=function(e){e=this.tourStart[e];for(var t=1;e<(e=this.tours[e]);)t++;return t};e.prototype.countGroups=function(){return this.nTours};e.prototype.get=function(e){return this.tourStart[e]};e.prototype.set=function(){throw new Error("Readonly")};e.build=function(t){for(var n=t.length,r=new Int32Array(n),i=new Int32Array(n),a=0,o=0;o<n;o++){var u=Tu(t,o,!1),s=void 0;if(u===o){a++;s=o}else s=i[u];t[o]=u;r[s]=o;i[u]=o}return new e(t,r,a)};return e}();function Tu(e,t,n){for(var r=t,i=0;r>=0&&e[r]!==r;){r=e[r];i++}if(n)for(var a=void 0;i>1;){a=t;t=e[t];e[a]=r;i--}return r}function Ru(e){to.ensureContiguous(e.vertexRange());var t=e.countVertices(),n=new Int32Array(t);wo(n,0);for(var r=e.iterateAdjacentPairs(!1),i=r.next();!i.done;){var a=i.value,o=a[0],u=a[1],s=Tu(n,o,!0),f=Tu(n,u,!0);s>f?n[s]=f:s<f&&(n[f]=s);i=r.next()}return Su.build(n)}function Lu(e){var t=e.countVertices(),n=new Int32Array(t);return Su.build(n)}var Bu=-1,Zu=function(){function e(){this.directedCategory="u";this.badIncidence=0;this.initialize(0,0)}e.prototype.iterateEdges=function(){return so(this.edges)};e.prototype.iterateVertices=function(){return so(this.vertices)};e.prototype.countVertices=function(){return this.vertices.size};e.prototype.countEdges=function(){return this.edges.size};e.prototype.vertexRange=function(){return this.vertices};e.prototype.edgeRange=function(){return this.edges};e.prototype.source=function(e){return e>=this.edges.begin&&e<=this.edges.end?this.incidence[2*e]:Bu};e.prototype.target=function(e){return e>=this.edges.begin&&e<=this.edges.end?this.incidence[2*e+1]:Bu};e.prototype.containsEdge=function(e){return to.isWithin(this.edges,e)};e.prototype.containsVertex=function(e){return to.isWithin(this.vertices,e)};e.prototype.isValidAdjacency=function(e,t){return to.isWithin(this.vertices,e)&&to.isWithin(this.vertices,t)};e.prototype.iterateAdjacentPairs=function(e,t){void 0===t&&(t=[-1,-1,-1]);return 0===this.countEdges()?io():!e&&this.badIncidence>0?Ou(this.incidence,this.edgeRange(),this.badIncidence,t):Gu(this.incidence,this.edgeRange(),t)};e.prototype.buildKeyed=function(e,t){var n=this;this.initialize(t,e.size);var r,i=this.incidence,a={value:[-1,void 0],done:!1},o=0,u=0,s=function(){if((r=e.next()).done)a.done=!0;else{var t=r.value,s=t[0],f=t[1];if(n.isValidAdjacency(s,f)){i[u++]=s;i[u++]=f}else{n.badIncidence++;i[u++]=Bu;i[u++]=Bu}a.value[0]=o++;a.value[1]=r.value[2]}return a},f=to.fromSize(e.size);f.next=s;return f};e.prototype.build=function(e,t){this.initialize(t,e.size);for(var n=this.incidence,r=0,i=e.next();!i.done;){var a=i.value,o=a[0],u=a[1];if(this.isValidAdjacency(o,u)){n[r++]=o;n[r++]=u}else{this.badIncidence++;n[r++]=Bu;n[r++]=Bu}i=e.next()}};e.prototype.initialize=function(e,t){this.vertices=to.fromSize(e);this.edges=to.fromSize(t);this.incidence=Zo("i32",2*t,Bu)};return e}();function Ou(e,t,n,r){var i=t.begin,a=t.size,o=t.end,u={done:!1,value:r},s=0;return{size:a-n,next:function(){for(;i<=o;){var t=e[s++],n=e[s++];if(t!==Bu&&n!==Bu){r[0]=t;r[1]=n;r[2]=i++;return u}i++}u.done=!0;return u}}}function Gu(e,t,n){var r=t.begin,i=t.size,a=t.end,o={done:!1,value:n},u=0;return{size:i,next:function(){if(r<=a){n[0]=e[u++];n[1]=e[u++];n[2]=r++}else o.done=!0;return o}}}var Fu=Object.freeze({StaticListGraph:Zu,StaticStringLabelMap:Mu,StaticPropertyMap:Au,buildFromLabeledIterators:Eu,StaticNDArrayMap:Iu,adjacencyMatrix:Cu,degrees:ku,connectedComponents:Ru,all:Lu}),Du=function(){function e(e,t){this.g=e;this.rng=t}e.prototype.run=function(e){for(var t=e["@@pos2d"].data,n=this.g.iterateVertices(),r=n.next();!r.done;){var i=t.get(r.value);i.x=this.rng();i.y=this.rng();r=n.next()}};return e}();function zu(e,t){void 0===t&&(t={});var n=void 0!==t.seed?ja.createPRNG(t.seed,0,1):function(){return Math.random()};return new Du(e,n)}var Vu,Yu={reorder:!1},Pu=function(){function e(e,t){void 0===t&&(t={});this.g=e;this.opts=t;ro(t,Yu)}e.prototype.run=function(e){var t=this,n=e["@@pos2d"].data,r=e["@@radius"].data,i=e["@@group"],a=void 0!==i?i.data:Lu(this.g);uo(a.iterateGroups(),function(e){var i=t.getVertexGroupSummary(r,a.iterateGroup(e)),o=i.numVerts,u=i.avgRadius;t.runOn(a.iterateGroup(e),n,o,u)})};e.prototype.runOn=function(e,t,n,r){var i=2*Math.PI/n,a=n<2?0:3*r/Math.sin(i/2);if(this.opts.reorder){var o=this.opts.reorder,u=lo(e);Mo(u,"object"==typeof o&&o.seed?ja.createPRNGi32(o.seed):Math.random);e=fo(u)}for(var s=0,f=e.next();!f.done;){var l=t.get(f.value);l.x=a*Math.sin(s);l.y=a*Math.cos(s);s+=i;f=e.next()}};e.prototype.getVertexGroupSummary=function(e,t){for(var n=0,r=0,i=t.next();!i.done;){++n;r+=e.get(i.value);i=t.next()}return{numVerts:n,avgRadius:r/=n}};return e}();function Wu(e,t){return new Pu(e,t)}!function(e){!function(e){e.name="@@pos2d";e.descriptor={name:e.name,itemType:"v"}}(e.Position2d||(e.Position2d={}));!function(e){e.name="@@radius";e.descriptor={name:e.name,itemType:"v"}}(e.Radius||(e.Radius={}));!function(e){e.name="@@degree";e.descriptor={name:e.name,itemType:"v"}}(e.Degree||(e.Degree={}));!function(e){e.name="@@group";e.descriptor={name:e.name,itemType:"v"}}(e.Group||(e.Group={}))}(Vu||(Vu={}));var Xu=function(){function e(){}e.prototype.repulsion=function(){return this.linRepulsion()};e.prototype.attraction=function(e){return Nu};e.prototype.linRepulsion=function(){return{nodeNode:function(e){return function(t,n,r,i,a,o,u){return Uu(e,t,n,r,i,a,o,u)}}}};return e}();function Uu(e,t,n,r,i,a,o,u){var s=i-t,f=a-n,l=s*s+f*f;if(l>_a){var c=e*r*o/l;u[0]-=s*c;u[1]-=f*c}}function Nu(e,t,n,r,i,a,o){var u=n-e,s=r-t,f=Qa(u,s),l=f-a;if(f>.001){var c=l/f;c>.01?c=Math.pow(c,3)*i*Math.sqrt(.5*l):c>0&&(c=0);o[0]+=u*c;o[1]+=s*c}return f}var ju={maxIterations:125,speed:void 0,moment1Beta:function(e){return Ku(.84,25,e)},moment2Beta:function(e){return Ku(.98,30,e)}};function _u(e){return{mass:Bo([e],"f32",1),displacement:Bo([2,e],"f32"),moment:Bo([2,e],"f32"),moment2:Bo([2,e],"f32")}}function Hu(e){return{targetLength:Bo([e],"f32",1),maxTargetLength:Bo([e],"f32",1),mass:Bo([e],"f32",1)}}function Ku(e,t,n){return n<t?e*Math.sin(n*(Math.PI/(2*t))):e}function Qu(e,t,n,r,i,a){void 0===a&&(a=12);return eo(e,t,.5*(r-n),a/(r-n),1,1,i-n)}var Ju=function(){function e(e,t){void 0===t&&(t={});this.graph=e;this.opts=t;this.numIterations=0;this.groups=[];var n=e.countVertices(),r=e.countEdges();ro(t,ju);this.graph=e;this.forceModels=new Xu;this.vertexData=_u(n);this.edgeData=Hu(r)}e.prototype.run=function(e){var t=e["@@pos2d"].data,n=e["@@radius"].data,r=e["@@degree"]?e["@@degree"].data:ku(this.graph),i=e["@@group"]?e["@@group"].data:Lu(this.graph);0===this.numIterations&&this.initialize(n,r,i);var a=this.setupNewIteration(t),o=this.forceModels.repulsion(),u=this.forceModels.attraction(1);this.calculateAttractionForces(u,a);this.calculateRepulsionForces(o);this.updateGlobalSpeed();this.updatePositions(r,t);this.numIterations++};e.prototype.isComplete=function(){return this.numIterations>=this.opts.maxIterations};e.prototype.buildGroupStates=function(e){var t=this.graph.countVertices(),n=this.groups,r=new Int32Array(t),i=0,a=0;uo(e.iterateGroups(),function(t){var o=e.iterateGroup(t),u=o.next();i=a;for(;!u.done;){r[a++]=u.value;u=o.next()}a-i>1&&n.push({id:t,indices:r.subarray(i,a),nbodyModel:new No("f32",void 0,16),repulsionScaling:0,schedule:null,avgRadius:0,degNorm:0})})};e.prototype.initialize=function(e,t,n){this.buildGroupStates(n);for(var r=this.graph,i=r.countVertices(),a=this.vertexData.mass,o=this.edgeData.mass,u=this.edgeData.targetLength,s=this.edgeData.maxTargetLength,f=new Float32Array(i),l=new Float32Array(i),c=new Int32Array(i),d=0;d<this.groups.length;d++){for(var h=this.groups[d],v=h.indices,g=v.length,p=0,m=0,y=0,b=0,x=0,w=0,A=0;A<g;A++){var M=v[A],I=e.get(M);w+=Math.sqrt(I);x+=I*I;b+=Math.log(I);var E=t.get(M);m+=Math.sqrt(E);p+=E}var C=p/2,k=C/g,S=Math.exp(b/g);w/=g;x/=g;m=C>0?m/C:1;c[h.id]=p;l[h.id]=S;for(A=0;A<g;A++){M=v[A],I=e.get(M),E=t.get(M);a.set(I*I/x+Math.sqrt(E)/m,M);y+=Math.pow(E-k,2)}y=y>0?y/g:1;h.repulsionScaling=0===C?1:.1*Math.pow(S,2)*w*Math.min(y,100)/Math.log(g+1);h.degNorm=m;h.avgRadius=S;h.schedule=new $u(this.opts.maxIterations,g,C,this.opts.speed)}uo(r.iterateAdjacentPairs(),function(r){var i=r[0],a=r[1],c=r[2],d=n.get(i),h=t.get(i),v=t.get(a),g=e.get(i),p=e.get(a),m=Math.sqrt(Math.min(h,v)),y=g+p+2*Math.min(g,p);f[d]+=m;o.set(m,c);u.set(y,c);s.set(y+12*l[d]*Math.sqrt((h+v)/2),c)});uo(r.iterateAdjacentPairs(),function(e){var t=e[0],r=e[2],i=n.get(t),a=c[i]/2,u=o.get(r)/(f[i]/a);o.set(u,r)})};e.prototype.setupNewIteration=function(e){var t=this.vertexData,n=this.graph.countVertices();t.displacement=Bo([2,n],"f32");var r=Bo([2,n],"f32"),i=Go(r),a=i[0],o=i[1];uo(this.graph.iterateVertices(),function(t){var n=e.get(t);a.set(n.x,t);o.set(n.y,t)});for(var u=this.groups,s=0;s<u.length;s++){var f=u[s];f.nbodyModel.buildSubset(f.indices,a,o,void 0,t.mass)}return r};e.prototype.calculateAttractionForces=function(e,t){for(var n=this.graph,r=this.edgeData.mass,i=this.edgeData.targetLength,a=this.edgeData.maxTargetLength,o=this.vertexData.displacement,u=o.values,s=[0,0],f=[0,0,0],l=Qu(0,1,0,.5*this.opts.maxIterations,this.numIterations),c=n.iterateAdjacentPairs(!1,f);!c.next().done;){var d=f[0],h=f[1],v=f[2];s[0]=0;s[1]=0;e(t.get(0,d),t.get(1,d),t.get(0,h),t.get(1,h),r.get(v),l*i.get(v),s)>a.get(v)&&r.set(1.04*r.get(v),v);u[o.index(0,d)]+=s[0];u[o.index(1,d)]+=s[1];u[o.index(0,h)]-=s[0];u[o.index(1,h)]-=s[1]}};e.prototype.calculateRepulsionForces=function(e){for(var t=Go(this.vertexData.displacement),n=t[0],r=t[1],i=this.groups,a=0;a<i.length;a++){var o=i[a];o.nbodyModel.runOnPoints(e.nodeNode(o.repulsionScaling),n,r,o.schedule.theta)}};e.prototype.updateGlobalSpeed=function(){for(var e=Go(this.vertexData.displacement),t=e[0],n=e[1],r=Go(this.vertexData.moment),i=r[0],a=r[1],o=Go(this.vertexData.moment2),u=o[0],s=o[1],f=this.groups,l=this.opts.moment1Beta(this.numIterations),c=this.opts.moment2Beta(this.numIterations),d=0;d<f.length;d++){for(var h=f[d],v=h.indices,g=v.length,p=0;p<g;p++){var m=v[p],y=t.get(m),b=n.get(m);i.set($a(i.get(m),y,l),m);a.set($a(a.get(m),b,l),m);u.set($a(u.get(m),y*y,c),m);s.set($a(s.get(m),b*b,c),m)}h.schedule.update()}};e.prototype.updatePositions=function(e,t){for(var n=this,r=n.groups,i=n.vertexData,a=Go(i.moment),o=a[0],u=a[1],s=Go(i.moment2),f=s[0],l=s[1],c=0;c<r.length;c++)for(var d=this.groups[c],h=d.indices,v=d.schedule,g=d.avgRadius,p=d.degNorm,m=v.speed*(1/p)*g,y=0;y<h.length;y++){var b=h[y],x=m*Math.sqrt(1+e.get(b)),w=Math.sqrt(f.get(b)),A=Math.sqrt(l.get(b)),M=o.get(b),I=u.get(b),E=t.get(b);E.x+=x*(M/(w+_a));E.y+=x*(I/(A+_a))}};return e}();function qu(e,t){return new Ju(e,t)}var $u=function(){function e(e,t,n,r){this.maxIterations=e;this.iterations=0;this.progress=0;this.coolingPoint=-1;var i=.5,a=n/(t*(t-1)/2),o=(1+2.5*Math.log(t))*(.03+i/Math.pow(t,a));this.targetSpeed=void 0===r?o:r;this.warmup=25}Object.defineProperty(e.prototype,"theta",{get:function(){return Qu(1.8,1,0,1,this.progress)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"speed",{get:function(){var e=this,t=e.progress,n=e.targetSpeed,r=.1*n,i=0;if(this.coolingPoint<0){i=Qu(r,n,0,this.warmup,this.iterations);t>.75&&(this.coolingPoint=t)}else{i=eo(n,r,.5,10,1,1,(t-this.coolingPoint)/(1-this.coolingPoint))}return i},enumerable:!0,configurable:!0});e.prototype.update=function(){this.progress=++this.iterations/this.maxIterations};return e}(),es=Object.freeze({defaultOpts:ju,create:qu}),ts={iterations:5},ns=function(){function e(e,t){void 0===t&&(t={});this.graph=e;this.opts=t;this.numIterations=0;ro(t,ts);this.relaxationFactor=Math.min(.9,e.countVertices()/e.countEdges())}e.prototype.run=function(e){for(var t=e["@@pos2d"].data,n=e["@@radius"].data,r=e["@@degree"].data,i=this.graph.iterateAdjacentPairs(),a=i.next();!a.done;){this.relaxEdge(a.value[0],a.value[1],n,r,t);a=i.next()}this.numIterations++};e.prototype.isComplete=function(){return this.numIterations>=this.opts.iterations};e.prototype.relaxEdge=function(e,t,n,r,i){if(e!==t){var a=i.get(e),o=i.get(t),u=r.get(e),s=r.get(t),f=2.5*(n.get(e)+n.get(t)),l=o.x-a.x,c=o.y-a.y,d=Qa(l,c);if(!(d<_a)){var h=this.relaxationFactor*(d-f),v=h*(s/(u+s)),g=h-v;a.x+=l/d*v;a.y+=c/d*v;o.x-=l/d*g;o.y-=c/d*g}}};return e}();function rs(e,t){return new ns(e,t)}var is=Object.freeze({defaultOpts:ts,create:rs}),as=function(){function e(e){this.layout=e;this.iterations=0}e.prototype.isComplete=function(){return this.iterations>0};e.prototype.run=function(e){this.iterations++;return this.layout.run(e)};return e}(),os=function(){function e(e){this.layouts=e;this.outputs=[];this.index=0;this.outputs=new Array(e.length)}e.prototype.isComplete=function(){return this.index>=this.layouts.length};e.prototype.run=function(e){for(;!this.isComplete();){var t=this.layouts[this.index][0];if(!t.isComplete()){this.outputs[this.index]=t.run(e);break}this.index++}return this.outputs};e.prototype.getPhase=function(e){for(var t=[],n=0;n<this.layouts.length;n++)this.layouts[n][1]===e&&t.push(this.layouts[n][0]);return t};return e}(),us={initialSpeed:1,speedDecay:.05,maxIterations:50,center:{x:0,y:0},padding:{proportion:0,min:0,max:0}},ss=function(){function e(e){void 0===e&&(e={});this.opts=e;this.numIterations=0;this.groupState=[];ro(e,us);this.speed=this.opts.initialSpeed}e.prototype.isComplete=function(){return this.speed<=_a||this.numIterations>=this.opts.maxIterations};e.prototype.run=function(e){if(e["@@group"]){var t=e["@@pos2d"].data,n=e["@@radius"].data,r=e["@@group"].data;0===this.numIterations&&(this.speed=this.initialize(t,n,r));this.runSolver();this.offsetGroups(t,r);this.numIterations++;this.speed*=1-this.opts.speedDecay}else this.speed=0};e.prototype.runSolver=function(){var e=this,t=e.speed,n=e.opts,r=e.solver,i=Go(e.xyr),a=i[0],o=i[1],u=i[2];if(!(r.build(n.center,a,o,u)<0))throw new Error("packing fail");r.solve(n.center,a,o,u,t,5)};e.prototype.initialize=function(e,t,n){var r=n.countGroups(),i=this.groupState,a=this.opts,o=a.padding,u=a.center,s=a.initialSpeed,f=this.xyr=Bo([3,r],"f32"),l=0,c=0,d=0;uo(n.iterateGroups(),function(r){for(var a=[],u=n.iterateGroup(r),s=u.next();!s.done;){var h=s.value,v=e.get(h),g=v.x,p=v.y;a.push({x:g,y:p,r:t.get(h)});s=u.next()}var m=xu(a);m.r+=qa(m.r*o.proportion,o.min,o.max);m.id=r;i.push(m);f.set(m.x,0,l);f.set(m.y,1,l);f.set(m.r,2,l);c+=m.r;d=Math.max(d,m.r);l++});var h=ja.createPRNG(37,-.1*d,.1*d);this.solver=new du(0,1,h);var v=Go(f),g=v[0],p=v[1],m=v[2];new cu(0).apply(u,g,p,m);return r>2?s*((c-d)/(r-1)):0};e.prototype.offsetGroups=function(e,t){for(var n=this,r=n.groupState,i=n.xyr,a=0;a<r.length;a++){for(var o=r[a],u=i.get(0,a)-o.x,s=i.get(1,a)-o.y,f=t.iterateGroup(o.id),l=f.next();!l.done;){var c=e.get(l.value);c.x+=u;c.y+=s;l=f.next()}o.x+=u;o.y+=s}};return e}();function fs(e,t){return new ss(t)}var ls={initialization:"random",initializationOptions:{iterations:5},packing:"circle",packingOptions:{}},cs=function(e){no(t,e);function t(t,n){var r,i=e.call(this,n)||this,a=Vu.Group,o=Vu.Degree;i.defaultProperties=((r={})[a.name]={prop:a.descriptor,data:Ru(t)},r[o.name]={prop:o.descriptor,data:ku(t)},r);return i}t.prototype.run=function(t){ro(t,this.defaultProperties);return e.prototype.run.call(this,t)};Object.defineProperty(t.prototype,"fd",{get:function(){return this.getPhase(1)[0]},enumerable:!0,configurable:!0});return t}(os);function ds(e,t){ro(t,ls,!0);var n=[];if("none"!==t.initialization){var r=t.initializationOptions;if("random"===t.initialization)n.push([new as(zu(e,r)),0]);else{if("link-relaxation"!==t.initialization)throw new Error('Unknown initialization "'+t.initialization+'"');n.push([new as(Wu(e,r)),0]);n.push([rs(e,r),0])}}n.push([qu(e,t),1]);"circle"===t.packing&&n.push([fs(e,t.packingOptions),2]);return new cs(e,n)}var hs,vs=Object.freeze({LayoutImpl:cs,create:ds}),gs=function(){function e(e,t,n){void 0===t&&(t=0);this.layout=e;this.interval=t;this.batchBudget=n}e.prototype.start=function(e,t){this.input=e;this.onComplete=t;this.nextStep()};e.prototype.nextStep=function(){var e=this,t=this.work();this.layout.isComplete()?this.onComplete(void 0,t):setTimeout(function(){return e.nextStep()},this.interval)};e.prototype.work=function(){var e;if(void 0===this.batchBudget)e=this.layout.run(this.input);else{var t=Date.now();e=this.layout.run(this.input);t=Math.max(1,Date.now()-t);for(var n=Math.floor((this.batchBudget-t)/t);n>0&&!this.layout.isComplete();){e=this.layout.run(this.input);n--}}return e};return e}();!function(e){e.forceDirected="forcedirected";e.random="random";e.circular="circular";e.linkRelaxation="linkRelaxation";e.organic="organic"}(hs||(hs={}));function ps(e,t,n){switch(e){case hs.organic:return ds(t,n);case hs.forceDirected:return qu(t,n);case hs.random:return new as(zu(t,n));case hs.circular:return new as(Wu(t,n));case hs.linkRelaxation:return rs(t,n);default:throw new Error("unknown layout")}}var ms=Object.freeze({get names(){return hs},createLayout:ps,get KnownProperties(){return Vu},forceDirected:es,linkRelaxation:is,organic:vs,SetTimeoutRunner:gs,SyncToAsyncLayout:as,PhasedLayout:os});function ys(e){var n=bs(Xn()),r=B(e,{selfLinks:!1}),i=nr({numbers:{x:1,y:1},strings:{id:1,id1:1,id2:1},booleans:{hi:1,a1:1,a2:1}});function a(e){function n(n){var a=o(n);i.typeCheck(a);var u=i.filterNodesAndLinks(a.items,{},{},{selfLinks:r.selfLinks,filterComboNodes:!0});i.ensureHiddenItemConsistency(u.nodes,u.links);t(u.nodes,function(e){delete e.parentId});t(u.links,function(e){delete e.parentId});e.privateSetProperties(u.nodes,u.links)}return n}function u(e){function t(){var t={};e.privateSetProperties(t,t)}return t}return K(n,{load:a(n),clear:u(n)})}function bs(e){var n={},r={},i={},a=e,u=null;n.clearCache=function(){u=null};var s=n.clearCache;n.privateSetProperties=function(e,t){r=e;i=t;s()};function f(e,n,r){var i=n&&n.all,a="toplevel"!==n.combos,o="underlying"!==n.combos;t(e,function(e){!i&&e.hi||!a&&e.parentId||!o&&e._combo||r(e)})}function c(e,t){f(i,e,t)}function d(e,t){f(r,e,t)}var v=function(e,t,n,r){function i(){var t=[];d(e,function(e){t.push(e)});return t}var o=i(),u=o.length,s=-1,f=0,c=500,h=Date.now(),v=h,g=700,p=function(){if(++s>=u){m(1);r()}else n(o[s],b)},m=function(e){a&&a.trigger("progress",t,e)},y=function(){h=Date.now();if(f++>c||h-v>g){f=0;v=Date.now();return!0}return!1},b=function(){if(y()){m(s/u);l(p,0)}else p()};m(0);b()};n.findAdjacency=function(e,t,n){var r=x(e);if(t===n)return r.selfAdjacency[t];var i=r.adjacency;return i[t]&&i[t][n]};n.connections=function(e){var t=x(e);return e.self?t.selfConnections:t.connections};n.eigenCentrality=function(e){var n,r,i=B(e,{all:!1,value:void 0});i.combos="toplevel";i.direction="any";V(i);O(i);var a={},o=p(i);function u(e,t){a[t]=e*o[n].nodes.length}for(n=0;n<o.length;n++){var s={};for(r=0;r<o[n].nodes.length;r++)s[o[n].nodes[r]]=!0;var f=l(s);t(f,u)}return a;function l(e){var t,n,r={},a=[],o=[],u=[],s=0,f=[],l=0;d(i,function(t){var n=t.id;if(e[n]){a.push(n);r[n]=a.length-1;o.push([]);u.push({})}});n=Math.max(100,5*Math.sqrt(a.length));c(i,function(t){if(e[t.id1]&&e[t.id2]){var n=r[t.id1],a=r[t.id2];if(!u[n][a]){o[n].push(a);o[a].push(n);u[a][n]=0;u[n][a]=0}var f=v(t,i);u[n][a]+=f;u[a][n]+=f;s+=f;l++}});if(0===a.length)return{};if(1===a.length){(f={})[a[0]]=1;return f}if(2===a.length){(f={})[a[0]]=.5;f[a[1]]=.5;return f}s/=l;n=Math.max(100,5*Math.sqrt(a.length));for(t=0;t<a.length;t++)f.push(Math.random());for(t=0;t<n;t++){f=g(f);t%10==0&&p()}p();var h={};for(t=0;t<a.length;t++)h[a[t]]=f[t];return h;function v(e,t){var n=1;t.value&&e.d&&(n=Number(e.d[t.value]));return n}function g(e){var t,n,r=[];for(t=0;t<a.length;t++){var i=0;for(n=0;n<o[t].length;n++)i+=u[t][o[t][n]]*e[o[t][n]];i+=s*e[t];r.push(i)}return r}function p(){var e,t=1/m(f);for(e=0;e<a.length;e++)f[e]*=t}function m(e){var t,n=0;for(t=0;t<e.length;t++)n+=Math.abs(e[t]);return n}}};n.pageRank=function(e){var t,n=B(e,{all:!1,value:void 0,directed:!0});n.combos="toplevel";V(n);D(n);var r,i={},a=[],o=[],u=[],s=[],f=[],l=.85;d(n,function(e){a.push(e.id);i[e.id]=a.length-1;o.push([]);u.push({});s.push(0)});r=Math.max(100,5*Math.sqrt(a.length));c(n,function(e){var t=i[e.id1],r=i[e.id2],a=g(e,n);if(!n.directed||e.a2||!e.a1&&!e.a2){if(!u[r][t]){u[r][t]=0;o[r].push(t)}u[r][t]+=a;s[t]+=a}if(!n.directed||e.a1||!e.a1&&!e.a2){if(!u[t][r]){u[t][r]=0;o[t].push(r)}u[t][r]+=a;s[r]+=a}});for(t=0;t<a.length;t++)f.push(Math.random());var h=1/m(f);for(t=0;t<a.length;t++)f[t]*=h;for(t=0;t<r;t++)f=p(f);h=1/m(f);for(t=0;t<a.length;t++)f[t]*=h;var v={};for(t=0;t<a.length;t++)v[a[t]]=f[t];return v;function g(e,t){var n=1;t.value&&e.d&&(n=Number(e.d[t.value]));return n}function p(e){var t,n,r=[],i=0,c=0;for(t=0;t<a.length;t++)i+=e[t];for(t=0;t<a.length;t++){var d=0;for(n=0;n<o[t].length;n++){var h=o[t][n];d+=u[t][h]*e[h]/s[h]}0===s[t]&&(c+=l*e[t]);d*=l;d+=(1-l)*i/a.length;r.push(d)}c/=a.length;for(t=0;t<f.length;t++)r[t]+=c;return r}function m(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t];return n}};n.neighbours=function(e,n){var a=R(e),o={},u={},s=U(a),f=B(n,{all:!1,direction:"any",hops:1});if(f.hops<1)throw new Error("neighbours error: hops must be a positive number");V(f);var l=0,c={},d={},h=s,v=x(f),g=v.adjacency,p=v.selfAdjacency;t(s,function(e,t){var n=z(t);if(!r[n]&&!i[n])throw new Error("neighbours error: ids must be present in the graph");l++});function m(e,t,n){if(!d[t]&&I(n,e,t,f)){o[t]=1;d[t]=1;if(n!==e){u[e]=1;e in h&&(u[n]=1);if(!(e in s)){l++;c[e]=1}}}}function y(){t(s,function(e,n){if(r[n]){g[n]&&t(g[n],function(e,t){for(var r=0;r<e.length;r++){m(t,z(e[r]),n)}});var a=p[n];if(a)for(var o=0;o<a.length;o++)m(n,a[o],n)}else if(i[n]){var h=i[n];if(!d[h.id2]&&I(h.id2,h.id1,n,f)){u[h.id2]=1;d[h.id2]=1;d[n]=1;if(!(h.id2 in s)){l++;c[h.id2]=1}}if(!d[h.id1]&&I(h.id1,h.id2,n,f)){u[h.id1]=1;d[h.id1]=1;d[n]=1;if(!(h.id1 in s)){l++;c[h.id1]=1}}}})}for(;f.hops--&&l;){l=0;y();s=c;c={}}return{nodes:Object.keys(u),links:Object.keys(o)}};n.privateNeighbourLinks=function(e){var n=x({all:!0,combos:"all"}),r=n.adjacency,i=n.selfAdjacency,a={},o=[];e.forEach(function(e){t(r[e],function(e){e.forEach(function(e){if(!a[e]){o.push(e);a[e]=!0}})});var n=i[e];if(n)for(var u=0;u<n.length;u++)o.push(n[u])});return o};n.privateGetLinkIdsBetween=function(e,t){var n=x({all:!0,combos:"all"}),r=n.adjacency,i=n.selfAdjacency,a=[];r[e]&&(a=r[e][t]||[]);e===t&&i[e]&&(a=a.concat(i[e]));return a};n.clusters=function(e){var t,n=B(e,{all:!1,factor:5,consistent:!0});n.combos="toplevel";V(n);var r,i,a=[],o=[],u=[],s=[],f={},l=0,h=[],v=[],p=[],m=[],y=[];d(n,function(e){s.push(e.id);o.push([]);u.push([]);f[e.id]=s.length-1;h.push([s.length-1]);v.push(s.length-1);y.push(s.length-1);a.push(0);p.push(0)});c(n,function(e){var t=x(e,n);l+=t;var r=f[e.id1],i=f[e.id2];if(!u[r][i]){u[r][i]=0;u[i][r]=0}u[r][i]+=t;u[i][r]+=t;a[r]+=t;a[i]+=t;p[r]+=t;p[i]+=t;o[r].push(i);o[i].push(r)});r=Math.max(1e4,50*s.length);if(0===s.length)return[];0===l&&(r=0);var b=ie();b.setSeed(n.consistent?900736044081:null);function x(e,t){var n=1;t.value&&e.d&&(n=+e.d[t.value]);return n}function w(e){i=g(i=+e)?i:5;i=Math.max(0,i);i=(i=Math.min(10,i))*i*i/125}w(n.factor);for(t=0;t<r;t++){if(b.next()>.95){S(y[Math.floor(b.next()*y.length)],y[Math.floor(b.next()*y.length)])}if(t<.5*r&&b.next()>.98){R(y[Math.floor(b.next()*y.length)])}var A=Math.floor(s.length*b.next()),M=o[A][Math.floor(b.next()*o[A].length)],I=v[M],E=v[A]
;if(I!==E){k(I,E,A)>=0&&T(A,I)}}function C(){var e,t,n=[];for(e=0;e<y.length;e++){var r=[];for(t=0;t<h[y[e]].length;t++)r.push(s[h[y[e]][t]]);n.push(r)}return n}function k(e,t,n){var r,s=p[t],f=p[e],c=a[n],d=(s-f-c)*c*i;d/=2*l;for(r=0;r<o[n].length;r++){var h=o[n][r];v[h]===t?d-=u[n][h]:v[h]===e&&(d+=u[n][h])}return d/l}function S(e,t){var n,r;if(t!==e&&0!==h[e].length&&0!==h[t].length){var a=p[e],s=p[t],f=0;f-=i*a*s/l;for(n=0;n<h[e].length;n++){var c=h[e][n];for(r=0;r<o[c].length;r++)v[o[c][r]]===t&&(f+=u[c][o[c][r]])}if((f/=l)>0){var d=h[e].length;for(n=0;n<d;n++)T(h[e][0],t)}}}function T(e,t){var n,r=v[e];v[e]=t;var i=[];for(n=0;n<h[r].length;n++)h[r][n]!==e&&i.push(h[r][n]);if(0===h[t].length){y.push(t);m.splice(m.indexOf(t),1)}h[r]=i;h[t].push(e);p[t]+=a[e];p[r]-=a[e];if(0===h[r].length){m.push(r);y.splice(y.indexOf(r),1)}}function R(e){var t,n=h[e].length;if(1!==n&&m.length){var r=[];for(t=0;t<n;t++)r.push(h[e][t]);for(t=0;t<n&&m.length;t++)T(r[t],m[0])}}return C()};n.components=function(e){var t=go,n=B(e,{all:!1});V(n);var r=ws(x(n),!0),i=Fu.connectedComponents(r.staticGraph),a={},o=r.vertexMap;t.forEach(i.iterateGroups(),function(e){a[e]={nodes:t.toArray(t.map(i.iterateGroup(e),function(e){return o.get(e)})),links:[]}});for(var u=r.edgeList,s=0;s<u.length;s++)for(var f=u[s],l=a[i.get(o.getUniqueInverse(f.id1))],c=0;c<f.ids.length;c++)l.links.push(f.ids[c]);return P(a)};var p=n.components;function m(e,t,n,r,i){e[n]||(e[n]={});e[r]||(e[r]={});if(!e[n][r]){e[r][n]=[];e[n][r]=e[r][n];t.push(i)}e[n][r].push(i)}function y(e,t,n){var r={id:t.id,id1:t.id1,id2:t.id2,ids:n};e.edges.push(r);e.connections.push(n)}function b(e){var n={connections:[],adjacency:{},vertices:{},edges:[]};d(e,function(e){n.vertices[e.id]={x:e.x,y:e.y};n.adjacency[e.id]={}});var r=[],a={};c(e,function(e){if(e.id1===e.id2){a[e.id1]=a[e.id1]||[];a[e.id1].push(e.id)}else m(n.adjacency,r,e.id1,e.id2,e.id)});for(var o=r.length,u=0;u<o;u++){var s=i[r[u]];y(n,s,n.adjacency[s.id1][s.id2])}if(X(a)){var f=n.connections.slice();t(a,function(e){f.push(e)});n.selfConnections=f}else n.selfConnections=n.connections;n.selfAdjacency=a;return n}function x(e){var t=B(e,{all:!1,combos:"toplevel"}),n=(t.all?"all":"visible")+"-"+t.combos;u||(u={});u[n]||(u[n]=b(t));return u[n]}n.internalMarkLinks=function(e){var n=x({combos:"all"}),r=n.adjacency,i=n.selfAdjacency,a=2,o=1,u={};e.forEach(function(e,n){var a=r[n];a&&t(a,function(e){for(var t=0;t<e.length;t++){var n=e[t];u[n]=!0}});var o=i[n];if(o)for(var s=0;s<o.length;s++)u[o[s]]=!0});t(u,function(t,n){var r=e.get(n);r&&r===a||e.set(n,o)})};n.distances=function(e,n){if(!r[e])throw new Error("distances error: id(s) must be present in the graph");var i=n||{};D(i);V(i);var a=T(e,i),o={};t(a.distance,function(e,t){g(e)&&(o[t]=e)});return o};var w=n.distances,A=function(e,t,n){var r,i=x(n).adjacency[e][t],a=1/0,o=k(n);if(i)for(var u=0;u<i.length;u++){var s=o(e,t,i[u],n);if(g(s)){if(s<a){a=s;(r=[]).push(i[u])}s===a&&a!==1/0&&r.push(i[u])}}return{value:a,links:r}},M=function(e,t){return i[e].a2&&i[e].id2===t||i[e].a1&&i[e].id1===t},I=function(e,t,n,r){return"any"===r.direction||("from"===r.direction&&M(n,t)||"to"===r.direction&&M(n,e))},C=function(e,t,n,r){var a=NaN;I(e,t,n,r)&&(r.value?i[n].d&&(a=+i[n].d[r.value]):a=1);return a},k=function(e){return W(e)?S:C},S=function(e,t,n,r){var i=C(e,t,n,r);return h(i)?i:1/i},T=function(e,n){var r={},i={},a=[],o=x(n).adjacency;function u(){for(var e,t=1/0,n=0;n<a.length;n++){var i=r[a[n]];if(i<=t){e=n;t=i}}return e}function s(e,t,n){i[e]||(i[e]=[]);i[e].push({id:t,links:n})}d(n,function(e){var t=e.id;r[t]=1/0;i[t]=void 0;a.push(t)});r[e]=0;for(;a.length>0;){var f=u(),l=a[f];if(r[l]===1/0)break;a.splice(f,1);t(o[l],function(e,t){var a=A(l,t,n),o=r[l]+a.value;if(o<r[t]){r[t]=o;i[t]=[{id:l,links:a.links}]}else o===r[t]&&s(t,l,a.links)})}return{distance:r,previous:i}};function L(e){e.direction=e.direction||"any";if(!/^(any|from|to)$/.test(e.direction))throw new TypeError("opts direction property should be either 'from', 'to' or 'any'")}function Z(e){e.normalization=e.normalization||"any";if(!/^(chart|component|unnormalized)$/.test(e.normalization))throw new TypeError("opts normalization property should be either 'component', 'chart' or 'unnormalized'")}function O(e){c(e,function(t){if(C(t.id1,t.id2,t.id,e)<=0)throw new Error("Link Weight must be Positive")});return{direction:e.direction,value:e.value,weights:W(e)}}function F(e){return/^(component|chart)$/.test(e.normalization)?e.normalization:"unnormalized"}function D(e){return L(e)||O(e)}function V(e){e.all=!!e.all}function W(e){return!!e.weights}function N(e){var t=0;d(e,function(){t++});return t}n.shortestPaths=function(e,t,n){if("string"!=typeof e||"string"!=typeof t)throw new Error("shortestPaths error: ids must be strings");if(!r[e]||!r[t])throw new Error("shortestPaths error: ids must be present in the graph");var i=B(n,{all:!1});D(i);V(i);var a=T(e,i),o=a.previous;if(a.distance[t]===1/0)return{onePath:[],one:[],items:[],distance:1/0};for(var u=[],s=[],f=t;o[f];){u.unshift(f);s.unshift(f);s.unshift(o[f][0].links[0]);f=o[f][0].id}u.unshift(f);s.unshift(f);function l(e){for(var t=[],n=0;n<e.length;n++)o[e[n].id]&&(t=t.concat(o[e[n].id]));return t}var c={};c[t]=1;var d=[];d.push({id:t});for(var h=l(d);h.length>0;){for(var v=0;v<h.length;v++){c[h[v].id]=1;for(var g=0;g<h[v].links.length;g++)c[h[v].links[g]]=1}h=l(h)}return{onePath:s,one:u,items:Object.keys(c),distance:a.distance[t]}};n.degrees=function(e){var n=B(e,{multi:!0,all:!1});n.combos="toplevel";D(n);V(n);var r=x(n).adjacency,i={};d(n,function(e){var a=e.id;i[a]=0;t(r[a],function(e,t){for(var r=0;r<e.length;r++){var o=C(a,t,e[r],n);if(g(o)){i[a]+=o;if(!n.multi)break}}})});return i};var j=n.degrees;n.betweenness=function(e,n){function r(e,t){return H[e]-H[t]}function i(e){e.sort(r);return e.shift()}function a(e,t){e.sort(r);Y(e,t)||e.push(t)}function u(e,t){var n=A(e,t,k).value;return g(n)?n:y()||g(n)?1/0:1}function s(e){return e.length>0}function f(){X.length=0;U.length=0;d(w,function(e){for(var t=0;t<Q.length;t++)c(Q[t].dict,e.id,Q[t].value)})}function l(e,t,n){d(e,function(e){c(t,e.id,n)})}function c(e,t,n){Array.isArray(n)&&s(n)&&e[t]?e[t].length=0:e[t]=o(n)}function h(){var e,t,n,r=p(w),i={};for(e=0;e<r.length;e++){n=r[e];for(t=0;t<n.nodes.length;t++)i[n.nodes[t]]=n.nodes.length}return i}function m(){return!G(w.value)}function y(){return!!w.directed}function b(){return w.endpoints}var w=B(e,{value:void 0,directed:!1,normalization:"component",endpoints:!1,weights:!1,all:!1});w.combos="toplevel";Z(w);V(w);var M=m()||y()?"dijkstra":"regular",I=b()?"endpoints":"regular",C=F(w),k={direction:y()?"from":"any",value:w.value,weights:W(w),all:w.all};D(w);var S,T,R,L,O,z,P={},X=[],U=[],N={},j={},_={},H={},K=0,Q=[{dict:j,value:0},{dict:H,value:1/0},{dict:N,value:[]},{dict:_,value:0}],J=x(w).adjacency,q={regular:function(e){j[e]=1;H[e]=0;X.push(e);for(;s(X);){S=X.shift();U.push(S);t(J[S],function(e,t){if(!g(H[t])){H[t]=H[S]+1;X.push(t)}if(H[t]===H[S]+1){j[t]+=j[S];N[t].push(S)}})}},dijkstra:function(e){j[e]=1;H[e]=0;X.push(e);for(;s(X);){S=i(X);U.push(S);t(J[S],function(e,t){if(H[t]>H[S]+u(S,t)){H[t]=H[S]+u(S,t);a(X,t);j[t]=0;N[t]=[]}if(H[t]===H[S]+u(S,t)){j[t]+=j[S];N[t].push(S)}})}}},$={regular:function(e){for(;s(U);){T=U.pop();O=(1+_[T])/j[T];for(L=0;L<N[T].length;L++){S=N[T][L];_[S]+=j[S]*O}T!==e&&(P[T]+=_[T])}},endpoints:function(e){P[e]+=U.length-1;for(;s(U);){T=U.pop();O=(1+_[T])/j[T];for(L=0;L<N[T].length;L++){S=N[T][L];_[S]+=j[S]*O}T!==e&&(P[T]+=_[T]+1)}}},ee={chart:function(){if(K>2){R=1/((K-1)*(K-2));t(P,function(e,t){P[t]*=R})}},component:function(){z=h();t(P,function(e,t){if(z[t]>2){R=1/((z[t]-1)*(z[t]-2));P[t]*=R}})},unnormalized:function(){if(!y()){R=.5;t(P,function(e,t){P[t]*=R})}}},te=function(){ie();E(n,P)},ne=q[M]||q.regular,re=$[I]||$.regular,ie=ee[C]||ee.chart;d(w,function(){K++});l(w,P,0);v(w,"betweenness",function(e,t){f();ne(e.id);re(e.id);t()},te)};n.closeness=function(e,n){var r=B(e,{direction:"any",value:void 0,normalization:"component",mode:"auto",weights:!1,all:!1});r.combos="toplevel";var a=x(r).adjacency;function o(e,n){var r=0;t(n,function(e){r+=g(e)?1:0});return r}function u(e){return 0===Object.keys(e).length}function s(e){return!G(e)}function f(e){return!i[e].a1&&!i[e].a2}function l(e){var n={},r=0,i={},o={};o[e]=1;for(;!u(o);){i=o;o={};t(i,function(e,i){if(!s(n[i])){n[i]=r;t(a[i],function(e,t){o[t]=1})}});r+=1}return n}function c(){return"any"!==r.direction}function d(){r.mode=r.mode||"auto";if(!r.mode.match(/^(connected|disconnected|auto)$/))throw new TypeError("Option mode property should be either 'connected', 'disconnected' or 'auto'")}function h(){d();return"auto"===r.mode?A():r.mode}function m(){return!G(r.value)}function y(){return F(r).match(/chart/)}function b(){return F(r).match(/component/)}function A(){var e="disconnected",t=p(r);if(1===t.length){e="connected";if(c())for(var n=0;n<t[0].links.length;n++)if(f(t[0].links[n]))return"disconnected"}return e}var M=D(r);Z(r);V(r);M.all=r.all;var I,C,k,S,T,R=m()||c()?"dijkstra":"regular",L=0,O={},z=h(),Y={regular:function(e){return l(e)},dijkstra:function(e,t){return w(e,t)}},P={connected:function(e,n){var r=0;t(n,function(e){r+=g(e)?e:0});return r?1/r:0},disconnected:function(e,n){var r=0;t(n,function(t,n){r+=e!==n?1/t:0});return r}},W=function(){E(n,O)};C=Y[R]||Y.regular;k=P[z];L=N(r);O={};v(r,"closeness",function(e,t){S=C(e.id,M);I=o(e.id,S);O[e.id]=k(e.id,S);if(L>1){T=y()?Math.pow(I-1,2)/(L-1):b()?I-1:1;O[e.id]*=T}t()},W)};n.kCores=function(e){var n=B(e,{all:!1});n.combos="toplevel";V(n);var r=x(n).adjacency;function i(e){var n=0;t(e,function(e){n=Math.max(n,e)});return n}var a=function(){var e,i,a,o,u,s,f,l,c,h,v,g={},p={},m=[],y=[];i=0;g=j({multi:!1,all:n.all,combos:"toplevel"});t(g,function(e){i=Math.max(i,e)});v=Object.keys(g).length;for(e=0;e<i+1;e++)y[e]=0;d(n,function(e){y[g[e.id]]++});u=1;for(e=0;e<i+1;e++){s=y[e];y[e]=u;u+=s}d(n,function(e){var t=e.id;p[t]=y[g[t]];m[p[t]]=t;y[g[t]]++});for(e=i;e>1;e--)y[e]=y[e-1];y[0]=1;for(o=0;o<v;o++){a=m[o];t(r[a],function(e,t){if(g[t]>g[a]){l=g[t];c=p[t];h=y[l];if(t!==(f=m[h])){p[t]=h;m[c]=f;p[f]=c;m[h]=t}y[l]++;g[t]--}})}return g}();return{maximumK:i(a),values:a}};return n}function xs(e,t){function n(e,t,n,r,i){this.nodeList=e;this.edgeList=t;this.staticGraph=n;this.vertexMap=r;this.edgeMap=i}var r=go.fromArray;Array.isArray(e)||(e=Object.keys(e));Array.isArray(t)||(t=values(t));var i=e.length>0&&"string"==typeof e[0]?r(e):r(e,function(e){return e.id}),a=t.length>0&&"string"==typeof t[0].id?r(t,function(e){return[e.id1,e.id2,e.id]}):r(t,function(e,t){return[e.id1,e.id2,t.toString()]}),o=new Fu.StaticListGraph,u=Fu.buildFromLabeledIterators(i,a,o);return new n(e,t,o,u.vertexMap,u.edgeMap)}function ws(e,t){var n=e.edges;if(t){var r=[];Object.keys(e.selfAdjacency).forEach(function(t){var n=e.selfAdjacency[t];r.push({id:n[0],id1:t,id2:t,ids:n})});r.length>0&&(n=n.concat(r))}return xs(e.vertices,n)}function As(){var e=q,n=Pa,r=Wa,i=3;function a(e){return!isNaN(e.w)&&!isNaN(e.h)}var o=function(t,n,i,o){var u,s,l,c,d,v,g=t.e||1,m=a(t),y=m&&"circle"===t.sh,b=!1;if(t.du)return{radius:10,baseRadius:10,borderSize:10,width:10,height:10};c=h(t);t._combo&&(b="boolean"==typeof o?o:t._combo.open);if(b){l=t.oc.w/2;v=d=t.oc.w;u=l+(c=t.oc&&"bw"in t.oc?t.oc.bw:Jn.bw)}else if(m){g=1;if(y){var x=Math.min(t.w,t.h);v=d=x+2*c;u=(l=x/2)+c}else{l=e(t.w,t.h)/2;d=t.w+2*c;v=t.h+2*c;u=e(d,v)/2}}else{v=d=2*(l=r*g)+2*(c*=g);u="box"===t.sh?e(d,v)/2:l+c}if(i.include&&t.t&&t.t.length>0){var w=f(t,n,{radius:u,height:v,width:d,e:g},i);s=Math.max(w.legacyDistToCorner,u);u=Math.max(w.distanceToCorner,u);d=Math.max(w.width,d);w.centred?v=Math.max(w.height,v):v+=w.height}else{var A=0;if(t.t){A=(p(t,i.maxLength).length+1)*((t.fs||nn)*g)}s=u+A/2}return{legacyRadius:Math.round(s),radius:Math.round(u),baseRadius:Math.round(l),borderSize:Math.round(c),width:Math.round(d),height:Math.round(v)}};function u(e,t){return!t&&("boolean"==typeof e.tc?e.tc:!e.w&&(!e.u&&!e.fi))}function s(e){return u(e,e._combo&&e._combo.open)}function f(t,n,r,a){var o=0,s=(i+(t.fs||nn))*r.e,f=v(t,n,r.e,r.radius,a.maxLength),l=f.width,c=f.height,d=u(t,r.isOpenCombo),h=a.padExtents?s:0,g=e(l/2,r.height/2+c/2);if(a.partial){var p=Math.max(1,l/(4*r.radius))*s,m=r.radius+p;if(d){l/2<=r.radius+s&&(m=l/2);o=e(m,c/2)}else o=Math.max(m,(r.height+c)/2)}else o=e(l/2,d?c/2:r.height/2+c);return{centred:d,width:l+h,height:c,distanceToCorner:o,legacyDistToCorner:g}}var l=function(e,t){var n=0;if(e.t){var r=e.fs||nn,o=a(e)?1:e.e||1;if(!s(e)){n=(r+i)*o*p(e,t).length/2}}return Math.round(n)},c=function(n,r,i,u,s,f){if(!r||isNaN(r.x)||isNaN(r.y))return 1/0;var c=Math.max(0,0|u),d=0;t(n,function(t){if(void 0!==t.x){var n=t.x-r.x,u=t.y-r.y;if(a(t)){u+=void 0!==t.labelOffset?t.labelOffset:l(t,f);var c=Math.abs(n)+t.w/2,h=Math.abs(u)+t.h/2,v=e(c,h);d=Math.max(d,v)}else{var g,p=0;if(void 0!==t.size)g=t.size;else if(void 0!==t.r){g=t.r;p=t.labelOffset}else{g=o(t,i,{include:s,maxLength:f}).radius;p=l(t,f)}var m=e(n,u+p);d=Math.max(d,m+g)}}});return Math.round(d+c)},d=function(e,n,r,i,a){var u=[],s=void 0===r?0:r;t(e,function(e){var t={include:i,maxLength:a},r=void 0!==e.r?e.r:o(e,n,t).radius;r+=s;if(!isFinite(e.x)||!isFinite(e.y)||!isFinite(r))throw new Error("Inputs must be finite");u.push({x:e.x,y:e.y,r:r})});return wu.radialExtents(u)};function h(e){var t=0;e.b&&(t=g(e.bw)?e.bw:n);!e.donut||e._combo&&e._combo.open||(t=e.donut.w+2*e.donut.bw);return t}function v(e,t,n,r,a){var o=0,u=0;if(e.t){var s=(e.fs||nn)*n,f=i*n,l=p(e,a);o=y(m(l,t,s,e.fb,e.ff));u=(s+f)*l.length;e.u||e.fi||e.c||e.bc||e.w&&e.h||(o=Math.max(o/10,r))}return{width:o,height:u}}function p(e,t){if(e.t){var n=e.t;if(void 0!==t&&n.length>t){n=n.substring(0,Math.max(0,t-3));n+="..."}return n.split(/\r\n|\r|\n/)}return[""]}function m(e,t,n,r,i){for(var a=[],o=0;o<e.length;o++)a[o]=zn(t,e[o],n,r,i||"sans-serif").width;return a}function y(e){for(var t=0,n=0;n<e.length;n++)t=Math.max(t,e[n]);return t}var b=function(e){var n,r,i,a,o=0;t(e,function(e){n=Z(n)?Math.min(n,e.x-e.size):e.x-e.size;r=Z(r)?Math.min(r,e.y-e.size):e.y-e.size;i=Z(i)?Math.max(i,e.x+e.size):e.x+e.size;a=Z(a)?Math.max(a,e.y+e.size):e.y+e.size;o++});return{x1:n,y1:r,x2:i,y2:a,c:o}},x=function(e,t){var n=go,r=xs(e,t),i=Fu.connectedComponents(r.staticGraph),a={},o=r.vertexMap;n.forEach(i.iterateGroups(),function(t,r){var u={};n.forEach(i.iterateGroup(t),function(t){t=o.get(t);var n=e[t];u[t]=n;n.c=r});a[t]={verts:u,edges:[],extents:b(u),c:r}});for(var u=0;u<t.length;u++){var s=t[u],f=a[i.get(o.getUniqueInverse(s.id1))];f.edges.push(s);s.c=f.c}return P(a)};return{labelOffset:l,nodeSize:o,radialExtentsFromPoint:c,radialExtents:d,getBounds:b,findComponents:x}}function Ms(){var e=-Math.PI/12,t=Math.sin(e),n=Math.cos(e),r=function(e,t){if(e.r===t.r){if(e.t){if(!t.t)return-1;if(e.t<t.t)return-1;if(e.t>t.t)return 1}else if(t.t)return 1;return e.id===t.id?0:e.id<t.id?-1:1}return e.r<t.r?1:-1};return{compareCircles:r,concentricLayout:function(i,a){var o,u=i;if(!u||0===u.length)return u;var s=B(a,{padding:8,radialPadding:0}),f=s.padding,l=0;u.sort(r);u=u.map(function(e){return{id:e.id,r:e.r+f,x:e.x,y:e.y,labelOffset:e.labelOffset,w:e.w,h:e.h}});var c=[],d=0,h=u[l++];if(1===u.length)g();else if(2===u.length)m();else if(3===u.length)b();else if(4===u.length)y();else if(u.length>4){var v=u[0].r;u[2].r/v>.5&&u.length>10?b():u[1].r/v>.5&&u.length>10?m():g();o=Math.abs(u[0].y-u[0].r)+s.radialPadding;h=u[l++];for(;h;)w();A(c);p()}function g(){u[0].x=0;u[0].y=-u[0].labelOffset}function p(){var e=u[0],t=u[0];u.forEach(function(n){n.y<e.y?e=n:n.y>e.y&&(t=n)});var n=(Math.abs(e.y-e.r)-(Math.sqrt(t.x*t.x+t.y*t.y)+t.r))/4;u.forEach(function(e){e.y+=n})}function m(){var e=h,t=u[l++];e.x=0;e.y=-t.r-e.labelOffset;t.x=0;t.y=e.r-t.labelOffset}function y(){var e=h,n=u[l++],r=u[l++],i=u[l++];if(n.r===r.r&&r.r===i.r){n=u[2];r=u[1]}var a=e.r+r.r,o=e.r,s=Math.sqrt(a*a-o*o),f=e.r-n.r,c=t*s;e.x=-n.r;e.y=-e.labelOffset-c;n.x=e.r;n.y=-n.labelOffset+c;r.x=f+c;r.y=-s-r.labelOffset;i.x=f-c;i.y=s-i.labelOffset}function b(){var e=h,r=u[l++],i=u[l++],a=(2*e.r+f)/Math.sqrt(3),o=(e.r-r.r)/2,s=1.25*Math.PI;e.x=a*t;e.y=-a*n+o;r.x=a*n;r.y=-a*t-r.labelOffset+o;i.x=a*Math.sin(s);i.y=-a*Math.cos(s)-i.labelOffset+o}function x(e){return 2*e.r+f}function w(){d+=h.r+o+s.radialPadding;o=h.r;var e=2*Math.PI*d,t=e-x(h),n={items:[],radius:d,spaceLeft:0,circumference:e};c.push(n);for(;h&&t>0;){n.items.push(h);(h=u[l++])&&(t-=x(h))}h&&(t+=x(h));n.spaceLeft=t;if(h&&u.length-l<5){for(var r=0;h;){r+=x(h);n.items.push(h);h=u[l++]}n.radius=(e-t+r)/(2*Math.PI);n.circumference=2*Math.PI*n.radius;n.spaceLeft=0}}function A(){c.forEach(function(t){var n=2*Math.PI/(t.circumference-t.spaceLeft),r=0,i=n*t.items[0].r;4===t.items.length&&(i-=e);var a=Math.PI/2;t.items.forEach(function(e){var o=n*e.r,u=r+o;e.x=t.radius*Math.cos(u-a-i);e.y=t.radius*Math.sin(u-a-i)-e.labelOffset;r+=n*x(e)})})}return u}}}function Is(e){var n,r,i,a,o,u,s,f,l,c,d,h,v=As(),g={},p=3,m=.5,y=Wa,b=[],x=[],w=[],A=[],M=[],I=[];function E(e,t){var n;function r(e,t,n,r,i){return{isLeaf:!0,children:[],points:[],x1:e,y1:t,x2:n,y2:r,depth:i}}function i(e){return e.depth>=t}function a(e,t){var n,i,a,o,u=.5*(e.x1+e.x2),s=.5*(e.y1+e.y2);if(0===t||1===t){a=e.y1;o=s}else{a=s;o=e.y2}if(0===t||2===t){n=e.x1;i=u}else{n=u;i=e.x2}e.isLeaf=!1;e.children[t]=r(n,a,i,o,e.depth+1)}function o(e,t){t(e);for(var n=0;n<4;n++)e.children[n]&&o(e.children[n],t)}function u(e,t){if(t.x<e.x1||t.y<e.y1||t.x>e.x2||t.y>e.y2)throw Error("[Layout] Error: the point is out of range.");if(i(e))e.points.push(t);else{e.points.push(t);var n,r=.5*(e.x1+e.x2),o=.5*(e.y1+e.y2);t.x<r&&t.y<o&&(n=0);t.x>=r&&t.y<o&&(n=1);t.x<r&&t.y>=o&&(n=2);t.x>=r&&t.y>=o&&(n=3);e.children[n]||a(e,n);u(e.children[n],t)}}var s=[],f=[];for(n=0;n<e.length;n++){s.push(e[n].x);f.push(e[n].y)}var l=Math.min.apply(0,s),c=Math.max.apply(0,s),d=Math.min.apply(0,f),h=Math.max.apply(0,f),v=c-l,g=h-d;v>g?h=d+v:c=l+g;var p=r(l,d,c,h,0);p.addPoint=function(e){u(p,e)};p.visit=function(e){o(p,e)};for(n=0;n<e.length;n++)p.addPoint(e[n]);return p}function C(e,t){return Math.sqrt(e*e+t*t)}function k(){var e=[];t(d,function(t,n){e.push({id:n,x:M[i[n]],y:I[i[n]]})});var n=E(e,p);b.length=0;x.length=0;function r(e){function t(t){if(t.isLeaf){var n,a=e.x-.5*(t.x1+t.x2),o=e.y-.5*(t.y1+t.y2),u=C(a,o),s=(t.x2-t.x1)/u,f=t.points,l=f.length;if(s>m){for(n=0;n<l;n++)if(e.id!==f[n].id){var c=e.x-f[n].x,d=e.y-f[n].y,h=Math.max(.001,C(c,d));r+=c/h;i+=d/h}}else{r+=l*a/u;i+=l*o/u}}}var r=0,i=0;n.visit(t);b.push(r);x.push(i)}for(var a=0;a<e.length;a++)r(e[a]);O(b,x)}function S(e,t,n){for(var r=t,i=B(e,L(Z(t,n),-1)),a=i.slice(),u=R(i,i),s=0;s<20&&u/o>.01;s++){var f=Z(a,n),l=u/R(f,a);r=B(r,L(a,l));var c=B(i,L(f,-l));i=c;var d=R(c,c),h=d/u;u=d;a=B(c,L(a,h))}return r}function T(){var e;for(e=0;e<o;e++){w[e]=[];A[e]={};A[e][e]=!0;for(var t=0;t<o;t++)w[e][t]=0}for(e=0;e<a.length;e++){var n=a[e],r=i[n.id1],u=i[n.id2];A[r][u]=!0;A[u][r]=!0;w[r][u]-=1;w[u][r]-=1;w[r][r]+=1;w[u][u]+=1}}function R(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function L(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r]*t);return n}function B(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r]+t[r]);return n}function Z(e,n){var r,i=[],a=0;for(r=0;r<o;r++){a=0;t(A[r],function(t,n){a+=w[r][n]*e[n]});i.push(a)}i=L(i,n);a=0;for(r=0;r<o;r++)a+=e[r];var u=[];for(r=0;r<o;r++)u.push(o*e[r]-a);return B(i,u)}function O(e,t){var n,r=0,i=0;for(n=0;n<e.length;n++){r+=e[n];i+=t[n]}r/=e.length;i/=e.length;for(n=0;n<e.length;n++){e[n]-=r;t[n]-=i}}function G(e,t,n){for(var r=0;r<t;r++){c+=1/(s+f+1);e.trigger("progress","layout",c);k(M,I);M=S(b,M,n);I=S(x,I,n);O(M,I)}}function F(t,c){var v,g;h=Object.keys(d);i={};M.length=0;I.length=0;w.length=0;A.length=0;var p=0,m=e(t.tightness);m=2-2*m/10+1;for(g=0;g<h.length;g++){v=h[g];p+=Math.max(1,d[v].size);i[v]=g}l=42*Math.sqrt(o)*m;l*=1+.02*(p/o-y);if(a.length/o<1){var b=.65,x=a.length/o;l*=b+x*(1-b)}for(g=0;g<h.length;g++){M.push(l*c.next());I.push(l*c.next())}r=o/50;n=o*Math.min(Math.sqrt(u),10);s=Math.min(8,4+2*u);f=16-s}function D(e){function t(e,t){return Math.atan2(e,t)||0}function n(e,t,n){var r=e,i=r*Math.cos(t),a=r*Math.sin(t);d[n].x=l*i;d[n].y=l*a}function r(e){var r=M[i[e]],a=I[i[e]];n(C(r,a),t(r,a),e)}e.forEach(r)}g.lens=function(e,t,i,l,g,p){c=0;e.trigger("progress","layout",c);d=t.v;a=t.e;o=t.vcount;for(var m=v.findComponents(d,a),y=m.length,b=o/y,x=0,w=0;w<y;w++)x=Math.max(x,Object.keys(m[w].verts).length);u=Math.max(x/2,b)/2;var A=[];if(o>1){F(i,g);T();G(e,s,n);G(e,f,r);D(h)}return l(e,d,{},t.extents,A,i,p)};return g}var Es=ms.names;function Cs(e){function t(e){var t=ms.KnownProperties,n=e.vertexMap,r=Fu.StaticPropertyMap.fromRange(n.keySpace(),null),i=Fu.StaticPropertyMap.fromRange(n.keySpace(),0);e.nodeList.forEach(function(e){var t=n.getUniqueInverse(e.id);r.set(t,e);i.set(t,Math.max(e.size,.5))});var a={};a[t.Position2d.name]={prop:t.Position2d.descriptor,data:r};a[t.Radius.name]={prop:t.Radius.descriptor,data:i};return a}function n(t,n,i,a,o,u){a.trigger("progress","layout",0);var s=ms.createLayout(t,r.staticGraph,n.libgOpts);new ms.SetTimeoutRunner(s,0,100).start(i,function(t){if(t)throw new Error(t);a.trigger("progress","layout",1);o(a,e.v,{},e.extents,{length:1},n,u)})}var r=xs(P(e.v),e.e);function i(e,i,a,o){var u=t(r);i.libgOpts={initializationOptions:{seed:i.consistent?7:void 0},packingOptions:{padding:{proportion:.2,min:25,max:200}}};n(Es.organic,i,u,e,a,o)}return{organic:i}}function ks(e){var n=As(),r={},i=Math.pow(10,-3.8),a=27,u=1.35,s=Math.pow(a,u);function f(e,t,n,r,i,a,o,u,s,f){var l=i[o];if(!(l in n)){if(!(l in r))throw new Error("link has end which is not in nodes list");var d=r[l];if(d.hi)throw new Error("link has end which is hidden");n[l]=c(e,t,d,l,u,s,f)}return l}function c(t,r,i,a,o,u,s){var f={include:u};if(u){var l=e.options().truncateLabels;f.maxLength=l?l.maxLength:void 0}var c=n.nodeSize(i,r,f);return{id:a,x:i.x,y:i.y,size:s?c.legacyRadius:c.radius,fixed:!!o&&a in o,lc:0,d:i.d,w:c.width,h:c.height,labeloff:n.labelOffset(i)}}function d(e,t){return e.fixed&&!t.fixed?-1:t.fixed&&!e.fixed?1:0}function h(e,n,r,i,a,o,u,s,l){for(var d=a().connections({all:!1,combos:l}),h={},v=[],g=0;g<d.length;g++){var p=d[g][0],m=i[p],y=f(e,n,h,r,m,p,"id1",o,u,s),b=f(e,n,h,r,m,p,"id2",o,u,s);if(null!==y&&null!==b){var x,w=[{id:p,sign:1,off:m.off}],A=m.w||1;for(x=1;x<d[g].length;x++){m=i[p=d[g][x]];w.push({id:p,sign:m.id1===y?1:-1,off:m.off});A=Math.max(A,m.w||1)}v.push({id1:y,id2:b,id:p,arrowSize:e.arrowLength(A,1),links:w,numLinks:w.length});h[y].lc+=1;h[b].lc+=1}}t(r,function(t,r){if(!t.hi&&(l||!t.parentId)&&!h[r]){var i=c(e,n,t,r,o,u,s);h[r]=i}});var M=Object.keys(h).length;return{v:h,e:v,vcount:M}}r.extractStructure=function(e,t,r,i,a,o,u,s){var f=P(Es).indexOf(u)>=0,l="lens"!==u&&!f,c="radial"!==u&&!f,d=null;if(o){d={};for(var v=0;v<o.length;v++)d[o[v]]=1}var g=h(e,t,r,i,a,d,c,l,s);g.extents=n.getBounds(g.v);return g};var v="_dummy",p=RegExp("^"+v);function m(e){return p.test(e.id)}function y(e,n,r,i,a,o,u){var s,f,l,c={},d={},h={},p=[],m={},y={},b=i(),x=u;for(s=0;s<a.length;s++){h[s]={};m[s]=[];var w=[],A=1/0;t(a[s].verts,function(e,t){if(e.d&&g(e.d[r])){l=e.d[r];if(!h[s][l]){h[s][l]=[];m[s].push(l)}h[s][l].push(t);y[t]=l;if(l<A){A=l;w=[t]}else l===A&&w.push(t)}else if(o)throw new Error("Sequential Layout: Node is missing valid level data.")});if(0===w.length){var M=Object.keys(a[s].verts)[0];w.push(M);y[M]=0;h[s][0]=[M];m[s].push(0)}m[s].sort(function(e,t){return e-t});var I=[];for(f=0;f<m[s].length;f++){var E=m[s][f];I=[];var C,k,S=b.neighbours(h[s][E]),T=((m[s][f+1]||E+1)+E)/2;for(k=0;k<S.nodes.length;k++){C=S.nodes[k];if(G(y[C])){I.push(C);y[C]=T}}if(I.length){m[s].splice(f+1,0,T);h[s][T]=I}}if(!o)for(f=0;f<w.length;f++){c[w[f]]=1;e[w[f]].level=0}d[s]=w}if(o){for(s=0;s<a.length;s++)for(f=0;f<m[s].length;f++)-1===p.indexOf(m[s][f])&&p.push(m[s][f]);p.sort(function(e,t){return e-t});for(s=0;s<a.length;s++)for(f=0;f<p.length;f++)h[s][p[f]]=f;x=x||[]}else for(s=0;s<a.length;s++)for(f=0;f<m[s].length;f++)h[s][m[s][f]]=f;var R,L,B,Z,O,F,D,V,Y=0,P={};function W(t){var n=t.origId||t.id,r={id:v+n+"-"+Y++,level:t.level-1,origId:n,x:0,y:0,c:t.c,size:10,fixed:!1,lc:t.lc,du:!0,w:20,h:20,labeloff:0};e[r.id]=r;a[t.c].verts[r.id]=r;P[r.id]=1;return r}function X(e,t,r){var i={id:v+t.id+"-"+r.id,id1:t.id,id2:r.id,c:e.c,numLinks:e.numLinks};"level"in t&&"level"in r&&(i.level=Math.max(t.level,r.level));n.push(i);a[e.c].edges.push(i);return i}function U(e,t,n){var r=W(e),i=n.id1===t.id;X(n,i?r:e,i?e:r);r.level===t.level+1?X(n,i?t:r,i?r:t):U(r,t,n)}function N(e,t,n){if(e.level>0){var r=W(e);X(n,e,r);X(n,r,t)}if(e.level<p.length-1){var i=W(e);i.level+=2;X(n,e,i);X(n,i,t)}}for(var j=0,_=n.length;j<_;j++){L=z((R=n[j]).id1);B=z(R.id2);Z=e[L];O=e[B];Z.level=h[Z.c][y[L]];O.level=h[O.c][y[B]];var H=Z.level,K=O.level;if(g(H)&&g(K)){R.level=Math.max(H,K);if(H<K){P[O.id]=1;V=Z;D=O}else if(K<H){P[Z.id]=1;V=O;D=Z}}if((F=Math.abs(H-K))>1)U(D,V,R);else if(o&&0===F){N(Z,O,R);x.push(R)}}if(o)for(s=0;s<a.length;s++){var Q=d[s][0];1!==d[s].length||e[Q].level||(e[Q].level=h[s][y[Q]])}else t(e,function(t,n){if(!P[n]&&!c[n]){for(var r,i=d[e[n].c],a=1/0,o=0;o<i.length;o++){var u=b.shortestPaths(n,i[o]);if(u.distance<a){r=u;a=u.distance}}for(var s=0;s<r.one.length;s++){var f=r.one[s],l=e[f];if(l&&"level"in l&&l.level<t.level){var h=X(t,t,l);t.level-l.level>1&&U(t,l,h);break}}}});return n}function b(e,n,r,i){for(var a,o,u,s,f=i(),l=0;l<r.length;l++){var c=f.distances(r[l]);t(c,function(t,n){"level"in e[n]||(e[n].level=1/0);e[n].level=Math.min(e[n].level,t)})}for(var d=0;d<n.length;d++){a=n[d].id1;o=n[d].id2;u=e[a];s=e[o];"level"in u&&"level"in s&&(n[d].level=Math.max(u.level,s.level))}}function x(e,n){var r={};function i(e,t,n,i){r[e]=r[e]||[];r[e][t]=r[e][t]||{};r[e][t][n]=r[e][t][n]||[];r[e][t][n].push(i)}t(e,function(e,t){"level"in e&&i(e.c,e.level,"vertices",t)});for(var a=0;a<n.length;a++)"level"in n[a]&&i(n[a].c,n[a].level,"edges",n[a]);return r}function w(e,n){var r={};function i(e,t,n,i){r[e]=r[e]||[];r[e][t]=r[e][t]||{vertices:[],edges:[]};for(var a=0;a<t;a++)r[e][a]=r[e][a]||{vertices:[],edges:[]};r[e][t][n]=r[e][t][n]||[];r[e][t][n].push(i)}t(e,function(e,t){"level"in e&&i(e.c,e.level,"vertices",t)});for(var a=0;a<n.length;a++)"level"in n[a]&&1===Math.abs(e[n[a].id1].level-e[n[a].id2].level)&&i(n[a].c,n[a].level,"edges",n[a]);return r}var A=ie();r.layout=function(e,n,r,i,a,o){n.trigger("prechange","layout");var u="^(standard|hierarchy|lens|sequential|radial|structural|tweak|"+P(Es).join("|")+")$";if(!new RegExp(u).test(e))throw new Error("The layout name is not valid.");var s=U(["standard","structural"]);A.setSeed(null);if(s[e]||a.consistent){var f=R(a.fixed||[]),l=U(a.fixed),c=0,d=0;if(f.length){t(l,function(e,t){if(t in r.v){c+=r.v[t].x;d+=r.v[t].y}});c/=f.length;d/=f.length}t(r.v,function(e,t){if(!l[r.v[t].id]){r.v[t].x=c;r.v[t].y=d}})}a.consistent&&A.setSeed(900736044081);switch(e){case"standard":N(n,r,i,a,o);break;case"hierarchy":L(n,r,i,a,o);break;case"lens":return Is(I).lens(n,r,a,Q,A,o);case"sequential":T(n,r,i,a,o);break;case Es.organic:Cs(r).organic(n,a,Q,o);break;case"structural":pe(n,r,i,a,o);break;case"radial":L(n,r,i,a,o,Y);break;case"tweak":ee(n,r,a,o)}};function M(e,t){for(var n=[],r=R(e),i=0;i<r.length;i++)t[r[i]]&&n.push(r[i]);return n}function I(e){var t=Number(e);t=g(t)?t:5;t=Math.max(0,t);return t=Math.min(10,t)}function E(e){return 10*(5-I(e))}function C(e){var n=0,r=0;t(e,function(e){if("level"in e&&!m(e.id)){n+=e.size;r+=1}});return n/r}function k(e){var n=0;t(e,function(e){n=Math.max(n,e.length)});return n}function S(e,n){for(var r=[],i=k(e),a=0;a<i;a++){var o=0,u=0,s=0,f=0,l=0;t(e,function(e){if(e[a]){for(var t=e[a].vertices,r=0;r<t.length;r++){var i=t[r],s=n[i].size;u+=s;o=Math.max(o,s)}f+=t.length}});s=u/f;var c=r[a-1];c&&o<c.max+c.yOffset&&(l=(c.max+c.yOffset)/2);r[a]={max:o,average:s,sum:u,yOffset:l}}return r}function T(e,r,i,a,u){var s=B(a,{top:[],orientation:"down",spacing:"auto"}),f=s.level,l=50+E(s.tightness),c=s.orientation.match(/down|up/)?"w":"h",d=s.orientation.match(/down|up/)?"h":"w",h=r.v,v=r.e,g=n.findComponents(h,v,i),p=[];if(!f)throw new Error("Sequential Layout: LayoutOptions is missing valid level property.");v=y(h,v,f,i,g,!0,p);var b,x,A,M=w(h,v);U();W();function I(e,t,n,r){var i,a,o,u,s,f,l=!0,c=-1;for(i=0;i<n.length;i++){var d=n[i];if(!r&&h[d].barycenter===1/0){l=!1;break}var v=0,g=0;for(a=0;a<t.length;a++){u=-1;d===t[a].id1?u=t[a].id2:d===t[a].id2&&(u=t[a].id1);if(-1!==u)if(h[u].barycenter===1/0)l=!1;else{g++;-1!==(s=e.indexOf(u))&&(v+=s)}}h[d].prevPos=i;f=!0;g>0?h[d].barycenter=v/g:h[d].barycenter===1/0?l=!1:0===i?h[d].barycenter=0:f=!1;if(f){if(c+1<i){var p=n[c],m=Math.min(h[d].barycenter,h[p].barycenter),y=Math.abs(h[d].barycenter-h[p].barycenter)/(i-c);for(o=1;o<i-c;o++)h[n[c+o]].barycenter=m+y*o}c=i}}n.sort(function(e,t){return h[e].barycenter===h[t].barycenter?h[e].prevPos-h[t].prevPos:h[e].barycenter-h[t].barycenter});return l}function C(e,t,n){e.sort(function(e,r){var i=Math.max(t.indexOf(e.id1),t.indexOf(e.id2)),a=Math.max(n.indexOf(e.id1),n.indexOf(e.id2)),o=Math.max(t.indexOf(r.id1),t.indexOf(r.id2)),u=Math.max(n.indexOf(r.id1),n.indexOf(r.id2));return i<o||i===o&&a<u?-1:1})}function T(e,t){var n,r;if(t<1||e.length<=t)return 0;n=e[t].edges;(r=[e[t-1].vertices,e[t].vertices]).sort(function(e,t){return e.length-t.length});return R(n,r[1],r[0])}function R(e,t,n){var r,i,a,o,u;if(e.length<2)return 0;C(e,t,n);r=e.map(function(e){var t=n.indexOf(e.id1);-1===t&&(t=n.indexOf(e.id2));return{index:t,multiplier:-1===t?0:e.numLinks}});i=1;for(;i<r.length;)i*=2;a=new Array(2*i-1);for(var s=0;s<a.length;s++)a[s]=0;i-=1;o=0;for(var f=0;f<r.length;f++){a[u=r[f].index+i]+=r[f].multiplier;for(;u>0;){u%2&&(o+=a[u+1]*r[f].multiplier);a[u=Math.floor((u-1)/2)]+=r[f].multiplier}}return o}function L(e,t,n,r){var i,a=o(t),u=[];a.forEach(function(t){u.push(t.id1===e?t.id2:t.id1)})
;r.forEach(function(e){a.push(e);i=e.id1===n?e.id2:e.id1;-1===u.indexOf(i)&&u.push(i)});return{verts:u,edges:a,common:t.length===r.length&&t===a.length}}function G(e,t){return L(e,h[e].childEdges||[],t,h[t].childEdges||[])}function z(e,t){return L(e,h[e].parentEdges||[],t,h[t].parentEdges||[])}function Y(e,t){var n,r,i,a,o,u,s=1,f=e[t].vertices,l=0,c=[],d=[];t>0&&(c=e[t-1].vertices);t<e.length-1&&(d=e[t+1].vertices);var v=0;for(n=0;n<f.length-1;n+=s){o=0;u=0;if(t>0){if(!(i=z(f[n],f[n+1])).common){i.verts.sort(function(e,t){return c.indexOf(e)-c.indexOf(t)});if(i.verts.length>1){o+=R(i.edges,i.verts,[f[n],f[n+1]]);u+=R(i.edges,i.verts,[f[n+1],f[n]])}}}else i={common:!0};if(t<e.length-1){if(!(a=G(f[n],f[n+1])).common){a.verts.sort(function(e,t){return d.indexOf(e)-d.indexOf(t)});if(a.verts.length>1){o+=R(a.edges,a.verts,[f[n],f[n+1]]);u+=R(a.edges,a.verts,[f[n+1],f[n]])}}}else a={common:!0};i.common&&a.common&&(h[f[n+1]].swapBlockStart=h[f[n]].swapBlockStart||n);if(u<o){var g=h[f[n]].swapBlockStart||n;r=f[g];f[g]=f[n+1];f[n+1]=r;h[f[g]].swapBlockStart=g;h[f[n+1]].swapBlockStart=g+1;l+=o-u;if(1===s){v=Math.max(v,n);s=-1}if(0===(n=g)){n=v;s=1}}else if(-1===s){n=v;s=1}}return l}function P(e){var t,n;do{n=0;for(t=0;t<e.length;t++)n+=Y(e,t)}while(n>0)}function W(){var e,n,r,i,a,u,s,f,l=!0;t(M,function(t,c){f=0;u=void 0;s=t.length;for(e=0;e<t.length;e++)if(t[e].vertices.length>0){s=e;break}if(s!==t.length-1){t[s].vertices.sort(function(e,t){return h[t].childEdges.length-h[e].childEdges.length});h[t[s].vertices[0]].barycenter=0;a=1/0;do{n=a;if(i){a=0;u=o(t)}else a=1/0;for(e=s;e<t.length-1;e++){r=I(t[e].vertices,t[e+1].edges,t[e+1].vertices,!0);if(l){I(t[e+1].vertices,t[e+1].edges,t[e].vertices,!1);r=I(t[e].vertices,t[e+1].edges,t[e+1].vertices,!1)}}i=r;for(e=t.length-1;e>s;e--){r=I(t[e].vertices,t[e].edges,t[e-1].vertices,e<f+2);if(l){I(t[e-1].vertices,t[e].edges,t[e].vertices,!1);r=I(t[e].vertices,t[e].edges,t[e-1].vertices,!1)}else a+=T(t,e);r||(i=!1)}l=!i}while(f++<100&&(a===1/0||a<n));u&&(M[c]=u);a>0&&v.length<1e4&&P(M[c])}})}function X(e,t,n){return e[n]&&e[n].edges?e[n].edges.filter(function(e){return e.id1===t||e.id2===t}):[]}function U(){var e,n;t(M,function(t){for(e=0;e<t.length;e++){var r=t[e].vertices;for(n=0;n<r.length;n++){var i=r[n];h[i].barycenter=1/0;h[i].childEdges=X(t,i,e+1);h[i].parentEdges=X(t,i,e)}}})}function N(){var e,n;t(M,function(t){for(e=0;e<t.length;e++){var r=t[e].vertices;for(n=0;n<r.length;n++){var i=r[n];h[i].orderPos=n;h[i].children=F(M,h,i);h[i].parents=D(M,h,i)}}})}function j(e,t,n,r){var i,a,o=t,u=t.filter(function(e){return m({id:e})});u.length>0&&(o=u);a=o.length;e.root=e;e.align=e;if(a>0){var s=[Math.floor((a+1)/2)-1,Math.ceil((a+1)/2)-1];for(i=0;i<2;i++){var f=n?s[i]:s[1-i],l=h[o[f]],c=l.orderPos;if(n&&r<c||!n&&r>c){l.align=e;e.root=l.root;e.align=e.root;return c}}}return r}function _(e,t,n){var r,i,a,o,u,s,f="l"===t[1];if(void 0===e[t]){r=e;e[t]=0;do{var d=-1;f&&r.orderPos>0?d=r.orderPos-1:!f&&r.orderPos<n[r.level].vertices.length-1&&(d=r.orderPos+1);if(-1!==d){_(a=(i=h[n[r.level].vertices[d]]).root,t,n);e.sink.id===e.id&&(e.sink=a.sink);o=r[c];u=i[c];if("h"===c)if(f){u+=2*i.labeloff;o-=2*r.labeloff}else{u-=2*i.labeloff;o+=2*r.labeloff}s=(o+u)/2+l;e.sink.id!==a.sink.id?a.sink.shiftData.push({vert:e.sink,dist:e[t]-a[t]-s}):e[t]=Math.max(e[t],a[t]+s)}r=r.align}while(r.id!==e.id)}}function H(e,t){e[t]=e.root[t];if(e.root.id===e.id){var n=e.root.sink.shift;if(!n){var r=e.root.sink.shiftData;n=1/0;for(var i=0;i<r.length;i++){var a=r[i].dist;r[i].vert.shift<1/0&&(a+=r[i].vert.shift);n=Math.min(n,a)}e.root.sink.shift=n}n<1/0&&(e[t]+=n)}}function J(e,t){var n,r,i,a,o=[],u=1/0,s=-1/0,f="l"===t[1],l="u"===t[0],c=l?0:e.length-1,d=l?1:-1,v=function(t){return l?t<e.length:t>=0},g=function(e){return f?0:e.length-1},p=f?1:-1,m=function(e,t){return f?e<t.length:e>=0};for(n=c;v(n);n+=d){i=e[n].vertices;var y=-1;f||n===c||(y=e[n-d].vertices.length);for(r=g(i);m(r,i);r+=p){a=h[i[r]];var b=l?a.parents:a.children;O(a,t)&&(a[t]=void 0);y=j(a,b,f,y);o.push(a);a.sink=a;a.shiftData=[];a.shift=void 0}}for(r=0;r<o.length;r++)(a=o[r]).root.id===a.id&&_(a,t,e);for(r=0;r<o.length;r++){H(a=o[r],t);u=Math.min(u,a[t]);s=Math.max(s,a[t])}if(!f){q(e,t);return{max:-u,min:-s}}return{max:s,min:u}}function q(e,t){for(var n=0;n<e.length;n++)for(var r=e[n].vertices,i=0;i<r.length;i++){h[r[i]][t]*=-1}}function $(e){var t=J(e,"ul"),n=J(e,"ur"),r=J(e,"dl"),i=J(e,"dr"),a=[t,n,r,i].sort(function(e,t){return e.max-e.min-(t.max-t.min)});function o(e,t){return e-t}for(var u=0;u<e.length;u++)for(var s=e[u].vertices,f=0;f<s.length;f++){var l=h[s[f]],c=[l.ul-t.min+a[0].min,l.ur-n.max+a[0].max,l.dl-r.min+a[0].min,l.dr-i.max+a[0].max].sort(o);l.x=(c[1]+c[2])/2}}function ee(e){var t,n;for(t=0;t<e.length;t++){var r=0,i=e[t].vertices;for(n=0;n<i.length;n++){var a=h[i[n]];if(!m(a)){var o=a[c]/2,u="h"===c?a.labeloff:0;r+=o-u;a.x=r;r+=o+u+l}}var s=(r-l)/2;for(n=0;n<i.length;n++)h[i[n]].x-=s}}function te(e){var t,n,r,i,a=[],o=[],u=0;for(t=0;t<e.length;t++){r=e[t].vertices;a[t]=0;o[t]=0;for(n=0;n<r.length;n++)if(!m(i=h[r[n]])){a[t]+=i[c];o[t]++}var s=a[t]+l*(o[t]-1);u=Math.max(u,s)}for(t=0;t<e.length;t++){r=e[t].vertices;if(o[t]>1){var f=(u-a[t])/(o[t]-1),d=0;for(n=0;n<r.length;n++)if(!m(i=h[r[n]])){var v=i[c]/2,g="h"===c?i.labeloff:0;d+=v-g;i.x=d;d+=v+g+f}}else for(n=0;n<r.length;n++)m(i=h[r[n]])||(i.x=u/2)}}function ne(e){var n,r,i,a=1/0,o=-1/0,u=re(),s=k(M);for(n=0;n<g.length;n++)t(g[n].verts,function(e){a=Math.min(a,e.x);o=Math.max(o,e.x)});r=(o-a)/(e*s);r=Math.max(r,u);t(M,function(e){i=0;for(var t=0;t<e.length;t++){for(var n=e[t].vertices,a=0;a<n.length;a++){A=n[a];h[A].y=i}i+=r}});return r}function re(){var e,t,n=0,r=S(M,h),i=[];for(e=0;e<v.length;e++){var a=v[e].level,o=v[e].arrowSize;i[a]=Math.max(i[a]||0,2*o)}for(t=0;t<r.length;t++){var u=r[t].max,s=0;r[t+1]&&(s=r[t+1].max);var f=i[t]||0;n=Math.max(n,u+s+l+f)}return n}function ie(e){var t,n,r,i,a={};i="equal"===s.spacing||"stretched"===s.spacing?function(e){return e.c}:function(){return 0};function o(e,t){return Number(e)-Number(t)}for(t=0;t<p.length;t++){var u=p[t];u.links.sort(function(e,t){return(Z(e.off)?e.off*e.sign:1/0)-(Z(t.off)?t.off*t.sign:1/0)});var f=0,c=0,g=0,y=!0,b=M[i(u)][u.level].vertices,x=b.indexOf(u.id1),w=b.indexOf(u.id2),A=[x,w].sort(o);for(n=A[0]+1;n<A[1];n++){var I=h[b[n]];m(I)||(y=!1);for(r=0;r<I.parentEdges.length;r++)f+=I.parentEdges[r].numLinks;for(r=0;r<I.childEdges.length;r++)c+=I.childEdges[r].numLinks;var E=(I[d]||I.size)/2;g=Math.max(g,E)}if(!y){if(c===f){f=h[b[A[0]]].parentEdges.length+h[b[A[1]]].parentEdges.length;c=h[b[A[0]]].childEdges.length+h[b[A[1]]].childEdges.length}var C=x<w?1:-1;c<f&&(C*=-1);s.orientation.match(/right|up/)&&(C*=-1);var k=g+20,S=40,T=e/2;k+=Math.abs(h[u.id1].x-h[u.id2].x)/l;(k=Math.min(k,T))+(u.links.length-1)*S>T&&(S=Math.max(10,(T-k)/(v.links.length-1)));for(n=0;n<u.links.length;n++){var R=u.links[n],L=k+n*S;a[R.id]={off:C*R.sign*L}}}}return a}N();var oe=s.ratio;"right"!==s.orientation&&"left"!==s.orientation||(oe=1/oe);var ue=[];if("equal"===s.spacing||"stretched"===s.spacing)for(var se=0;se<g.length;se++)ue[se]=g[se].verts;else{var fe=[],le=[];ue[0]={};t(M,function(e,t){for(b=0;b<e.length;b++){fe[b]||(fe[b]={vertices:[],edges:[]});if(le[b]){x=e[b].vertices;for(var n=0;n<x.length;n++){A=x[n];h[A].orderPos+=le[b]}}fe[b].vertices=fe[b].vertices.concat(e[b].vertices);fe[b].edges=fe[b].edges.concat(e[b].edges);le[b]=fe[b].vertices.length}ue[0]=K(ue[0],g[t].verts)});(M={})[0]=fe}var ce=0;t(M,function(e,r){"equal"===s.spacing?ee(e):"stretched"===s.spacing?te(e):$(e);var i=n.getBounds(ue[r]);ce-=i.x1;t(ue[r],function(e,t){h[t].x+=ce});ce+=i.x2+l});var de=ie(ne(oe));if(s.orientation.match(/up|right|left/)){var he=V(s.orientation);t(M,function(e){for(b=0;b<e.length;b++){x=e[b].vertices;for(var t=0;t<x.length;t++){A=x[t];he(h[A])}}})}var ve=[],ge=r.extents;Q(e,h,de,ge,ve,s,u)}function L(e,r,i,a,o,u){var s=B(a,{top:[],orientation:"down",stable:!0,flatten:!1}),f=s.level,l=u?1:E(s.tightness),c=s.top,d=s.tidy,h=!u&&s.flatten,v=r.v,g=r.e,p=r.extents,m=n.findComponents(v,g,i);if(f)g=y(v,g,f,i,m,!1);else{c=M(c,v);b(v,g,c,i)}var w=x(v,g),A=C(v),I=S(w,v);function k(){var e,n;t(w,function(t){for(var r=t.length-1;r>=0;r--)for(var i=t[r].vertices,a=[],o=0;o<i.length;o++){n=i[o];var u=F(w,v,n);v[n].children=[];v[n].subChildrenCount=0;if(0!==u.length){var s=[];for(e=0;e<u.length;e++)a.indexOf(u[e])<0&&s.push(u[e]);if(s.length>0){v[n].children=s;v[n].subChildrenCount=T(s);for(e=0;e<s.length;e++){a.push(s[e]);v[s[e]].parent=n}}}}})}function T(e){for(var t=0,n=0;n<e.length;n++){var r=v[e[n]].subChildrenCount;t+=0===r?1:r}return t}var R=2*A+24+l;function L(e,t,n){n||(e.x=t);var r=t-e.subChildrenCount*(R/2),i=e.children;if(i)for(var a=0;a<i.length;a++){var o=v[i[a]],u=o.subChildrenCount;0===u&&(u=1);var s=r+u*R;L(o,(s+r)/2,!1);r=s}}function Z(e,t,n){for(var r,i=t.miny,a=Math.PI*(2/3),o=0,u=0;u<w[e].length;u++){var s=w[e][u].vertices,f=I[u].yOffset,l=I[u].average,c=2*((A<l?l:A)+12)+f;i+=o;for(var d=0;d<s.length;d++){r=s[d];var h=v[r];h.y=i;if(!n){var g=h.children;if(g&&g.length>1){var p=O(G(g.map(function(e){return v[e]})),a);c=Math.max(c,p)}}}o=c}}function O(e,t){return e/(2*Math.tan(t/2))}function G(e){for(var t=1/0,n=-1/0,r=0;r<e.length;r++){var i=e[r].x;t=Math.min(t,i);n=Math.max(n,i)}return n-t}function D(e,t){for(var n=V(t),r=0;r<w[e].length;r++)for(var i=w[e][r].vertices,a=0;a<i.length;a++)n(v[i[a]])}k();var z={},Y={};t(w,function(e,t){var n=Number(t);z[n]=fe(m[n].verts);Y[n]={children:w[t][0].vertices,subChildrenCount:T(w[t][0].vertices)}});t(w,function(e,t){L(Y[t],z[t].x,!0);Z(t,z[t],h)});t(w,function(e,t){u||D(t,s.orientation)});u&&u(v,w,m,z,A,s.tightness);var P=[];d?H(e,v,m,0,1,p,P,s,o):Q(e,v,{},p,P,s,o)}function F(e,t,n){var r,i,a,o,u=t[n].c,s=t[n].level+1,f=e[u][s],l={},c=[];if(f){for(a=0;a<f.edges.length;a++){var d=f.edges[a];r=d.id1+"";i=d.id2+"";r===n&&(l[i]=1);i===n&&(l[r]=1)}var h=f.vertices;for(o=0;o<h.length;o++)l[r=h[o]+""]&&c.push(r)}return c}function D(e,t,n){var r=[],i=t[n].level;if(i>0){var a,o,u,s=t[n].c,f=e[s][i],l={};if(f&&f.edges){for(o=0;o<f.edges.length;o++){var c=f.edges[o];c.id1===n?l[c.id2]=1:c.id2===n&&(l[c.id1]=1)}var d=e[s][i-1];if(d&&d.vertices)for(u=0;u<d.vertices.length;u++)l[a=d.vertices[u]]&&r.push(a)}}return r}function V(e){var t={up:function(e){e.y=-e.y;e.x=e.x},down:function(){},right:function(e){var t=e.y;e.y=e.x;e.x=t},left:function(e){var t=e.y;e.y=e.x;e.x=-t}};return t[e]||t.down}function Y(e,n,r,i,a,o){function u(e,t){return(e.r+t.r)/(e.a-t.a)}function s(e,t,n){var r=t>0?e+n:e+n/2;return r>0?r:e}function f(e,t,n,r){if(r&&1===e.length)return 0;var i=t,a=i;for(l=1;l<e.length;l++)a=Math.max(u(h[e[l]],h[e[l-1]]),a);return s(a,a-i,n)}var l,c,d,h,v=E(o);t(n,function(t,n){var o=fe(r[Number(n)].verts),u=0,s=u,g=4*a,p=g,m=2*a+24;for(c=0;c<t.length;c++){var y,b=t[c].vertices;h=[];for(l=0;l<b.length;l++){d=b[l]+"";var x=(y=e[d]).x-o.minx,w=o.maxx-o.minx+m;if((x*=2*Math.PI/w)<0||x>2*Math.PI)throw new Error("[Radial] Theta angle should be in the range [0; 2*PI]");h[d]={a:x,r:y.size}}s=u;0===c?b.length>1&&(u+=g/2):u+=g;if((u=f(b,u,v,c<1))-s>p){p=u-s+1;g=Math.max(g,p/2);0===c&&b.length<3&&(u/=2)}for(l=0;l<b.length;l++){(y=e[b[l]+""]).x=i[Number(n)].x+u*Math.cos(h[y.id].a);y.y=i[Number(n)].y+u*Math.sin(h[y.id].a)}}})}function W(e,t){var n=e.extents.c,r=Math.max(e.extents.x2-e.extents.x1,e.extents.y2-e.extents.y1),i=120*Math.sqrt(n),a=Math.max(r,i)/2,o=0;n>1&&(o=Math.min(Math.pow(n,2.5),100));var u=o*n*Math.log(n),s=1/X(t);return{repulsionFactor:40*Math.max(1,Math.pow(s,2)),coeff:1,naturalDistance:20*s,iterations:o,chunk:20,temperature:a,temp:a,estTime:u}}function X(e){var t=I(e.tightness);return Math.pow(2,.4*(t-5))}function N(e,t,r,i,a){var o=t.v,u=t.vcount,s=t.e,f=n.findComponents(o,s,r),c=t.extents,d=i.fixed||[],h=i.tidy;se(o);var v=f.length,g=0,p=h?u/(u+v):1;e.trigger("progress","layout",0);for(var m,y=[],b=0,x=Date.now(),w=0;w<f.length;w++){var A=W(f[w],i);b+=A.estTime;y.push(A)}for(var M=0,I=0;I<f.length;I++){y[I].start=M;var E=M+(p-g)*(y[I].estTime/b);y[I].stop=E;M=E}var C=0;function k(t){var n=t,r=f[n],i=y[n];re(e,r,i,i.start,i.stop,function(){ue(r.verts);C++;if(++n<f.length){m=Date.now();if(m-x>16||C>1e3){x=m;C=0;l(function(){k(n)},0)}else k(n)}else S()})}function S(){h?H(e,o,f,p,1,c,d,i,a):Q(e,o,{},c,d,i,a)}f.length>0?k(0):Q(e,o,{},c,d,i,a)}function _(e){return P(e).some(function(e){return e.fixed})}function H(e,n,r,i,a,o,u,s,f){for(var l={},c=[],d={},h=1/0,v=1/0,g=0;g<r.length;g++){var p=le(r[g].verts);l[g]=p;var m=u.length>0&&_(r[g].verts);c.push({x:p.x,y:p.y,width:p.width,height:p.height,id:g,fixed:m});d[g]={x:p.x,y:p.y};h=Math.min(h,d[g].x);v=Math.min(v,d[g].y)}var y=B(s,{strategy:"rect",ratio:4/3});Ce(c,{strategy:y.strategy,step:30,max:2,sort:!1,ratio:y.ratio,tightness:y.tightness},function(r){h="rect"===y.strategy?h:0;v="rect"===y.strategy?v:0;for(var i={},a=0;a<r.length;a++){i[r[a].id]=r[a];i[r[a].id].x+=h;i[r[a].id].y+=v}t(n,function(e){var t=i[e.c].x-d[e.c].x,n=i[e.c].y-d[e.c].y;e.x+=t;e.y+=n});Q(e,n,{},o,u,y,f)})}function Q(e,t,r,i,a,o,u){var s=n.getBounds(t);0===a.length&&(s=oe(t,i,s));g(s.x1)||(s=null);if(!u)return{vertices:t,updatedEdges:r,extents:s};l(function(){e.trigger("progress","layout",1);u({vertices:t,updatedEdges:r,extents:s},o)})}function J(e,t,n){$(e[t.id1],e[t.id2],n)}function $(e,t,n){var r,i,a;if(!e.fixed||!t.fixed){var o=2*A.next()*Math.PI;a=1.3*ce(e,t,n)/2;if(e.fixed||t.fixed){r=e.fixed?e.x:t.x;i=e.fixed?e.y:t.y;a*=2}else{r=(e.x+t.x)/2;i=(e.y+t.y)/2}if(!e.fixed){e.x=r+a*Math.cos(o);e.y=i+a*Math.sin(o);o+=Math.PI}if(!t.fixed){t.x=r+a*Math.cos(o);t.y=i+a*Math.sin(o)}}}function ee(e,t,r,i){var a={temperature:10,i:0},o={verts:t.v,edges:t.e},u=W(t,r);u.chunk=5;u.iterations=5;a.temperature=Math.pow(u.temperature,.72);te(a,o,u);var s=n.getBounds(o.verts);g(s.x1)||(s=null);e.trigger("progress","layout",1);i({vertices:o.verts,extents:s},r,!1)}function te(e,n,r){for(var i=Math.min(e.i+r.chunk,r.iterations);e.i<i;){var a=n.verts,o=n.edges,u=0;t(a,function(e){e.dx=0;e.dy=0;u++});se(a,2);if(1===u){e.i=i;return}if(2===u){if(o[0])J(a,o[0],r.naturalDistance);else{var s=P(a);$(s[0],s[1],r.naturalDistance)}e.i=i;return}ve(a,r.repulsionFactor);for(var f=0;f<o.length;f++)de(o[f],a,r.naturalDistance,r.coeff);var l=e.temperature*(1-e.i/r.iterations);t(a,function(e){he(e,l)});e.i++}}function re(e,t,n,r,i,a){var o={i:0,temperature:n.temperature};function u(){return r+(i-r)*(o.i/n.iterations)}function s(){return o.i>=n.iterations}function f(){te(o,t,n)}function c(){f();if(s())a();else{e.trigger("progress","layout",u());l(c,0)}}c()}function oe(e,n,r){var i=(r.x1+r.x2)/2-(n.x1+n.x2)/2,a=(r.y1+r.y2)/2-(n.y1+n.y2)/2;t(e,function(e){e.x-=i;e.y-=a});return{x1:r.x1-i,y1:r.y1-a,x2:r.x2-i,y2:r.y2-a}}function ue(e){var n,r,i,a=0,o=0,u=0,s=!1,f=0,l=0;t(e,function(e){a+=e.x;o+=e.y;u+=1;s=s||e.fixed});if(!(u<3||s)){a/=u;o/=u;t(e,function(e){if((n=Math.sqrt((e.x-a)*(e.x-a)+(e.y-o)*(e.y-o)))>l){l=n;f=Math.atan2(e.y-o,e.x-a)}});f=-f;var c=Math.sin(f),d=Math.cos(f);t(e,function(e){r=a+(e.x-a)*d-(e.y-o)*c;i=o+(e.x-a)*c+(e.y-o)*d;e.x=r;e.y=i})}}function se(e,n){var r=n||30;t(e,function(e){if(!e.fixed){e.x+=r*(A.next()-.5);e.y+=r*(A.next()-.5)}})}function fe(e){var n=0,r=0,i=0,a=1/0,o=1/0,u=-1/0,s=-1/0;t(e,function(e){n+=1;r+=e.x;i+=e.y;o=Math.min(o,e.x);a=Math.min(a,e.y);u=Math.max(u,e.x);s=Math.max(s,e.y)});r/=n;i/=n;var f=0,l=!1;t(e,function(e){var t=e.x-r,n=e.y-i,a=Math.sqrt(t*t+n*n);f=Math.max(a+1.5*e.size,f);l=l||e.fixed});return{x:r,y:i,sum:n,size:f,fixed:l,miny:a,minx:o,maxy:s,maxx:u}}function le(e,n){var r=G(n)?{}:n,i=20,a=1/0,o=1/0,u=-1/0,s=-1/0;t(e,function(e,t){if(!(t in r)){o=Math.min(o,e.x-e.size);a=Math.min(a,e.y-e.size);u=Math.max(u,e.x+e.size);s=Math.max(s,e.y+e.size)}});return{x:o-=i,y:a-=i,width:(u+=i)-o,height:(s+=i)-a}}function ce(e,t,n){return e.size+t.size+n*(1+((e.lc?e.lc:1)+(t.lc?t.lc:1))/6)}function de(e,t,n,r){var i=t[e.id1],a=t[e.id2],o=i.x-a.x,u=i.y-a.y,s=ce(i,a,n),f=q(o,u);if(f>.02){var l=r*((f-s)/f),c=o*l,d=u*l;i.dx-=c;i.dy-=d;a.dx+=c;a.dy+=d}}function he(e,t){if(!e.fixed){var n=q(e.dx,e.dy),r=e.dx/n*Math.min(n,t),i=e.dy/n*Math.min(n,t);e.x+=r;e.y+=i}}function ve(e,n){var r,o,f,l,c=fe(e);r=c.minx;f=c.miny;var d=(o=c.maxx)-r,h=(l=c.maxy)-f;d>h?l=f+d:o=r+h;function v(e,t,n,r){return{leaf:!0,nodes:{},point:null,x1:e,y1:t,x2:n,y2:r}}function g(e,t){var n=e.x1,r=e.y1,i=e.x2,a=e.y2,o=.5*(n+i),u=.5*(r+a),s=t.x>=o,f=t.y>=u,l=(f?2:0)+(s?1:0);e.leaf=!1;s?n=o:i=o;f?r=u:a=u;e.nodes[l]||(e.nodes[l]=v(n,r,i,a));p(e.nodes[l],t)}function p(e,t){if(e.leaf){var n=e.point;if(n){if(Math.abs(n.x-t.x)+Math.abs(n.y-t.y)<.01){g(e,t);return}e.point=null;g(e,n);g(e,t);return}e.point=t}else g(e,t)}function m(e,t){if(!e(t))for(var n=t.nodes,r=0;r<4;r++)n[r]&&m(e,n[r])}function y(e){var t=0,n=0;e.charge=0;e.size=0;if(!e.leaf)for(var r=e.nodes,i=0;i<4;i++){var a=r[i];if(a){y(a);e.charge+=a.charge;e.size+=a.size;t+=a.charge*a.cx;n+=a.charge*a.cy}}if(e.point){var o=I(e.point);e.pointCharge=o;e.charge+=o;e.size+=e.point.size;t+=o*e.point.x;n+=o*e.point.y}e.cx=e.charge?t/e.charge:0;e.cy=e.charge?n/e.charge:0}var b,x=.5;function w(e){if(e.point!==b){var t=e.cx-b.x,n=e.cy-b.y,r=1/q(t,n);if((e.x2-e.x1)*r<x){M(b,e,e.charge,r,t,n);return!0}e.point&&M(b,e.point,e.pointCharge,r,t,n)}return!e.charge}var A=1e5;function M(e,t,n,r,i,a){E(e,n,i,a,Math.min(r,A))}function I(e){return a*Math.pow(e.size,u)/s*(1+(e.lc?e.lc:1)/3)}function E(e,t,r,a,o){if(!(o<i)){var u=n*I(e)*t*o*o*o;e.dx-=r*u;e.dy-=a*u}}var C=v(r,f,o,l);t(e,function(e){p(C,e)});function k(){t(e,function(e){b=e;m(w,C)})}y(C);k();return C}function ge(e,t,n,r,i,a){e[t]=r?n[t]:{x:i,y:a}}function pe(e,n,r,i,a){var o=1.25-(I(i.tightness)-5)/10,u=ye(n.v,n.e);N(e,me(u,n.v,o),r,i,function(e,r,i){var o={};t(e.vertices,function(e,t){if(u.rev[t])for(var r=e.fixed,i=0;i<u.rev[t].length;i++){var a=u.rev[t][i],s=e.x,f=e.y;if(e.jit.positions){s+=e.jit.positions[a].x;f+=e.jit.positions[a].y}ge(o,a,n.v,r,s,f)}else ge(o,t,n.v,n.v[t].fixed,e.x,e.y)});var s={vertices:o,extents:e.extents};a(s,r,i)})}function me(r,i){var a,o,u={},s=[],f=0;t(r.rev,function(a,o){for(var l={x:0,y:0,size:0},c=a.length,d=!1,h=0;h<c;h++){var v=i[a[h]];l.x+=v.x;l.y+=v.y;l.size+=v.size}l.x/=c;l.y/=c;var g=document.createElement("canvas").getContext("2d"),p=Ms(),m=P(i).filter(function(e){return r.rev[o].indexOf(e.id)>-1}).map(function(t){t.r=n.nodeSize(e.privateGetItem(t.id),g,{include:!1}).radius;t.rwt=n.nodeSize(e.privateGetItem(t.id),g,{include:!0}).radius;t.labelOffset=0;return t}),y=0,b=0;m.forEach(function(e){y+=e.r;b+=e.rwt});var x=(b-y)/m.length,w=.5,A={positions:j(m=p.concentricLayout(m,{padding:Math.max(8,x*w)}))},M=n.radialExtentsFromPoint(m,{x:0,y:0},g,0);u[o]={x:l.x,y:l.y,size:M,fixed:d,jit:A,lc:0};f++;for(var I=a[0],E={},C=r.index[I],k=0;k<C.length;k++){var S=C[k];E[r.ids[S]]=1}t(E,function(e,t){o<t&&s.push({id1:o,id2:t})})});for(var l=0;l<s.length;l++){a=s[l].id1+"";o=s[l].id2+"";u[a].lc++;u[o].lc++}t(i,function(e,t){if(!r.ids[t]){u[t]={x:e.x,y:e.y,size:e.size,lc:0,fixed:e.fixed,jit:{radius:e.size,position:{x:0,y:0}}};f++}});return{v:u,e:s,vcount:f,extents:n.getBounds(u)}}function ye(e,t){return Ae(we(t))}function be(e,t,n){e[n]||(e[n]=[]);e[n].push(t)}function xe(e,t){be(e,t.id1,t.id2);be(e,t.id2,t.id1)}function we(e){for(var t={},n=0;n<e.length;n++)xe(t,e[n]);return t}function Ae(e){var n,r={},i={};t(e,function(e,t){e.sort();n="";for(var a=0;a<e.length;a++)n+=e[a];r[n]||(r[n]=[]);r[n].push(t);i[t]=n});return{rev:r,ids:i,index:e}}function Me(e,t,n,r){var i,a,o={},u=0,s=t.length-1;do{i=Ie(e,t,n,s,o,r);u=Math.max(i.radius,u);s=i.index}while(s>=0);switch(t.length){case 4:a=2;break;case 3:a=2.5;break;case 2:a=3;break;case 1:a=1;break;default:a=2}return{positions:o,radius:u*a}}function Ie(e,t,n,r,i,a){var o=r;if(0===o){i[t[0]]={x:0,y:0};return{radius:n,index:-1}}var u=(o+1)*n,s=n,f=Math.sqrt(u/(Math.PI*s))*s,l=Math.floor(2*Math.PI*f/n);l=Math.min(l,o+1);var c=2*Math.PI/l,d=0;switch(l){case 2:d=Math.PI/2;f*=.75;break;case 3:d=Math.PI/3;f*=.85;break;case 4:d=0;f*=.85;break;case 5:d=0;f*=.9;break;default:d=0}f*=a;for(var h=0;h<l;){i[t[o-h]]={x:f*Math.cos(d),y:f*Math.sin(d)};d+=c;h++}return{radius:f,index:o-=l}}function Ee(e,t,n,r){var i,a=0,o={};for(i=0;i<t.length;i++)a+=e[t[i]].size;if(1===t.length)o[t[0]]={x:0,y:0};else{var u=Math.PI/4;2===t.length&&(u=Math.PI/2);4===t.length&&(u=0);t.length<4&&(a*=1.5);var s=2*Math.PI/t.length,f=r*a/4;for(i=0;i<t.length;i++){o[t[i]]={x:f*Math.cos(u),y:f*Math.sin(u)};u+=s}}return{positions:o,radius:a}}r.arrange=function(e,r,i,a,o,u,s,f){function l(e,t){var n,r=[];for(n=0;n<t.length;n++)e[t[n]]&&r.push(t[n]);return r}function c(e,t,n,r,i){var a;for(a=0;a<e.length;a++)if(e[a].id===t){e[a].x=n-e[a].width/2;e[a].y=r-e[a].height/2;break}return i(e)}var d,h,v,g={tidy:function(e,t,n){return ke(e,{step:30,max:2,sort:!1,ratio:t.ratio},n)},average:function(e,t,n){return c(e,t.specialId,t.centre.x,t.centre.y,n)},absolute:function(e,t,n){return c(e,t.specialId,t.absolute.x,t.absolute.y,n)}},p={grid:function(e,t,n,r){var i=2*n+24+r,a=0,o=0,u=Math.floor(Math.sqrt(e.length)),s=Math.ceil(e.length/u),f={};for(d=0;d<u;d++){for(h=0;h<s;h++){var l=s*d+h;e[l]&&(f[e[l]]={x:a,y:o});a+=i}a=0;o+=i}return f},circle:function(e,t,n,r){return Ee(t,e,n,1.25-(5-r)/50).positions},radial:function(e,t,n,r){return Me(t,e,n,1.25-(5-r)/50).positions}},m="#arranged#";function y(e,t,n,r,i){var a={},o=[],u={};for(d=0;d<e.length;d++){u=le(e[d].verts,t);if(isFinite(u.width)){o.push({x:u.x,y:u.y,width:u.width,height:u.height,id:d});a[d]={x:u.x,y:u.y}}}u=le(t);o.push({x:u.x,y:u.y,width:u.width,height:u.height,id:m});a[m]={x:u.x,y:u.y};M(o,{ratio:x.ratio,centre:n,absolute:r,specialId:m},function(e){return i({packed:e,original:a})})}function b(e,n,r){var i,a;t(e,function(e){if(e.arranged){i=r[m].x-n[m].x;a=r[m].y-n[m].y}else{i=r[e.c].x-n[e.c].x;a=r[e.c].y-n[e.c].y}e.x+=i;e.y+=a})}var x=B(s,{tightness:5,position:"average",x:0,y:0});r.trigger("prechange","arrange");var w=a.v,A=E(x.tightness),M=g[x.position]||g.average,I=p[e]||p.grid,C={x:Number(x.x)||0,y:Number(x.y)||0},k={x:0,y:0},S=R(i);if((S=l(w,S)).length){v=0;for(d=0;d<S.length;d++){v+=w[S[d]].size;k.x+=w[S[d]].x;k.y+=w[S[d]].y}v/=S.length;k.x/=S.length;k.y/=S.length;var T=I(S,w,v,A),L={};t(T,function(e,t){w[t].x=e.x;w[t].y=e.y;L[t]=w[t];L[t].arranged=1});y(n.findComponents(w,a.e,o),L,k,C,function(e){for(var t=e.packed,n=e.original,i={},o=0;o<t.length;o++)i[t[o].id]=t[o];b(w,n,i);var u=[],s=a.extents;Q(r,w,{},s,u,x,f)})}else f()};function Ce(e,t,n){function r(e,t,n){return(t-e)*n+e}function i(e,t,n){return(e-n)/(t-n)}function a(e,t,n,a,o,u){var s=i(t,n,a);return r(u,o,s=Math.pow(s,e))}function o(e,t){if(t.length<1)return!1;function n(t){var n=e.y<t.y+t.height,r=e.y+e.height>t.y;return n&&r}function r(t){var n=e.x<t.x+t.width,r=e.x+e.width>t.x;return n&&r}var i,a;for(i=0;i<t.length;i++)if(r(a=t[i])&&n(a))return!0;return!1}var u,s,f,l={spiral:function(e){var t=a(.6,e,100,0,g,1),n=a(1,e,600,0,.3,.5)*e;return{x:Math.cos(n)*t,y:Math.sin(n)*t}},rect:function(e){return ke(e,t,n)}},c=0,h=[],v=l[t.strategy]||l.rect,g=0;for(u=0;u<e.length;u++){s=e[u];g+=s.width}g/=2*e.length;if("rect"===t.strategy)return v(e);e.sort(d);for(u=0;u<e.length;u++){(s=e[u]).x=s.fixed?s.x:0;s.y=s.fixed?s.y:0;for(;o(s,h)&&!s.fixed;){f=v(c,s);s.x=f.x;s.y=f.y;c++}h.push(s)}return n(h)}function ke(e,t,n){function r(){for(var t=0,n=0;n<e.length;n++)t+=e[n].width*e[n].height;return t}function i(e,t){var n=d(e,t);return n||t.height-e.height}function a(e){for(var t=0,n=0;n<e.length;n++)t<e[n].width&&(t=e[n].width);return t}function u(e){for(var t=o(e),n=0;n<t.length;n++){var r=t[n].width%c.step,i=t[n].height%c.step;0!==r&&(t[n].width+=c.step-r);0!==i&&(t[n].height+=c.step-i)}return t}function s(e){return!g||e.ratio()>=c.ratio-.2&&e.ratio()<=c.ratio}function f(e){for(var t=E(c.tightness),n=0;n<e.length;n++){e[n].width+=t;e[n].height+=t}}function l(e){var t=1.1,n=1.03,r=10,i=Math.sqrt(e.area()*t/c.ratio)*n,a=i*c.ratio;a<e.maxWidth+r&&(a=e.maxWidth+r);return{width:a,height:i,lowestFreeHeightDeficit:0,ratio:function(){return m.width/m.height}}}var c=B(t,{ratio:4/3,max:10,sort:!0,step:10,tightness:5});c.sort&&e.sort(i);f(e);var h,v=u(e),g=!0;if(0!==e.length){var p={area:r,maxWidth:a(v),maxHeight:v[0].height},m=l(p),y=0;ne(function(){return m.width>=p.maxWidth},function(){var e=Se(v,m);if(0===e.comps.length){m.width*=1.03;m.height*=1.03}else{y++;if(!h||s(e)){(h=e).efficiency=p.area()/e.area();if(s(e))return!0}if(y>=c.max)return!0}return!1},function(){return n(h.comps)})}else{h=Te();n(h.comps)}}function Se(e,t){var n,r=Te();t.canvas||(t.canvas=Re());for(var i=t.canvas.setDimensions(t.width,t.height),a=0,o=0,u=0;u<e.length;u++){var s=e[u];if(!(n=i.addRect(s.width,s.height)).placed){r.width=0;r.height=0;r.comps.length=0;r.lowestHeightFlushedRightItem=0;break}s.x=n.offsetX;s.y=n.offsetY;r.comps.push(s);s.y+s.height>r.height&&(r.height=s.y+s.height);s.x+s.width>r.width&&(r.width=s.x+s.width);var f=s.width+s.x;if(f>o||f===o&&s.height>a){r.lowestHeightFlushedRightItem=n.lfhd;a=s.height;o=f}}t.lowestFreeHeightDeficit=i.lfhDeficitSinceLastRedim();return r}function Te(){var e={width:0,height:0,area:function(){return e.width*e.height},comps:[],lowestHeightFlushedRightItem:0,ratio:function(){return 0===e.width?1/0:e.width/e.height}};return e}function Re(){var e=0,t=Le(),n=Be;function r(e,t){return t-(f.height-e)}function i(e,n,r){if(r.leftOverW>0){f.cells+=t.rows();var i=e+(r.nRequiredCellsH-1);t.insertCol(i,r.leftOverW)}if(r.leftOverH>0){f.cells+=t.cols();var a=n+(r.nRequiredCellsV-1);t.insertRow(a,r.leftOverH)}for(var o=e+(r.nRequiredCellsH-1);o>=e;o--)for(var u=n+(r.nRequiredCellsV-1);u>=n;u--)t.setItem(o,u,!0)}function a(e,n,r,i){i.nRequiredCellsH=0;i.nRequiredCellsV=0;i.leftOverW=0;i.leftOverH=0;for(var a,o=0,u=0,s=n;u<r.height;){a=e;o=0;for(;o<r.width;){if(t.item(a,s))return!1;o+=t.colWidth(a);a++}u+=t.rowHeight(s);s++}i.nRequiredCellsH=a-e;i.nRequiredCellsV=s-n;i.leftOverW=o-r.width;i.leftOverH=u-r.height;return!0}function o(e,n){f.width=e;f.height=n;f.area=s();t.init(e,n,!1);return f}function u(e,o){var u={offsetX:0,offsetY:0,width:e,height:o,placed:!1},s=0,l=0,c=0,d=0,h={};f.addAttempts++;for(var v=Be;;){h={};for(;l<t.rows()&&t.item(s,l);){d+=t.rowHeight(l);l++}if(l<t.rows()&&r(d,u.height)<=0){if(a(s,l,u,h)){i(s,l,h);u.offsetX=c;u.offsetY=d;u.placed=!0;break}d+=t.rowHeight(l);l++}var g=r(d,u.height);if(g>0){d=0;l=0;c+=t.colWidth(s);s++;f.lfhDeficitSinceLastRedim()>g&&(n=g)}if(f.width-c<u.width){u.placed=!1;break}}v=n;return{offsetX:u.offsetX,offsetY:u.offsetY,lfhd:v,placed:u.placed}}function s(){return f.width*f.height}var f={matrix:t,cells:e,addAttempts:0,addRect:u,lfhDeficitSinceLastRedim:function(){return n},setDimensions:o};return f}function Le(){var e=[],t=[],n=[],r=0,i=0;function a(){if(e.length>0||t.length>0){e.length=0;t.length=0;n.length=0}}function u(o,u,s){if(o<=0)throw new Error("[Matrix] Column size cannot be 0 or similar");if(u<=0)throw new Error("[Matrix] Row size cannot be 0 or similar");r=1;i=1;a();e.push({index:0,size:o});t.push({index:0,size:u});n[0]=[];n[0][0]=s;return c}function s(e,a){for(var o=t[e].index,u=0;u<i;u++)n[u][r]=n[u][o];e<r-1&&t.splice(e+1,0,{index:r,size:a});t[e+1]={index:r,size:a};t[e].size-=a;r++;return c}function f(t,r){var a=e[t].index;n[i]=o(n[a]);t<i-1&&e.splice(t+1,0,{index:i,size:r});e[t+1]={index:i,size:r};e[t].size-=r;i++;return c}function l(){var n,a,o,u="\n     ",s=0,f=0;for(s=0;s<i;s++){n=Math.floor(e[s].size/100)%10==0?" ":""+Math.floor(e[s].size/100)%10;a=Math.floor(e[s].size/10)%10==0&&" "===n?" ":""+Math.floor(e[s].size/10)%10;o=Math.floor(e[s].size)%10==0&&" "===n&&" "===a?" ":""+Math.floor(e[s].size)%10;u+=e[s].size>999?" "+e[s].size+" ":" "+n+a+o+" "}u+="\n";for(s=0;s<r;s++){n=Math.floor(t[s].size/100)%10==0?" ":""+Math.floor(t[s].size/100)%10;a=Math.floor(t[s].size/10)%10==0&&" "===n?" ":""+Math.floor(t[s].size/10)%10;o=Math.floor(t[s].size)%10==0&&" "===n&&" "===a?" ":""+Math.floor(t[s].size)%10;u+=t[s].size>999?" "+t[s].size+": ":" "+n+a+o+": ";for(f=0;f<i;f++)u+=c.item(f,s)?"  X  ":"  .  ";u+="\n"}return u}var c={init:u,cols:function(){return i},rows:function(){return r},item:function(r,i){return n[e[r].index][t[i].index]},setItem:function(r,i,a){n[e[r].index][t[i].index]=a},insertRow:s,insertCol:f,colWidth:function(t){return e[t].size},rowHeight:function(e){return t[e].size},inspect:l};return c}var Be=16e6;return r}var Ss={"Arrow-ne.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAMAAABF0y+mAAAARVBMVEUAAAAAruoAruoAruoArukArOsAre8AruoArusAr+0Ap+IArusAruoAruoAr+oAruoAr+oArusArusAreoAruoAruoArurGDVJ2AAAAFnRSTlMA7PlILTQSzUApCPry5LWHbmZYV56dONEurAAAAHFJREFUKM+90DkOgDAMRFGzZQOyQu5/VCRiVwzp4LdPsqyhj3MpG6vedBprreOu/RFiNg6pZKijhToaqaOBgK6MJ8BlY/TAhsppbNt9eYc2zG0NbPyzwtbUQmM1yEQLMtGETHIPA81sMKXFsLJhtfRjF/wgC8yO94CNAAAAAElFTkSuQmCC","Arrow-nw.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAMAAABF0y+mAAAAPFBMVEUAAAAAruoAresArusAruoAqvEArusAresArusAp+IArekAruoAr+oAruoAr+oAruoAruoAr+oAresArurF+043AAAAE3RSTlMA7jL5SBJYQSwI8+TOzLWeh29nYHqaQgAAAHNJREFUKM+9z8kKwDAIRdHXIVOnDP7/v7Yk2QRU6KK9Sw+I4peMd7aEYRSczSle574Q0bJiyFGPMVjFkBVDUgxRMVwdt5nBk3oTo3vdufHafp8nTk2/hVXfjFdXTVBbTdDymKgBUBRv1St6GIgqG+ANPuwGG+MKJZ7NkmMAAAAASUVORK5CYII=","Arrow-se.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAMAAABF0y+mAAAAP1BMVEUAAAAAr+oAruoAruoAruoAruoAsOkAr+sAreoAr+sAruoAp+IAr+sAruoAruoAruoAruoAruoAreoA//8Arur2XPH+AAAAFHRSTlMAL/nsSOsSaldAKgjx48/MtJ2GARaOxv8AAAB2SURBVCjPvcs5EoQwEENRYYxXGDbd/6yzdYCrmiaCH+qVcGehGPYaunMjT7UMNLS71r7RaqiPx2/fqHcJiooxQ1ExFmj6Nwao+jO3Q9Pxa5wARaUZio6Ci4LeCa6GcTOM0TAmw5gVc9O8rFtMuTZWP0sJOx7oDS3DCuS8EfUUAAAAAElFTkSuQmCC",
"Arrow-sw.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAMAAABF0y+mAAAAQlBMVEUAAAAArusAruoArukAruoAruoArusAsvEAruoArusArusAr+0AruoAruoAr+oAruoAruoAr+oArusAn98As+YAruriSELzAAAAFXRSTlMA+Ugt7usyEc1XQCny5LWeh25mCArMFThRAAAAc0lEQVQoz73JSQ6EMAwEQAdmyMYO/f+vIpClFiLxDepa8qXW16/7BV8/gPs8/LNxrajNOFmb+kl0ujxK0OVRhi6PPM7l3blreTcDzu2LJwGKR6Nez6NJ0zWFnGHsAmMjjE0wdk9xmacxDI5b4HOK6ybvOgBebguIlLvi1QAAAABJRU5ErkJggg==","Arrow.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAABACAMAAAB4KUSAAAAAflBMVEUAAACVlZWRkpWSkpaQkpWRk5WQkpWSkpWQkpaPj4////9wcHCRkpX9/f3S09TU1NWztLaSkpKGhoaPj492dnb39/empqahoaGJiYmDg4NycnLt7e3j4+Pc3NzExMS6urqysrOXl5eLi4t8fHz7+/vx8fHg4OCrq6vo6OjGxsZuZdNVAAAACnRSTlMAGLS4bEXLqI8QHTDIvAAAAPxJREFUSMft1rlSw0AQhGEZMMe21rJ1opV1IWzD+78gVaNIimaagnKgP9vgizqYjbb+ptdHbfuF28X61vCQaCrj5zX0TtMhfrgv6Fl49CSsBxaiY2FIKJgC+ZmEmBoSIi1IiNOnGb5DqjwJMbAQHQtDwkGZ0wI/MCdzUlDmpKDMSUGZUw0zLBpYiI6FIaGgzKmDJ8zlwFRVVVneem+AUri4OT0Ms+ytcGozgam3wbRxHaTWBMfCuSIXWBrgeJNXKTAv9PDqpBbSt/nM+VpgZoauh/Rlhhdx49kM3Yi6b5hTfm39nX8e/gcOR03xCr7F6l6iRfsnbbtoa+u3/QB6AlluQsKWJgAAAABJRU5ErkJggg==","Hand.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAABACAMAAAB4KUSAAAAArlBMVEUAAACVlZWRkpWSkpaQkpWRk5WQkpWSkpWQkpaPj4////+RkpVwcHD9/f3S09TU1NWztLbKysqzs7Px8fHv7+/u7u7p6emWlpZzc3PS0tKDg4P5+fnCwsKioqJ3d3f19fXm5ubc3NzY2Ni5ubm2trapqambm5uRkZGLi4v8/Pzz8/Pr6+vi4uLGxsa8vLyvr6+Ojo6AgIB4eHh0dHTo6Oiurq6lpqd9fX2Hh4d7e3sYjczTAAAACnRSTlMAGLS4bEXLqI8QHTDIvAAAAWNJREFUSMft1dduwjAYhmE66HA+QzMgk+zF3tDe/43VQqlQzIGdVEgc5JV+Owd5pESy5F7Xffp4ka1fc0+KfDwcDGU6KW88pESmgfLcQdbhmB8PLaBtAbDshtDwEh+lVsJPPKMBtHcAHJe4DoCdLQ3HezimNWFPE8t0sB/LwgzKlAwvcEimCjJZaGLJ1nU1SxSBJFSgslWrRgVQhC0h/HELWC7CDcwWMCJkAYs2h+wrR8DdYLhKhkVzSBMLrOZQBUqzgn8TGxJwi5SS+AJriWAAuGxLG0Md0NlGi6aQOjhd3rM5OBdAYle/Rzm4gC84chn8OblNxUYA3W9sprdwjUwASbiHdgtNeCJIPCDmHf1BJIQ0x3nGQR0IhJDMtshpHcZwiBiSCPDqcIVcBpIU1nJkXIvOWElBOgHXNhDBSqa7mjPn0rcVnenX3Ee/kR8Xal8yKRz8VKR779Xqv8r21Ovq+m+/Ii1ihjYVGpMAAAAASUVORK5CYII=","Nav-Control-Head.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAABoCAMAAAAqwkWTAAABDlBMVEUAAACRkpWWlpqRk5WRkpWRkpWRkpWRkpWRkpWOjpSRkpWRkpWRkZORkpWRkpWRkpWRk5WRkZeRkpWRkpWSkpWRkpWRkZaRkZaRkpWRkpWRkpWQkZWRkpWRkpSRkpX///8ArurQ0dORkpX8/v8Jsev7+/y/6/rY2NqfoKLq6usiue3f4OHg9f1TyfH4/f7Hx8nT1NWurrHp+f2UlZfw8fFNxvHz8/T29vfm5ufi4+S8vb6qq62Wl5qW3vfu7u+3t7nl9/2s5fiT3faJ2vVizfIpu+2am57y+/4RtOzE7fpr0fPc3N2xsbSnqKqD2PUZt+y36fmN2/bCwsSkpad+1vRGxfCk4/hy0/Q8we/Kysxfm/hGAAAAH3RSTlMA+QdRsCLmzbkMj+wZ8dWdeBRpWklCNCzcwXI8h35gX/9DngAABnpJREFUaN61mmlD2kAQhjfcyOl91oE3pAnFChTKXdFK8a7Wq/r//0g1tZiwTDZYeb7y4WF2J7Ozk4gpCC9tZGLr0bVEKrIWXQ/NbW/Oi/cmsLwV1SCTCC2svp9lfiFmS6xqJ3/WLu41mvViq2Q+9i96eCKSWQq8RyzBkAbUuuW2QTINs2M9u+ZW/jeYDwmg1y8ZxFPPdwFEg/+j2dKAqmmQir2yBaQX37iC8WdNv0i+0M0bYO1NUQUjqHXq5J9SFwiFp9WEQ0Cf0fAqC9qH6dZvUYNVoqkxyjVEpwgqkAHKbArsnpzs8mnRRSroe9miGLaJ4+Ayl7u84rOiDMz5W77NFKpN4viVs/nssVNDxOJCzZKGa93TY/ONNzUuEFWX220NeVJ4bL4Ti1HFmiolFlAzlR61qY+ItymIWkntUZv0DtaSgmdZwxmxHL461KY+onxGrKRQ8e1R71MswBXrCMpKj3/TBeYYUQh9X55CwZepMcTkGrEBy/Dj+bS/88mXqYRUeNIGaTX+7Ll3eoicpgPeVEZU3qZA2uNB/XLs8rhMx0d86nWRlURZVInlwO1xm66IZa+mjS9e2Gvh6N7tcZsOiKeMkJRx18SzU3B63KbCPvEY1ljmLdsZx3M78kimQ+/THWuufIih4t3kfH9Kh8HRWIp8fkqFb+RNF4vO1JYCklU7E7LraEdXNixIu3YoT7PiwrFLqxgaNCvOEB2J5lCmmaFbWPlXFBKo0+woj6p4EF2aIXUkAlIqzITuSzrEtVqTZkn+pQ4tTSqn+v4uvYGjLyTTQILLOf3Xca7we5LKqBdbreKeMbkk3j2VqY8kYcG+UUfRGvd8zj1zJ/n3zvIvmEWDO7XkotTBxnNLgp4ueSYeAA0z76BSHC8/A65bNhGyk7vKeHKn5KSYH6M0ZvrE9eVNpOyj9ZrxuEWlvMTYNfpHjjMNkRQigwrjyTn3tZWfwJkrpt85ztTFshDraDOegWuYMJGWK7c/caYOFoRIoDHZ83XXebvPT6bpSm/O9Ig5EUeP88iJIFMiP6YzhEQYltpDZp7D8GNqY12swlJ7mnmWIvkwFREVm7gYPXCMx145fu140/2okcSaWB49rwesh1q8yCTG5Gz5GoiIIM7pL19ZD5V4UYU8TN9HpUFzHBIPTDftWyRvwc+RKCE2R+f46WvI46W+PcXS0c+c9I/riIgV3IyqvGxS79GZh+fuNevSzufoY4Ez1XlRi/f8+DL6o4iKJIakNOm8qOHDQyXEhNBgqE0lNhd0Hx6qICNEGkVSmppsYfDjoWtkhQjBpMmmE3VIpiugQ8ZD5wgKsYUyTTZdOi4qhqneoROnR26DttEnxnToXLyKcuHuOI8BBIRdvhnTwNUDVRQeumQ81P57c0mgzphuyYZZvUqD3Dy4PPJ9IoQKTTQVdsb7R9OhaenSNILxUBVL9tBRnjWdXD57DuSOvN42bUtp1BRLbdCD5DFqmj26C2OoS8364eB2h5sdGDoxnJye3ss/lv5dLtNo0yzpIPtvftahGWL0kBQ2SfQMmh0mYq9zE5Nmx/nr7GRxlrflOlKjcXEgMsN06GDLOb+v0oxo1LR5IRwhFWk2XGPOPSE+J092bgeH0njr6vT0QBVQT0s6RfEISuTBQeH5fDohJ7sDu9PxHhP0x6fsQc+J3U5BPt13Xzrb316eNiJx4SaGsmLSaZskT66w6zlSXRTymHiPOAavHYvLY7PvNdiKCYksbgz+hYHT5PYc66ynBS0sZGJ8bT26dJlsj/rlRNPCtphAMsKXvBNnv+fyfGYD0s+RYd6HoVckCbnfu5I8zAaluXdiWQzrapON2lNBalVwZGA1edNUnjNoy4InhAuDN03hadcQFB4E1nGhjkntKfWwIDyJr8NS7ZPaYwIbQkEghKEi95SePLRFoSaDnsmb1B6jA21J+OED0DFYk8pTvEFkRfhjOYGbPc5k390HrKdSQ2xe+CW5jhr3LciX04ev7Lm6VwWyYho+MF+3KL9tWdsU0xGOAedTdSy6yX2to/4CCect39HkLSAWFm8hvhEBuqZBahqPQ2B9SbyVwEIE6HXauncwlSqAmGJzVKrFGACrY9aZjWk9VmtAKrMi/ptkNo1nWb/sfvPRbFeuqz0AWigYEO9DeCGUgM3Quqie96vdG6sHm/RcMC7eldXtrVBawyupaCYbTIrZEEiGV5aDi0ubq+F5MRV/AMrHP3wtA6vJAAAAAElFTkSuQmCC","Nav-Control-Short-Zoom.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAACACAMAAACMX59YAAABU1BMVEUAAACOjpiRkpWRkpWSkpWRkpWRkpWQkJWRkpWRkpWRkpWRkpWRkpWRkpWQkpWRk5SRkZWQkZWRk5WTk5WOjo6RkpWRkpWRkpWRkpWRkpWRkpWQkJWRkpaRkZaRkpWRkpWRkpWRkpWRkpWRk5WRkpWRkpWRkpWRkZWOjpSSk5aRkpWRkpWRk5WRkpWRk5WRkpWRkZWRkZWQkpT///+RkpUAruoiue2Q3Pas5fjFxceVlpj6+vqkpacRs+yhoqT9/v78/Pzx8fLk5OWur7Gen6H8/f7q6+u+v8D39/je3+DW19jOzs+7vL6nqKqcnaCXmJvR0dLIycq4ubu2triwsbOrq66am51+1vVo0PPo6OnCw8Wys7XS8fux5/nt7e4qvO4LsuvLzM3w+/7o+P3Y8/zH7vu56fma3/f09PROx/Ezv+4Zt+wEsOvg4OHa29yX3vY9we9ZHrf1AAAAM3RSTlMABfp2HfA8IWdV6+Cij09JQjArGArm2dLFYFo0JRP057CpmG7Xy5WADvb2vLZ8cKeJgoGIgHZSAAADoElEQVRo3u2Y2VfaQBSHQyCCCIgiitRq1bZ23+anLSFlF1BZBBG3Vu2+L///U0NJThNT7kx8as/J9wTk3C+ZO3NnbpD+aXyBYDDou2xwLHpjETry3Ep6xnX41bUl6LRyuQp0lGjA3d39i4DWKWWZTvZoZx+QH7l4ikAKKB8xC6ddYHZaNH5qCZUtdoEjDbcnBeMV9OrMQbYBWcgQDGNvk/2NDG6PCeTvBk6MeAc1TFzlCh4jl7XEvH5t+ZIvI8KdgDsoWUIOvq4fWr4WVVzhCKLYswS8WNd5b0vDNTp+RkGV/eHZQPDU8kNdRZAUpLHPKAHr4j4piGCXFmwhRQomUKUFWVWmauIW1DwtYBqmCME0NDbk6dmGzpeB4Png09mBYT5BjBCMYd+8tQPjQRqYFxEcOgWfRARTaLLffHAKDoZX9jBOCBLoG6v+4MtznfNB5Png08ahUWFNkBWp4CM9C/k2yIK8h21acIRZicKPLi3IYIWuZqh1SrBZQVwiuYcOJdg2RkCthPbHC/vBS0sl5DAvcbhm21EO9QVk2SGPMcc9KYOKraLfvrXVsnxF4jIOYyodlFT4JQH8MJ/BzpaKm5IkaGhk2QUKGZjxfNKLaG3bT5fvOch+SZjpFJDrnDKD4o4GzI5JbpifA9DqHWcyxycVABMPXHc68UgSBuFrMSKcIBDz64wvSP8zMwtXpgKXbRSvhpYnMGwUb066l0wvywDUSlNrQSe8dstVeCIC4GS7mGc6hepgISmrLp5iMgz1uGirxB6QEu5WQ0Cv6CjGCpKCreYq8Io5qZcRpk5m/o5S2MOSwCiCinl/p6GMu3zBXXTZKOoVhPgD6NfZSL5D4fWqc9hlBGWs8Q6WVoESlLBEr6cVZBhJDnFun0fSQZQ+nft5WlDCDbIIUGY0Wdyhq6DGhrz7uWHjs3lI95GgDiUzh2/O1y/ywszigojg/bqDHyKCVXMIb746BO+GV1rkEGLosSEvP2/YOPtgJlH2kd12hdFUcZ186VNQpAU7iHBapF1asI80p5qbjKKIxRlS4EviGyVoYEWieQBtk0ihKgc5At8sOmwUhSai/MYCKLHRb98CJ9wTtKujptBsNGkeov23ROYzwLgkgi8CZAqOCSxDTkuC3Jehbdn3kZ02ki4avbHrgPbq1Ex+qdYGlhOSC3yrSQD9cqNW6zZVAKm4+7/ClsMwuB4lsk+xMBkKhebjCcnDw8PDw8PDw8PDw+My/AIFurvICRtjawAAAABJRU5ErkJggg==","Nav-Control-Zoom.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAEgCAMAAAAzNIUCAAABQVBMVEUAAACQkpWRkZaTk5aRkpWRkpWSkpWRkpWQkJWRkpWRkpWTk5WRkpWRkpWIiJmQkJaSkpaRkpWQkpSRkpWRkpWRkpWSkpSRkpWRkpWRkpWRkpWSkpaRk5WRkZGRkpWRkpWRk5WQkZWRk5WRk5aRk5SRkZX///+RkpWxsrTHx8kArurQ0dP9/f4iue36+vr29/fY2drd3t/4+Pjx8fLo6OmUlZj8/PyQ3Pbl5ues5fj09PSrrK7r6+zi4+Tb3N3U1NbNzc+cnZ8Rs+y3t7mgoaTu7u/k5OXa29zW1tjCw8S7vL6lpajf4OHS09WZmpyXmJvv7/Ds7e3KyszExcawsLOjpKaB1/WoqKuen6EqvO6/wMLX8vxoz/NPyPEKsuvw+/626Pl31PRq0PMZt+zO7/uj4veb3/eX3vaP2/aO2/ZkzvKuoX/yAAAAJnRSTlMAmGYM/fBd+iHZdRX26QUvt6KIgFVMHODIj0M8KgfFr2w00Kc6nNlHBgsAAAT9SURBVHja7ZxpV9pAFIbTyiII7mvVql3mRTMGAsRSwYWCoqC4r612X///D+hwIKfR6A04nlNp5/kky33IZO5cvORMtAdNd6eg+67BQ2OjEQiCzx4FOloO7xqIQpAvFk8h8I91tvbp4QhQ2c8YTGCkV7NAsL+Foxh+ChymmYO1AhDqaTa+J4pTk10jU0HkSXPxM34cxpkLo4zgUDPxnVEUOLuJA0ReeMdPjiLG2c2cY6TLUzCAI8MR8/694wE/RJ/nBESw7gg5vpz75Hi4a/lmPARjKDgC3s4JPjiemMUUHd/hR4794XVN8MrxRNzy0SkZQJZRAlbAACnog04LtvCUFIwgRwsMKzhJnQKfxWkBOwK1JCZwxOq8OpsXfK4J3swLzo4b5hiofH6BrP3RLhoHUkaAEIzbgnduwYUteEwtZFTqb/vmFhzb8zhIFTJUG1n/8fMbwWUt8rL21/y7hforJxjXCPxYpGeB74BckL1I0II0QhpFGAVaMItHdDnyWXFKwE/hURh7sU8JEvYIiEzYcZzGL9fqgVEUaeTBlH0W7IS6cKyOTTzr9izKfujOmvTW8cBEcEbzZNCHBLuRjIWw1gRhQL8p3rQcU0gbfCgnr4cvHMAZTxOIIL/CmZPlIoJhrWkmRoHi/p4dnVqtAKFxrRUCfgD5w82Dg83YKQTPJ7XWeIRKHg2qsRNRRloWzLKUuSoo7YpKeDeBjRLICbghJ0it6ImkhICv6Lq+JSEwdEFCZggJIcjICIyl5TRv8zxQAiV4EAJ7McktZ+mCIl3SpIuqZFlv9zxQAiW4H0EqF5cSrIvlnJIQLOiCZVlB6S8OQbCWXmz3PFACJVA90wPpmZJmYl31TEqgBKpnEgK+LQSmzBDWtvUNuZ5pIc7bPA+UQAnuqWfak+uZMu3fMy0JwZqMgKueSQn+EYFsyyO+nUuG7HJelxDEZQsK3xCCtMw5iJuJjGp5lEAJ7qXlMXMyAl5refZkC4op2zMtyZyDnOi5DNXyKIES3INgcc1gkv3CdlxCkNQFW7ICU2YIpuxlIr6Xjrd7HiiBEtyPgMsJdld0c0GmZ6r9pppp856ptKEuEymBEtyHwFg39/73nimty14mSi6qnkkJlOCf6JmkKxJbFoJdGQHPravLRH9fwJN3T+WD5c1sHoBVjO1nWxf0YQeCnWrVQo2+yZbCO/p9wMnsUrw2ilTpPA+MDLYQ3xMCCs4ts7x0BDzvaDZ+KIJKhl2F6zt4Ntxc/GAQZYO52K1gpCnDk2B9Bl0kswg1MYrhKDbZzSQrmPIW9CLGbmOxioDnABx7NN1sIOo1iKdYZQQnmKbjZ1A1KIGJEVowhnNGwU8xTgpCSDOSTfRT8V3Y4bTAY9f4E2QZTRx+SvAY5cZYj8/mr3D2s2GokvuVw3YW/phz8bX+ShGdpOCg/rYLt+CXvW99ghBM27N47BZ8r7+SxzC1ku2FwD/NX+NjfXoWLN8kVYpQZDQ5esdztx+LtEBHn8diXqEFh3jseQMEihSCXV63YMjQS+G5RjNAHkLK8vV4CDqi2HbFue9jQaaClbtNsI9ol+bJS+R3b6uIviHNm+5e5HM3pwDCzX2z9sJyZ0OyDN+A1hzdL4Hs1dLGN/KIBLSmCUSBWMn4s+n7CBid0Fqga8wPWCfl/dXV2UIRQKjlf1E6pkeDaOCfIs4+5Xgx3d/fPxCY0BQ0vwHPu0gIqkZhFgAAAABJRU5ErkJggg==","Slider.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAYBAMAAAB+X3LOAAAAIVBMVEUAAACRk5aRkZSSk5OWlpaSkpL5+v+RkpW7vMC1tbmhoqXGrO6IAAAABnRSTlMAaFgoEQ5LYgUfAAAANElEQVQoz2PADpgFMYADAwNjOQYwAIl2oAGwaEUaGlg+3EXLZ6KBcgNcYcashAECGAYDAADj/n4pps+kzwAAAABJRU5ErkJggg==","TBFit.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAWlBMVEUAAAB4eHh4eHh4eHh2dnZ9fX14eHh4eHh4eHh4eHh4eHh4eHhwcHB4eHhwcHB4eHh4eHhycnJ4eHh3d3dxcXF4eHh3d3d3d3d3d3dubm5xcXF5eXl4eHhxcXE+JRc1AAAAHHRSTlMA9qd7GAewklkjEvLn28fArJqNbWZkUi9QOjlR6dZl8gAAAVBJREFUSMfFVtuWgyAMXC4V1LZar90t/P9vbozIulVq56l58sBMyCSQ+PURO422Vaq14+kddGFr4YKJ2hYH8FwGdOTI/JV3M6MulWwaWV1mikmeMpTTftbrZUH32XRgOezjFbsL6MgxE0XtpUbSRpbvyMpoQ24TNuFV+mi5syjuKXF3sXE2kBPCp+xB2/+UF2V0kYyqXGfXkN7XFSXlZpUIEpAsaIS4P4ic6AdmVpkqhBM6VOP2DLyFCmgCLSpsVKCv/pngrzqqsGGtdq7nj5+z3xL8+Zs/eufqEAaVhb103u8QyDo+nTIzhzfSfebwfYrgWQjd9nGRUHH4aQILqRYRLSWMw08bC6Hkt0vZm84fWtc4p2ACHBIsGk4rXDj0asCXD77e6ANCnihD0CYAtxm0kQGt8hFbJd6M8XZ/PFAcmUJHFjoUwbELDnbw1+ET9gtaEjv2MjNk4gAAAABJRU5ErkJggg==","TBNext.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAWlBMVEUAAAB4eHh4eHh1dXV4eHh5eXl3d3d4eHh0dHR4eHh7e3t0dHR4eHh4eHhxcXF4eHhxcXF4eHhycnJvb294eHh3d3dwcHB3d3d1dXV4eHh3d3d5eXl4eHhxcXGK2btVAAAAHHRSTlMA9pEkpgZ7sGxZGBOq8u/b2sC8lWRSRC8PfFBRuUo9rwAAAWBJREFUSMfFVll2gzAMxAvGZklKA4Ek9v2vWVEQslna6vUj8zXBM44lC4nsLcgHZ42xbsj/oh5dLfwCUbvxF7lCNXnUD/JKzqprq6XU7XW2yOpM3zfTetGV+KDsiukPm/5Y//jeDtXokZPFHKVGw0KhDsIqYEHvE6Zpoy3M5Dh4KJ7ZCZ5it1kPm5B+hxcsJ5FXzbqFzRA2TUgTZ1dCvAsN94wYASKXUSIgAIWyS8pI4ulnHdlD+KhihpBRpkbhRUmG8JkToxsEEVaiowhABrgRS6JwdKIuMQQbMUTnfT2zXHhfpoZwJ7aeCTIzn3CAes42houK2AKo9gFDaLcGSFDEZrQYhKWEkQESRGwtT4t1J/eGcCO23oRhG9hHYgfNTiv74rilwS4+dnlzXyDmKyoUtwmw2wy3kTFa5YtaZdqMH+dzQPPb/R7meKB4gOGOrH8PRYLS27GrFXOwMz8d3oEvPJs941PvdQ4AAAAASUVORK5CYII=","TBPause.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAS1BMVEUAAAB4eHh4eHh4eHh4eHh4eHh4eHh3d3d4eHh7e3t5eXmBgYF4eHh4eHh4eHh3d3d4eHh3d3d5eXl1dXV4eHh4eHh4eHhxcXF4eHj1iuhDAAAAF3RSTlMA+ad78rBZUSMYkgjArI1tZC8UD9valLlU9lYAAAEtSURBVEjHxJXbkoQgDERJuCiOd9fd/v8v3R01W9SMgnmaPFnQB+gQovlIPKYwWDuE6XFHvYSOcITrwlKQ10xAGsR1Rj43u3xtue+5XXekma/0lXvO+zHKQBw9AXDVud5uy4lamG1Te5YaBuDrE1seAL8n7Km311vzyaCrcubsyxCAF312ev5f4mcLk37LAdLsNoA3OcB4oEkSQaA6B4hEggW/Bsx3kqnlj44lIBJIKjGIgytAXITjswPGMjAC3VEUBMQyEAG3F8gErKYMmC9gEgvtHaAVEwPAdwAGBrn2/g7QA1YNqI+kNq1Oq/ritKWhLj51eWsfkPqJapuAus3oG5m+Veqbsb7dl38ovxODVyiUV1mISlEEUimKwCpFCqtdzIqdBbliJ7npQH8AADUuN1z9SxsaAAAAAElFTkSuQmCC","TBPlay.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAYFBMVEUAAAB4eHh4eHh4eHh6enp4eHh4eHh4eHiBgYF4eHh0dHR4eHh4eHh4eHh3d3d4eHh3d3d4eHh3d3dxcXFxcXFxcXFxcXFxcXFwcHBwcHBwcHBycnJzc3N0dHRxcXF4eHhzyzi7AAAAHnRSTlMA9ad7F69ZIwiPEJPbwG1kUlAv7+HQu6OMdFxGMR+YuEezAAABRUlEQVRIx8VW2baDIAyUXaQu9e6b/v9f3rGWggJtc/rQPHlgBpghJFZPiXrUnRCdHut70I1WbD4HU7q5ATfcoz2Hmytw6VbUoeXW8vawUqws4Qd2OkZ/AchenYaGPF4sc07uN10oImcNx4QyGVkKEzw1bMGL8tY8M8iOJXFHliw2YBHgiwxMb5TLsMT7b+FULLbDQe/5c5o+/jIMKLeREeAbT0B8pgkByGxih1wVEaaXr8RGFznVsOiA0xqv3/u0AchvrIMCEHy8/SQqdPjsEwJia1h/WbaGpzJH2Bom4cyqbEQ+VznCzjBk++gltCVCbFjrRXQwrEwIhsH8zl+7LROCYRbpQyaQj0QWTbaVfHHU1CAnHzm9qQ+I9kQBoRYBepmhFzJ6qaQXY3q5v91QZoR4uGV5gCU1RXrbTRs71w3x1+EZ8Q9bFUNUrCre7AAAAABJRU5ErkJggg==","TBPlayExtend.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAYFBMVEUAAAB4eHh4eHh4eHh6enp4eHh4eHh3d3d4eHh8fHx1dXVycnJ4eHh5eXl4eHh4eHh4eHh4eHh4eHh4eHh4eHhxcXFxcXFycnJvb292dnZ4eHhvb29vb29ycnJxcXF4eHh7Kc98AAAAHnRSTlMA9qd7F7CSUSMHbRD1WPLbwKyNZFrv2ryVMC8nRUR/XsosAAABT0lEQVRIx8VWV3bEIAxcinsvKXayzP1vGROw2WQBW1+rLz+YwdJISNxeYsXSlEKUzVJcQVfzwGCtHubqBJ5zhj/GeB6By9Sgup6PI+87Q0llCJ+1ej+ZDoCcEgagzfx44TtOppoifNJwAEnuCSsBwJ8F03gR/jX3LNZZMLj66bAMgAcf3JZtwJ/SOdA+ypECifdo9W0/EiB9EAJgud7e7B/h7euAwEnINd1PUO/V7oRTqmJgMkRQH4UJcwPtlTjrCIIE9XlEMdvVAZgiBGWkmoDBFgUDZIxgpJJAbbxbgO4WI1ipOmD9XWyAPkqwUvVAY7J5CKb8ZqXiQLmnfYwSrFQjIMgEskvkoMmyXkzc3SWOXhr04qOXN/0CnV9RBzlvAndPEyC0GXIjo7dKejOmt/vzgYLNBHVkUYciceyeD/baDfamuvR0WM3TYS1ur7AfgEVDcxHQFLwAAAAASUVORK5CYII=","TBPrev.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAXVBMVEUAAAB4eHh4eHh4eHiBgYF3d3d4eHh4eHh3d3d4eHh6enpvb294eHhxcXF4eHhxcXF4eHh4eHhvb293d3dxcXF4eHhycnJ3d3dzc3N6enp4eHhycnJxcXF4eHhxcXFnXdd7AAAAHXRSTlMA9qeRCHuwWVEjFhDy79vZwKyVbWtkRC8mGXy8u51RKiIAAAFZSURBVEjHxVbbVoQwDLQt5S6CiMjq9P8/07JQkh6KGl92nmbptKczGxKeHoJsLkZrx2LO/qJuikFhhxqK5hd5pRUiKF39IK/Npup6bYzuu22Lqa/0Zbuu59MSHixTrgC0ZVp/Sx1Xm3WLTUWj/UJeJWzlfkGfA9P8oBh23ZF4qMpLc+p0WAkgrU8v1218xBuxI5CWx2G8X/bz3Z2Yd25YEN4Ay+fj2REjCUiio+3Ni3PE2CX0oVBQdMHs0zlH7LDpRaESi8jBq/PgjFwUOx2AiWJxKxgLmIBhv4MCForlDsYCFkBtBTIDHQvoDsYOdMAcLPQU0AbGDvTBxAhoCmgDsag8x1B3JgQUQCwqB/uvDfxKX0FGLL6S3LQ8VvkfJy8NefFReVNUxKLylr5AgleUJOImIG8z8kYmb5XUjG/Xc0DL2/0ZNj1Q4GGlI0s6FIVjVzjYhZ8Oj8A3c5hAJhDkPcoAAAAASUVORK5CYII=","TBZoomIn.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAACWUlEQVRYw+VYwU7CQBAtN2960BA8gnf8FMSDiEfxiDEx7CyLB3+ARMBfgJoICX4Bfod8BSZyKAccZltoS9ttS0tM7CZNWbpvdmffvJ2ppv2T6/mgcQ4Vdg8CBN4rjfPng4SgH47YDYxgDktX+4EhVOFwJ3B+xt7A2IK2N4O98bNY4M0T6MLCBvUFEzaANrTxPsFfNiO80zyJCM/KMDOHz2HMbkXO/YbI8RqM166bsXJ49Aw8WXODrsgGvSqyvGc5kbW0TCi+oAsk/JjnQ+1UHlciR/TV3MpY8CHnY41qWSYUo8wXf1gpKilYCYkrJxaw2Etz9qVYpL4wR5f9ifkdPIeHpWx+/5vkmPmQFnlPW+vvRZUB5B9tN+94Ri2FlRHEHKUBrVEglIVHdKMorGz3AnVJaQD98Ep+0LckjcJlHhxWYQyILEW34ZJBVEzpf21XA+jsD8KqOhc2Iv7cJmKgRgaGDnmQorUtaXEMiJwMVpts4GlFgqw8fEIZQH9MCa+46ahQxyQpA/yTGHm12eJ72oGBF1jY5liBThOubzoEdbQTM9AmPLE/A+m7KO1NTp2myQYaO90KtNSlYg9il7pcp37gJHxkGo3C/g99SltmqaYtlFOnmXjtljoivDp1JC/2zTT2KUryu074+8pRKBv9aOk7MidC+u5Mxg3eUxUgyHur0BIR1mwvofgHr3mVUHCHohCrhDJJyzuOInCKKq+vikDQ8WlqLwLh5fE4ZhmLkIoyFnTPqA1/wSGW20NJQVch/s6vdyzEHdwq8iuorz4lQB2fiol9Svjz1y+we1CD3hl6FwAAAABJRU5ErkJggg==","TBZoomOut.png":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAACSklEQVRYw+VYwU7CQBCFGzc9SAgehTt+CuJB1CN4hJgYdpaFgz9AIuIv1JoICXwBfod8BSZwKAccpi20FGi33RITt0nTbrpvdmffvJ1pIvFP2nOqcQllVgcBAu/lxuVzShH04ym7hwHMYbl1zaAPd3ASCZzn2QcYHmjnZbAPng8F3kzDKywcUN8wZu/QgQ7ex/jmMMK7zbQkPCvB1Bo+hyGriOz2FyLLqzBcu27KSsHRk9C25wavInPoU5HhPduJrJVIBuILusCEH/KLQDt1gSsxR2j+3Era8AHnY49q2SZ8RlkfzlhRlhSsiMQ1J3ZgsdfW7IuhSH1ljS7tJ+aP7xwONosc0z2kRd7T1kr43ss/2m7e3Rm1FFZGMObsa40coSx2RDeKwsp2L6p2wRv5QfdIGoXL/HBYBWkiQ9FtbMkgKqbpfwWNjwjrzr2wAfGnosRAlQz0XfJgipZX0kI5KWsGq0M28LQiQVZ1/sGE8AqbjjJ1jFUZ4F/EyJvNFtdpB95dvFrKXa4V6DTh2qZDUEdHmYEO4YnjGYjfRXFvcuw0VRto7NwTaLFLxRHELna5jv3AUXxkGo3c8Q99SlumsaYtlFPHmXhFSx0RfhZk/UnQrDS2LZP8rhN+zXcUyoYml74jcyTSd3cybvCeXwGCvLcLLSGxZmcJxUe8uquEggcUhVAllEVa3nUVgRNUeX1VBIKOTxNnEQgvT2chy1iE9CljQd8ZtRLBc4Lldt+k4FYh/slvIxbiLm4V+A3UVr8SoIZPBWW/Ev58+wWZNt3EgwcumAAAAABJRU5ErkJggg==","openhand.png":"data:image/png;base64,AAACAAEAICACAAgACAAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAAAEAAAAAAAAAAAAAAgAAAAAAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8AAAA/AAAAfwAAAP+AAAH/gAAB/8AAA//AAAd/wAAGf+AAAH9gAADbYAAA2yAAAZsAAAGbAAAAGAAAAAAAAA//////////////////////////////////////////////////////////////////////////////////////gH///4B///8Af//+AD///AA///wAH//4AB//8AAf//AAD//5AA///gAP//4AD//8AF///AB///5A////5///8="},Ts={w:1,x:1,y:1,fs:1,bw:1,b1:1,b2:1};function Rs(e,n,r,i,a){var u,s,f,l,c,d,h=new Map,v=new Map,p=new Map,m=new Map,y={x:1,y:1,w:1,h:1,e:1,fs:1,off:1,b1:1,b2:1,bw:1},b={t:1,u:1,id:1,id1:1,id2:1,ff:1,sh:1,ls:1,bs:1},x={c:1,c2:1,b:1,fc:1,fbc:1},w={p:1},A={hi:1,bg:1,ci:1,du:1,fb:1,a1:1,a2:1,re:1,tc:1,a:1},M={gh:1},I={pos:1},E={x:1,y:1,off:1,lat:1,lng:1},C={ls:{solid:!0,dashed:!0,dotted:!0},bs:{solid:!0,dashed:!0}},k=["ha0","ha1","ha2","ha3","ha4","ha5","ha6","ha7","ha8","ha9"],S={},T={},L={},O=null,G=1,D=2,V=new Map,Y=!1,W=!1,U=F(),_=null,H=ks(e);S.setDirty=function(e){V.delete(e);V.set(e,D)};var J=S.setDirty;function q(){re();u=null;f=null}function $(e){t(L,function(t){he(t,e)});t(T,function(t){he(t,e)})}var ee=nr({numbers:y,numOrString:w,negatives:E,strings:b,stringValues:C,colours:x,booleans:A,reserved:M,mapPos:I,halos:k},J,q,$);S.graph=function(){_||(_=bs(n)).privateSetProperties(T,L);return _};var te=S.graph;function ne(e,t){var n,r=1===e?t.id1:t.id2;return{x:(n=h.has(t.id)?ke(r):T[r]).x,y:n.y}}S.setAllDirty=function(){Y=!0;n.privateTrigger("redraw",{all:!0})};var re=S.setAllDirty;function ie(e){Y=!1;W=!1;e?V=e:V.clear()}var oe=function(e,t){var n=V.get(e);if(!n||t&&n===G){t&&V.delete(e);V.set(e,G)}};function ue(){return!(!Y&&!W)||V.size}S.moveAllNodesBy=function(e,t,n){fe(e,function(e){e.x+=t;e.y+=n;oe(e.id)})};S.moveNode=function(e,t,n){var r=T[e];if(r){var i=t-r.x,a=n-r.y;if(r._combo)fe([e],function(e){e.x+=i;e.y+=a;oe(e.id)});else{r.x+=i;r.y+=a;oe(r.id)}}};var se=S.moveNode;function fe(e,t){for(var n={},r=e.slice(0);r.length>0;){var i=r.shift(),a=T[i];if(a&&!n[i]){n[i]=!0;t(a);if(a._combo)for(var o=a._combo.nodeIds,u=0,s=o.length;u<s;u++)n[o[u]]||r.push(o[u])}}}S.setLinkOffset=function(e,t){var n=L[e];if(n){n.off=t;J(e)}};S.ensureObject=ee.ensureObject;S.ensureTypesInArray=ee.ensureTypesInArray;S.load=function(e){if(e){T={};L={};Qe(!0);Et();ee.typeCheck(e,L);var t=ee.filterNodesAndLinks(e.items,T,L,{selfLinks:c});L=t.links;T=t.nodes;S.reveal(e.reveal,!1);ee.ensureHiddenItemConsistency(T,L);_=null;le();ht();re()}Fe()};function le(){O=null}function ce(e){Object.keys(e).forEach(function(t){O.push(e[t])})}S.getRawItems=function(){if(!O){O=[];ce(L);ce(T)}return O};var de=S.getRawItems;S.defaultValueFor=function(e){switch(e){case"e":return 1;case"fs":return i.fontSize;case"off":case"b1":case"b2":return 0;case"x":case"y":return 0;case"w":case"h":return 1;case"bw":return 4;case"donut":return K({v:[]},ee.donutDefaults);case"ha0":case"ha1":case"ha2":case"ha3":case"ha4":case"ha5":case"ha6":case"ha7":case"ha8":case"ha9":return{c:Ot.transparent,r:0,w:0};case"fi":return{c:"black",t:""};case"oc":return Jn;case"c":case"b":return Ot.midgrey;case"fc":return Ot.black;case"fbc":return Ot.textback;default:return}};S.bothEndsShown=function(e){return!e.hi&&!(T[e.id1].hi||T[e.id2].hi)};S.neighbourLinkIds=function(e){return te().privateNeighbourLinks(e)};S.privateGetLinksBetween=function(e,t){for(var n=te().privateGetLinkIdsBetween(e,t),r=[],i=n.length,a=0;a<i;a++)r.push(L[n[a]]);return r};S.bothEndsForeground=function(e){return!(T[e.id1].bg||T[e.id2].bg)};function he(e,t){e[t]&&He(e.id)}function ve(e){return e&&!!e.parentId}function ge(e,t,n){for(var r="x"===t||"y"===t?oe:J,i=0;i<e.length;i++){var a=e[i],o=T[a],u=L[a];if(o){o[t]=n;r(a)}else if(u){u[t]=n;J(a)}}}function pe(e,t){var n=!1;T[e]&&(n=ye(T[e],t));L[e]&&(n=ye(L[e],t));return n}function me(e){return $e(e)&&!pe(e,"gh")}function ye(e,t){return!!e[t]}S.resurrect=function(e){be(e,"gh",!0)};S.ghost=function(e){we(e,"gh")};S.show=function(e,t){be(e,"hi",t);Ye()};S.hidden=function(){return xe("hi")};S.hide=function(e){we(e,"hi");Ye()};function be(e,n,r){var i,a=R(e);ge(a,n,!1);ee.ensureConsistency(n,T,L);if(r){var o={},u={};for(i=0;i<a.length;i++)o[a[i]]=1;t(L,function(e){if(ye(e,n)&&!ye(T[e.id1],n)&&!ye(T[e.id2],n)&&(o[e.id1]||o[e.id2])){e[n]=!1;var t=e.parentId;t&&L[t]&&(u[t]=!0)}});ee.applyPropertyRuleToComboLinks(u,n,L)}}function xe(e){var n=[];t(T,function(t,r){t[e]&&n.push(r)});t(L,function(t,r){t[e]&&n.push(r)});return n}function we(e,t){ge(R(e),t,!0);ee.ensureConsistency(t,T,L)}S.each=function(e,n){e.type.match(/^(node|all)$/)&&t(T,n);e.type.match(/^(link|all)$/)&&t(L,n)};S.setItem=function(e){var t=o(e);ee.ensureObject(t,!1,L);var n=null;"node"===t.type&&(n=T);if("link"===t.type){n=L;if(!ee.hasValidEnds(t,{},T,c))return;(T[t.id1].hi||T[t.id2].hi)&&(t.hi=!0)}ee.setZeroXY(t);if(t.id){var r=n[t.id];n[t.id]=t;if(r){r._combo&&(n[t.id]._combo=r._combo);r.parentId&&(n[t.id].parentId=r.parentId);r._offset&&(n[t.id]._offset=r._offset)}t.hi?ee.ensureHiddenItemConsistency(T,L):q();Ye();le();J(t.id)}Fe()};S.type=function(){return"LinkChart"};var Ae,Me=S.type;S.setOptions=function(e){c=e.selfLinks;d=e.marqueeLinkSelection;i.setOptions(e)};S.setLastHoverId=function(e){Ae=e};S.showFullLabelOnHover=function(e){Ae&&J(Ae);if(e){J(e);i.setSpecialOptions("showFullLabel",e)}else i.setSpecialOptions("showFullLabel",null)};function Ie(){var e=[];de().forEach(function(t){t._combo||e.push(o(t,"d"))});return e}S.serialize=function(){return{type:Me(),items:Ie()}};function Ee(e,n,r,i,a){var u,s,f,l,c;for(u=0;u<e.length;u++){s=z(e[u].id);l=[];if(s)if(n){c=new RegExp(s,"im");t(T,function(e,t){c.test(t)&&l.push(e)});t(L,function(e,t){c.test(t)&&l.push(e)})}else{T[s]&&l.push(T[s]);L[s]&&l.push(L[s])}var d=o(e[u]);for(f=0;f<l.length;f++){var h=!0,v=l[f];if(!i&&"node"===v.type&&(void 0!==d.x||void 0!==d.y)){var g=void 0===d.x?v.x:d.x,p=void 0===d.y?v.y:d.y;S.moveNode(v.id,g,p)}t(d,function(e,t){if("id"!==t&&"type"!==t){h&&"x"!==t&&"y"!==t&&(h=!1);switch(t){case"id1":case"id2":if(e!==v[t])throw Error("You cannot change the ends of an existing link");break;case"parentId":if(a&&e!=v[t])throw Error("You cannot manually change the parentId of an item");case"hi":r.all=!0;r.hi=!0;v[t]=e;break;case"oc":if(v.oc){r.all=!0;v.oc=Q(v.oc,d.oc)}break;default:er[t]&&(v._noHalos=!1);Ts[t]?r.positions=!0:r.all=!0;v[t]=e}}});h?oe(v.id):J(v.id)}}}S.validateCombos=function(){var e={};function n(t){var n=t.parentId;if(n){var r=T[n]||L[n];if(!r)throw new Error("The "+t.type+" '"+t.id+"' has parentId = '"+n+"' but the parent item is not present in the model.");if(!r._combo)throw new Error("The "+t.type+" '"+t.id+"' has parentId = '"+n+"' but the parent item has no _combo property.");e[n]=e[n]||{};e[n][t.id]=!0}}function r(n){if(n._combo){var r={};(n._combo.nodeIds||[]).concat(n._combo.linkIds).forEach(function(t){r[t]=!0;var i=T[t]||L[t];if(!i)throw new Error("The combo "+n.type+" '"+n.id+"' has a child item '"+t+"' in its _combo property, but this item is not present in the model.");if(!e[n.id][t])throw new Error("The combo "+n.type+" '"+n.id+"' has a child item '"+t+"' in its _combo property, but this item's parentId property is "+(i.parentId?"set to '"+i.parentId+"'":"undefined."))});t(e[n.id],function(e,t){if(!r[t]){var i=T[t]||L[t];throw new Error("The "+i.type+" '"+i.id+"' has parentId set to '"+n.id+"' but is not included in the parent's _combo property.")}})}}t(T,n);t(L,n);t(T,r);t(L,r)};S.unsafeApplyChanges=function(e,t,n){var r,i,a;for(r=0;r<e.length;r++){i=(a=e[r]).id;var o=void 0!==a.x,u=void 0!==a.y;if(!o&&!u||n)a._combo&&g(a._combo.e)&&S.moveAllNodesBy([i],0,0);else{var s=o?a.x:T[i].x,f=u?a.y:T[i].y;S.moveNode(i,s,f)}K(T[i]||L[i],e[r]);t?J(i):oe(i)}};S.setProperties=function(e,t,n,r,i){var a=o(e);a=R(a);ee.ensureTypesInArray(a,!1,L);Ee(a,t,n,r,i);n.hi&&ee.ensureHiddenItemConsistency(T,L);(n.graphCache||n.hi)&&Ye();Fe()};function Ce(e){var n={};t(e,function(e,t){var r=L[t];r&&void 0===r.off&&(n[t]=r)});return n}S.merge=function(e){var n=o(e);ee.ensureTypesInArray(n,!1,L);var r={carefulWithXandY:!0,selfLinks:c},i=ee.filterNodesAndLinks(n,T,L,r);t(i.nodes,function(e,t){T[t]=K(T[t],e);T[t]._noHalos=!1;J(t)});t(i.links,function(e,t){L[t]=K(L[t],e);L[t]._noHalos=!1;J(t)});ee.ensureHiddenItemConsistency(T,L);Ye();le();var a=Ce(i.links);it(a);Fe()};S.firstVisibleItemInAncestry=function(e){var t=T[e]||L[e];if(t&&!t.hi){if("link"===t.type&&Mt(e)&&Ze(e))return t;var n=S.getParentItems(e);n.push(t);var r=null;n.every(function(n){if(null===n)return!1;if(n.hi){r=null;return!1}if(n.id===e){r=t;return!1}if(n._combo){r=n;return n._combo.open}return!1});return r}return null};var ke=S.firstVisibleItemInAncestry;S.getItem=function(e){return o(Le(e),"d")};S.getItemsByID=function(e){for(var t=R(e),n=[],r=0;r<t.length;r++){var i=Le(t[r]);i=i||null;n.push(i)}return n};var Se=S.getItemsByID;S.getAncestryIds=function(e,t){var n=e,r=[],i=0;do{t&&1===i&&n.indexOf("_combolink")>-1||r.unshift(n);var a=Le(n);n=a&&a.parentId;i++}while(n);return r};var Te=S.getAncestryIds;S.getParentItems=function(e){var t=Te(e);t.pop();return Se(t)};var Re=S.getParentItems;S.getByID=function(e){var t=z(e);return T[t]||L[t]||null};var Le=S.getByID;S.allParentsOpen=function(e,t){return!Le(e).parentId||Re(e).every(function(e){return e._combo.open&&(!t||!e.hi)})};var Be=S.allParentsOpen,Ze=function(e){var t=L[e];if(t&&!t.hi){if(t.parentId){if(Oe(t.parentId)){var n=ke(t.id1);if(t.id1===t.id2&&n)return!0;var r=ke(t.id2);return n&&r&&n.id!==r.id}return!1}return!0}return!1};S.allParentsVisible=function(e){return!Le(e).parentId||Re(e).every(function(e){return!e.hi})};var Oe=S.allParentsVisible;S.topParentId=function(e){for(var t=e,n=Le(t),r=n&&n.parentId;r;)(t=r)===(r=(n=Le(t))?n.parentId:null)&&(r=null);return t};var Ge=S.topParentId;function Fe(){var e=new Map;ze(T,e);ze(L,e);a.forEach(function(t){t.isAsset||e.has(t.src)||a.delete(t.src)})}function De(e,t){var n=!1;e.forEach(function(e){e&&e.g&&e.g.forEach(function(e){n=Ve(e,t)||n})});return n}function ze(e,n){t(e,function(e){Ve(e,n);De([e,e.t1,e.t2],n);e.bu&&Ve(e.bu.g,n)})}function Ve(e,t){if(e){var n=e.u;if(n){t.set(n,!0);if(!a.has(n)){a.get(n);return!0}}}}function Ye(){_&&_.clearCache()}function Pe(){u={};s=0;for(var e=Object.keys(T),t=0,n=e.length;t<n;t++){var r=e[t],i=T[r];if(!i.hi&&Be(r,!0)){u[r]=i;s++}}}function We(){f={};for(var e=Object.keys(L),t=0,n=e.length;t<n;t++){var r=e[t],i=L[r],a=!i.hi;a&&(a=Mt(r)?Ze(r):Be(r,!0))&&(f[r]=i)}}function Xe(){if(!u){Pe();We()}}function Ue(){Y||(V.size>100?V.size>=s?W=!0:Ne():te().internalMarkLinks(V))}function Ne(){t(f,function(e,t){V.has(t)||(V.has(e.id1)||V.has(e.id2))&&V.set(t,D)})}S.generate=function(e,t,n,r,a){var o,s=n.getUnzoom(),c=s!==l;c&&re();if(ue()){Xe();Ue();ie((o=i.generate(u,f,Y,W,V,e,t,n,Ke,h,qe,S.isTransferring,r,a)).stillDirty);l=s}i.generateHandles(e,t,n,p);return i.animated()||o&&o.rebuildAll||c};S.contains=function(e){return i.contains(e,T).filter(function(e){return!ve(T[e])})};S.animated=function(){return i.animated()};function je(t){t.forEach(function(t){var n=e.privateGetItem(t);n&&(n._combo||n.parentId)&&e.privateSetAllItemsInComboDirty([e.privateGetTopItemId(n.id)])})}S.setSelection=function(e,t,r){var i=z(e),a=!e&&0===p.size,o=1===p.size&&p.has(e);if(!a){if(!t&&!r){if(o)return;Qe(!!i)}p.has(i)?t&&He(i):_e(i);n.privateTrigger("redraw",{all:!0})}};var _e=function(e,t){var r=z(e);if(r&&!p.has(r)&&me(r)){je([r]);p.set(r,1);J(r);t||n.trigger("selectionchange")}},He=function(e,t){var r=z(e);if(p.delete(r)){je([r]);J(r);t||n.trigger("selectionchange")}};S.hasSelection=function(){return p.size};S.isSelected=function(e){return!!p.size&&p.has(e)};var Ke=S.isSelected,Qe=function(e){var t=[];p.forEach(function(e,n){J(n);t.push(n)});je(t);p.clear();e||n.trigger("selectionchange")};function Je(e){t(e,function(e,t){_e(t,!0)})}S.addItemsToTransfer=function(e){e.forEach(function(e){v.set(e,!0)})};S.removeItemsFromTransfer=function(e){e.forEach(function(e){v.delete(e)})};S.isTransferring=function(e){return!!v.size&&v.has(e)};S.clearExtraItemsInTransientLayer=function(){m.forEach(function(e,t){J(t)});m.clear()};S.drawInTransientLayer=function(e){if(e&&e.length>0){e.forEach(function(e){m.has(e)||J(e)});var t=N(e);m.forEach(function(e,n){t.has(n)||J(n)});m=t}};S.removeFromTransientLayer=function(e){e.forEach(function(e){m.delete(e)&&J(e)})};function qe(e){return m.has(e)}var $e=function(e){Xe();return u[e]||f[e]};S.isItemShown=$e;S.selectAll=function(){Je(T);Je(L);n.privateTrigger("redraw",{all:!0});n.trigger("selectionchange")};S.doSelection=function(e){if(e){Qe(!0);for(var t=0;t<e.length;t++)_e(e[t],!0);n.privateTrigger("redraw",{all:!0})}var r=[];p.forEach(function(e,t){r.push(t)});return r};var et=S.doSelection;S.privateSelection=function(){return p};S.moveSelection=function(e,n){var r=[];if(p.size){t(T,function(e,t){Ke(t)&&!ve(e)&&r.push(t)});t(L,function(e,t){if(Ke(t)){T[e.id1].du&&r.push(e.id1);T[e.id2].du&&r.push(e.id2)}})}for(var i=0;i<r.length;i++){var a=T[r[i]];S.moveNode(r[i],a.x+e,a.y+n)}};S.removeItem=function(e){var n,r=R(e);if(r.length>0){for(var i={},a={},o=0;o<r.length;o++){n=r[o];L[n]&&(i[n]=L[n]);T[n]&&(a[n]=1)}t(L,function(e,t){(a[e.id1]||a[e.id2])&&(i[t]=e)});t(i,function(e,t){He(t,!0);It(t);J(t);delete L[t]});t(a,function(e,t){He(t,!0);J(t);delete T[t]});Ye();le();it(i);q()}};S.selectionPlusDummyNodes=function(){for(var e=et(),t=0;t<e.length;t++){var n=L[e[t]];if(n){T[n.id1].du&&e.push(n.id1);T[n.id2].du&&e.push(n.id2)}}return e};function tt(e){var t=bs(n);t.privateSetProperties(T,e);return t}function nt(e){var t=B(e,{all:!1,self:!0,combos:"all"});return te().connections(t)}function rt(e,t){var n=[],r={};if(X(e)){var i=tt(e).findAdjacency;n=nt();for(var a=0;a<n.length;a++){var o=L[n[a][0]];i({all:!0,combos:"all"},o.id1,o.id2)&&(r[a]=1)}}t(n,r)}S.resetConnectionOffsets=function(e){n.privateTrigger("redraw",{all:!0});rt(e,ct);kt(e)};var it=S.resetConnectionOffsets,at=function(e,t){var n;rt(e,function(e,r){n=dt(e,r,t)});return n};function ot(e,t){var n=[];function r(e,t){n.push({id:e.id,off:t})}kt(e,t,r);return n}function ut(e){for(var t={},n=0;n<e.length;n++){var r=e[n],i=L[r];i&&(t[r]=i)}return t}S.showHideBendLinks=function(e){var t=ut(e);it(t)};S.showHideGetLinksToBend=function(e,t){var n=ut(e),r=at(n,t),i=ot(n,t);if(i.length>0){var a=j(i);r=r.filter(function(e){return void 0===a[e.id]}).concat(i)}
for(var o=[],u=0;u<r.length;u++){var s=r[u];L[s.id].off!==s.off&&o.push(s)}return o};function st(e){ct(nt(e))}function ft(e,n,r,i,a){var o=i||function(e){return e};function u(e){var t=1e6,n=Z(e.off)?e.off:t,r=o(e);r.id1>r.id2&&(n=f(-n));return n}function s(e,t){return u(L[e])-u(L[t])}function f(e){return 0===e?0:e}t(n||e,function(t,n){var i=e[+n];r||(i=i.filter(function(e){return!L[e].gh}));if(i.length>0){i.sort(s);for(var u=o(L[i[0]]),l=u.id1===u.id2,c=i.length,d=l?20:40,h=l?0:-.5*d*(c-1),v=0;v<c;v++){var g=L[i[v]],p=o(g),m=h+v*d;m=p.id1<=p.id2?m:-m;a(g,f(m))}}})}function lt(e,t){e.off=t;J(e.id)}function ct(e,t){ft(e,t,!0,null,lt)}function dt(e,t,n){var r=[];function i(e,t){r.push({id:e.id,off:t})}ft(e,t,n,null,i);return r}function ht(){for(var e=nt(),t={},n=0;n<e.length;n++){var r=!1,i=e[n];if(i.length>1){for(var a=0;a<i.length;a++){var o=L[i[a]];o&&(r=r||Z(o.off))}r||(t[n]=1)}}ct(e,t)}S.getCursor=function(e){var t=yt(e);return t||(e?'url("'+Ss["openhand.png"]+'"), pointer':"auto")};S.getResizePrimitive=function(){return i.getResizePrimitive()};var vt=new RegExp(U+"((\\S+)(?:\\-resize))$"),gt={nw:["x1","y1"],n:["y1"],ne:["x2","y1"],e:["x2"],se:["x2","y2"],s:["y2"],sw:["x1","y2"],w:["x1"]};function pt(e){return(e+"").match(vt)}function mt(e){var t=pt(e);return gt[t[2]]}function yt(e){var t=pt(e);return t?t[1]:null}var bt=new RegExp(U+"(id[1|2])$");S.startDragger=function(e,t,n,i,a,o){var u=(o+"").match(bt),s=z(n);return r.createLinkEndDragger(e,S,t,T,L[s],u[1],i,a,s)};S.createDragger=function(e,t,i,a,o,s,l,c,d){var h=l.handMode,v=z(a);if(d&&h)return r.createMapDragger(i,a,o,s);if(pt(a)){var g=mt(a),p=c,m=T[v]._combo&&T[v]._combo.open;return r.primitiveMover(Wn,t,i,v,p,!0,g,o,s,m,function(e){n.trigger("prechange","resize");var t=T[z(a)],r=e.a,i=r?r.x:0,o=r?r.y:0;if(m)t.oc.w=2*e.r;else if("C"===e.p){t.x=i+e.x;t.y=o+e.y;t.w=2*e.r;t.h=t.w}else{var u=i+e.x1,s=o+e.y1,f=i+e.x2,l=o+e.y2;t.x=u+Math.floor((f-u)/2);t.y=s+Math.floor((l-s)/2);t.w=f-u;t.h=l-s}J(t.id)})}if(null!==v&&L[v]){if(L[v].id1===L[v].id2)return null;var y=(a+"").match(bt);return y?r.createLinkEndDragger(e,S,i,T,L[v],y[1],o,s,v):r.createLinkDragger(ne,t,i,S,L[v],o,s,v)}S.clearExtraItemsInTransientLayer();if(h&&null===a)return r.createHandDragger(i,o,s,Qe);if(null!==v){Xe();return r.createDefaultDragger(S,u,f,Ke,xt,i,a,o,s)}return wt(i,o,s)};function xt(){var e=[];p.forEach(function(t,n){var r=T[n];r&&r.parentId&&e.push(Ge(r.parentId))});return e}var wt=function(e,r,i){if(!n.trigger("dragstart","area",null,r,i,null)){var a={};p.forEach(function(e,t){a[t]=1});var o={id:null,p:tn.rect,x1:r,y1:i,x2:r,y2:i,bc:Ot.midgrey,bw:1,fc:Ot.blue,fi:!1},s=e.viewToWorldX(r),l=e.viewToWorldY(i),c={x1:s,y1:l,x2:s,y2:l};o.wbc=en(o.bc);o.wfc=en(o.fc);return{rebuild:{drawOnly:!0},scrollable:!0,getCursor:function(){return"crosshair"},generate:function(e){var t=e.getLayer(),n=e.getLayerPath();e.setLayerPath(null);e.setLayer(ni.HANDLES);e.copyPrimitive(o);e.setLayerPath(n);e.setLayer(t)},dragMove:function(e,t,n,r){g(e,t,n,r)},endDrag:function(t,r,i){e.cancelScroll();n.trigger("dragend","area",null,r,i)||(t?n.trigger("selectionchange"):Qe());n.trigger("dragcomplete","area",null,r,i)}}}function h(t,n){o.x1=Math.min(e.worldToViewX(s),t);o.y1=Math.min(e.worldToViewY(l),n);o.x2=Math.max(e.worldToViewX(s),t);o.y2=Math.max(e.worldToViewY(l),n);c.x1=e.viewToWorldX(o.x1);c.y1=e.viewToWorldY(o.y1);c.x2=e.viewToWorldX(o.x2);c.y2=e.viewToWorldY(o.y2)}function v(e,t){var r=!1;function i(n,i){if(!t&&!e.has(i)){He(i,!0);r=!0}}function a(e,t){if(!p.has(t)){_e(t,!0);r=!0}}p.forEach(i);e.forEach(a);r&&n.privateTrigger("redraw",{all:!0})}function g(e,n,r,i){Xe();h(e,n);var a=new Map;t(u,function(e,t){yn(c,e.x,e.y)&&a.set(t,!0)});"off"!==d&&t(f,function(e,t){if("centre"===d)yn(c,e._x,e._y)&&a.set(t,!0);else if("ends"===d){var n=u[e.id1],r=u[e.id2];yn(c,n.x,n.y)&&yn(c,r.x,r.y)&&a.set(t,!0)}});v(a,r||i)}};S.createGestureDragger=function(r,i,a){var o,u,s,f,l=r.zoom(),c=r.viewToWorldX(i),d=r.viewToWorldY(a),h={};t(T,function(e,t){h[t]={x:e.x,y:e.y}});function v(t,n,i){var a=-t*(2*Math.PI/360);a*=2;var o=Math.sin(a),u=Math.cos(a);e.privateEach({type:"node",items:"toplevel"},function(e){var t=e.id,n=(h[t].x-c)*u+(h[t].y-d)*o+c,r=-(h[t].x-c)*o+(h[t].y-d)*u+d;se(t,n,r)});var s=r.viewToWorldX(n),f=r.viewToWorldY(i);e.privateEach({type:"node",items:"toplevel"},function(e){var t=e.id;se(t,e.x+(s-c),e.y+(f-d))})}function g(e){var t=Math.pow(e,2);r.zoomToPosition(t*l,i,a)}function p(e,t,n,r){o=e;u=t;s=n;f=r}p(1,0,c,d);var m=!1,y=60,b=!1;function x(){g(o);m=m||Math.abs(u)>12;b=b||Math.abs(s-c)>y||Math.abs(f-d)>y;v(m?u:0,b?s:c,b?f:d)}function w(){e.privateEach({type:"node",items:"toplevel"},function(e){var t=e.id;se(t,h[t].x,h[t].y)})}return{animate:function(){x()},getCursor:function(){return"move"},dragMove:function(e,t,n,r){p(e,t,n,r)},endDrag:function(e,t,r,i,a){p(t,r,i,a);if(e){w();n.trigger("prechange","move");x()}else w()}}};S.labelPosition=function(e,t){var n=Le(e);if(!n||n.hi)return null;var r=n._edit;if(!r||r.hib)return null;var i=r.x1,a=r.y1,o=r.x2,u=r.y2;if("node"===n.type){i+=n.x;a+=n.y;o+=n.x;u+=n.y}return{x1:t.x(i),y1:t.y(a),x2:t.x(o),y2:t.y(u),fs:t.worldToViewDistance(r.fs)}};S.extractStructure=function(e,t,n){return H.extractStructure(i,e,T,L,te,t.fixed,n)};S.updateLinkStyles=function(e){if(e.straighten){n.privateTrigger("redraw",{all:!0});st({self:!1,combos:"toplevel"})}};S.layout=function(e,t,n,r,i){H.layout(e,t,n,te,r,i)};S.arrange=function(e,t,n,r,i,a,o){H.arrange(e,t,n,r,te,i,a,o)};S.applyVertices=function(e){t(T,function(t,n){e[n]&&se(n,e[n].x,e[n].y)})};S.applyUpdatedOffsets=function(e){t(L,function(t,n){e[n]&&S.setLinkOffset(n,e[n].off)})};S.makeAnimator=function(e,n,r){var i=n,a={};t(T,function(e,t){a[t]={x:e.x,y:e.y}});return Nn(function(o){i-=o;var u=r(Math.max(0,(n-i)/n));t(T,function(t,n){if(e[n]){var r=a[n].x+u*(e[n].x-a[n].x),i=a[n].y+u*(e[n].y-a[n].y);se(n,r,i)}});return i>0},{positions:!0})};function At(e){var t=L[e];return t&&!t._combo}S.reveal=function(e,t){if(e){Et();e.forEach(function(e){if(e&&!h.has(e)&&At(e)){h.set(e,!0);J(e)}});!1!==t&&kt(void 0,void 0,void 0,!0);q()}};S.isRevealedLink=function(e){return!!h.size&&h.has(e)};var Mt=S.isRevealedLink;S.getRevealedLinks=function(){var e=[];h.forEach(function(t,n){e.push(n)});return e};var It=function(e){J(e);h.delete(e);Ke(e)&&!Be(e)&&He(e,!0)};S.clearRevealedLinks=function(){h.forEach(function(e,t){J(t);Ke(t)&&!Be(t)&&He(t,!0)});h.clear()};var Et=S.clearRevealedLinks;function Ct(e,n,r){t(e,function(e){var t,i=ke(e.id1),a=ke(e.id2);if(null!==i&&null!==a&&i!==a){t=i.id>a.id?i.id+a.id:a.id+i.id;void 0===n[t]&&(n[t]=[]);n[t].push(e.id);r[e.id]={id1:i.id,id2:a.id}}})}S.applyRevealedLinkOffsets=function(e,n,r,i){var a=void 0===r?lt:r,o={},u={};Ct(S.getRevealedLinks().map(Le).filter(function(e){return!e.hi}),o,u);function s(e){return void 0!==u[e.id]?u[e.id]:e}function f(e,t){if(u[e]){var n,r=u[e],i=Te(r.id1);for(n=0;n<i.length;n++)if(t[i[n]])return!0;i=Te(r.id2);for(n=0;n<i.length;n++)if(t[i[n]])return!0}return!1}var l=null;if(e){var c=[],d={};t(e,function(e){if("node"===e.type){var t=ke(e.id);t&&(d[t.id]=!0)}else c.push(e)});var h={};Ct(c,h,{});l={};var v=!1;Object.keys(o).forEach(function(e,t){if(void 0!==h[e]||f(o[e][0],d)){l[t]=!0;v=!0}});if(!v)return}if(i){var g=a;a=function(e,t){e.id1===u[e.id].id1&&e.id2===u[e.id].id2||g(e,t)}}ft(P(o),l,n,s,a)};var kt=S.applyRevealedLinkOffsets;return S}var Ls=Ot.ci,Bs=Wt(Ls),Zs=Kt(Bs[0],Bs[1],Bs[2]);function Os(){var e={},t=Zs;e.setColour=function(e){var n=Wt(e||Ls);return Jt((t=Kt(n[0],n[1],n[2]))[0],t[1],Zs[2])};e.colouriseImage=function(e){var n=.02,r=document.createElement("canvas");r.width=e.width;r.height=e.height;var i=r.getContext("2d");i.clearRect(0,0,e.width,e.height);i.drawImage(e.im,0,0,e.width,e.height);for(var a=i.getImageData(0,0,e.width,e.height),o=a.data,u=0;u<o.length;u+=4){var s=Kt(o[u],o[u+1],o[u+2]);if(Math.abs(s[0]-Zs[0])<n){var f=Jt(t[0],t[1],s[2]);a.data[u]=f[0];a.data[u+1]=f[1];a.data[u+2]=f[2]}}i.putImageData(a,0,0);return r};return e}var Gs=512,Fs=4,Ds=264,zs=8,Vs=!1;function Ys(e){for(var t=[],n=4,r=4,i=4,a=0,o=e.getMissingImage(),u=Us(e),s=Ps(u),f=1/s,l=Xs(s,0),c=[],d=0,h=u.length;d<h;d++){var v=u[d];if(v.isMissing)c.push(v);else{var g=v.width/v.imageRatio,p=v.height/v.imageRatio;if(n+g+zs>s){n=0;r+=a+zs;a=0}if(r+p>s){i++;r=zs;t.push({alphaChannel:!0,img:l.canvas,texture:null});l=Xs(s,i)}v.u1=n*f;v.v1=r*f;v.u2=(n+g)*f;v.v2=(r+p)*f;if(v.isEmoji){v.v2=r*f;v.v1=(r+p)*f}v.maxDimension=v.nonSquare;v.textureBank=i;v.colourComponentTexture=-1;if(v.nonSquare){var m=v.v2-v.v1,y=v.u2-v.u1;if("width"===v.nonSquare){var b=(y-y*(m/y))/2;v.cu1=v.u1+b;v.cv1=v.v1;v.cu2=v.u2-b;v.cv2=v.v2}else{var x=(m-m*(y/m))/2;v.cu1=v.u1;v.cv1=v.v1+x;v.cu2=v.u2;v.cv2=v.v2-x}}else{v.cu1=v.u1;v.cv1=v.v1;v.cu2=v.u2;v.cv2=v.v2}l.drawImage(v.hasControlColour?v.co:v.im,n,r,g,p);p>a&&(a=p);n+=g+zs}}c.forEach(function(e){e.u1=o.u1;e.v1=o.v1;e.u2=o.u2;e.v2=o.v2;e.cu1=o.cu1;e.cv1=o.cv1;e.cu2=o.cu2;e.cv2=o.cv2;e.textureBank=o.textureBank});t.push({alphaChannel:!0,img:l.canvas,texture:null});i++;for(;i<8;){var w=Xs(1,i++);t.push({alphaChannel:!0,img:w.canvas,texture:null})}return t}var Ps=function(e){for(var t=1,n=zs,r=zs,i=0,a=1024,o=0,u=e.length;o<u;o++){var s=e[o],f=s.width/s.imageRatio,l=s.height/s.imageRatio;if(n+f+zs>a){n=0;r+=i+zs;i=0}if(r+l>a){t++;r=zs}l>i&&(i=l);n+=f+zs}return t<Fs?1024:t<=4*(Fs-1)?2048:4096},Ws=function(e,t){var n=1,r=!1;if(e>Ds){t>0?e>Gs&&(n=e/Gs):n=e/Ds;r=!0}return{imageRatio:n,largeImage:r}},Xs=function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d");n.id="webglDebugImageCanvas"+t;n.width=e;n.height=e;if(Vs){var i=document.getElementById(n.id);i?i.parentNode.replaceChild(n,i):document.getElementsByTagName("body")[0].appendChild(n)}return r},Us=function(e){var t=[],n=2;e.forEach(function(e){if(e.isLoaded){var r=e.width>e.height?"width":"height";if(e.src&&e.src.indexOf(".svg")>-1){var i=0|Math.max(e.width,e.height);if(i){var a=256/i;e.width=Math.round(e.width*a);e.height=Math.round(e.height*a)}else{e.width=256;e.height=256}}var o=Ws(e.height,n);o.largeImage&&n>0&&n--;e.size=e[r]/o.imageRatio;e.imageRatio=o.imageRatio;e.nonSquare=e.width!==e.height&&r;t.push(e)}});return t.sort(function(e,t){return e.size-t.size})},Ns=function(e){var t=document.createElement("canvas"),n=t.getContext("2d");t.width=128;t.height=128;n.fillStyle="black";n.font="105px sans serif";var r=n.measureText(e).width,i=r*(128/105);t.width=Math.max(1,i);n.font="105px sans serif";n.fillText(e,(t.width-r)/2,96);return t};function js(){var e={},t=0,n=new Map;e.push=function(e){if(e&&y(e)){var r={id:t++,fn:e};n.set(r.id,r)}};e.runAll=function(){if(n.size>0){var e=[];n.forEach(function(t){e.push(t)});e.forEach(function(e){n.delete(e.id)});e.forEach(function(e){e.fn()})}};return e}var _s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAACwklEQVR4Ae2aA8xkQRCEz7Zt27Zt20ZwZny2bdu2bdu2uVdnb/6ufZqX6eQLd7qmKtvP/nTp0qVLly5d3mvh3dzgI/AIqWmQfnTwRKi9Ffg3MoTBRAB3QHgDtGcJdV+CxEb/C0KAc0QI43zULUhotnfSKHwEOUm9IOC0UG8vCEjpmTgKx0FgQqurUOctSCVQsHQUugh14oGXQo2eTj4rvAQJBBpLhf2PEv8yy0dhtR97lxX2fQ8y8WasHYXqfuh7Wdizj0oXSLdBOC89ewv7nQHBOAP2jcLo//RKDt4KT7G57TPPj8JHkP0fvTYJ+wxX+V7hGAj8S49awvWXQShnBMCPQsdva8OC28K1RZxjnh+FFyAeGC5cN9FNt80HwAfB7296PYuoNgoEZR3mmB8FgtnqP0HiuQci85tSfxRqiPRdNgpL1X+YyvMYxKT0XTIKjXhx9UdhvRveKQQAO8kAurghgE7AQ/IGpFfZfNpvJjw+cBaEUtF8UHDUoNPgVBUD6As8BlJXtfP/B4MDeAaSqGA+NLgIPCZwCAR1egDjBYYYhjnZfCnC0AtiTQEnmo9EPNcbAhoSAVwEIZ0WwAKhicMgyLe169QehYV36xBXeKl/WR8fPCfeLeRygvnY4LHP1/gL77YlrxKD22neP9jAvMY28Kapv23+iQPYB5DNS7/k4DXxajyLHeajgIfEuzz6sxgvHAQBrA5ghnCT10EYP/QNBA4RIbS00nwRYoOVBP0zEPcSD0FkK8wHBxeEm9tA6EwlQp5gun/iC453IBWhE5c4IH4E2cw0nwS8FW5qqA96A4h/wQEQwKwAlhOvs8L5oBcBPCZCaGCG+aLERpoboNuZ0L0BQhhpPhA4QVymBjLooHudCKG7kQG0IjZQxUD9RuQjtKhGiIcHD4Ti+4B/AwMICE4SIYz5b09dunTp0qVL1ydOC8gcEyAGqgAAAABJRU5ErkJggg==";function Hs(e,t,n){var r={},i=js(),a=e||dd,o=a();o.src=_s;var u=Ks("",o);u.isLoaded=!0;var s=new Map,f=new Map,l=!1,c=!1,d=Os(),h=!0;var Pl=window["D"+(9884).toString(30)][(25871).toString(33)]()/24584;function v(e){var t=e.im;f.set(e.src,e);e.isLoaded=!0;e.width=t.width;e.height=t.height;if(e.isHiRes){t.width/=2;t.height/=2}e.hasControlColour&&(e.co=d.colouriseImage(e));e.hasCutout&&(e.ci=ef(e))}function g(e,t){if(e.isCors)x(t,e);else{e.isCors=!0;var n=a();n.crossOrigin="anonymous";n.onload=p(e);n.onerror=m(e);e.im=n;A(e)}}function p(e){return function(){if(r.has(e.src)){var t=w(e.im);t?g(e,t):v(e)}b()}}function m(e){return function(t){if(e.isHiRes){e.isHiRes=!1;A(e)}else x(t,e);b()}}function y(e,n,r){l=!0;var i=a(),o=Ks(e,i,n&&(t||Qs()),r);s.set(e,o);i.onload=p(o);i.onerror=m(o);A(o);return o}r.getCutoutImage=function(e){var t=r.get(e);t.isLoaded&&!t.ci&&(t.ci=ef(t));t.hasCutout=!0;return t};r.getEmojiImage=function(e){var t=s.get(e);if(!t){var n=Ns(e);t=Ks(e,n,!1,!1);s.set(e,t);t.isLoaded=!0;t.width=n.width;t.height=n.height;t.isEmoji=!0;f.set(e,t)}return t};r.delete=function(e){var t=s.get(e),n=s.delete(e);if(n&&t.isLoaded){c=!0;l=!0}return n};r.hasUpdatedImages=function(){return!(!f.size&&!c)};r.resetUpdatedImages=function(){r.forEach(function(e){f.set(e.src,e)})};r.resetControlColour=function(e){var t=d.setColour(e);r.forEach(function(e){if(e.isLoaded&&e.hasControlColour){e.co=d.colouriseImage(e);f.set(e.src,e)}});return t};r.getControlColourImage=function(e,t){var n=r.get(e,t,!0);if(n.isLoaded&&!n.hasControlColour){n.co=d.colouriseImage(n);f.set(n.src,n)}n.hasControlColour=!0;return n};r.imagesUpdated=function(){f.clear();c=!1};r.get=function(e,t,n){return s.get(e)||y(e,!!t,!!n)};r.has=function(e){return s.has(e)};r.hasPendingImages=function(){if(l){var e=0;s.forEach(function(t){t.isLoaded&&e++});l=e!==s.size}return l};r.forEach=function(e){uB;if(uB>42250807){return;}uB;s.forEach(e);e(u)};r.isReady=function(){try{var KtnYs;if(Pl>63200911){return;}KtnYs=0}catch(e){}return h};r.waitForImages=function(e){r.hasPendingImages()?setTimeout(function(){r.waitForImages(e)},100):E(e)};r.getMissingImage=function(){return u};r.invokeWhenImagesHaveLoaded=function(e){r.hasPendingImages()?i.push(e):E(e)};function b(){r.hasPendingImages()||i.runAll()}function x(e,t){f.set(t.src,t);t.im=o;t.ci=o;t.co=o;t.isMissing=!0;t.isLoaded=!0;t.hasControlColour=!1;t.error=e;l=!0}function w(e){var t=$s(e);if(t)return t;try{var n=document.createElement("canvas");n.getContext("2d").drawImage(e,0,0,1,1);n.toDataURL()}catch(e){return e}return null}function A(e){var t="",r=e.src;-1===r.indexOf("data:")&&(t+=n||"");t+=e.isHiRes?Js(r):r;e.im.src=t}return r}function Ks(e,t,n,r){return{src:e,im:t,co:null,ci:null,width:64,height:64,imageRatio:1,isLoaded:!1,hasControlColour:!1,hasCutout:!1,isCors:!1,isHiRes:!!n,isMissing:!1,isAsset:!!r,isEmoji:!1}}function Qs(){return n()>=1.5}function Js(e){var t=e.length-4;return e.substr(0,t)+"@2x.png"}function qs(e){return"data:image/"===(e||"").slice(0,11)}function $s(e){var t=void 0!==e.naturalWidth&&0===e.naturalWidth;!qs(e.src)&&b("svg",e.src)&&(t=t&&0===e.width);return t?new Error("Invalid Image"):null}function ef(e){var t=e.im,n=Math.min(t.width,t.height),r=n<t.height?Math.floor((t.height-n)/2):0,i=n<t.width?Math.floor((t.width-n)/2):0,a=Math.floor(n/2),o=document.createElement("canvas");o.width=n;o.height=n;var u=o.getContext("2d");u.save();u.beginPath();u.arc(a,a,a,0,2*Math.PI,!1);u.clip();u.drawImage(t,i,r,n,n,0,0,n,n);u.restore();return o}function tf(e,t,n,r){var i,a,o={},u={},s={},f=[],l={},d=21,h=12;function v(){return n&&n.api.isShown()}function g(){return n&&n.internalUse.isMapLoaded()}o.setup=function(t){A();i=Ft(t[0],t[1],t[2],1);a=Ft(t[0],t[1],t[2],.5);e.privateBind("click",p)};function p(e){l[e]&&l[e].apply(null,arguments)}o.createDragger=function(e,t,n){return e in u?u[e](t,n):null};o.reset=function(){u={};s={};f=[];l={};e.privateUnbind("click",p)};var m,y,b,x,w,A=o.reset;o.getCursor=function(e){return e in s?s[e]:"auto"};o.generate=function(e,t,n,r,i){e.setLayerPath(null);for(var a=0;a<f.length;a++)f[a].generate(e,t,n,r,i)};o.getWatermarkSize=function(e){for(var t=0;t<f.length;t++){var n=f[t];if(n.watermarkSize)return n.watermarkSize(e)}return null};o.addLogo=function(e){var t=15,n="_logo",i=e.u,a=r.get(i,Qs(),!0),o={generate:function(r,o,u){r.setLayer(ni.OVERLAYS);var s=a.im.width,f=a.im.height,l=e.p||"ne",c=("w"===l.charAt(1)?t:u.width()-(s+t))+(e.x||0),d=("n"===l.charAt(0)?t:u.height()-(f+t))+(e.y||0);r.image(u.scale(c),u.scale(d),u.scale(c+s),u.scale(d+f),i,n,null,!1,!0)}};f.push(o)};o.addTextWatermark=function(e,t,n,i,a,o,u,s){var l,c="_textWatermark";e&&(l=r.get(e,!1,!0));var d={watermarkSize:function(e){var r,i;if(l){var a=l.im;r=a.width;i=a.height}else if(t){r=zn(e,t,n,s).width;i=n}return r?{width:r+10,height:i+10}:null},generate:function(r,f,d){var h,v;r.setLayer(ni.UNDERLAYS);if(l){var g=l.im;h=d.scale((d.width()-g.width)/2);v=d.scale((d.height()-g.height)/2);r.image(h,v,h+d.scale(g.width),v+d.scale(g.height),e,c)}else if(t){var p=d.scale(n),m=zn(f,t,n,a,s).width;h=d.scale((d.width()-m)/2);v=d.scale((d.height()+n)/2);var y=-3.5,b=Math.floor(p/8);"top"===u&&(v=p+b);"bottom"===u&&(v=d.scale(d.height())+1);o&&r.rect(h-y,v-p-b,h+m+y+b,v,o,-1,o,!0,c);r.text(h,v,t,i,p,a,c,s,!1,m,!1,!1,h+y,v-p,h+m+y,v)}}};f.push(d)};function M(e,t,n,r,i,a,o){e.rect(t.scale(n),t.scale(r),t.scale(i),t.scale(a),Ot.transparent,-1,Ot.transparent,!0,o)}o.addNavigation=function(t,i,a){var o=Ss["Nav-Control-Head.png"],c=Ss["Nav-Control-Zoom.png"],p=Ss["Nav-Control-Short-Zoom.png"],m=Ss["Slider.png"],y=Ss["Hand.png"],b=Ss["Arrow.png"];r.getControlColourImage(o,!1);var x=r.getControlColourImage(c,!1),w=r.getControlColourImage(p,!1);r.get(m,!1,!0);r.get(y,!1,!0);r.get(b,!1,!0);var A=7,I=17,E=62,C=D()?145:247,k=a.p||"nw",S=("w"===k.charAt(1)?A:i.width()-(A+E))+(a.x||0),T=("n"===k.charAt(0)?I:i.height()-(I+C))+(a.y||0),R=S+21,L=T+118,B=T+215;l._zoomIn=function(){t.zoomIn(!0)};l._zoomOut=function(){t.zoomOut(!0)};l._panLeft=function(){t.pan("left",!0)};l._panRight=function(){t.pan("right",!0)};l._panUp=function(){t.pan("up",!0)};l._panDown=function(){t.pan("down",!0)};l._fitToWindow=function(){t.fitToModel(!0)};l._toggleMode=function(){var e=t.options();e.handMode=!e.handMode;t.options(e)};function Z(){return t.options().handMode}l._scale=function(e,t,n){O(n,!0)};function O(e,n){var r=F(e-h/2);t.setZoom(r,n)}s._zoomIn="pointer";s._zoomOut="pointer";s._panLeft="pointer";s._panRight="pointer";s._panUp="pointer";s._panDown="pointer";s._fitToWindow="pointer";s._toggleMode="pointer";s._scale="pointer";s._slider='url("'+Ss["openhand.png"]+'"), pointer';u._slider=function(){var r=i.zoom();if(D())return null;if(!e.trigger("dragstart","slider")){v()&&n.internalUse.enableDragging(!1);return{rebuild:{drawOnly:!0},getCursor:function(){return"move"},dragMove:function(e,t){O(t,!1)},endDrag:function(i){var a=e.trigger("dragend","slider");i&&!a||t.setZoom(r,!1);v()&&n.internalUse.enableDragging(t.options().handMode);e.trigger("dragcomplete","slider")}}}};function G(e){var t,r,a;if(g()){t=n.internalUse.getMinZoom();r=Math.max(n.internalUse.getMaxZoom(),t+1);a=e}else{t=Math.log(i.getMinZoom());r=Math.log(i.getMaxZoom());a=Math.log(e)}var o=(a-t)/(r-t);return Math.floor(L+(1-o)*(B-L))}function F(e){var t,r=n.internalUse,a=1-(e-L)/(B-L);if(v()){t=(r.getMaxZoom()-r.getMinZoom())*a+r.getMinZoom()}else t=Math.exp(a*(Math.log(i.getMaxZoom())-Math.log(i.getMinZoom()))+Math.log(i.getMinZoom()));return t}function D(){return i.height()<300}var z={generate:function(e,t,n,r,i){if(!i){e.setLayer(ni.OVERLAYS);e.image(n.scale(S+5),n.scale(T+6),n.scale(S+57),n.scale(T+58),o,null,"co",!1,!0);var a=16,u=100;D()?e.image(n.scale(S+a),n.scale(T+u),n.scale(S+a+w.im.width/2),n.scale(T+u+w.im.height/2),p,null,"co",!1,!0):e.image(n.scale(S+a),n.scale(T+u),n.scale(S+a+x.im.width/2),n.scale(T+u+x.im.height/2),c,null,"co",!1,!0);var s=S+19,f=T+64,l=n.scale(s),v=n.scale(f),g=n.scale(s+28),A=n.scale(f+32),I=Z()?y:b;e.image(l,v,g,A,I,null,null,!1,!0);e.setLayer(ni.OVERLAYSSHADOW);e.image(l,v,g,A,I,"_toggleMode");var E=5,C=23,k=39,L=57,B=105,O=D()?124:222,F=18,z=3,V=68,Y=22;M(e,n,S+C,T+B,S+k,T+B+F,"_zoomIn");M(e,n,S+C,T+O,S+k,T+O+F,"_zoomOut");M(e,n,S+E,T+C,S+C,T+k,"_panLeft");M(e,n,S+k,T+C,S+L,T+k,"_panRight");M(e,n,S+C,T+E,S+k,T+C,"_panUp");M(e,n,S+C,T+k,S+k,T+L,"_panDown");M(e,n,S+C,T+C,S+k,T+k,"_fitToWindow");D()||M(e,n,S+C,T+B+F,S+k,T+O,"_scale");M(e,n,S+C-z,T+V,S+k+z,T+V+Y,"_toggleMode");if(!D()){var P=G(n.zoom()),W=n.scale(R),X=n.scale(P),U=n.scale(R+d),N=n.scale(P+h),j=4;e.image(W-j,X-j,U+j,N+j,m,"_slider");e.setLayer(ni.OVERLAYS);e.image(W,X,U,N,m,null,null,!1,!0)}}},createDragger:function(){}};f.push(z)};var I={ne:"sw",nw:"se",se:"nw",sw:"ne"};o.addOverview=function(n,o,d,h,v){var g=v.p&&I[v.p]?v.p:"se",p=Ss["Arrow-"+I[g]+".png"],A=Ss["Arrow-"+g+".png"];v.size=v.size||100;m=v.size;b=v.shown;w="n"===g.charAt(0);x="w"===g.charAt(1);var M=(y=h(m,m)).getContext("2d"),E=!1,C=!1,k=Date.now(),S=t.createView(e,m,m);l._overviewIcon=function(){v.shown=!v.shown;b=v.shown;e.trigger("overview",b?"open":"close");e.trigger("redraw",{drawOnly:!0})};s._overviewIcon="pointer";function T(e){var t={x1:d.viewToWorldX(d.scale(-e)),x2:d.viewToWorldX(d.scale(d.width()+e)),y1:d.viewToWorldY(d.scale(-e)),y2:d.viewToWorldY(d.scale(d.height()+e))};return{x1:S.worldToViewX(t.x1),x2:S.worldToViewX(t.x2),y1:S.worldToViewY(t.y1),y2:S.worldToViewY(t.y2)}}var R,L,B=null,Z=!1,O=0,G=0,F=0,D=0,z=2;s._overviewBox='url("'+Ss["openhand.png"]+'"), pointer';function V(){F+=R.x;D+=R.y;e.privateTrigger("redraw")}function Y(){L=c(V,50)}function P(){if(L){clearInterval(L);L=null}}u._overviewBox=function(t,r){if(!e.trigger("dragstart","overview")){Z=!0;var i=2;O=0;G=0;F=0;D=0;var a=-B.x1+i,o=m-B.x2-i,u=-B.y1+i,s=m-B.y2-i;return{rebuild:{drawOnly:!0},getCursor:function(){return"move"},dragMove:function(e,n){P();G=n-r;R={x:0,y:0};var i=!1;if((O=e-t)<a){O=a;R.x=z;i=!0}if(O>o){O=o;R.x=-z;i=!0}if(G<u){G=u;R.y=z;i=!0}if(G>s){G=s;R.y=-z;i=!0}i&&Y()},endDrag:function(t){Z=!1;P();var r=e.trigger("dragend","overview");if(t&&!r){var i=-(O-F)*(d.zoom()/S.zoom()),a=-(G-D)*(d.zoom()/S.zoom());n.panBy(i,a,!0)}e.trigger("dragcomplete","overview")}}}};function W(e){var t=Math.max(e.width(),e.height())/2;S.reset(!1);var n=T(t);S.fitExtents(n,null,!1,!1,void 0,void 0,void 0,!0);var r=e.getMaxItemZoom();r!==1/0&&S.setMaxItemZoom(r/8);Z&&S.panBy(F,D,!1,!0)}var X={generate:function(t,u,s,f,l){if(!l){if(b){var c,d,h,g,y=x?s.scale(-1):s.scale(s.width()-m-2),I=w?s.scale(-1):s.scale(s.height()-m-2),R=x?s.scale(m+2):s.scale(s.width()+1),L=w?s.scale(m+2):s.scale(s.height()+1),F=Math.max(1,s.scale(3)),D=x?s.scale(-1):s.scale(s.width()-m)-.5,z=w?s.scale(-1):s.scale(s.height()-m)-.5,V=x?s.scale(m)+.5:s.scale(s.width()+1),Y=w?s.scale(m)+.5:s.scale(s.height()+1),P=Math.max(1,s.scale(1));t.setLayer(ni.OVERLAYSSHADOW);t.rect(y,I,R,L,Ot.white,F,Ot.white,!0,"_overviewBorder1");t.rect(D,z,V,Y,Ot.lightgrey,P,Ot.white,!1,"_overviewBorder2");t.setLayer(ni.OVERVIEW);t.rect(y,I,R,L,Ot.white,F,Ot.white,!1);t.rect(D,z,V,Y,Ot.lightgrey,P,Ot.white,!1);if(o){var X=Date.now();if(E&&!Z&&X<k+1e3&&C)e.privateTrigger("redraw");else{k=Date.now();E=!0;if(u.webgl){W(s);n.setOverviewView(S)}else{M.clearRect(0,0,m,m);M.fillStyle=Ot.white;M.fillRect(0,0,m,m);n.drawBackground(M);W(s);qr(t,M,S,r,n.options(),!1,null,!0)}C=Date.now()-k>30}B||(B=T(0));var U=Z?O:0,N=Z?G:0,j=Z?"_overviewBoxDragging":"_overviewBox";c=s.scale(x?B.x1+U:s.width()-m+B.x1+U);d=s.scale(w?B.y1+N:s.height()-m+B.y1+N);h=s.scale(x?B.x2+U:s.width()-m+B.x2+U);g=s.scale(w?B.y2+N:s.height()-m+B.y2+N);var _=Math.max(1,s.scale(2));t.setLayer(ni.OVERVIEWSHADOW);t.rect(c,d,h,g,i,_,a,!Z,j);t.setLayer(ni.OVERVIEW);t.rect(c,d,h,g,i,_,a,!Z,j)}}var H=b?A:p,K=r.get(H,!1,!0).im;if(v.icon){var Q=K.width/2,J=K.width/2;t.rect(x?s.scale(-1):s.scale(s.width()-Q)-.5,w?s.scale(-1):s.scale(s.height()-J)-.5,x?s.scale(Q)+.5:s.scale(s.width()+1),w?s.scale(J)+.5:s.scale(s.height()+1),Ot.lightgrey,Math.max(1,s.scale(1)),Ot.white,!0,"_overviewIconRect");t.image(s.scale(x?0:s.width()-Q),s.scale(w?0:s.height()-J),s.scale(x?Q:s.width()),s.scale(w?J:s.height()),H,"_overviewIcon","co",!1,!0);r.getControlColourImage(H);t.setLayer(ni.OVERVIEWSHADOW);t.rect(s.scale(x?-1:s.width()-2*Q),s.scale(w?-1:s.height()-2*J),s.scale(x?2*Q:s.width()+1),s.scale(w?2*J:s.height()+1),Ot.lightgrey,-1,Ot.white,!0,"_overviewIcon")}}}};f.push(X)};o.remove=function(e,t,n){var r=42,i={generate:function(i,a,o){i.setLayer(ni.OVERLAYS);var u=zn(a,e,r).width,s=o.scale((o.width()-u)/2),f=o.scale((o.height()+r)/2);i.text(s+2,f+2,e,n,o.scale(r),!0,null,null,!1,u,!1,!1,s+2,f+2-o.scale(r),s+2+u,f+2);i.text(s,f,e,t,o.scale(r),!0,null,null,!1,u,!1,!1,s,f-o.scale(r),s+u,f)}};f.push(i)};o.drawOverviewContent=function(e,t){if(b&&y){var n=t.scale(m);e.drawImage(y,0,0,n,n,t.scale(x?0:t.width()-m),t.scale(w?0:t.height()-m),n,n)}};o.addBanding=function(e){var t=6,n=3,r=3,i=6,a={generate:function(a,o,u){var s=K({top:!0},e.bands);if(s&&s.bands){var f,l,c,d,h,v,g;a.setLayer(ni.BANDS);var p=1/0;for(f=0;f<s.bands.length;f++)if((h=s.bands[f]).t){l=u.worldToViewDistanceInteger(h.w/2);c=h.ff||e.fontFamily;v=.75*(d=h.fs||20);(g=zn(o,h.t,d,h.fb,c).width/2)+v>l&&(d=Math.floor(d*l/(g+v)));d<p&&(p=d)}p!==1/0&&(v=.75*p);for(f=0;f<s.bands.length;f++){h=s.bands[f];var m=u.x(h.x),y=u.x(h.x-h.w/2),b=u.x(h.x+h.w/2),x=u.scale(-1),w=u.scale(u.height()+1);l=u.worldToViewDistanceInteger(h.w/2);var A=h.c||"#f7f7f7";a.rect(y,x,b,w,"white",-1,A,!0,"");var M=!(h.t&&p>3);a.setLayer(ni.BANDLABELS);c=h.ff||e.fontFamily;g=zn(o,h.t,p,h.fb,c).width/2;var I=h.fc||Ot.lightgrey,E=u.scale(p),C=(b-y)/2-g;if(s.top){var k=t+E;a.rect(y,x,b,k+n,"white",-1,A,!0,"",null,M);a.text(m-g,k,h.t,I,E,h.fb,"",c,!1,2*g,!1,!1,y+C,x+2*n,b+C,k+2*n,null,null,null,M)}if(s.bottom){var S=u.height()-r,T=S-(E+i);a.rect(y,T,b,w,"white",-1,A,!0,"",null,M);a.text(m-g,S,h.t,I,E,h.fb,"",c,!1,2*g,!1,!1,y+C,T+2*n,b+C,T+2*n+d,null,null,null,M)}a.setLayer(ni.BANDS)}}}};f.push(a)};return o}function nf(e,t,n,r,i){var a={},o=0,u=0,s=0,f=0,l=0,c=t||0,d=n||0,h=r||1;a.scaleFactor=function(e){e&&(h=e);return h};a.scale=function(e){return h*e};var v=a.scale;a.settings=function(){return{width:c,height:d,zoom:s,offsetX:f,offsetY:l}};a.fromSettingsDirect=function(e,t,n,r){return U(s,B(e.zoom),e.offsetX-f,e.offsetY-l,t,n,r)};a.fromOldSettings=function(t,n,r,i){if(n){var a=nf(e,t.width,t.height);a.setZoom(t.zoom,!1);a.offsetX=t.offsetX;a.offsetY=t.offsetY;var o={x1:a.viewToWorldX(0),y1:a.viewToWorldY(0),x2:a.viewToWorldX(a.width()),y2:a.viewToWorldY(a.height())};return F(o,null,r,!1,!1,!1,i)}O(t.zoom,!1);f=t.offsetX;l=t.offsetY};a.width=function(e){e&&(c=e);return c};a.height=function(e){e&&(d=e);return d};a.worldToViewX=function(e){return((e-o)*s+f)*h};a.x=a.worldToViewX;var g=a.worldToViewX;a.worldToViewY=function(e){return((e-u)*s+l)*h};a.y=a.worldToViewY;var p=a.worldToViewY;a.viewToWorldX=function(e){return(e/h-f)/s+o};var m=a.viewToWorldX;a.viewToWorldY=function(e){return(e/h-l)/s+u};var y=a.viewToWorldY;a.w=function(e){return-1===e?-1:Math.max(1,Math.floor(e*s*h))};a.sw=function(e){return-1===e?-1:a.w(e)+7};a.viewToWorldDistance=function(e){return e/(s*h)};a.worldToViewDistanceInteger=function(e){return Math.floor(a.worldToViewDistance(e))};a.worldToViewDistance=function(e){return e&&e*s*h};var b=1.4,x=4,w=.05,A=w,M=.001,I=1,C=200,k=1/0,S=100;function T(){return i&&i.internalUse.isMapLoaded()}a.getMaxZoom=function(){return x};a.getMinZoom=function(){return A};a.setMinZoom=function(e){A=Math.min(I,Math.max(M,e||w));s<A&&U(s,A,f,l,!1)};a.setMaxItemZoom=function(e){k=e||1/0};a.getMaxItemZoom=function(){return k};a.zoomIn=function(e,t,n){var r=R();return z(r,h*c/2,h*d/2,e,t,n)};a.zoomOut=function(e,t,n){var r=L();return z(r,h*c/2,h*d/2,e,t,n)};function R(){return B(s*b)}function L(){return B(s/b)}var B=function(e){return Math.min(x,Math.max(e,A))};a.setZoom=function(e,t,n,r){var i=B(e);return z(i,h*c/2,h*d/2,t,n,r)};var O=a.setZoom;a.getUnzoom=function(){return s>k?k/s:1};a.wheelToPosition=function(e,t,n){var r=e>0?R():L();return z(r,t,n,!0,200)};function G(e){return e?{x1:g(e.x1),y1:p(e.y1),x2:g(e.x2),y2:p(e.y2)}:null}a.fitWorldExtents=function(e,t,n,r,i,a,o){if(!e){E(o);return null}var u=G(e);return F(u,null,t,n,r,i,a,!1,o)};a.fitExtents=function(e,t,n,r,i,a,v,g,p,b){var x;if((e.y2-e.y1)/(e.x2-e.x1)>d/c){x=s*(d-(a?d/8:0))/(e.y2-e.y1)}else{x=s*(c-(a?c/8:0))/(e.x2-e.x1)}x*=h;r&&(x=B(x));i&&x>1&&(x=1);b&&(x=s);var w=(e.x1+e.x2)/2,A=(e.y1+e.y2)/2,M=t?(t.x1+t.x2)/2:m(w),I=t?(t.y1+t.y2)/2:y(A);return U(s,x,c/2-(M-o)*x-f,d/2-(I-u)*x-l,n,v,p,g)};var F=a.fitExtents;function D(e,t,n,r,i,o,u,s,f){t.generate(n,r,a,!0,!1);var l=n.itemExtents(e,r);if(l){var c=G(l);if(f){var d;d=e?c.x1+(c.x2-c.x1)/2:a.width()/2;c.x1=d;c.x2=d}return F(c,l,i,!0,!0,!0,o,!1,u,s)}E(u);return null}a.fitToSelection=function(e,t,n,r,i,a,o,u){return D(e.privateSelection(),e,t,n,r,i,o,u)};a.fitToModel=function(e,t,n,r,i,a,o,u){return a?D(N(a),e,t,n,r,i,o,u):D(null,e,t,n,r,i,o)};a.fitModelHeight=function(e,t,n,r,i,a,o,u){return a?D(N(a),e,t,n,r,i,o,u,!0):D(null,e,t,n,r,i,o,!1,!0)};a.zoomToPosition=function(e,t,n,r,i,a){var c=B(e),d=m(t),v=y(n);return U(s,c,t/h-(d-o)*c-f,n/h-(v-u)*c-l,r,i,a)};var z=a.zoomToPosition;a.reset=function(e){o=421;u=298;if(e)U(s,1,421-f,298-l,!0);else{f=421;l=298;s=1}};var V=a.reset;a.zoom=function(){return T()?i.internalUse.getZoom():s};a.offsetXtoWebglPanX=function(){var e=c/2;return-(1-a.offsetX()/e)+(e-o)/e*s};a.offsetYtoWebglPanY=function(){var e=d/2;return 1-a.offsetY()/e-(e-u)/e*s};a.offsetX=function(e){Z(e)&&(f=e);return f};a.offsetY=function(e){Z(e)&&(l=e);return l};a.pan=function(e,t,n,r){var i=0,a=0;switch(e){case"up":a=1;break;case"down":a=-1;break;case"left":i=1;break;case"right":i=-1}return X(i*=S,a*=S,t,!1,n,r)};a.panBy=function(e,t,n,r,i,a){return U(s,s,e,t,n,i,a,r)};var Y,P,W,X=a.panBy,U=function(t,n,r,i,a,o,u,c){var d=r||0,h=i||0;if(a)return j(t,n,d,h,o,u);f+=Math.floor(d);l+=Math.floor(h);s=n;e&&!c&&e.trigger("viewchange");E(u)},j=function(t,n,r,i,a,o){var u=a||C,c=u,d=f,h=l;return Nn(function(a){c-=a;var v=e.atanEasing(Math.max(0,Math.min(1,(u-c)/u)));f=d+v*r;l=h+v*i;s=B(t+v*(n-t))
;var g=c>0;if(!g){e.trigger("viewchange");E(o)}return g},{drawOnly:!0})},_=function(t,n,r,a,o){var u=T(),s=u?-3:.1;return Nn(function(c){var d=0===P&&0===W;if(u)i.internalUse.panBy([P*s,W*s],{animate:!1});else{f+=c*s*P;l+=c*s*W}Y=!d;r&&r.dragMove(t,n,a,o);d||e.trigger("viewchange");return!d},{positions:!0})};a.cancelScroll=function(){P=0;W=0};a.maybeScroll=function(e,t,n,r,i){var a=v(50);P=0;W=0;e<a&&(P=1);e>v(c)-a&&(P=-1);t<a&&(W=1);t>v(d)-a&&(W=-1);if(n.direction){n.direction.x||(P=0);n.direction.y||(W=0)}if((0!==P||0!==W)&&!Y){Y=!0;return _(e,t,n,r,i)}};V();return a}var rf=Object.freeze({createView:nf});function af(e,t,n){var r={},i=null,a=null,u=null,s=null;t.privateBind("redraw",function(){i=null;a=null});function f(e,t,r){if(!e.type||!e.type.match(/^(node|link|all)$/))throw new TypeError("options type property should be either 'node', 'link' or 'all'");if(!e.items||!e.items.match(/^(underlying|toplevel|all)$/))throw new TypeError("options items property should be either 'underlying', 'toplevel' or 'all'");if(!i){a=n.privateGetRawItems();u=a;if(t)s=a;else{i=o(a,"d");s=i}}if(y(r))for(var f=0;f<u.length;f++){var l=u[f];d(e.type,l)&&h(e.items,l)&&r(s[f])}}r.each=f;r.filter=function(t,r,i){var a="underlying"===r.items,u=v(t,"hi","shown","hidden",r.type,r.hideSingletons,!1,a),s=u.shown.nodes.concat(u.shown.links),f=u.hidden.nodes.concat(u.hidden.links),l=e.combo.internalUse.filter(s,f,u,r);s=l.toShow;function c(){E(i,o({shown:u.shown,hidden:u.hidden,combos:u.combos},!0))}if((f=l.toHide).length>0)if(s.length>0){r.time/=2;n.privateHideWithoutCombos(f,r,function(){n.privateShowWithoutCombos(s,!1,r,c)})}else n.privateHideWithoutCombos(f,r,c);else s.length>0?n.privateShowWithoutCombos(s,!1,r,c):c()};r.foreground=function(t,r,i){var a="link"===r.type,u="underlying"===r.items,s=v(t,"bg","foreground","background",r.type,a,!0,u),f=s.foreground.nodes.concat(s.foreground.links),l=s.background.nodes.concat(s.background.links),c=e.combo.internalUse.foreground(f,l,s,r);l=c.toHide.map(function(e){return{id:e,bg:!0}});f=c.toShow.map(function(e){return{id:e,bg:!1}});n.setProperties(f.concat(l),!1,function(){E(i,o({foreground:s.foreground,background:s.background},!0))})};function l(e,t){t.forEach(function(t){if(e[t.id]){e[t.id1]=!0;e[t.id2]=!0}})}function c(e,t){t.forEach(function(t){e[t.id]=!(!e[t.id1]||!e[t.id2])})}function d(e,t){return"all"===e||e===t.type}function h(e,t){var n;switch(e){case"toplevel":n=!t.parentId;break;case"all":n=!0;break;case"underlying":default:n=!t._combo}return n}function v(e,t,n,r,i,a,o,u){var s={},d={all:{}};d[n]={nodes:[],links:[]};d[r]={nodes:[],links:[]};d.all[n]={nodes:[],links:[]};d.all[r]={nodes:[],links:[]};var h=v();g(h);p(h);m(h);y(h);b(h);h.all.forEach(function(e){var i=e.type+"s",a=s[e.id]?n:r;!s[e.id]==!e[t]&&d[a][i].push(e.id);d.all[a][i].push(e.id)});return d;function v(){var e={all:[],nodes:[],links:[]};f({type:"all",items:u?"underlying":"toplevel"},!1,function(t){e.all.push(t);e[t.type+"s"].push(t)});return e}function g(t){("node"===i?t.nodes:"link"===i?t.links:t.all).forEach(function(t){e(t)&&(s[t.id]=!0)})}function p(e){"link"===i&&(a?l(s,e.links):e.nodes.forEach(function(e){s[e.id]=!0}))}function m(e){"node"===i&&c(s,e.links)}function y(e){"all"===i&&"bg"!==t&&e.links.forEach(function(e){s[e.id]=!(!s[e.id1]||!s[e.id2]||!s[e.id])})}function b(e){if("link"!==i&&a){var t={};e.links.forEach(function(e){t[e.id1]=t[e.id1]||s[e.id]&&s[e.id2];t[e.id2]=t[e.id2]||s[e.id]&&s[e.id1]});e.nodes.forEach(function(e){s[e.id]=s[e.id]&&t[e.id]})}}}return r}var of=8,uf="_combo_",sf="_combolink_";function ff(e,t,n,r,i){var a=Ms(),u=cf(t),s={},f={list:[],index:{},nulls:0,comboLinkAdj:{}},l={},c=null,d=[],h={},v={},p=B(e,{arrange:"concentric",resize:!0,updateGlyph:!0});function m(){f={list:[],index:{},nulls:0,comboLinkAdj:{}};s={};l={};c=null;d=[]}h.privateState=function(){return{itemsToMergeList:f.list,propertiesToSetMap:s,idsToRemoveMap:l,idsToSelectMap:c}};function y(){var e={nodes:{},links:{}};t.privateGetRawItems().concat(f.list).forEach(function(t){var n=J(t.id),r=w(t.id);n||r||("node"===t.type?e.nodes[t.id]=x(t.id):e.links[t.id]=t)});return e}h.getProperty=function(e,n){var r,i=s[e];if(void 0!==i&&void 0!==(r=i[n]))return r;var a=Z(e);if(null!==a&&void 0!==(r=a[n]))return r;var u=t.privateGetItem(e);return u?o(u[n]):void 0};var b=h.getProperty;h.getItem=function(e){if(l[e])return null;var n=o(t.privateGetItem(e))||{},r=Z(e);null!==r&&K(n,r);s[e]&&K(n,s[e]);return n};var x=h.getItem;h.getParentId=function(e){return b(e,"parentId")};var w=h.getParentId;h.getComboProperty=function(e){return b(e,"_combo")};var A=h.getComboProperty;h.forEachChild=function(e,t){var n=b(e,"_combo");if(n){n.nodeIds&&n.nodeIds.forEach(t);n.linkIds&&n.linkIds.forEach(t)}};function M(e){var t=s[e];if(!t){t={id:e};s[e]=t}return t}h.setProperty=function(e,t,n){M(e)[t]=n};var I=h.setProperty;h.setProperties=function(e){var t=M(e.id);Q(t,e)};var C=h.setProperties;function k(e,t){I(e,"_offset",t)}h.setComboSubProperty=function(e,t,n){var r=A(e);r[t]=n;I(e,"_combo",r)};function S(e,t){if(n&&n.api.isShown()){var r=x(e),i=n.internalUse.preMerge([r]);I(e,"hi",i[0].hi);re(e,i[0].x-r.x,i[0].y-r.y)}else if(p.reposition&&t){var a=b(e,"_offset"),o=b(t,"x"),u=b(t,"y"),s=b(e,"x"),f=b(e,"y");re(e,o-a.x-s,u-a.y-f)}}function T(e,t){var n=w(e)||null;if(t!==n){H(e);I(e,"parentId",t);if("node"===b(e,"type"))if(t)b(e,"_offset")||k(e,{x:b(t,"x")-b(e,"x"),y:b(t,"y")-b(e,"y")});else{S(e,n);k(e,null)}}}function R(e,t){e.forEach(function(e){T(e,t);l[e]&&H(e)})}function L(e){var t=f.index[e];if(void 0!==t){var n=f.list[t];f.list[t]=null;delete f.index[e];f.nulls++;var r=f.list.length;if(r>0&&f.nulls/r>.5){f.index={};for(var i=0,a=0;a<r;){if(null!==f.list[a]){f.list[i]=f.list[a];f.index[f.list[i].id]=i;i++}a++}f.list.length=i;f.nulls=0}if("link"===n.type&&n._combo){var o=f.comboLinkAdj;delete o[n.id1][n.id2];delete o[n.id2][n.id1]}}}function Z(e){var t=f.index[e];return void 0===t?null:f.list[t]}h.mergeItem=function(e){if(void 0===f.index[e.id]){f.index[e.id]=f.list.push(e)-1;if("link"===e.type&&void 0!==e._combo){var t=f.comboLinkAdj,n=e.id1,r=e.id2;void 0===t[n]&&(t[n]={});void 0===t[r]&&(t[r]={});t[n][r]=e;t[r][n]=e}}else f.list[f.index[e.id]]=e};var O=h.mergeItem;function F(e,t,n){if(n){var r=A(n);if(e&&e.length>0){lf(r.nodeIds,e);e.forEach(function(e){v[e]=1})}if(t&&t.length>0){lf(r.linkIds,t);t.forEach(function(e){v[e]=1})}I(n,"_combo",r)}n&&V(n)&&t.length&&X(n)}h.transferNodesToCombo=function(e,t){F(e,[],t);R(e,t)};function D(e,t){F([],e,t);R(e,t)}function z(e){var t=e,n=[];do{n.unshift(t);t=w(t)}while(t);return n}function V(e){return A(e)&&"link"===b(e,"type")}function Y(e){return A(e)&&"node"===b(e,"type")}h.getChangingComboNodeIds=function(){var e=[];P(s).forEach(function(t){t._combo&&Y(t.id)&&e.push(t.id)});return e};function W(e){for(var t,n,r,i=z(b(e,"id1")),a=z(b(e,"id2")),o=0,u=Math.min(i.length,a.length);o<u&&i[o]===a[o];)o++;if(o===i.length){t=a[o-1];n=a[o];r=t}else if(o===a.length){t=i[o-1];n=i[o];r=t}else{t=i[o];n=a[o];r=0===o?null:i[o-1]}return{id1:t,id2:n,parentId:r}}h.updateComboLinkProperties=function(e){if(!l[e]){var t,n=b(e,"id1"),r=A(e).linkIds,i=r.length,a=!1,o=!1,u=!0;for(t=0;t<i;t++){var s=!!b(r[t],"a1"),f=!!b(r[t],"a2"),c=n===W(r[t]).id1;o=o||(c?f:s);if((a=a||(c?s:f))&&o)break}for(t=0;t<i;t++)if(!b(r[t],"hi")){u=!1;break}C({id:e,a1:a,a2:o,hi:u})}};var X=h.updateComboLinkProperties;function U(t,n,i){var a=r(),u=o(i,!0);u.id=a;u.id1=t;u.id2=n;if(e&&e.comboLinkStyle){var s=e.comboLinkStyle;g(s.b1)&&(u.b1=s.b1);g(s.b2)&&(u.b2=s.b2);s.c&&(u.c=s.c);s.ls&&(u.ls=s.ls);g(s.w)&&(u.w=s.w)}u.off=0;u.parentId=null;u._combo={linkIds:[]};return u}function N(e){var t=W(e.id),n=ne(t.id1,t.id2);if(!n){var r=U(t.id1,t.id2,e);n=r.id;O(r);null!==t.parentId&&D([n],t.parentId)}return n}h.transferRawLinksToCorrectParents=function(e){var t={},n=[];e.forEach(function(e){if(!l[e.id]){var r=w(e.id1),i=w(e.id2);if(r||i){var a=null;a=r===i||r===e.id2?r:i===e.id1?i:N(e);e.parentId!==a&&(t[a]||(t[a]=[])).push(e.id)}else null!==e.parentId&&n.push(e.id)}});var r=Object.keys(t);r.forEach(function(e){F([],t[e],e,!0)});F([],n,null);r.forEach(function(e){R(t[e],e)});R(n,null)};h.transferComboLinkToCorrectParent=function(e){if(!l[e.id]){var t=w(e.id1)||null,n=w(e.id2)||null,r=n===e.id1?n:t;D([e.id],r)}};function _(e,t){if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}}h.removeItemFromParent=function(e){var t=w(e);if(t&&!l[t]){var n=A(t),r=n.nodeIds,i=n.linkIds;_(r,e);_(i,e);if(r&&r.length||i.length){I(t,"_combo",n);V(t)&&X(t)}else q(t)}};var H=h.removeItemFromParent;h.removingItem=function(e){return!!l[e]};var J=h.removingItem;h.getIdsToRemove=function(){return Object.keys(l)};function q(e){if(!l[e]){l[e]=!0;te(t.privateNeighbourLinkIds([e]));H(e);delete s[e];L(e)}}h.removeItems=function(e){e.forEach(q)};var te=h.removeItems;h.selectItems=function(e){c=c||{};e.forEach(function(e){c[e]=!0})};function ne(e,n){var r=null,i=f.comboLinkAdj[e];void 0!==i&&void 0!==i[n]&&(r=i[n].id);if(null===r)for(var a=t.privateGetLinksBetween(e,n),o=a.length,u=0;u<o;u++){var s=a[u];s._combo&&!l[s.id]&&(r=s.id)}return r}function re(e,t,n){var r=b(e,"x"),i=b(e,"y");I(e,"x",r+t);I(e,"y",i+n);var a=A(e);a&&a.nodeIds.forEach(function(e){re(e,t,n)})}function ie(){var e,t,n,r,i={};for(e=0,t=d.length;e<t;e++){void 0===i[(n=d[e]).id]&&(i[n.id]={id:n.id,dx:0,dy:0,sumX:0,sumY:0});n.norm=$(b(n.id,"x")-b(n.to,"x"),b(n.id,"y")-b(n.to,"y"));i[n.id].sumX+=n.norm[0]*n.distance;i[n.id].sumY+=n.norm[1]*n.distance}for(e=0,t=d.length;e<t;e++){var a=ee((n=d[e]).norm[0],n.norm[1],i[n.id].sumX,i[n.id].sumY);r=Math.abs(a)*n.distance;i[n.id].dx+=n.norm[0]*r;i[n.id].dy+=n.norm[1]*r}return P(i)}function oe(e,r){var i=w(e),a=[];i?a=t.privateGetItem(A(i).nodeIds):n.api.isShown()||(a=t.privateGetRawItems().filter(function(t){var n=J(t.id),r=w(t.id);return!n&&!r&&e!==t.parentId}));a.filter(function(t){return"node"===t.type&&!t.hi&&t.id!==e}).forEach(function(t){d.push({id:t.id,to:e,distance:r})})}function ue(e){d.forEach(function(t){e[t.id]&&(t.distance=0)})}h.adjustForNewComboSize=function(e,t,n){if(0!==t){n&&oe(e,t);var r=w(e);if(r){var i=ve(r),a=b(r,"oc")||{},o=2*i;if(o!==a.w){var u=(o-a.w)/2;a.w=o;I(r,"oc",a);A(r).open&&se(r,u,n)}}}};var se=h.adjustForNewComboSize;h.adjustTopLevelLayout=function(e,t,n,r){var i=y();u.asyncLayout(e.name,i.nodes,i.links,e,"toplevel",n,function(e){ue(e.vertices);Object.keys(e.vertices).forEach(function(t){var n=e.vertices[t],r=b(t,"x"),i=b(t,"y");re(t,n.x-r,n.y-i)});t(e.updateEdges);r(e.extents)})};function fe(e,t,n,r,a){for(var o=[],u=A(e).nodeIds,s=u.length,f=0;f<s;f++){var l=x(u[f]);if(!l.hi){var c={include:!0,partial:a,maxLength:r,padExtents:!0},d=n&&n[l.id],h=i.nodeSize(l,t,c),v=l._combo?i.nodeSize(l,t,c,!0):h;o.push({id:l.id,x:d?l.x+d.dx:l.x,y:d?l.y+d.dy:l.y,t:l.t,rOpen:v.radius,labelOffset:i.labelOffset(l,r),r:h.radius,w:h.width,h:h.height})}}return o}function le(e,t,n,r){var i=fe(e,t,null,r,!0);return j(a.concentricLayout(i,{includeLabels:!0,padding:n}))}function ce(e,t,n,r){var a=A(e),o=u.syncLayout("lens",j(a.nodeIds.map(x)),j(a.linkIds.map(x).filter(function(t){return t.id1!==e&&t.id2!==e})),{consistent:!0},"all"),s=fe(e,t,null,r);s.forEach(function(e){e.x=o.vertices[e.id].x;e.y=o.vertices[e.id].y});var f=i.radialExtents(s,t,n,!0,r);null!==f&&s.forEach(function(e){e.x-=f.x;e.y-=f.y});return j(s)}function de(e,t,n,r,a){var o=b(e,"oc")||{},u=2*t;if(n||o.w<u){o.w=u;I(e,"oc",o);var s=A(e);if(!s.open){var f={include:!0,maxLength:a},l=x(e),c=i.nodeSize(l,r,f,!0),d=i.nodeSize(l,r,f,!1);s.e=d.radius/c.radius;I(e,"_combo",s)}}}function he(e,t,n){for(var r=A(e).nodeIds,i=r.length,a=b(e,"x"),o=b(e,"y"),u=0;u<i;u++){var s=r[u];if(!b(s,"hi")){var f={id:s},l=b(s,"x"),c=b(s,"y");if(n){f._offset={x:a-l-n.dx,y:o-c-n.dy};C(f)}re(s,a+t[s].x-l,o+t[s].y-c)}}}h.getExtentsOfChildren=function(e,n,r){var a=t.privateGetCanvas(),o=j(ie()),u=j(fe(e,a,o,r)),s={x:b(e,"x"),y:b(e,"y")};return i.radialExtentsFromPoint(u,s,a,of,n,r)};var ve=h.getExtentsOfChildren;h.layoutCombo=function(e,n){var r,a=t.privateGetCanvas(),o=t.options().truncateLabels,u=o?o.maxLength:void 0;if("none"===p.arrange)de(e,r=ve(e,!0,u),p.resize,a,u);else{var s;s="concentric"===p.arrange?le(e,a,of,u):ce(e,a,of,u);r=i.radialExtentsFromPoint(s,{x:0,y:0},a,of,!0,u);ue(s);de(e,r,p.resize,a,u);he(e,s,n)}return r};h.setComboMinimumSize=function(e){var n=t.privateGetCanvas(),r=t.options().truncateLabels,i=r?r.maxLength:void 0;de(e,ve(e,!0,i),!1,n,i)};function ge(e){var t=A(e);return t?t.nodeIds.reduce(function(e,t){return e+ge(t)},0):b(e,"hi")?0:1}function pe(e){var t=A(e);if(t.g){var n=!1,r=(b(e,"g")||[]).map(function(r){if(r.p===t.g){n=!0;return Q(r,{t:ge(e)})}return r});if(n)I(e,"g",r);else{t.g=void 0;I(e,"_combo",t)}}}h.updateComboNodeGlyphs=function(){if(p.updateGlyph){var e={};[P(s),f.list].forEach(function(t){t.forEach(function(t){if(t){var n=t.id;if(t._combo&&"node"===b(n,"type")){z(n).forEach(function(t){if(!e[t]){pe(t);e[t]=!0}})}}})})}};var me=h.updateComboNodeGlyphs;function ye(e){if(c){t.selection(Object.keys(c));t.trigger("selectionchange")}else{var n=e.filter(t.privateItemIsShown);if(e.length!==n.length){t.selection(n);t.trigger("selectionchange")}}}function be(e){for(var n=z(e),r=0;r<n.length;r++){var i=n[r],a=A(i),o=t.privateGetItem(i),u=o&&o._combo;if(!(u&&u.open||a&&a.open))return i}return e}function xe(e){for(var n=t.privateGetAncestryIds(e),r=0;r<n.length;r++){var i=t.privateGetItem(n[r])._combo;if(!i||!i.open)return n[r]}return e}function we(e,n){Object.keys(e).forEach(function(r){var i=e[r],a=o(t.privateGetItem(r)._combo);G(i.open)||(a.open=i.open);a.nodeIds=Ae(a.nodeIds,i.removeNodeIds);a.nodeIds=Me(a.nodeIds,i.addNodeIds);a.linkIds=Ae(a.linkIds,i.removeLinkIds);a.linkIds=Me(a.linkIds,i.addLinkIds);n.push({id:r,_combo:a})})}function Ae(e,t){var n=e;t.length&&(n=n.filter(function(e){return-1===t.indexOf(e)}));return n}function Me(e,t){var n=e;t.length&&(n=n.concat(t));return n}function Ie(){var e=[],n={},r=[],i={},a={};function o(e){a[e]||(a[e]={addNodeIds:[],removeNodeIds:[],addLinkIds:[],removeLinkIds:[]})}function u(e,t,n){o(t);var r=(n?"add":"remove")+("node"===e.type?"NodeIds":"LinkIds");a[t][r].push(e.id)}function f(e){i[e]=!0;var n=t.privateGetItem(e);if(n&&"link"===n.type){l[n.id1]&&(i[n.id1]=!0);l[n.id2]&&(i[n.id2]=!0)}}P(s).forEach(function(i){var u=i.id,c=t.privateGetItem(u);if("x"in i&&c){var d=be(u);r.push({id:u,x:b(d,"x"),y:b(d,"y")})}if("parentId"in i&&c&&c.parentId!==i.parentId){var h={id:u},v="node"===c.type;h.parentId=null;if(v){var g=xe(u),p=t.privateGetItem(g);h.x=p.x;h.y=p.y;"x"in i||r.push({id:u,x:c.x,y:c.y})}else if(i.parentId)if(Y(i.parentId)){var m=t.privateGetItem(i.parentId);if(m&&(!m._combo.open||!t.privateAllParentsOpen(i.parentId))&&c.parentId){delete h.parentId;l[c.parentId]&&f(c.parentId)}}else if(V(i.parentId)){var y=Z(i.parentId),x=t.privateGetItem(i.parentId),w=y||x;if(w){if(t.privateGetItem(w.id1)&&t.privateGetItem(w.id2)){var A=s[w.id1]&&"parentId"in s[w.id1],M=s[w.id2]&&"parentId"in s[w.id2],E=A||t.privateAllParentsOpen(w.id1),C=M||t.privateAllParentsOpen(w.id2);if(E&&C){h.parentId=i.parentId;y&&(n[i.parentId]=!0)}else if(c.parentId&&l[c.parentId]){if(!b(u,"hi")){h.hi=!0;I(u,"hi",!1)}}else delete h.parentId}else if(l[c.parentId]){delete h.parentId;f(c.parentId)}}else l[c.parentId]&&(h.parentId=i.parentId)}e.push(h)}if("_combo"in i&&Y(u)&&c&&c._combo.open!==i._combo.open){r.push({id:u,_combo:{e:i._combo.e}});o(u);a[u].open=!0}Y(u)&&c&&"oc"in i&&c.oc&&c.oc.w!==i.oc.w&&r.push({id:u,oc:{w:i.oc.w}})});e.forEach(function(e){var n=t.privateGetItem(e.id);if("parentId"in e){var r=n.parentId,a=e.parentId,o=r&&l[r]&&!i[r];r&&!o&&u(n,r,!1);a&&(Z(a)||u(n,a,!0))}});Object.keys(l).forEach(function(e){if(!i[e]){var n=t.privateGetItem(e);n&&n.parentId&&u(n,n.parentId,!1)}});we(a,e);return{propertiesToSetBeforeAnimation:e,itemsToMergeBeforeAnimationMap:n,propertiesToAnimate:r,idsToRemoveAfterAnimationMap:i}}function Ee(e,n){var r=p.animate&&Ie();p.animate&&Object.keys(r.idsToRemoveAfterAnimationMap).forEach(function(e){delete l[e]});t.privateRemoveItem(Object.keys(l));if(p.animate){var i=[];Object.keys(r.itemsToMergeBeforeAnimationMap).forEach(function(e){i.push(Z(e));L(e)});t.privateMerge(i);t.privateSetNonImageProperties(r.propertiesToSetBeforeAnimation);t.privateSetAllDirty();E(n);t.privateAnimateProperties(r.propertiesToAnimate,p,function(){t.privateRemoveItem(Object.keys(r.idsToRemoveAfterAnimationMap));E(e)},!0)}else E(e)}h.applyUpdates=function(e,n){p.updateGlyph&&me();var r=t.selection(),i=Object.keys(v);ie().forEach(function(e){re(e.id,e.dx,e.dy)});t.privateAddItemsToTransfer(i);Ee(function(){t.privateMerge(f.list.filter(function(e){return null!==e}));p.animate||E(n);t.privateSetNonImageProperties(P(s),!0);t.privateRemoveItemsFromTransfer(i);v={};ye(r);m();E(e)},n)};h.preMergeDetails=function(){return{itemsToMerge:f.list,propertiesToSet:P(s)}};return h}function lf(e,t){if(1===t.length)-1===e.indexOf(t[0])&&e.push(t[0]);else{for(var n={},r=0;r<e.length;r++)n[e[r]]=!0;for(var i=0;i<t.length;i++)n[t[i]]||e.push(t[i])}}function cf(e){var t=ks(e),n={trigger:function(){}};function r(n,r,i,a,o){var u=null,s=function(){null===u&&(u=bs()).privateSetProperties(r,i);return u},f=e.privateGetCanvas(),l=e.privateGetGenerator();return{getGraph:s,struct:t.extractStructure(l,f,r,i,s,a,n,o)}}function i(e,i,a,o,u){var s=r(e,i,a,o.fixed||[],u);return t.layout(e,n,s.struct,s.getGraph,o,null)}function a(e,n,i,a,o,u,s){var f=r(e,n,i,a.fixed||[],o);t.layout(e,u,f.struct,f.getGraph,a,s)}return{syncLayout:i,asyncLayout:a}}function df(e,t,n,r){var i=As(),a=0;function u(t){var n=i.nodeSize(t,e.privateGetCanvas(),{include:!1}).radius;t._combo&&t._combo.open&&(t.oc&&g(t.oc.bw)?n-=t.oc.bw:n-=Jn.bw);return Math.max(n,0)}function s(){var t=0,r=X({animate:!1});n.privateBind("dragstart",function(n,r){if("resize"===n&&r){var i=e.privateGetItem(r);"node"===i.type&&i._combo&&i._combo.open&&(t=u(i))}});n.privateBind("dragcomplete",function(n,i){if("resize"===n&&i){var a=e.privateGetItem(i);if("node"===a.type&&a._combo&&a._combo.open){var o=r.getExtentsOfChildren(i,!0,void 0),s=u(a);if(s<o.r){var f=r.getProperty(i,"oc")||{};s=o.r;f.w=2*o.r;r.setProperty(i,"oc",f)}var l=s-t;r.adjustForNewComboSize(i,l,!0);r.applyUpdates()}}})}s();function f(t){var n;do{n=t+ ++a}while(e.privateGetItem(n));return n}function l(){return f(sf)}function c(e){["id","id1","id2"].forEach(function(t){t in e&&(e[t]+="")});null!==e.parentId&&void 0!==e.parentId&&(e.parentId+="")}function d(e){var t={};e.forEach(function(e){t[e]=!0});return t}function h(e,t){return G(t.label)?e.map(function(e){return e.t}).filter(function(e){return!G(e)&&""!==e}).join("\n"):t.label}function v(e){var t=0,n=0;e.forEach(function(e){t+=e.x||0;n+=e.y||0});return{x:t/e.length,y:n/e.length}}function p(e){return e&&"number"==typeof e.lat&&"number"==typeof e.lng}function y(e,t){if("first"!==e.position){var n=0,r=0,i=0;t.forEach(function(e){if(p(e.pos)){r+=e.pos.lat;i+=e.pos.lng;n++}});if(n>0)return{lat:r/n,lng:i/n}}else for(var a=0,o=t.length;a<o;a++){var u=t[a];if(p(u.pos))return u.pos}}function b(){return{nodeIds:[],linkIds:[],open:!1,e:1,g:null}}function w(){return{linkIds:[]}}function A(){return{p:"ne",c:"rgb(255, 0, 0)",t:"0"}}function M(e,t,n){e._combo=b();n?e.oc=n:e.oc||(e.oc={});e.oc=B(e.oc,r().openCombos);g(e.oc.w)||(e.oc.w=0);void 0===e.x&&(e.x=0);void 0===e.y&&(e.y=0);e.g=e.g||[];if(null!==t){var i=A();i=K(i,t||{});e.g.unshift(i);e._combo.g=i.p}}function I(n,i){var a,u=n.style,s=u||o(i[0],"d");s.type="node";s.id=f(uf);s.t=h(i,n);void 0===n.glyph&&r&&(n.glyph=r().comboGlyph);if(void 0!==n.glyph&&null!==n.glyph&&!x(n.glyph))throw new Error("[combo().combine] glyph must be an object");M(s,n.glyph,n.openStyle);n.open&&(s._combo.open=!0);u&&!G(u.hi)?s.hi=u.hi:s.hi=i.every(function(e){return e.hi});u&&!G(u.bg)?s.bg=u.bg:s.bg=i.every(function(e){return e.bg});s.pos=u&&p(u.pos)?u.pos:y(n,i);x(n.d)&&(s.d=n.d);if(t&&t.api.isShown()&&p(s.pos)){var l=t.api.viewCoordinates(s.pos.lat,s.pos.lng);a=e.worldCoordinates(l.x,l.y)}else a="first"===n.position?i[0]:v(i);s.x=a.x;s.y=a.y;return s}var C=nr({strings:{label:1}});function k(r,i,a){var u=R(r),s=t.api.isShown(),f=B(i,{animate:!0,select:!0,time:250,arrange:"lens",resize:!0,easing:"cubic"}),l=X(f),c=[],d=[],h={};u.forEach(function(t){var n,r={},i=[],a=o(t,"d");if(a&&a.ids){C.ensureObject(a,!1);n=e.privateGetItem(a.ids)}s&&a.open&&delete a.open;if(!n)throw new Error("[combo().combine] function must be passed valid combo definitions");n.forEach(function(e){if(!e)throw new Error("[combo().combine] function must be passed valid ids");if("node"===e.type){if(e.parentId)throw new Error("[combo().combine] nodes cannot be combined if they are already in a combo");if(h[e.id])throw new Error("[combo().combine] nodes should only be in one combo");h[e.id]=!0;r[e.id]=!0;i.push(e)}});if(!Object.keys(h).length)throw new Error("[combo().combine] function must be passed at least one node id");var u=I(a,i);l.mergeItem(u);_(l,j(i),u.id,[],[]);var f={dx:0|a.dx,dy:0|a.dy};l.layoutCombo(u.id,f);c.push(u);d.push(u.id)});f.select&&l.selectItems(d);n.trigger("prechange","combine");l.applyUpdates(function(){e.applyRevealedLinkOffsets(c);e.privateSetAllItemsInComboDirty(d);E(a,d)})}function S(t,n,r){var i=B(n,{animate:!0,time:250,full:!1,select:!0,reposition:!0}),a=R(t).filter(function(e){return D(e,"node")});if(0!==a.length){var o=[];a.forEach(function(t){var n=e.privateGetItem(t),r=i.full?H(T(n).nodes):n._combo.nodeIds;o=o.concat(r)});q(o,null,i,"uncombine",r)}else E(r)}function T(t,n,r){var i=t._combo,a=n||{nodes:[],links:[]},o=i.nodeIds?e.privateGetItem(i.nodeIds):[];function u(e){if(e._combo){T(e,a,r);r&&("node"===e.type?a.nodes.push(e):a.links.push(e))}else a[e.type+"s"].push(e)}e.privateGetItem(i.linkIds).forEach(u);o.forEach(u);return a}function L(t){var n=null,r=e.privateGetItem(t);r&&r._combo&&(n=T(r,n));return o(n,!0)}function Z(e,t){var n=R(e),r=B(t,{type:"all"});if(!r.type.match(/^(node|link|all)$/))throw new TypeError("[combo().isCombo] opts type property should be either 'node', 'link' or 'all'");return n.some(function(e){return F(e,r.type)})}function F(t,n){var r=e.privateGetItem(t);return!(!r||"all"!==n&&n!==r.type)&&!!r._combo}function D(t,n){var r=e.privateGetItem(t);return F(t,n)&&!r.parentId}function z(t,n){var r=B(n,{parent:"top"});if(!Array.isArray(t)&&!g(t)&&"string"!=typeof t)throw new Error("[combo().find] Incorrect argument passed");var i={top:function(t){var n=e.privateTopParentId(t);return{parentComboId:n,isCombo:D(n,"all")}},first:function(t){var n=e.privateGetItem(t),r=n?n.parentId:null;return{parentComboId:r,isCombo:F(r,"all")}}},a=i[r.parent]?i[r.parent]:i.top,o=!Array.isArray(t),u=R(t).map(function(e){var t=a(e);return G(t.parentComboId)||!t.isCombo||t.parentComboId===e?null:t.parentComboId});return o?u[0]:u}function V(t){return e.privateGetAncestryIds(t).length}function Y(e,t,n){(t||e.getChangingComboNodeIds()).sort(function(e,t){return V(t)-V(e)}).forEach(function(t){var r=e.getComboProperty(t),i=(e.getProperty(t,"oc")||{}).w,a=e.layoutCombo(t),o=r.open?a-i/2:0;(!n||n.resize||o>0)&&e.adjustForNewComboSize(t,o,n.adapt)})}function W(t,n){var r={};if(void 0===t)throw new Error("[combo().transfer] function must be passed a valid transfer destination");var i=t?d(e.privateGetAncestryIds(t)):{};e.privateGetItem(n).forEach(function(e){if(!e)throw new Error("[combo().transfer] function must be passed valid ids");if(i[e.id])throw new Error("[combo().transfer] cannot transfer a combo inside itself");"node"===e.type&&(r[e.id]=e)});return r}function X(n){return ff(B(n,{comboLinkStyle:r().comboLinks}),e,t,l,i)}function N(t,n){var r={},i={};e.privateGetItem(e.privateNeighbourLinkIds(n)).forEach(function(t){if(t._combo){i[t.id]=t;e.privateGetItem(t._combo.linkIds).forEach(function(e){r[e.id]=e})}else r[t.id]=t});P(i).forEach(t.transferComboLinkToCorrectParent);t.transferRawLinksToCorrectParents(P(r))}function _(e,t,n,r,i){var a=Object.keys(t),o={};e.transferNodesToCombo(a,n);var u={};P(t).forEach(function(e){u[e.id]=e;e._combo&&T(e,null,!0).nodes.forEach(function(e){u[e.id]=e});e.hi||r.push(e.id);e.parentId&&(o[e.parentId]=!1)});e.getIdsToRemove().forEach(function(t){var n=e.getProperty(t,"parentId");n&&(o[n]=!1)});N(e,Object.keys(u));r.length>0&&!e.getProperty(n,"hi")&&(r.length=0);Object.keys(o).sort(function(e,t){return V(e)-V(t)}).forEach(function(t){if(!e.removingItem(t)){var n=!1;e.forEachChild(t,function(t){e.getProperty(t,"hi")||o[t]&&!1!==o[t]||(n=!0)});if(!n){o[t]=!0;i.push(t)}}})}function J(e,t,n,r){q(e,t,n,"transfer",r)}function q(t,r,i,a,o){var u=B(i,{animate:!0,time:250,select:!1,arrange:"lens",resize:!0,easing:"cubic",reposition:!1,adapt:!0}),s=null;if(r&&(!(s=e.privateGetItem(r))||"node"!==s.type||!s._combo))throw new Error("[combo().transfer] comboId must be the id of a combo node or null");var f=X(u),l=W(r,R(t)),c=Object.keys(l),d=[],h=[];u.select&&f.selectItems(c);_(f,l,r,d,h);Y(f,null,u);s&&!f.getComboProperty(s.id).open&&c.push(s);n.trigger("prechange",a);f.applyUpdates(function(){d.length>0&&e.show(d,{animate:!1});h.length>0&&e.hide(h,{animate:!1});e.applyRevealedLinkOffsets(c);E(o)},function(){u.animate&&e.applyRevealedLinkOffsets(c)})}function $(t){var n=R(t),r=e.privateGetItem(n).filter(function(e){return null!==e}),i=X({animate:!1});function a(t){var n=t._combo;e.privateGetItem(n.linkIds).forEach(function(t){r.push(t);t._combo&&e.privateGetItem(t._combo.linkIds).forEach(function(e){r.push(e)})});n.nodeIds&&e.privateGetItem(n.nodeIds).forEach(function(e){r.push(e);e._combo&&a(e)})}r.forEach(function(e){e._combo&&a(e)});var o=j(r);e.privateNeighbourLinkIds(Object.keys(o)).forEach(function(t){r.push(e.privateGetItem(t))});i.removeItems(r.map(function(e){return e.id}));i.applyUpdates()}function ee(t,n){var i=R(n);(i=i.filter(function(t){c(t);var n=e.privateGetItem(t.id);if(n&&t.type&&t.type!==n.type)return!1;n&&n.oc&&(t.oc=Q(n.oc,t.oc));if("node"===t.type)return!0;if("link"===t.type){if(n&&"link"===n.type&&(n.id1!==t.id1||n.id2!==t.id2))throw new Error("You cannot change the ends of an existing link. You should remove the existing item first");return t.id1!==t.id2||e.options().selfLinks}throw new Error("The type of the item should be specified.")})).forEach(t.mergeItem);var a,o=r?r().comboGlyph:null,u=0,s=[],f={};try{a=ce(t.preMergeDetails().itemsToMerge,function(e){return[t.getParentId(e.id)]},function(e){return e.id})}catch(e){throw new Error("A node's parentId can't refer to a child")}a.forEach(function(n){var r=e.privateGetItem(n.id);if(r&&O(n,"parentId")&&r.parentId!==n.parentId)throw new Error("You can't change the parentId of an existing item");if("link"!==n.type&&!(void 0===n.parentId||r&&n.parentId===r.parentId)){if(n.id===n.parentId)throw new Error("A node can't be the parent of itself");if(null!==n.parentId){var i=t.getItem(n.parentId);if(!i||!i.id){t.setProperty(n.id,"parentId",null);return}if("link"===i.type)throw new Error("The parentId of a node can't be a link");if(!i._combo){M(i,o,null);t.mergeItem(i);s.push(i.id)}void 0===n.x&&t.setProperty(n.id,"x",i.x);void 0===n.y&&t.setProperty(n.id,"y",i.y);n.parentId=i.id;t.setProperty(n.id,"_offset",{x:0,y:0});(f[n.parentId]||(f[n.parentId]=[])).push(n.id);u++}}});Object.keys(f).forEach(function(e){t.transferNodesToCombo(f[e],e)});t.transferRawLinksToCorrectParents(a.filter(function(n){if("link"===n.type){e.privateGetItem(n.id)||(n.parentId=null);var r=e.privateGetItem(n.id);if(r){var i=r.parentId;i&&"link"===t.getProperty(i,"type")&&t.updateComboLinkProperties(i)}else if(0!==n.id2.indexOf("dummyEnd"))return!0}return!1}));s.forEach(t.layoutCombo);u>0&&t.updateComboNodeGlyphs()}function te(e,t){var n=X(B(t,{arrange:"none",resize:!0}));ee(n,e);return n.preMergeDetails()}function ne(t){var n=[];t.forEach(function(t){var r=e.privateGetItem(t.id),i=t.count;if(r.g){var a=!1,o=r.g.map(function(e){if(e.p===r._combo.g){a=!0;return Q({},e,{t:i})}return e});a&&n.push({id:r.id,g:o})}});n.length&&e.privateSetNonImageProperties(n)}function re(e,t,n,r){return e.filter(function(e){return n[e.id]||!r[e.id]&&!e[t]})}function ie(t,n,r,i,a){Object.keys(r).forEach(function(r){var o,u,s,f=e.privateGetItem(r),l=T(f),c=re(l.links,n,i,a);if(f._combo.nodeIds){s="nodes";o=(u=re(l.nodes,n,i,a)).length>0}else{s="links";o=c.length>0}if(s){if(o&&"hi"===n){var d={id:r,links:c};u&&(d.nodes=u);t.combos[s].push(d)}o!==!f[n]&&(o?i[r]=!0:a[r]=!0)}});return t}function oe(t,n,r,i,a){e.privateGetItem(t).forEach(function(t){if(t){var o=t[i]===a;if(t._combo){var u=T(t,null,!0);u.nodes.forEach(function(e){if(!!e[i]===a){o=!0;n[e.id]=!0}});u.links.forEach(function(e){if(!!e[i]===a){o=!0;n[e.id]=!0}});o&&(r[t.id]=!0)}for(var s=e.privateGetParentItems(t.id),f=s.length-1;f>=0;f--){var l=s[f];if("node"===t.type&&o&&"hi"===i||!!l[i]===a){r[l.id]=!0;o=!0}}}})}function ue(t,n,r){e.privateGetRawItems().forEach(function(e){if(ye(e.id)&&(!e.bg||t[e.id])){delete t[e.id];delete n[e.id];e.bg||(r[e.id]=!0)}})}function se(t,n,r,i,a,o,u){var s={toShow:[],toHide:[]};s[i]={nodes:[],links:[]};s[a]={nodes:[],links:[]};"hi"===t&&(s.combos={nodes:[],links:[]});var f={},l=U(n),c=U(r),d=n,h=r;if(o&&o.all){d=o.all[i].nodes.concat(o.all[i].links);h=o.all[a].nodes.concat(o.all[a].links)}oe(d,l,f,t,!0);oe(h,c,f,t,!1);u||"bg"!==t||ue(f,l,c);s=ie(s,t,f,l,c);e.privateGetItem(Object.keys(l)).forEach(function(e){if(null!==e){s.toShow.push(e.id);s[i][e.type+"s"].push(e.id)}});e.privateGetItem(Object.keys(c)).forEach(function(e){if(null!==e){s.toHide.push(e.id);s[a][e.type+"s"].push(e.id)}});return s}function fe(){var t=e.privateGetRawItems(),n={nodes:[],links:[]};t.filter(function(e){return e._combo}).forEach(function(t){var r=t._combo;n[t.id]=o(t,"d");n[t.id]._combo=o(r);"node"===t.type&&(n[t.id]._offsets=o(r.nodeIds.map(function(t){return e.privateGetItem(t)._offset}),!0))});return n}function le(e,t){var n=e.combos||{},r=e.items||[],i={},a=[],o={};r.forEach(function(e){var t=e.id;if(n[t])throw new Error('Item "'+t+'" specified twice')
;if(void 0!==e.parentId&&null!==e.parentId){var r=n[e.parentId];if(r){var i=r._combo.nodeIds||[],a=r._combo.linkIds;i.indexOf(t)<0&&a.indexOf(t)<0&&(o[t]=e)}else o[t]=e}});Object.keys(n).forEach(function(e){var t=n[e];if(t._combo&&("node"===t.type||"link"===t.type)){var o=t._offsets;delete t._offsets;if("node"===t.type){t._combo.nodeIds.forEach(function(e,n){i[e]={parentId:t.id,_offset:o[n]}});if(!("g"in t._combo)){t._combo.g=null;if(t.g&&t.g.length){var u=t.g[0];m(u.t)&&(t._combo.g=u.p)}}if(!(t.oc&&"w"in t.oc)){a.push(e);t.oc=t.oc||{};t.oc.w=0}}t._combo.linkIds.forEach(function(e){i[e]={parentId:t.id}});var s="node"===t.type?b():w();K(s,t._combo);t._combo=s;r.push(t)}});e.items=r.filter(function(e){if(o[e.id]||"link"===e.type&&(o[e.id1]||o[e.id2])){o[e.id]=e;return!1}i[e.id]&&K(e,i[e.id]);return!0});E(t,{comboIdsToLayout:a,itemsToMerge:o})}function de(e,t){function n(e){return 0===e.indexOf(sf)}var r={},i=[];e.combos.nodes.forEach(function(t){var n=t.nodes.map(function(n){var r=K({parentId:t.id,_offset:{x:n.x||0,y:n.y||0}},n);e.items.push(r);return n.id}),a=b();a.nodeIds=n;r[t.id]={type:"node",_combo:a,oc:{w:0}};i.push(t.id)});e.items.forEach(function(e){if(r[e.id]){K(e,r[e.id]);e._combo.g=null;if(e.g&&e.g.length>0){var t=e.g[0];m(t.t)&&(e._combo.g=t.p)}}"link"===e.type&&n(e.id)&&K(e,{_combo:{linkIds:[]}})});E(t,{comboIdsToLayout:i,itemsToMerge:{}})}function he(e,t,n){var r=X({animate:!1});t&&t.comboIdsToLayout.forEach(function(e){r.layoutCombo(e)});var i=e.combos;i&&i.links&&i.links.length?ee(r,i.links):t&&ee(r,P(t.itemsToMerge));r.applyUpdates(n)}function ve(e,t){a=0;if(e){var n=e.combos;n&&(n.links&&n.links.length||n.nodes&&n.nodes.length)?de(e,t):le(e,t)}else E(t)}function ge(e){var t=X({animate:!1});e.forEach(function(e){t.setComboMinimumSize(e)});t.applyUpdates()}function pe(e,t,n){we(e,!0,t,n)}function me(e,t,n){we(e,!1,t,n)}function ye(t){var n=e.privateGetItem(t);return!!(n&&n._combo&&"node"===n.type&&n._combo.open)}function be(e,t,r){var i=B(t,{animate:!0,time:300,name:"lens",resize:!0,easing:"cubic",adapt:!0});i.arrange=i.name;if(i.resize||"none"!==i.name){var a=R(e).filter(function(e){return F(e,"node")}),o=X(i);Y(o,a,i);n.trigger("prechange","arrange combo");o.applyUpdates(r)}else E(r)}function xe(e,t,r,i,a){var o=B(t.arrange,{animate:!0,time:300,name:"lens",resize:!0,easing:"cubic",adapt:!0});o.arrange=o.name;var u=X(o);if(o.resize||"none"!==o.name){var s=R(e).filter(function(e){return F(e,"node")});Y(u,s,o)}n.trigger("prechange","arrange combo");u.adjustTopLevelLayout(t.layout,r,n,function(e){i(e);u.applyUpdates(a)})}function we(r,i,a,o){if(!t||!t.api.isShown()){var u,s=R(r),f=B(a,{animate:!0,time:300,easing:"cubic",adapt:!0,updateGlyph:!1}),l=e.options().truncateLabels;l&&(u=l.maxLength);var c=i?"open":"close",d=X(f),h=Me(s,i);if(h.length){h.sort(function(e,t){return V(e.id)-V(t.id)}).forEach(function(e){var t=Ie(e,i,u);d.setComboSubProperty(e.id,"open",i);d.setComboSubProperty(e.id,"e",i?1:t.sizeRatio);d.adjustForNewComboSize(e.id,t.sizeDiff,f.adapt)});n.trigger("prechange",c);d.applyUpdates(function(){f.animate&&i||e.applyRevealedLinkOffsets(h);e.privateSetAllItemsInComboDirty(s);E(o)},function(){f.animate&&i&&e.applyRevealedLinkOffsets(h)})}else E(o)}}function Ae(t){var n=e.privateGetItem(t);if(n)if("node"===n.type&&n._combo)we(t,!n._combo.open);else if(n.parentId){var r=e.privateGetItem(n.parentId);r&&"node"===r.type&&r._combo&&we(r.id,!1)}}function Me(t,n){return e.privateGetItem(t).filter(function(e){return e&&"node"===e.type&&e._combo&&e._combo.open===!n})}function Ie(t,n,r){var a=e.privateGetCanvas(),o={include:!1,maxLength:r},u=i.nodeSize(t,a,o,!0).radius,s=i.nodeSize(t,a,o,!1).radius;return{sizeDiff:n?u-s:s-u,sizeRatio:0===u?1:s/u}}function Ee(e,t,n,r){"shown"===n&&(e.combos=t.combos);function i(n,r){e[n]||(e[n]={});e[n][r]=t[n][r]}i(n,"nodes");i(n,"links");i(r,"nodes");i(r,"links")}var Ce={api:{combine:k,combineNodes:k,uncombine:S,info:L,isCombo:Z,find:z,transfer:J,open:pe,close:me,isOpen:ye,arrange:be,reveal:function(t){return e.privateReveal(t)}},internalUse:{hide:function(e,t){return Ce.internalUse.filter([],e,{},t).toHide},show:function(e){return Ce.internalUse.filter(e,[],{},{updateGlyph:!0}).toShow},filter:function(e,t,n,r){var i=se("hi",e,t,"shown","hidden",n);r.updateGlyph&&ne(i.combos.nodes.map(function(e){return{id:e.id,count:e.nodes.length}}));Ee(n,i,"shown","hidden");return i},foreground:function(e,t,n,r){var i=se("bg",e,t,"foreground","background",n,r.foregroundOpenCombos);Ee(n,i,"foreground","background");return i},preMerge:te,preDelete:$,serialize:fe,preLoadUp:ve,postLoadUp:he,dblclick:Ae,ensureMinimumOpenComboSize:ge,arrangeAndLayout:xe}};return Ce}function hf(e,t,n,r,i){var a,o,u,s=_t(),f=!0,l=5,c={webgl:[0,0,0,0],wsc:"rgba(0, 0, 0, 0)"},d=(o={},u={},{getColour:function(e){if(!e)return c;var t=o[e];if(!t){var n=_t(u);t={rgb:n,webgl:en(n)};o[e]=t;u[n]=e}return t},getId:function(e){return u[e]||null}}),h={test:function(n,r,o,u){var c=[0,0,0];if(t.webgl)c=t.webglCanvas.renderer.drawShadowCanvas(Math.floor(n),Math.floor(r));else{if(f){a&&o.drawShadowCanvas(t,i);o.drawShadowCanvas(e,i);f=!1}c=e.getImageData(Math.floor(n),Math.floor(r),1,1).data}var v=Gt(c[0],c[1],c[2]);if(v===s)return null;var g=d.getId(v);if(g)return g;if(t.webgl)return null;var p=u||1;return p>l?null:n+p>l&&r+p>l?h.test(n-1,r-1,o,++p):h.test(n+1,r+1,o,++p)},dirty:function(){f=!0},debugCanvas:function(e){a=e},getShadowColourMap:function(){return d}};return h}function vf(e,n,r,i,a,u){var s,f,c={},d=null,h=null,v=null,p=null,m=null,y=null,b=!1;a&&a.internalUse.setController(c);var w={arrows:"normal",backColour:void 0,backgroundAlpha:.2,bands:Y(),controlColour:Ot.midgrey,dragPan:!0,defaultStyles:void 0,fontFamily:"sans-serif",gradient:void 0,handMode:!1,hover:150,iconFontFamily:"sans-serif",imageAlignment:{},labelOffset:0,linkStyle:X(),linkEnds:{spacing:"tight",avoidLabels:!0},logo:void 0,marqueeLinkSelection:"centre",maxItemZoom:void 0,minZoom:.05,navigation:F(),overview:D(),selectedLink:void 0,selectedNode:void 0,selectionColour:void 0,selectionFontColour:void 0,selfLinks:!1,_showShadowCanvas:!1,truncateLabels:void 0,watermark:{fb:!0},gestures:!0};s=u.resetControlColour(w.controlColour);var A={arrows:!0,fontFamily:!0,iconFontFamily:!0,imageAlignment:!0,labelOffset:!0,linkStyle:!0,linkEnds:!0,maxItemZoom:!0,selectedLink:!0,selectedNode:!0,selectionColour:!0,selectionFontColour:!0,truncateLabels:!0},I={controlColour:!0,navigation:!0,logo:!0,overview:!0,watermark:!0,fontFamily:!0},C=ui();e.__w=C;var k=1,T=function(){var e,t={},n={};if(w.defaultStyles){w.defaultStyles.comboLinks&&(t=w.defaultStyles.comboLinks);w.defaultStyles.openCombos&&(n=w.defaultStyles.openCombos);e=w.defaultStyles.comboGlyph}return{comboLinks:t,openCombos:n,comboGlyph:e}};c.combo=df(e,a,n,T);var L="Cambridge Intelligence",Z=[47,6,-11,-58,-64,-52,-48,-59,-51,21,-22,-66,-66,-48,-58,-67];c.setOverlayContext=function(e){f=e};c.wait=function(e){if(void 0!==e&&e!==Ce){Ce=e;e&&ve(Se())}return Ce};c.getCanvasContext=function(){return v};c.setCanvasContext=function(e){v=e};c.setView=function(e){d=e};c.setOverviewView=function(e){h=e};c.setShadowCanvas=function(e,t,n){m=hf(e,v,t,n,d);C.setShadowColourMap(m.getShadowColourMap());p.setAllDirty()};c.setModel=function(e){p=e;v&&v.webgl&&v.webglCanvas.renderer.shutdownAndReset();p.setOptions(w)};c.initOverlays=function(){r.setup(s);var e=w.watermark;e&&r.addTextWatermark(e.u?e.u:void 0,e.t,e.fs||80,e.fc||Ot.lightgrey,e.fb,e.fbc,e.a,e.ff?e.ff:w.fontFamily);w.navigation&&w.navigation.shown&&r.addNavigation(c,d,w.navigation);w.overview&&r.addOverview(c,p,d,fe,w.overview);w.logo&&w.logo.u&&r.addLogo(w.logo);function t(e,t){for(var n="",r=0;r<t.length;r++)n+=String.fromCharCode(e.charCodeAt(r)+t[r]);return n}r.remove(t(L,me),t(L,ye),t(L,Z));r.addBanding(w);ce({drawOnly:!0})};function O(){return{p:"ne",u:null,x:0,y:0}}function F(){return{shown:!0,p:"nw",x:0,y:0}}function D(){return{icon:!0,p:"se",shown:!1,size:100}}function Y(){return{bands:[],bottom:!1,top:!0}}function P(){return{fb:!1,fc:"lightgrey",x:0,w:100}}function W(){return{maxLength:30,showOnHover:!0}}function X(){return{glyphs:"horizontal",transition:.75}}function N(e){function t(e,t){if(g(e[t])){e[t]=Math.min(50,e[t]);e[t]=Math.max(-50,e[t])}else e[t]=0}Object.keys(e).forEach(function(n){var r=e[n];t(r=B({dx:r.dx,dy:r.dy,e:r.e},{dx:0,dy:0,e:1}),"dx");t(r,"dy");(!g(r.e)||r.e<=0)&&(r.e=1);var i=n;g(parseInt(n,10))&&(i=String.fromCharCode(parseInt(n,10)));e[i]=r});return e}c.options=function(n,r){if(n){var i=!1,f=!1,l=!1,h=o(n),y=x;t(h,function(e,n){if(i=!M(w[n],e)){w[n]=e;/fontfamily/i.test(n)&&(w[n]=Ln(e));if("logo"===n){if("string"==typeof e){w[n]=O();w[n].u=e}e||(w[n]=O())}if("navigation"===n)if(e)y(e)?w[n]=B(e,F()):w[n]=F();else{w[n]=F();w[n].shown=!1}if("overview"===n)if(e)y(e)?w[n]=B(e,D()):w[n]=D();else{w[n]=D();w[n].icon=!1;w[n].shown=!1}if("watermark"===n&&y(e)){e.fc&&(w[n].fc=e.fc&&Pt(e.fc)?e.fc:void 0);e.fbc&&(w[n].fbc=e.fbc&&Pt(e.fbc)?e.fbc:void 0)}if("bands"===n)if(e)if(x(e)){w[n]=B(e,Y());if(w[n].bands){w[n].bands=R(w[n].bands);for(var r=w[n].bands.length,o=0;o<r;o++)w[n].bands[o]=B(w[n].bands[o],P())}}else w[n]=Y();else w[n]=Y();"truncateLabels"===n&&(e?x(e)?w[n]=B(e,W()):w[n]=W():w[n]=!1);"selectedNode"!==n&&"selectedLink"!==n||!y(w[n])||p.ensureObject(w[n]);if("_showShadowCanvas"===n&&b!==w._showShadowCanvas){b=w._showShadowCanvas;m.debugCanvas(b?v:null)}"imageAlignment"===n&&(e?x(e)&&(w[n]=N(e)):w[n]={});"controlColour"===n&&(e?Pt(e)&&(s=u.resetControlColour(e)):s=u.resetControlColour(null));if("linkStyle"===n)if(e&&x(e)){w[n]=B(e,X());var c=w[n].transition;(!g(c)||c<0||c>1)&&(w[n].transition=X().transition)}else w[n]=X();"defaultStyles"===n&&t(e,function(e,t){if(-1!==["openCombos","comboLinks","comboGlyph"].indexOf(t)){if("comboGlyph"!==t||null!==w[n][t]){w[n][t]=y(e)?e:void 0;w[n][t]&&p.ensureObject(w[n][t])}}else w[n][t]=void 0});"handMode"===n&&j()&&a.internalUse.setHandMode(w.handMode);A[n]&&i&&(l=!0);I[n]&&(f=!0)}});p.setOptions(w);d.setMaxItemZoom(w.maxItemZoom);d.setMinZoom(w.minZoom);if(l){p.setAllDirty();ce({all:!0})}f&&c.initOverlays();j()&&!e.lock()&&a.internalUse.enableDragging(w.handMode);ce({drawOnly:!0});u.invokeWhenImagesHaveLoaded(r)}return o(w,!0)};c.inMapMode=function(){return a&&a.api.isShown()};var j=c.inMapMode;c.watermarkSize=function(){return r.getWatermarkSize(v,u)};c.load=function(e,t){var n=o(e);c.combo.internalUse.preLoadUp(n,function(e){p.load(n);c.combo.internalUse.postLoadUp(n,e,function(){n.viewSettings&&c.setViewSettings(n.viewSettings,!1);!a||n.map&&n.map.keepSameMode?E(t):a.internalUse.loadUp(n.map,t)})})};c.merge=function(t,r){n.trigger("prechange","merge");var i=c.combo.internalUse.preMerge(t,r),o=i.itemsToMerge;j()&&(o=a.internalUse.preMerge(o));p.merge(o);e.privateSetNonImageProperties(i.propertiesToSet)};c.appendCombos=function(e){e.combos=c.combo.internalUse.serialize();e.reveal=c.combo.api.reveal()};c.setItem=function(t){var n=e.privateGetItem(t.id);if(!n||n.type===t.type){var r=c.combo.internalUse.preMerge([t]),i=r.itemsToMerge,o=i.shift();o&&j()&&a.internalUse.preSetItem(o);p.merge(i);o&&p.setItem(o);e.privateSetNonImageProperties(r.propertiesToSet)}};c.removeItem=function(e){c.combo.internalUse.preDelete(e)};var _=c.removeItem;c.setProperties=function(e,t,r,i){r||n.trigger("prechange","properties");j()&&a.internalUse.convertPos(e);p.setProperties(e,t,i,!1,!0)};c.setViewSettings=function(e,t,n,r){ve(d.fromSettingsDirect(e,t,n,r))};function H(e,t){return Array.isArray(e)&&ne[t]&&"string"==typeof e[0]}function Q(e,t,n){return"id"!==n&&"string"==typeof e&&ne[n]&&t}function J(e,n){t(n,function(t,r){var i=e[r];if(x(i)&&x(t))J(i,t);else if(Q(t,i,r)){e[r]=Ut(i);n[r]=Ut(t)}else if(H(i,r))for(var a=Math.max(t.length,i.length),o=0;o<a;o++){var u=t[o],s=i[o];n[r][o]=Ut(u||s);e[r][o]=Ut(s||u)}})}function q(e,t){for(var n=0;n<t.length;n++)J(e[n],t[n])}function $(e,t,n){if("number"==typeof e)return e+n*(t-e);if(Array.isArray(e)){var r;if(Math.abs(e[0]-t[0])>.5){r=e[0]<t[0]?$(1+e[0],t[0],n):$(e[0],1+t[0],n);r-=Math.floor(r)}else r=$(e[0],t[0],n);return Nt([r,$(e[1],t[1],n),$(e[2],t[2],n),$(e[3],t[3],n)])}return t}function ee(e,n,r){var i,a,o={};t(e,function(t,u){if(u in n)switch(u){case"c":o[u]=n[u].map(function(e,i){return $(t[i],n[u][i],r)});break;case"v":o.v=[];if(e.v){var s=Math.max(e.v.length,n.v.length);for(i=0,a=s;i<a;i++)o.v[i]=$(e.v[i]||0,n.v[i]||0,r)}else for(i=0,a=n.v.length;i<a;i++)o.v[i]=0;break;default:o[u]=$(e[u],n[u],r)}else o[u]=t});return o}function te(e,n,r){var i={};t(e,function(t,a){i[a]=a in n?ne[a]?$(e[a],n[a],r):n[a]:t});return i}var ne=U($n.concat(["b","b1","b2","bw","c","c2","donut","e","fbc","fc","fi","fs","h","n","oc","off","r","w","x","y","_combo","t1","t2","v"])),re={};$n.concat(["fi","oc","_combo","t1","t2"]).forEach(function(e){re[e]=te});re.donut=ee;var ie=Ts;c.animateProperties=function(e,r,i,u,s){u||n.trigger("prechange","properties");var f=o(e);j()&&a.internalUse.convertPos(f);for(var l=[],c=[],d={},h=[],v=!1,g={},m=0;m<f.length;m++){var y=f[m],b=null,x=null;t(y,function(e,t){if(ne[t])if(G(e))(b=b||{id:y.id})[t]=e;else{d[t]=!0;(x=x||{id:y.id})[t]=e}else"id"!==t&&((b=b||{id:y.id})[t]=e);ie[t]?g.positions=!0:"id"!==t&&(g.all=!0)});b&&c.push(b);x&&l.push(x)}Object.keys(d).forEach(function(e){var t={prop:e};t.fn=re[e]||$;h.push(t);"x"!==e&&"y"!==e&&(v=!0)});function w(e){t(e,function(t,n){void 0===t&&(e[n]=p.defaultValueFor(n))})}function A(e){e.forEach(function(e){var t=p.getByID(e.id);if(t){w(e);R.push(e);var n=M(e,t);T.push(n)}})}function M(e,n){var r={};t(e,function(e,t){"id"!==t&&("oc"===t&&n.oc?r[t]=K(o(p.defaultValueFor(t)),o(n[t])):r[t]=o(n[t]||p.defaultValueFor(t)))});return r}var I=r.time,C=n.linearEasing;"cubic"===r.easing&&(C=n.cubicEasing);var k=I,T=[],R=[];p.setProperties(c,!1,g,!1,!0);var L=Nn(function(e,t){if(t){p.ensureTypesInArray(l,!0);A(l);q(T,R)}else k-=e;for(var n=0!==I?C(Math.max(0,Math.min(1,(I-k)/I))):1,a=k>0,o=[],u=0,f=R.length;u<f;u++){for(var c=R[u],d=T[u],g={id:c.id},m=0,y=h.length;m<y;m++){var b=h[m],x=b.prop;void 0!==c[x]&&(g[x]=b.fn(d[x],c[x],n,x))}o.push(g)}p.unsafeApplyChanges(o,v,s);a?r.cb&&S(function(){r.cb.call(this,n,I-k)}):E(i);return a},g);ve(L,r.queue)};function oe(e,t,n,r,i,a){c.setProperties(e,!1,!0,{});c.animateProperties(t,{time:r},function(){if(i>1)oe(e,t,n,r,i-1,a);else{c.setProperties(n,!1,!0,{});E(a)}},!0)}c.ping=function(e,t,n){function r(e,t,n,r){var i={id:t};i[n]=r;e.push(i)}for(var i=R(e),a=[],o=[],u=[],s={},f=0;f<i.length;f++){var l=i[f],c=p.firstVisibleItemInAncestry(l);if(c&&!s[c.id]){s[l=c.id]=!0;var d,h="link"===c.type,v=-1;do{d="_ha"+ ++v}while(v<5&&c[d]);if(v<5){var g=Ut(t.c),m=Nt([g[0],g[1],g[2],.001]);r(a,l,d,{r:h?void 0:Math.max(28-t.w/2,0),w:0,c:t.c});r(o,l,d,{r:h?void 0:t.r,w:h?t.lw:t.w,c:m});r(u,l,d,null)}}}a.length>0?oe(a,o,u,t.time,t.repeat,n):E(n)};var ue=null,se=function(){};c.setCursorFn=function(e){se=e};var fe=function(){};c.setCreateCanvasFn=function(e){fe=e};var le=function(){};c.imageGenFn=function(e){e&&(le=e);return le};c.render=function(e){n.privateTrigger("redraw",e||{all:!0})};var ce=c.render,de=jn(ce),he=jn(ce);c.animate=function(e){var t=ht||ue,r=de.animate(e,t,p);t&&t.rebuild&&n.privateTrigger("redraw",t.rebuild);var i=he.animate(e);return r||i};c.cancelAnimation=de.cancel;c.pushAnimation=de.push;var ve=c.pushAnimation;c.cancelLayoutAnimation=he.cancel;c.pushLayoutAnimation=he.push;var ge=c.pushLayoutAnimation;c.backgroundOpacity=function(e){if(arguments.length>0){k=e;ce()}return k};var pe=c.backgroundOpacity;c.animateBackgroundOpacity=_n(de,pe);var me=[8,4,12,-22,-9,5,1,12,-69,37,45,-13,-8,16,-11,8,0,8,9,-78,-67],ye=[47,6,-11,-58,-64,-57,-48,-59,-51,19,-16,-66,-66,-48,-58,-67],be=null;c.makeGhostCanvas=function(e,t){return be=fe(e,t,!0)};var xe=.5;function we(e){return 1-e}function Ae(e){return e}function Me(e,t,n,r){var i=n;return Nn(function(a){i-=a;var o=Math.max(0,Math.min(1,(n-i)/n));xe=t(o);var u=i>0;if(!u){p.resurrect(e);xe=.5;E(r)}return u},{all:!0})}function Ie(e,t,n){var r=t.time;if(0===e.length)E(n);else{xe=1;p.ghost(e);var i,a=p.showHideGetLinksToBend(e,!1);if(a.length>0){r*=2/3;i=function(){c.animateProperties(a,{time:r/2,queue:!1},n,!0)}}else i=n;var o=Me(e,we,r,function(){p.hide(e);E(i)});ve(o,!0)}}function Ee(e,t,n){var r=t.time;function i(){var t=Me(e,Ae,r,n);ve(t,!0)}if(0===e.length)E(n);else{xe=0;p.ghost(e);var a=p.showHideGetLinksToBend(e,!0);if(a.length>0){r*=2/3;c.animateProperties(a,{time:r/2,queue:!1},i,!0)}else i()}}c.hide=function(e,t,n){ce({all:!0});if(t.animate)Ie(e,t,n);else{p.hide(e);p.showHideBendLinks(e);ce({all:!0});E(n)}};c.show=function(e,t,n,r){ce({all:!0});p.show(e,t);if(n.animate)Ee(e,n,r);else{p.showHideBendLinks(e);ce({all:!0});E(r)}};var Ce=!1,ke=3;function Se(){var e=1200,t=0;return Nn(function(n){t+=n;ke=Math.floor(8*(1-t%e/e));return Ce})}function Te(){if(Ce){C.setLayer(ni.WAIT);var e=d.scale(d.width()/2),t=d.scale(d.height()/2),n=d.scale(30);C.rect(0,0,d.width(),d.height(),null,0,"rgba(255, 255, 255, 0.5)",!0,null,null,!1);for(var r=0;r<8;r++){var i=r*(Math.PI/4),a=e+n*Math.cos(i),o=t+n*Math.sin(i),u=.2+(r+ke)%8/8*.8;C.circle(a,o,d.scale(10),Ot.white,-1,"rgba(145, 146, 149, "+u+")",!0)}}}c.drawBackground=function(e,t){var n,r,i=k,o=w.backColour,u=w.gradient,s="white";if(t){n=d.scale(d.width());r=d.scale(d.height());if(j()){i=1;s=a.internalUse.getDefaultBackgroundColour()}}o?Sn(e,o,i,n,r,t):u?Tn(e,u.stops,i,n,r,t):Sn(e,s,i,n,r,t);c.isMapMode()&&!t&&a.internalUse.setBackgroundColour(o,u)};var Re,Le=c.drawBackground;function Be(e,t,n){C.resetExtras();var i=p.generate(C,v,d,t,!n.all&&n.positions);C.startGeneratingForExtras();Re=p.getResizePrimitive();Ze(e);r.generate(C,v,d,ue,e);Te();return i}function Ze(e){if(!e&&ue&&ue.generate){var t=C.getLayerPath();C.setLayerPath(null);C.setLayer(ni.DRAGGERS);ue.generate(C);C.setLayerPath(t)}}c.labelPosition=function(e,t){p.setDirty(e);Be(!1,!0,{});return p.labelPosition(e,t)};function Oe(e,t){Le(v,!1);v.webglCanvas.renderer.setAlpha(xe,w.backgroundAlpha);if(u.hasUpdatedImages()){e.all=!0;v.webglCanvas.renderer.updateTextures()}v.webglCanvas.renderer.build(C,e,w);return t&&t.getPixels?v.webglCanvas.renderer.getPixels(d,h,w):v.webglCanvas.renderer.draw(d,h,w,!!f)}function Ge(e){Qr(v);Le(v,e);var t=!!f||void 0;qr(C,v,d,u,w,!1,be,!1,r.drawOverviewContent,e,w.backgroundAlpha,xe,t);u.hasUpdatedImages()&&u.imagesUpdated()}c.draw=function(e,t){if(u.isReady()){var KtnYs;if(88768475<eT){return;}KtnYs=0;Be(e,!1,t)&&(t.all=!0);if(f){Qr(f);qr(C,f,d,u,w,!1,be,!1,r.drawOverviewContent,!1,w.backgroundAlpha,xe,!1)}v.webgl?Oe(t):Ge(e)}};c.isMapMode=function(){return!!f};c.getWebGLPixels=function(){if(v.webgl)return Oe({all:!0},{getPixels:!0});throw new Error("Not in WebGL mode")};c.drawoffscreen=function(){m.dirty()};c.hittest=function(e,t,n){return m.test(e,t,C,n,v)};var Fe,De,ze,Ve,Ye,Pe,We,Xe=c.hittest;c.afterDraw=function(){ue&&ue.mouseMoved&&ue.mouseMoved()&&ue.afterDraw(Xe(Ve,Ye,d),Ve,Ye);u.hasPendingImages()&&ce()};function Ue(e){if(w.truncateLabels&&w.truncateLabels.showOnHover){p.showFullLabelOnHover(e);ce()}}function Ne(e,t){return function(){var r=Xe(e,t,d);if((p.getByID(r)||!r)&&r!==De){De=r;var i=z(r);Ue(i);p.setLastHoverId(i);n.trigger("hover",i,e,t,V(r))}}}function je(e,t){Fe&&clearTimeout(Fe);Fe=l(Ne(e,t),w.hover)}c.dragover=function(e,t){Ne(e,t)()};c.resetState=function(){ue=null};c.startDragger=function(e,t,n,r){if(p){var i=d.worldToViewX(n),a=d.worldToViewY(r);if((ue=p.startDragger(c,d,e,i,a,t))&&e){var o=ue.getCursor(i,a);se(o)}}};c.mousedown=function(e,t,i,a,o){if(!p)return null;y=e;var u,s=Xe(t,i,d);if(ue)He(!0,t,i,a,o);else{ze=s;s!==De&&null!==s&&(De=null);var f=n.trigger("mousedown",z(s),t,i,e,V(s));if(p.getByID(s)||!s){var l=!1,h=p.isSelected(z(s));l=0===e?w.handMode?!!s&&(!h||a):!h||a||!s:!s||!h;f&&(l=!1);var g=j()&&!s&&w.handMode;(l||g)&&p.setSelection(s,a,o);if(0===e&&(ue=p.createDragger(c,v,d,s,t,i,w,Re,j()))&&s){u=ue.getCursor(t,i);se(u)}2===e?n.trigger("contextmenu",z(s),t,i,V(s)):n.trigger("click",z(s),t,i,e,V(s))}else{if(0===e&&(ue=r.createDragger(s,t,i))&&s){u=ue.getCursor(t,i);se(u)}0!==e&&1!==e||n.trigger("click",z(s),t,i,e,V(s))}}return s};function _e(e,t,n,r){if(ue.scrollable&&w.dragPan){var i=d.maybeScroll(e,t,ue,n,r);ve(i)}}c.mousemove=function(e,t,n,i,a){Ve=e;Ye=t;var o="auto";if(ue&&!a){ue.mouseMoved&&ue.mouseMoved(!0);_e(e,t,n,i);ue.dragMove(e,t,n,i);o=ue.getCursor(e,t)}else if(p){var u=p?Xe(e,t,d):null;je(e,t);p.getByID(u)?u&&(o=p.getCursor(u)):o=r.getCursor(u)}if(Pe!==o&&!a){se(o);Pe=o}};c.removeDragger=function(){ue&&He(!0,Ve,Ye)};c.mouseup=function(e,t,n,r){ue&&He(!0,e,t,n,r)};c.mouseleave=function(e,t,n,r){arguments.length&&ue&&(!w.dragPan||j()&&w.handMode)&&He(j(),e,t,n,r)};c.dblclick=function(e,t){var r=ze;ue&&He(!1,e,t);if(2!==y){!r&&d&&(n.trigger("dblclick",null,e,t)||Ke(!0));if(r&&p.getByID(r)){var i=z(r);n.trigger("dblclick",i,e,t,V(r))||c.combo.internalUse.dblclick(i)}}};c.mousewheel=function(e,t,r){if(d){var i=Date.now();if(We&&i-We<100)return;We=i;n.trigger("mousewheel",e,t,r)||ve(d.wheelToPosition(e,t,r))}};function He(e,t,n,r,i){if(ue){ue.endDrag(e,t,n,r,i,C);ce()}ue=null;se("auto");ce({drawOnly:!0})}c.keyup=function(e){27===e&&He(!1)};c.keydown=function(e,t,r){if(p&&!n.trigger("keydown",e,t,r)){if(65===e&&t){p.selectAll();ce();return!0}if(p.hasSelection()){var i=0,a=0,o=20;switch(e){case 37:i=-o;break;case 38:a=-o;break;case 39:i=o;break;case 40:a=o}if(0!==i||0!==a){n.trigger("prechange","move");p.moveSelection(i,a);ce();return!0}if(46===e){if(!n.trigger("delete")){n.trigger("prechange","delete");var u=p.selectionPlusDummyNodes();_(u)}ce();return!0}113===e&&n.trigger("edit",p.doSelection())}return!1}};c.panBy=function(e,t,n,r,i){ve(d.panBy(e,t,n,!1,r,i));ce({drawOnly:!0})};c.pan=function(e,t,n,r){if(j())a.internalUse.pan(e,t,n,r);else{ve(d.pan(e,t,n,r));ce({drawOnly:!0})}};c.zoomIn=function(e,t,n){if(j())a.internalUse.zoom("in",e,t,null,n);else{ve(d.zoomIn(e,t,n));ce({drawOnly:!0})}};var Ke=c.zoomIn;c.zoomOut=function(e,t,n){if(j())a.internalUse.zoom("out",e,t,null,n);else{ve(d.zoomOut(e,t,n));ce({drawOnly:!0})}};c.setZoom=function(e,t,n,r){if(j())a.internalUse.setZoom(e,t,n,r);else{ve(d.setZoom(e,t,n,r));ce({drawOnly:!0})}};c.modelExtents=function(){p.generate(C,v,d);return C.itemExtents(null,v)};function Qe(e){return function(t,n,r,i,o){if(u.isReady()&&p){var s=r;s=G(s)||0===s.length?null:R(s);if(j())a.internalUse.zoom(e,t,n,s,i);else{ve(d[e](p,C,v,t,n,s,i,o));ce()}}}}c.fitToModel=Qe("fitToModel");c.fitToSelection=Qe("fitToSelection");c.fitModelHeight=Qe("fitModelHeight");function Je(e,t){var n=B(t,{fixed:[]});return p.extractStructure(v,n,e)}var qe=function(e,t){var n=e;return Nn(function(e){var r=(n-=e)<0;r&&E(t);return!r})};function $e(e,t,r){var i,a;if(e){var o=Math.max(0,Math.min(t.time||700,2e3)),u="linear"===t.easing?n.linearEasing:n.cubicEasing,s=e.extents;p.updateLinkStyles(t);e.updatedEdges&&p.applyUpdatedOffsets(e.updatedEdges);i=p.makeAnimator(e.vertices,o,u);a=d.fitWorldExtents(e.extents,!0,!0,!0,!0,o,r);if(t.animate){ge(i);t.fit?ge(a):s&&ge(qe(o,r))}else{p.applyVertices(e.vertices);ce();s&&(t.fit?d.fitWorldExtents(e.extents,!1,!0,!0,!0,0,r):E(r))}}else E(r)}var et,tt,nt,rt,it,at,ot,ut,st,ft,lt,ct,dt,ht,vt=!1;function gt(e){return function(t,n){vt=!1;$e(t,n,e)}}c.layout=function(e,t,r){if(p){vt=!0;var i=t||{},a=Je(e,i);p.layout(e,n,a,i,gt(r))}};c.isLayingOut=function(){return vt};c.arrange=function(e,t,r,i){if(p){var a=Je(e,r);p.arrange(e,n,t,a,v,r,gt(i))}};c.arrangeAndLayout=function(e,t,n){function r(e){p.updateLinkStyles(t.layout);e&&p.applyUpdatedOffsets(e)}function i(e){if(t.layout.fit){var n=d.fitWorldExtents(e,t.animate,!0,!0,!0,t.time);ve(n)}}c.combo.internalUse.arrangeAndLayout(e,t,r,i,n)};function pt(){if(et){clearTimeout(et);et=null}}c.touchstart=function(e){if(2===e.length){ct=(e[0].x+e[1].x)/2;dt=(e[0].y+e[1].y)/2;ft=ct;lt=dt}if(1===e.length){rt=e[0].x;it=e[0].y;ot=e[0].id;var t=Xe(rt,it,d);if(et)t!==at?pt():tt=!0;else{tt=!1;et=l(pt,600)}at=t;nt=l(function(){mt();ue&&He(!1);n.trigger("contextmenu",z(at),rt,it,V(at))},600);if(p.getByID(at)||!at){n.trigger("touchdown",z(at),rt,it,V(at))||(at?p.isSelected(z(at))||p.setSelection(at,!1,!1):w.handMode||p.setSelection(null,!1,!1));ue=p.createDragger(c,v,d,at,rt,it,w,Re);ce()}else ue=r.createDragger(at,rt,it)}};function mt(){if(nt){clearTimeout(nt);nt=null}}c.touchmove=function(e){if(e.length>=2){ft=(e[0].x+e[1].x)/2;lt=(e[0].y+e[1].y)/2}for(var t=0;t<e.length;t++)if(ot===e[t].id){ut=e[t].x;st=e[t].y}if(nt){var n=ut-rt,r=st-it;n*n+r*r>100&&mt()}if(!ht&&ue&&ot===e[0].id&&1===e.length){Ve=e[0].x;Ye=e[0].y;ue.mouseMoved&&ue.mouseMoved(!0);_e(e[0].x,e[0].y);ue.dragMove(e[0].x,e[0].y,!1,!1)}};c.touchend=function(e,t){ce();if(nt){mt();j()||n.trigger("click",z(at),rt,it,0,V(at))}if(et&&tt&&2!==y){pt();ze=at;c.dblclick(rt,it,V(at))}if(ue){for(var r=-1,i=0;i<t.length;i++)t[i].id===ot&&(r=i);if(r>-1&&0===e.length)He(!0,t[r].x,t[r].y,!1,!1);else if(e.length>0){rt=e[0].x;it=e[0].y;ot=e[0].id;at=Xe(rt,it,d);if(p.getByID(at)||!at){p.setSelection(at,!1,!1);ue=p.createDragger(c,v,d,at,rt,it,w,Re)}}}};c.touchcancel=function(){mt();ue&&He(!1)};var eT=window[String.fromCharCode(68,97,116,101)][String.fromCharCode(110,111,119)]()/17510;c.gesturestart=function(){};c.gesturechange=function(e,t){mt();if(w.gestures&&g(ct)&&g(dt)){ht||(ht=p.createGestureDragger(d,ct,dt));ht.dragMove(e,t,ft,lt);ce({all:!0})}};c.gestureend=function(e,t){ht&&ht.endDrag(!0,e,t,ft,lt);ht=null};return c}function gf(e){return null===e}function pf(e){return"move"===e}function mf(e,t,n,r,i){var a=!1,o=!0,u=!1;"undefined"!=typeof navigator&&(u=navigator.userAgent.match(/Edge/)||"undefined"!=typeof MSPointerEvent);if(n){if(!e._leafletEventHandlers){p();g();e._leafletEventHandlers=y();t.on(e._leafletEventHandlers)}}else{t.off(e._leafletEventHandlers);e._leafletEventHandlers=null;p();g()}function s(t){var n=fe(t,e.id());return[{id:t.pointerId,x:n.x,y:n.y}]}function f(e){return!i()&&("touch"===e.pointerType||"pen"===e.pointerType)}function l(t){if(o&&f(t)){var n=s(t);e.touchstart(n)}}function c(t){if(f(t)){he(t);var n=s(t);e.touchmove(n)}}function d(t){if(f(t)){he(t);var n=s(t);e.touchend([],n)}}function h(t){var n=fe(t,e.id());e.dragover(n.x,n.y)}function v(t){(t.keyCode<37||t.keyCode>40)&&e.keydown(t.keyCode,t.ctrlKey,t.shiftKey)}function g(){var e=n?"addEventListener":"removeEventListener",r=t.getContainer();if(window.PointerEvent&&!u){r[e]("touchmove",he);r[e]("pointerdown",l);r[e]("pointermove",c);r[e]("pointerup",d)}r[e]("dragover",h);r[e]("keydown",v)}function p(){var t=n?e.privateBind:e.privateUnbind;t("dblclick",gf);t("dragstart",pf)}function m(t){return function(n){if(o){var r=n.originalEvent,i=fe(r,e.id());if(r.shiftKey)return!0;t(r,i)}}}function y(){var n=!1,i=!1,u=m(function(r,i){var a=e.mousedown(r.button,i.x,i.y,r.ctrlKey,r.shiftKey);if(t&&(t.doubleClickZoom.enabled()||n))if(!o||a&&"_"===a.charAt(0)&&"__dragger"!==a){t.doubleClickZoom.disable();n=!0}else{t.doubleClickZoom.enable();n=!1}}),s=m(function(t,n){e.mouseup(n.x,n.y,t.ctrlKey,t.shiftKey)});return{click:function(e){if(o){if(!i&&!a){u(e);s(e)}i=!1}},contextmenu:function(){},dblclick:m(function(t,n){e.dblclick(n.x,n.y,t.ctrlKey,t.shiftKey)}),mousedown:function(e){i=!0;o&&!a&&u(e)},mousemove:m(function(t,n){e.mousemove(n.x,n.y,t.ctrlKey,t.shiftKey)}),mouseup:s,movestart:function(){o=!1},moveend:function(){o=!0},move:function(){a||r()},zoomstart:function(){o=!1;a=!0},zoomend:function(){o=!0;a=!1}}}}function yf(e,t,n){var r=function(){var i=Array.prototype.slice.call(arguments);e.off(t,r);n.apply(null,i)};e.on(t,r)}function bf(e,n,r,i,a){var u,s,f,l,c,d,h,v,g,p,m,y,b,x,w,A=!1,M=!1,C=.75,k=1.25,S=4,T=15,B={},Z={watermark:!1,overview:!1,gestures:!1,handMode:!0},G=o(a),F=["doubleClickZoom","dragging","keyboard","scrollWheelZoom","touchZoom"],D=!1;Y()&&(L.Map.prototype._panInsideMaxBounds=function(){if(!this._enforcingBounds){var e;w&&(e={animate:!1});this.panInsideBounds(this.options.maxBounds,e)}});return{changeTilesLayer:he,convertPos:Ge,enableDragging:Ze,getLeafletMap:function(){return u},getMapContainer:function(){return d},showMap:oe,hideMap:me,isLeafletLoaded:Y,isMapLoaded:Be,isShown:function(){return A},isTransitioning:function(){return M},latLngToWorldCoordinates:Oe,lockEvents:_,restoreMapMode:Re,restoreNetworkMode:Le,setController:function(e){s=e},setHandMode:X,setSize:Ce,setView:function(e){b=e},updateNodePositions:q};function z(){if(!c){c=e.privateGetElement();y=ee(c)}}function V(){var e="1.3.4",t="1.3.4",n=L.version.split("-")[0].split("+")[0];if(ve(n,e)<0)throw new Error("Cannot use an older version of Leaflet than "+e);if(!D&&ve(n,t)>0){console.warn("You are using an unsupported version of Leaflet - please use "+t+" instead.");D=!0}}function Y(){if("undefined"==typeof L)return!1;V();return!0}function W(){if(u){var t=e.lock()||!x;d.style.touchAction=t?"none":""}}function X(e){if(e!==x){x=e;W()}}function U(){return x}function N(e){u=e;r.setLeafletMap(u)}function j(t){u&&mf(e,u,t,J,U)}function _(e){if(u){var t=e?"disable":"enable";F.forEach(function(e){u[e][t]()});j(!e);W()}}function H(){var e=u.containerPointToLayerPoint([0,0]),t={x:Math.round(e.x),y:Math.round(e.y)};L.DomUtil.setPosition(c,t);b.offsetX(-t.x);b.offsetY(-t.y)}function J(){H();ke({drawOnly:!0})}function q(t){e.setProperties(ie(),!1,t)}function $(){return new(L.Layer.extend({initialize:function(e,t){L.setOptions(this,t)},setOptions:function(e){L.setOptions(this,e);return this.redraw()},redraw:function(){this._forceRedraw();return this},onAdd:function(){this.getPane().appendChild(c);u.on("zoomend",this._onZoomEnd,this);u.on("moveend",this._onMoveEnd,this);u.options.zoomAnimation&&u.on("zoomanim",this._animateZoom,this);u.on("zoom",this._zoom,this);j(!0);var e=u.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(c,e)},onRemove:function(){u.off("zoomend",this._onZoomEnd,this);u.off("moveend",this._onMoveEnd,this);j(!1);u.options.zoomAnimation&&u.off("zoomanim",this._animateZoom,this);u.on("zoom",this._zoom,this)},addTo:function(){u.addLayer(this);return this},_onZoomEnd:function(){H()
;this._forceRedraw({all:!0})},_onMoveEnd:function(){n.trigger("viewchange")},_forceRedraw:function(e){u&&q(function(){ke(e)})},_animateZoom:function(e){var t=u.getZoomScale(e.zoom),n=u._getCenterOffset(e.center)._multiplyBy(-t).subtract(u._getMapPanePos());L.DomUtil.setTransform(c,n,t)},_zoom:function(e){e.pinch&&q()}}))}function ee(e){if(!e)return-1;for(var t=0,n=e;n=n.previousSibling;)++t;return t}function te(){return i.anyOpenCombos()?a.time*(2/3):a.time}function ne(){var e=r.getZoom();e=Math.min(T,Math.max(S,e));return C+(k-C)*(e-S)/(T-S)}function re(t){if(a.animate){var n=te(),r={time:a.time*(1/3),adapt:!1},o=e.viewOptions();e.combo().close(i.getOpenCombos(),r,function(){var r=ne();o.zoom===r?e.animateProperties(ie(),{time:n},t):e.viewOptions({zoom:r},{animate:!1},function(){var i=ie();e.viewOptions(o,{animate:!1},function(){var a=2;function o(){0==--a&&E(t)}var u={animate:!0,time:n};e.viewOptions({zoom:r},u,o);e.animateProperties(i,u,o)})})})}else e.combo().close(i.getOpenCombos(),{animate:!1},function(){e.viewOptions({zoom:ne()},{animate:!1},function(){q(t)})})}function ie(){var t=[];e.privateEach({type:"node",items:"toplevel"},function(e){if(de(e)){var n=Oe(e);n.id=e.id;t.push(n)}});return t}function oe(t){if(e.privateIsLayingOut())E(t);else{z();if(u||M)E(t);else{x=!0;M=!0;var r=e.lock();e.lock(!0);n.trigger("map","showstart");Se();e.options(Z);i.recordState();var o=i.getHiddenOnMapIds();e.hide(o,{time:a.time,animate:a.animate},function(){fe(null,function(){re(function(){Ae(a.animate,function(){ue(r,t)})})})})}}}function ue(t,r){A=!0;M=!1;n.trigger("map","showend");t||e.lock(!1);if(l){Ce(l[0],l[1]);e.zoom("fit");l=null}I(r)}function se(e,t){return L.Browser.ie3d?"translate("+Math.round(e)+"px,"+Math.round(t)+"px)":"translate3d("+Math.round(e)+"px,"+Math.round(t)+"px, 0px)"}function fe(e,t){c=le();function n(e,t){e._leaflet_pos=t;e.style.transform=se(t.x,t.y)}L.Draggable.include({_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e);n(this._element,this._newPos);this.fire("drag",e)}});var i=Q({boxZoom:!1,zoomAnimationThreshold:20,zoomControl:!1,preferCanvas:!0},a.leaflet);N(new L.Map(d,i));ge();_(!0);e?r.centerView(e):r.fitMapToBounds(null,!1);ce(t)}function le(){p=c.style.position;m=c.style.top;c.style.position="absolute";c.style.zIndex=1e3;c.classList.add("leaflet-zoom-animated");c.style["transform-origin"]="50% 50%";(d=document.createElement("div")).style.width=c.clientWidth+"px";d.style.height=c.clientHeight+"px";d.style.position="relative";d.style.top=c.top;d.style.left=c.left;(g=c.parentNode).insertBefore(d,c);c.style.pointerEvents="none";return c}function ce(t){var n,r={};function i(){$(e,u,c,h).addTo(u);E(t)}if("string"==typeof a.tiles)n=a.tiles;else if(a.tiles){n=a.tiles&&a.tiles.url||G.tiles.url;r=L.extend(r,a.tiles)}if(n){yf(f=new L.TileLayer(n,r),"loading",i);u.addLayer(f)}else i()}function he(e){if(u){u.removeLayer(f);ce(e)}else E(e)}function ge(){h=document.createElement("canvas");s.setOverlayContext(h.getContext("2d"));var e=u.getSize();h.width=e.x;h.height=e.y;h.style.margin="0";h.style["pointer-events"]="none";cd(h,h.getContext("2d"));var t=L.Control.extend({options:{position:"topleft"},onAdd:function(){return h}});v=new t;u.addControl(v)}function pe(t,r){i.clearState();M=!1;t.lockChart||e.lock(!1);t.triggerEvent&&n.trigger("map","hideend");I(r)}function me(t){if(u&&!M){var o=e.lock(),s=te();M=!0;e.lock(!0);n.trigger("map","hidestart");r.fitMapToBounds(null,a.animate,c)}else E(t);function f(){var n=i.getHiddenOnMapIds();e.show(n,!1,{animate:n.length>0,time:a.time},function(){pe({lockChart:o,triggerEvent:!0},t)})}function l(t,n,r,o){e.viewOptions(t,{animate:!1},function(){e.hide(i.getHiddenOnMapIds(),{animate:!1},function(){e.setProperties(n,!1,function(){e.viewOptions(r,{animate:!0,time:s});e.animateProperties(o,{time:s},function(){e.combo().open(i.getOpenCombos(),{time:a.time*(1/3),adapt:!1},f)})})})})}function c(){var n,r;be({restorePositions:!0,animate:a.animate},function(){if(a.animate){n=e.viewOptions();r=Ee()}xe(function(){var u=Ee();Te();e.show(i.getHiddenOnMapIds(),!1,{animate:!1},function(){e.zoom("fit",{animate:!1},function(){if(a.animate){var s=e.viewOptions();e.combo().close(i.getOpenCombos(),{animate:!1,adapt:!1},function(){l(n,r,s,u)})}else pe({lockChart:o,triggerEvent:!0},t)})})})})}}function ye(e){c.style.top=d.offsetTop+"px";var t=y>0?g.childNodes[y+1]:g.firstChild;g.insertBefore(c,t);c.style.transform="";c.style.transformOrigin="";e&&q();ke({positions:!0})}function be(e,t){s.setOverlayContext(null);ye(e.restorePositions);u.removeControl(v);Me(e.animate,function(){d.parentNode&&d.parentNode.removeChild(d);c.style.pointerEvents="auto";c.style.position=p;c.style.top=m;u.remove();N(null);E(t)})}function xe(t){A=!1;e.combo().open(i.getOpenCombos(),{animate:!1,adapt:!1},function(){var n=i.getPositions();if("restore"===a.transition&&n){var r=P(n).filter(function(t){return!e.combo().find(t.id)});e.setProperties(r,!1,t)}else{var o=e.privateValidateLayoutOptions({animate:!1});e.allowDraw(!1);s.layout("standard",o,function(){e.allowDraw(!0);E(t)})}})}function we(t,n,r){if(t)e.privateAnimateBackgroundOpacity(n,{time:a.time},r);else{e.privateSetBackgroundOpacity(n);E(r)}}function Ae(e,t){we(e,0,t)}function Me(e,t){we(e,1,t)}function Ie(t){e.privateEach({type:"node",items:"toplevel"},function(e){e.hi||t({id:e.id,x:e.x,y:e.y})})}function Ee(){var e=[];Ie(function(t){e.push(t)});return e}function Ce(e,t){if(A){d.style.height=t+"px";d.style.width=e+"px";var n=h.getContext("2d");h.width=e;h.height=t;cd(h,n,!1);w=!0;u.invalidateSize(!1);w=!1}else l=[e,t]}function ke(e){var t=e||{positions:!0};n.privateTrigger("forceRedraw",t)}function Se(){var n=e.options();B={};t(Z,function(e,t){B[t]=n[t]})}function Te(){e.options(B);B={}}function Re(t,n){var r=e.lock();z();A=!0;Se();fe(t,function(){e.options(Z);H();q(function(){Ae(!1,function(){r||_(!1);E(n)})})})}function Le(t){var n=e.lock();z();A=!1;be({restorePositions:!1,animate:!1},function(){Te();pe({lockChart:n,triggerEvent:!1},t)})}function Be(){return!!u}function Ze(e){u.dragging.enabled()!==e&&(e?u.dragging.enable():u.dragging.disable())}function Oe(t){var n=u.latLngToContainerPoint([t.pos.lat,t.pos.lng]);return e.worldCoordinates(n.x,n.y)}function Ge(t){var n,r,i,a=R(t);for(r=0;r<a.length;r++)if(O(n=a[r],"pos")){i=Oe({pos:K(e.getItem(n.id).pos,n.pos)});n.x=i.x;n.y=i.y}}}function xf(e,t){var n=null;function r(e){n=e}function i(e,t,r,i){y(i)&&yf(n,"moveend",i);n.setZoom(e,{animate:t})}function a(){return n.getZoom()}function o(e){if(e.length){var t=L.latLngBounds(e),n=t.getNorth(),r=t.getSouth(),i=t.getWest(),a=t.getEast();if(n===r&&i===a){var o=.01;t=L.latLngBounds([[n-o,i-o],[n+o,i+o]])}return t}}function u(){var t=[];e.privateEach({type:"node",items:"toplevel"},function(e){de(e)&&!e.hi&&t.push(L.latLng(e.pos.lat,e.pos.lng))});return t}function s(e,t){if(a()!==t)return!0;var r=n._limitCenter(e,t,n.options.maxBounds),i=n._getCenterOffset(r).floor();return i.x||i.y}function f(e){var r=L.point([2*t.padding,2*t.padding]),i=n.getBoundsZoom(e,!1,r);if(a()!==i)return!0;var o=n.project(e.getSouthWest(),i),u=n.project(e.getNorthEast(),i);return s(n.unproject(o.add(u).divideBy(2),i),i)}function l(e,r,i){var l=o(e||u());if(l)if(void 0===a()||f(l)){y(i)&&yf(n,"moveend",i);n.fitBounds(l,{animate:!!r,padding:[t.padding,t.padding]})}else E(i);else{var c=L.latLng(0,0),d=2;if(s(c,d)){y(i)&&yf(n,"moveend",i);n.setView(c,d,{animate:!!r})}else E(i)}}function c(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];G(r)||!de(r)||r.hi||t.push(L.latLng(r.pos.lat,r.pos.lng))}return t}function d(t,n,r){var i=c(e.getItem(t));i.length?l(i,!!n,r):E(r)}function h(){return n.getMaxZoom()}function v(){return n.getMinZoom()}function p(){return Math.min(1,(h()-v())/10)}function m(t,r,i,o,s){var f={animate:!!r,duration:g(i)?i/1e3:.25};switch(t){case"in":y(s)&&yf(n,"moveend",s);n.zoomIn(p(),f);break;case"out":y(s)&&yf(n,"moveend",s);n.zoomOut(p(),f);break;case"fit":case"fitToModel":o?d(o,r,s):l(u(),!!r,s);break;case"selection":case"fitToSelection":d(e.selection(),r,s);break;case"height":case"fitModelHeight":var c=-1/0,v=-1/0,m=1/0,b=1/0,x=function(e){if(de(e)&&!e.hi){if(e.pos.lat>c){c=e.pos.lat;v=e.pos.lng}if(e.pos.lat<m){m=e.pos.lat;b=e.pos.lng}}};o?e.getItem(o).forEach(x):e.privateEach({type:"node",items:"toplevel"},x);isFinite(c)&&isFinite(v)&&isFinite(m)&&isFinite(b)?l([[c,v],[m,b]],!!r,s):y(s)&&E(s)}return a()/h()}function b(e,t){n.panBy(e,t)}function x(t,r,i,a){var u=null,s=100,f={animate:!!r,duration:g(i)?i/1e3:.25};y(a)&&yf(n,"moveend",a);if("selection"===t){var l=[],c=e.getItem(e.selection());if(c.length){for(var d,h=0;h<c.length;h++)"node"===(d=c[h]).type&&de(d)&&!d.hi&&l.push(L.latLng(d.pos.lat,d.pos.lng));n.panInsideBounds(o(l),f)}}else{switch(t){case"up":u=[0,-s];break;case"down":u=[0,s];break;case"left":u=[-s,0];break;case"right":u=[s,0]}u&&n.panBy(u,f)}}function w(e){n.setView([e.lat,e.lng],e.zoom,{reset:!0})}return{fitMapToBounds:l,getMaxZoom:h,getMinZoom:v,getZoom:a,pan:x,panBy:b,setLeafletMap:r,centerView:w,setZoom:i,zoom:m}}function wf(e){var t,n,r;function i(){u();e.privateEach({type:"node",items:"all"},function(e){var t=e.id;e._combo&&e._combo.open&&n.push(t);e.parentId||f(e)});e.privateEach({type:"link",items:"toplevel"},function(e){e.hi||!t[e.id1]&&!t[e.id2]||(t[e.id]=!0)})}function a(e){t=o(e.hiddenOnMap)||{};n=o(e.openCombos)||[];r=o(e.positions)||{}}function u(){t={};n=[];r={}}function s(){return{hiddenOnMap:o(t),openCombos:o(n),positions:o(r)}}function f(e){var n=e.id;delete r[n];delete t[n];de(e)?r[n]={id:n,x:e.x||0,y:e.y||0}:e.hi||(t[n]=!0)}function l(n){if("link"===n.type&&!n.hi){var r=e.getItem(n.id1),i=e.getItem(n.id2);r&&i&&de(r)&&de(i)||(t[n.id]=!0)}}u();return{anyOpenCombos:function(){return n&&n.length>0},clearState:u,getPositions:function(){return r},getOpenCombos:function(){return n},getHiddenOnMapIds:function(){return Object.keys(t)},isHiddenOnMap:function(e){return t[e]},deserialize:a,serialize:s,recordLinkState:l,recordNodeState:f,recordState:i}}function Af(e,t,n,r,i,a){var o,u=new Map,s=t(n.width,n.height),f=s.getContext("2d"),l=new Hs,c=e.getPane("mapPane"),d={x:0,y:0,scale:1};Mf(c,d=Ef(c.style.transform,d),l,u);If(e,d,l,u,r);i(f,!0);l.waitForImages(function(){u.forEach(function(e,t){var i=t;if("IMG"===i.tagName){var a=l.get(i.src);i=a.isMissing?null:a.im}else i===r&&(i=n);i&&f.drawImage(i,Math.floor(e.x),Math.floor(e.y),i.width*e.scale,i.height*e.scale)});try{o=s.toDataURL()}catch(e){throw new Error("[toDataURL] Error exporting chart."+e)}finally{E(a,o)}})}function Mf(e,t,n,r){Cf(e,"leaflet-tile-container",function(e){var i=Ef(e.style.transform,t);Cf(e,"leaflet-tile",function(e){var t=Ef(e.style.transform,i);n.get(e.src);r.set(e,t)})})}function If(e,t,n,r,i){var a=e.getPane("overlayPane"),o=[];Cf(a,null,function(e){o.push(e)});o.sort(function(e,t){return(0|e.style["z-index"])-(0|t.style["z-index"])});o.forEach(function(e){var a=Ef(e.style.transform,t);if("IMG"===e.tagName){a.scale=e.width/e.naturalWidth;n.get(e.src);r.set(e,a)}else if("CANVAS"===e.tagName){e.style.width&&e!==i&&(a.scale=kf(e.style.width)/e.width);r.set(e,a)}})}function Ef(e,t){var n=Q({},t),r=e.split(/translate(3d)?\(|\);?/);if(r[2]&&r[2].length){var i=kf(r[2]);n.x+=i[0]||0;n.y+=i[1]||0}return n}function Cf(e,t,n){var r;r=t?e.getElementsByClassName(t):e.children;for(var i=0;i<r.length;i++)n(r[i],i)}function kf(e){return e.match(/[-\d]+/g).map(Number)}function Sf(e,n){var r={animate:!0,time:800,tiles:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',subdomains:"abcd",minZoom:0,maxZoom:20},transition:"restore",padding:5},i="#ddd",a=xf(e,r),u=wf(e),s=bf(e,n,a,u,r),f=s.isLeafletLoaded();function l(){throw new Error("Leaflet was not found. Make sure you include leaflet.js and leaflet.css in your web page.")}function c(e){return f?e:l}function d(){return i}function h(e,t){var n=s.getMapContainer();e?n.style.background=e:t?Rn(n,t.stops,1):n.style.background=i}function v(e,t){var n=s.getLeafletMap().latLngToContainerPoint([e,t]);return{x:n.x,y:n.y}}function g(e,t){var n=s.getLeafletMap().containerPointToLatLng([e,t]);return{lat:n.lat,lng:n.lng}}function p(e,n){if(e){t(e,function(e,t){r[t]=e});"tiles"in e&&s?s.changeTilesLayer(n):E(n)}return o(r)}function m(){if(!f)return null;var e=s.getLeafletMap(),t={show:s.isShown()};if(t.show){var n=e.getCenter();t.lat=n.lat;t.lng=n.lng;t.zoom=e.getZoom();t.bounds=e.getBounds().toBBoxString();var r=u.serialize();t.hiddenOnMap=r.hiddenOnMap;t.openCombos=r.openCombos;t.restoreXY=r.positions}return t}function y(e,t,n,r,i){return Af(s.getLeafletMap(),e,t,n,r,i)}function b(e,t){u.deserialize({hiddenOnMap:e.hiddenOnMap,openCombos:e.openCombos,positions:e.restoreXY});if(s.isShown()){a.centerView(e);s.updateNodePositions(t)}else s.restoreMapMode(e,t)}function x(e){s.isShown()?s.restoreNetworkMode(e):E(e)}function w(e,t){if(f){var n=e||{};n.show?b(n,t):x(t)}else E(t)}function A(e){if("node"===e.type){u.recordNodeState(e);if(de(e)){var t=s.latLngToWorldCoordinates(e);e.x=t.x;e.y=t.y}else e.hi||(e.hi=!0)}}function M(t){for(var n=[],r=0;r<t.length;r++){var i=t[r];if("node"===i.type){var a=e.getItem(i.id);if(a){var o=u.getPositions(),s={};u.isHiddenOnMap(i.id)?s.hi=!1:"hi"in a&&(s.hi=a.hi);if(o[i.id]){s.x=o[i.id].x;s.y=o[i.id].y}a.pos&&(s.pos=a.pos);i=K(s,i)}A(i)}"link"===i.type&&u.recordLinkState(i);n.push(i)}return n}return{api:{show:c(s.showMap),hide:c(s.hideMap),viewCoordinates:c(v),mapCoordinates:c(g),isShown:function(){return s&&s.isShown()},leafletMap:s.getLeafletMap,options:c(p)},internalUse:{convertPos:s.convertPos,enableDragging:s.enableDragging,getDefaultBackgroundColour:d,getMapContainer:s.getMapContainer,getMaxZoom:a.getMaxZoom,getMinZoom:a.getMinZoom,getZoom:a.getZoom,isMapLoaded:s.isMapLoaded,isTransitioning:s.isTransitioning,loadUp:w,lock:s.lockEvents,pan:a.pan,panBy:a.panBy,preMerge:M,preSetItem:A,serialize:m,setBackgroundColour:h,setController:s.setController,setHandMode:s.setHandMode,setSize:s.setSize,setView:s.setView,setZoom:a.setZoom,toDataURL:y,zoom:a.zoom}}}function Tf(e,n){var r,i,a={},u=Xn(),s=Ua(u),f=Xa(u,a,n),c=Rs(a,u,s,f,n),d=Sf(a,u),h=tf(u,rf,d,n),v=vf(a,u,h,f,d,n),p=af(v,u,a);v.setModel(c);a.privateInit=function(e,t,n,r,a,o){i=r;v.setCursorFn(a);v.setCreateCanvasFn(r);v.imageGenFn(o);m(e,t,n)};function m(e,t,n){var a=i(t,n);v.makeGhostCanvas(t,n);var o=r;r=nf(u,t,n,1,d);v.setView(r);v.setCanvasContext(e);v.setShadowCanvas(a.getContext("2d"),t,n);sn();if(o){r.setMinZoom(o.getMinZoom());r.setMaxItemZoom(o.getMaxItemZoom());r.fromOldSettings(o.settings(),!1)}d.internalUse.setView(r);v.initOverlays()}a.privateSetSize=m;a.privateMapSetSize=function(e,t){d.internalUse.setSize(e,t)};a.privateGetMapContainer=function(){return d.internalUse.getMapContainer()};a.privateGetElement=function(){return document.getElementById(e)};a.privateIsLayingOut=v.isLayingOut;a.graph=function(){return c.graph()};a.map=function(){return d.api};function b(){return d&&d.api.isShown()}function x(){return d&&d.internalUse.isTransitioning()}a.ggwp=function(){return v.getWebGLPixels()};a.combo=function(){return v.combo.api};function w(e){return B(!0===e?{animate:!0}:e,{animate:!1,time:1e3})}a.toDataURL=function(e,t,o,u){var s,l,h;if(!u)throw new Error("[toDataURL] callback is required");if(v.isMapMode()){s=r.width();l=r.height()}else{s=Math.floor(e);l=Math.floor(t)}var g=r.settings();s=s>0?s:g.width;l=l>0?l:g.height;var p=B(o,{fit:"exact",watermark:!0,gradient:!0,logo:!0});b()&&(p.fit="exact");if("oneToOne"===p.fit){(h=v.modelExtents())||(h={x1:0,y1:0,x2:100,y2:100});var m=10;h.x1-=m;h.y1-=m;h.x2+=m;h.y2+=m;var y=v.watermarkSize();if(y&&p.watermark){var x=(y.width-(h.x2-h.x1))/2;if(x>0){h.x1-=x;h.x2+=x}var w=(y.height-(h.y2-h.y1))/2;if(w>0){h.y1-=w;h.y2+=w}}s=h.x2-h.x1;l=h.y2-h.y1;p.noScale=!0}function A(e){s=Math.floor(s/e);l=Math.floor(l/e)}var M=s*l/16e6;if(M>1){A(Math.sqrt(M))}var I=8e3,C=s/I;C>1&&A(C);var k=l/I;k>1&&A(k);var S=i(s,l,!0),T=p.noScale?1:s/r.width(),R=Xn(),L=nf(R,Math.floor(s/T),Math.floor(l/T),T,d),Z=tf(R,rf,null,n),O=vf(a,R,Z,f,null,n);O.setCreateCanvasFn(i);O.setModel(c);O.setView(L);O.setCanvasContext(S.getContext("2d"));O.setShadowCanvas(null,s,l);O.imageGenFn(v.imageGenFn());G();function G(){var e=v.options();e.overview={shown:!1};p.watermark||(e.watermark=!1);p.gradient||(e.gradient=!1);p.logo||(e.logo=!1);O.options(e,null,!0);O.backgroundOpacity(v.backgroundOpacity());var t=O.makeGhostCanvas(L.width(),L.height()),a=[];if(!p.selection){a=c.doSelection();c.doSelection([])}switch(p.fit){case"chart":O.fitToModel(!1);break;case"view":L.fromOldSettings(r.settings(),!0);break;case"exact":L.fromOldSettings(r.settings(),!1);break;case"oneToOne":L.fitWorldExtents(h,!1,!1,!1,0,0)}L.scaleFactor(T);O.initOverlays();O.draw(!0,{all:!0});n.waitForImages(function(){O.draw(!0,{all:!0});var e;try{e=S.toDataURL()}catch(e){throw new Error("[toDataURL] There is a problem exporting the chart."+e)}finally{if("rtl"===S.dir){var n=document.getElementsByTagName("body")[0];n.removeChild(S);n.removeChild(t)}}p.selection||c.doSelection(a);c.setAllDirty();if(b()){var r,o=v.getCanvasContext();r=o.webglCanvas?o.webglCanvas:o.canvas;d.internalUse.toDataURL(i,S,r,v.drawBackground,u)}else E(u,e)})}};a.load=function(e,t){switch(e&&e.type){case"LinkChart":if(d&&d.internalUse.isTransitioning())throw new Error("Cannot load chart during map show or hide operation");c=Rs(a,u,s,f,n);v.setModel(c);v.load(e,function(){v.initOverlays();n.invokeWhenImagesHaveLoaded(t)});break;default:throw new Error("Unknown chart type passed to load")}};a.chartType=function(){return c.type()};a.clear=function(){u.trigger("prechange","delete");v.load({type:"LinkChart",items:[],map:{keepSameMode:!0}},function(){v.render()})};a.merge=function(e,t){A(e,{updateGlyph:!0},t)};function A(e,t,r){if(G(e))throw new Error("Null or undefined object passed to merge");var i=T(e);v.merge(i,t);v.render();n.invokeWhenImagesHaveLoaded(r)}function M(e,t){var n=c.getByID(e);return!n||!t&&n.parentId?null:n}function I(e,t){return c?Array.isArray(e)?e.map(function(e){return M(e,t)}):M(e,t):null}a.privateReveal=function(e){var t=e;if(t){t=R(t);var n=a.privateGetItem(t).filter(function(e){return e&&"link"===e.type&&!e._combo});c.reveal(H(n));a.privateTrigger("redraw",{all:!0})}return c.getRevealedLinks()};a.privateGetItem=function(e){return I(e,!0)};a.privateItemIsShown=function(e){return!!c&&c.isItemShown(e)};a.privateGetTopItemId=function(e){return c.topParentId(e)};a.privateGetRawItems=function(){return c?c.getRawItems():[]};a.privateGetCanvas=function(){return v.getCanvasContext()};a.privateGetGenerator=function(){return f};a.privateRedrawItem=function(e){c&&c.setDirty(e)};a.privateSetAllItemsInComboDirty=function(e){a.privateGetItem(e).forEach(function(e){if(e){a.privateRedrawItem(e.id);if(e._combo){a.privateSetAllItemsInComboDirty(e._combo.linkIds);e._combo.nodeIds&&a.privateSetAllItemsInComboDirty(e._combo.nodeIds)}}})};a.applyRevealedLinkOffsets=function(e){c&&c.applyRevealedLinkOffsets(e)};a.privateTopParentId=function(e){return c?c.topParentId(e):null};a.privateMerge=function(e,t){var n=e;d&&d.api.isShown()&&(n=d.internalUse.preMerge(n));c.merge(n);v.render();E(t)};a.privateEach=function(e,t){var n=B(e,{type:"all",items:"underlying"});return p.each(n,!0,t)};a.privateBothEndsShown=function(e){return c.bothEndsShown(e)};a.privateBothEndsForeground=function(e){return c.bothEndsForeground(e)};a.privateGetParentItems=function(e){return c.getParentItems(e)};a.privateFirstVisibleItemInAncestry=function(e){if(c)return c.firstVisibleItemInAncestry(e)};a.privateAllParentsOpen=function(e,t){return c&&c.allParentsOpen(e,t)};a.privateGetAncestryIds=function(e){return c.getAncestryIds(e)};a.privateSetAllDirty=function(){v.render();c.setAllDirty()};a.privateAddItemsToTransfer=function(e){c.addItemsToTransfer(e)};a.privateRemoveItemsFromTransfer=function(e){c.removeItemsFromTransfer(e)};a.privateSetNonImageProperties=function(e,t){var n={};c.setProperties(e,!1,n,t);v.render(n)};a.privateNeighbourLinkIds=function(e){return c.neighbourLinkIds(e)};a.privateRemoveItem=function(e){c.removeItem(e);v.render()};a.privateGraph=function(){return c.graph()};a.privateGetLinksBetween=function(e,t){return c.privateGetLinksBetween(e,t)};a.validateCombos=function(){c.validateCombos()};a.setProperties=function(e,t,r){if(e){var i={};v.setProperties(e,t,!1,i);v.render(i)}n.invokeWhenImagesHaveLoaded(r)};function C(e,t,n,r,i){var a=B(t,{time:1e3,easing:"linear",queue:!0});(a.time<0||!g(a.time))&&(a.time=0);var o=R(e);v.animateProperties(o,a,n,r,i)}a.animateProperties=function(e,t,n){C(e,t,n)};a.privateAnimateProperties=function(e,t,n,r){C(e,t,n,!0,r)};function k(e){return isFinite(e)?Math.min(Math.max(0,e),1):e?1:0}a.privateAnimateBackgroundOpacity=function(e,t,n){var r=B(t,{time:500});v.animateBackgroundOpacity(k(e),r.time,n)};a.privateSetBackgroundOpacity=function(e){v.backgroundOpacity(k(e))};a.ping=function(e,t,n){var r=B(t,{c:"#909090",w:20,r:80,time:800,repeat:1,lw:40});v.ping(e,r,n)};a.getItem=function(e){return Array.isArray(e)?e.map(c.getItem):c?c.getItem(e):null};a.setItem=function(e,t){if(e){u.trigger("prechange","properties");v.setItem(e);v.render();n.invokeWhenImagesHaveLoaded(t)}};a.removeItem=function(e){u.trigger("prechange","delete");v.removeItem(e);v.render()};function S(e){e&&"boolean"==typeof e.combos&&!e.items&&(e.items=e.combos?"underlying":"toplevel")}a.each=function(e,t){var n=B(e,{type:"all",items:"underlying"});return p.each(n,!1,t)};a.filter=function(e,t,n){var r=L(t);return p.filter(e,r,n)};function L(e){S(e);var t=B(e,{type:"all",items:"underlying",animate:!0,time:1e3,updateGlyph:!0});return B(t,{hideSingletons:"link"===t.type})}a.foreground=function(e,t,n){S(t);var r=B(t,{type:"node",items:"underlying",foregroundOpenCombos:!0});return p.foreground(e,r,n)};a.hide=function(e,t,n){if(G(e)||""===e)E(n);else{u.trigger("prechange","hide");var r=R(e),i=w(t);i=B(i,{updateGlyph:!0});var a=v.combo.internalUse.hide(r,i);v.hide(a,i,n)}};a.privateHideWithoutCombos=function(e,t,n){u.trigger("prechange","hide");var r=R(e),i=w(t);v.hide(r,i,n)};a.hidden=function(){return c.hidden()};a.show=function(e,t,n,r){if(G(e)||""===e)E(r);else{u.trigger("prechange","show");var i=R(e),o=w(n);o=B(o,{updateGlyph:!0});var s=v.combo.internalUse.show(i,t);v.show(s,t,o,r);var f=[];s.forEach(function(e){var t=a.privateGetItem(e);if("node"===t.type){t._combo&&f.push(t.id);t.parentId&&f.push(t.parentId)}return!1});v.combo.internalUse.ensureMinimumOpenComboSize(f)}};a.privateShowWithoutCombos=function(e,t,n,r){u.trigger("prechange","show");var i=R(e),a=w(n);v.show(i,t,a,r)};a.labelPosition=function(e){return c?v.labelPosition(e,r):null};a.contains=function(e){return c?c.contains(e):[]};a.serialize=function(){var e=c.serialize();v.appendCombos(e);var t=d.internalUse.serialize();t&&(e.map=t);e.viewSettings=r.settings();return e};a.worldCoordinates=function(e,t){var n=r.scale(e),i=r.scale(t);return{x:Math.floor(r.viewToWorldX(n)),y:Math.floor(r.viewToWorldY(i))}};a.viewCoordinates=function(e,t){return{x:r.worldToViewX(e),y:r.worldToViewY(t)}};a.viewOptions=function(e,t,n){if(!e)return r.settings();var i=w(t),a=B(e,{offsetX:0,offsetY:0,zoom:1});v.setViewSettings(a,i.animate,i.time,function(){v.render({drawOnly:!0});E(n)})};a.options=function(e,t){return v.options(e,t)};a.displayOptions=function(e,t){return a.options(e,t)};a.interactionOptions=function(e){return a.options(e)};a.lock=function(e,t){if(void 0!==e){Z=e;d&&d.internalUse.lock(Z);if(e){var n=t||{};v.wait(n.wait);v.removeDragger()}else v.wait(!1);v.render()}return Z};var Z=!1;a.zoom=function(e,t,n){var r=w(t);switch(e){case"in":v.zoomIn(r.animate,r.time,n);break;case"out":v.zoomOut(r.animate,r.time,n);break;case"one":v.setZoom(1,r.animate,r.time,n);break;case"fit":v.fitToModel(r.animate,r.time,r.ids,n);break;case"selection":v.fitToSelection(r.animate,r.time,null,n);break;case"height":v.fitModelHeight(r.animate,r.time,r.ids,n)}};a.pan=function(e,t,n){var r=w(t);"selection"!==e||b()?v.pan(e,r.animate,r.time,n):v.fitToSelection(r.animate,r.time,null,n,!0)};a.getLastError=function(){return u.getErrors()};a.imagePrefix=function(e){return v.imagePrefix(e)};a.cancelAnimation=function(){v.cancelAnimation()};a.layout=function(e,t,n){if(b()||x())E(n);else{var r=O(t);v.layout(e||"standard",r,n)}};function O(e){var t=a.viewOptions();return B(e,{fit:!0,animate:!0,tidy:!0,ratio:t.height>0?t.width/t.height:1,tightness:5,straighten:!0})}a.privateValidateLayoutOptions=O;a.arrange=function(e,t,n,r){var i=B(n,{fit:!1,animate:!0,tidy:!1,ratio:1});v.arrange(e||"grid",t,i,r)};a.selection=function(e){var t=G(e)?e:R(e),n=c?c.doSelection(t):[];t&&v.render();return n};function D(e,n,r,i,o){var u=o.layout.fix,s=!o.filter||o.filter.updateGlyph,f=e;function l(e,n){a.privateEach({type:"link",items:"toplevel"},function(t){if(!e[t.id1]||!e[t.id2]){var r=e[t.id1]||e[t.id2],i=e[t.id1]?t.id2:t.id1;if(r&&i){n[i]||(n[i]={x:0,y:0,_counter:0,id:i});n[i].x+=r.x;n[i].y+=r.y;n[i]._counter++}}});var r=0;t(n,function(t){if(!e[t.id]){t.x/=t._counter;t.y/=t._counter;e[t.id]=t;r++}});return r}function d(e,n,r){if(b())r();else{for(var i,o={},u=[];0!==i;)i=l(n,o);t(e,function(e){if("node"===e.type&&!o[e.id]){e.x=w[e.id].x;e.y=w[e.id].y}});t(o,function(e){u.push(e)});a.setProperties(u,!1,r)}}function h(){var e=[],t={};c.each({type:"node"},function(n){e.push(n.id);t[n.id]=n});return{list:e,dict:t}}function v(){var e={};c.each({type:"all"},function(t){e[t.id]=!0});return e}function g(e){var n={},r={};t(f,function(t){n[t.id]=t;if(("adjacent"===u||"nonadjacent"===u)&&"link"===t.type){var i=a.privateTopParentId(t.id);if(!e[i]){var o=a.privateTopParentId(t.id1);o&&e[o]&&(r[o]=!0);var s=a.privateTopParentId(t.id2);s&&e[s]&&(r[s]=!0)}}});return{dict:n,touched:r}}function p(){var e=0;a.privateEach({items:"toplevel"},function(){e++});return e}function m(e,t){switch(u){case"all":return e;case"adjacent":return Object.keys(t);case"nonadjacent":return e.filter(function(e){return!t[e]});case"none":default:return[]}}function y(){var e={open:[],closed:[]};f.forEach(function(t){"node"===t.type&&t.parentId&&(a.combo().isOpen(t.parentId)?e.open.push(t.parentId):e.closed.push(t.parentId))});return e}function x(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r];if(!G(i)&&!n[i.id]){n[i.id]=1;w[i.id]={x:i.x,y:i.y};delete i.x;delete i.y;t.push(i)}}return t}var w={};f=x(f);var M=y(),I=h(),E=I.dict,C=v(),k=p();A(f,{updateGlyph:s},function(){var e=g(C),t=e.dict,a=m(I.list,e.touched);n(t,function(){d(f,E,function(){r(C,function(){i(M,p()!==k,a)})})})})}a.expand=function(e,t,n){var r=t;function i(e){function t(t,n){function r(e){return t[e.id]?p.filter.filterFn(e):!e.hi}if(p.filter&&X(t)){var i=o(p.filter);i.animate=e;return a.filter(r,i,n)}return n()}return t}function s(e,t,n){p.arrange.animate=t;a.combo().arrange(e,p.arrange,n)}function f(e){p.layout.fixed=e;a.layout(p.layout.name,p.layout,n)}function l(e,t){p.layout.fixed=t;v.arrangeAndLayout(e,p,n)}function c(e,t,r){var i=!1;if(p.animate)for(var o=0;o<e.open.length;o++)if(a.privateItemIsShown(e.open[o])){i=!0;break}var u=e.open.concat(e.closed);t?i?l(u,r):s(u,!1,function(){f(r)}):s(u,i,n)}function d(e,t){var n=null;if(e.filter&&y(e.filter.filterFn)){var r=e.filter.filterFn;(n=L(e.filter)).time=Math.floor(t.time/5);n.filterFn=r}return n}function h(e){e.arrange.animate=e.animate;e.arrange.time=e.time;e.arrange.easing=e.layout.easing;e.filter&&(e.arrange.updateGlyph=e.filter.updateGlyph);return B(e.arrange,{name:"lens",resize:!0,updateGlyph:!0})}function g(e,t){t.layout.animate=t.animate;t.layout.time=t.time;t.layout=B(t.layout,{fit:t.fit,straighten:t.straighten,tidy:t.tidy,tightness:t.tightness});var n={name:"standard",strategy:"spiral",tidy:!1,fit:!1,fix:e.layout?"nonadjacent":"all",easing:"cubic"};return O(B(t.layout,n))}var p=B(r=r||{},{animate:!0,time:1e3,layout:{},filter:{},arrange:{}});p.filter=d(r,p);p.filter&&(p.time-=p.filter.time);p.layout=g(r,p);p.arrange=h(p);u.trigger("prechange","expand");D(R(T(e)),i(!1),i(p.animate),c,p)};a.createLink=function(e,t,n,r){var i=a.getItem(e);if(a.getItem(t))throw new Error("LinkId ("+t+") already exists and must be unique");if(e&&i&&"node"===i.type&&t){var o=z(t),u=B(n,{style:{}});a.privateBind("dragcomplete",d);var s="dummyEnd"+Math.floor(1e7*Math.random()),f={type:"node",du:!0,id:s,x:i.x,y:i.y},c=K(u.style,{id:o,id1:e,id2:s,type:"link"});a.merge([f,c],function(){l(function(){v.startDragger(o,s+F()+"id2",i.x,i.y)})})}function d(e,t){if("dummy"===e){a.removeItem(s);a.privateUnbind("dragcomplete",d);var n=z(t)===o?null:t;E(r,n)}}};Qn(a,v,a.lock);a.mousemove=function(e,t,n,r){v.mousemove(e,t,n,r,Z)};a.dragover=function(e,t){v.dragover(e,t)};K(a,u);function V(e,t){v.draw(e,t);v.drawoffscreen();v.afterDraw()}var Y=Un(V,v.animate,v.getCanvasContext);K(a,Y);a.privateBind("redraw",Y.redraw);return a}
var Rf="cHJlY2lzaW9uIGhpZ2hwIGZsb2F0O2F0dHJpYnV0ZSB2ZWMyIGFfcG9zaXRpb247YXR0cmlidXRlIGZsb2F0IGFfcmFkaXVzO2F0dHJpYnV0ZSBmbG9hdCBhX3N0YXJ0QW5nbGU7YXR0cmlidXRlIGZsb2F0IGFfZW5kQW5nbGU7YXR0cmlidXRlIGZsb2F0IGFfd2lkdGg7YXR0cmlidXRlIHZlYzQgYV9jb2xvdXI7YXR0cmlidXRlIHZlYzQgYV9jb2xvdXIyO2F0dHJpYnV0ZSB2ZWMzIGFfaGl0VGVzdENvbG91cjthdHRyaWJ1dGUgZmxvYXQgYV9saW5lVHlwZTthdHRyaWJ1dGUgdmVjMyBhX2NvcmU7dW5pZm9ybSBmbG9hdCB1X2hpdFRlc3Q7dW5pZm9ybSBmbG9hdCB1X3pvb207dW5pZm9ybSB2ZWMzIHVfcmVzb2x1dGlvbjt1bmlmb3JtIG1hdDQgdV90cmFuc2Zvcm07dmFyeWluZyB2ZWM0IHZfY29sb3VyO3ZhcnlpbmcgdmVjNCB2X2NvbG91cjI7dmFyeWluZyB2ZWM0IHZfY29yZTt2YXJ5aW5nIHZlYzQgdl9saW5lRGF0YTt2YXJ5aW5nIHZlYzMgdl9oaXRUZXN0Q29sb3VyO3ZhcnlpbmcgdmVjNCB2X2JhcnljZW50cmljO3ZhcnlpbmcgdmVjNCB2X3Bvc2l0aW9uO3ZhcnlpbmcgdmVjMyB2X2Rhc2hpbmc7ZmxvYXQgYT0zLjE0MTU5MjY1MzU5O2Zsb2F0IGI9MS4wO2ludCBjPTI7aW50IGQ9MztpbnQgZT00O2Zsb2F0IGY9NC4wO2Zsb2F0IGc9Zi0wLjU7aW50IGgoZmxvYXQgYSl7cmV0dXJuIGludChmbG9vcihhKzAuNSkpO312ZWMyIGkodmVjMiBqLGZsb2F0IGssZmxvYXQgbCxmbG9hdCBtLGZsb2F0IG4pe3JldHVybiB2ZWMyKGoueCsoaypjb3MobCttKm4pKSxqLnkrKGsqc2luKGwrbSpuKSkpO31mbG9hdCBvKGZsb2F0IHAsZmxvYXQgcSl7ZmxvYXQgcj1wLzIuMDtmbG9hdCBzPWZsb29yKCgocStyKS8ocCtyKSkrMC41KTtpZigocypwKT5xKXtzPTEuMDt9cmV0dXJuIHM7fXZvaWQgbWFpbigpe2Zsb2F0IHQ9MS4wL3Vfem9vbTtpbnQgdT1oKGFfbGluZVR5cGUpO2Jvb2wgdj11PT1jO2Jvb2wgdz11PT1kO2Jvb2wgeD11Pj1lO3ZlYzIgeTtmbG9hdCB6O2lmKHgpe2ludCBBPWgoYV9saW5lVHlwZSktZTt2ZWMyIEI9YV9wb3NpdGlvbjt2ZWMyIEM9dmVjMihhX3JhZGl1cyxhX3N0YXJ0QW5nbGUpO3ZlYzIgRD12ZWMyKGFfZW5kQW5nbGUsYV93aWR0aCk7ZmxvYXQgRT1kaXN0YW5jZShDLEQpO2Zsb2F0IEY9RS91X3pvb207ej0xLjAvRjt2ZWMyIEc7aWYoQT09MCl7eT1CO0c9KEMrRCkvMi4wO31lbHNlIGlmKEE9PTEpe3k9QztHPShCK0QpLzIuMDt9ZWxzZSBpZihBPT0yKXt5PUQ7Rz0oQytCKS8yLjA7fXZlYzIgSD1ub3JtYWxpemUoeS1HKTt5Kz1IL3Vfem9vbTt2X2JhcnljZW50cmljPXZlYzQoYV9jb3JlLnh5eix6KTt2X2NvcmU9dmVjNCgxLjApO3ZfbGluZURhdGE9dmVjNCgwLjAsMC4wLDAuMCxhX2xpbmVUeXBlKTt9ZWxzZXt2ZWMyIGo9YV9wb3NpdGlvbjtmbG9hdCBrPWFfcmFkaXVzO2Zsb2F0IEk9YV9zdGFydEFuZ2xlO2Zsb2F0IEo9YV9lbmRBbmdsZTtmbG9hdCBLO3ZlYzIgTDtmbG9hdCBNO2Zsb2F0IE47aWYodV9oaXRUZXN0PT0xLjApe3Q9Ny4wL3Vfem9vbTt9Ym9vbCBPPWgoc2lnbihhX2NvcmUucikpPT0xO2Zsb2F0IG49YWJzKGFfY29yZS5yKS0xLjA7ZmxvYXQgbT0oYV9lbmRBbmdsZS1hX3N0YXJ0QW5nbGUpL2Y7Yi89dV9yZXNvbHV0aW9uLno7aWYodyl7Yj1tYXgoYixzdGVwKDIuNSxhX2xpbmVUeXBlKSoyLjApO31mbG9hdCBQPW1heChhX3dpZHRoKnVfem9vbSxiKS91X3pvb207ZmxvYXQgUT1QK3Q7ZmxvYXQgUj1RLzIuMDtmbG9hdCBTPVAvMi4wO2lmKG48Zil7Tj0xLjA7fWVsc2V7Tj0tMS4wO31mbG9hdCBUPWFfcmFkaXVzKihKLUkpO3ZlYzIgVT1pKGosbWF4KGsrUywwLjApLGFfc3RhcnRBbmdsZSxtLG4rKE4vMi4wKSk7ZmxvYXQgVj1tLzIuMDtmbG9hdCBXPWxlbmd0aChVLWopO2Zsb2F0IFg9Vy9jb3MoVik7aWYoTyl7Sz1YK3Q7fWVsc2V7ZmxvYXQgWT1zbW9vdGhzdGVwKDIwMDAwLjAsMTAwMDAwLjAsaykqMjAuMDtLPWstUi1ZO312X2xpbmVEYXRhPXZlYzQoMC4wLFAsVCwtYV9saW5lVHlwZSk7Sz1tYXgoSywwLjApO2Zsb2F0IFo9KDEuMC9UKS91X3pvb207ZmxvYXQgYmE9VCp1X3pvb207ZmxvYXQgYmI9KEotSSkvYmE7ZmxvYXQgYmM9STtmbG9hdCBiZD1iYjtiYy09KDEuMC1zdGVwKDAuNSxuKSkqYmQ7YmMrPXN0ZXAoZyxuKSpiZDt5PWkoaixLLGJjLG0sbik7aWYodyl7ZmxvYXQgYmU9YmEvNC4wO2Zsb2F0IGJmPVQvKFAqMi4wKTtmbG9hdCBiZz1taW4oYmUsYmYpO3ZfY29yZT12ZWM0KGJjLGNlaWwoYmcpLFosYV9yYWRpdXMpO3ZfZGFzaGluZz12ZWMzKFAsUCwwLjUpO31lbHNlIGlmKHYpe2Zsb2F0IHA9bWF4KDIuMC91X3pvb20sUCoyLjApO2Zsb2F0IGJoPW8ocCxUKTtmbG9hdCByPShULXAqYmgpLyhiaC0xLjApO2Zsb2F0IGJpPXIqYmgvKFQrcik7dl9jb3JlPXZlYzQoYmMsYmgtYmksWixhX3JhZGl1cyk7ZmxvYXQgYmo9KHAvKHArcikpLzIuMDt2X2Rhc2hpbmc9dmVjMyhwLHIsYmopO31lbHNle3ZfY29yZT12ZWM0KGJjLG4vZixaLGFfcmFkaXVzKTt9dl9wb3NpdGlvbj12ZWM0KHksaik7fXZlYzIgYms9eS91X3Jlc29sdXRpb24ueHk7dmVjMiBibD1iayoyLjA7dmVjMiBibT1ibC0xLjA7dmVjNCBibj1hX2NvbG91cjtibi89MjU1LjA7dl9jb2xvdXI9Ym47dmVjNCBibz1hX2NvbG91cjI7Ym8vPTI1NS4wO3ZfY29sb3VyMj1ibzt2X2hpdFRlc3RDb2xvdXI9YV9oaXRUZXN0Q29sb3VyO2dsX1Bvc2l0aW9uPXVfdHJhbnNmb3JtKnZlYzQoYm0qdmVjMigxLC0xKSwwLDEpO30=",Lf="CiNpZmRlZiBHTF9PRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMKCiNleHRlbnNpb24gR0xfT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIDogZW5hYmxlCgojZW5kaWYKcHJlY2lzaW9uIGhpZ2hwIGZsb2F0O3VuaWZvcm0gZmxvYXQgdV9oaXRUZXN0O3VuaWZvcm0gZmxvYXQgdV9zaGFkb3dUeXBlO3VuaWZvcm0gZmxvYXQgdV96b29tO3VuaWZvcm0gZmxvYXQgdV9ncmFkaWVudFN0YXJ0RnJhY3Rpb247dmFyeWluZyB2ZWM0IHZfY29sb3VyO3ZhcnlpbmcgdmVjNCB2X2NvbG91cjI7dmFyeWluZyB2ZWMzIHZfaGl0VGVzdENvbG91cjt2YXJ5aW5nIHZlYzQgdl9jb3JlO3ZhcnlpbmcgdmVjNCB2X2xpbmVEYXRhO3ZhcnlpbmcgdmVjNCB2X2JhcnljZW50cmljO3ZhcnlpbmcgdmVjNCB2X3Bvc2l0aW9uO3ZhcnlpbmcgdmVjMyB2X2Rhc2hpbmc7aW50IGE9MjtpbnQgYj0zO2ludCBjPTQ7ZmxvYXQgZD0zLjE0MTU5MjY1MzU5O2Zsb2F0IGU9MC43MDcxMDY3ODExODY1NDc1NztmbG9hdCBmKGZsb2F0IGcsZmxvYXQgaCl7ZmxvYXQgaT1sZW5ndGgodmVjMihkRmR4KGgpLGRGZHkoaCkpKSplO3JldHVybiBzbW9vdGhzdGVwKGctaSxnK2ksaCk7fWZsb2F0IGo9MC4wMDAxO2Zsb2F0IGsoZmxvYXQgbCxmbG9hdCBtLGZsb2F0IGgpe2Zsb2F0IG49bWF4KGgtbCwwLjApO2Zsb2F0IG89bWF4KGosbS1sKTtyZXR1cm4gbWluKDEuMCxuL28pO31mbG9hdCBwKHZlYzMgcSl7dmVjMyByPWZ3aWR0aChxKTt2ZWMzIHM9c21vb3Roc3RlcCh2ZWMzKDAuMCkscioyLjAscSk7cmV0dXJuIG1pbihtaW4ocy54LHMueSkscy56KTt9aW50IHQoZmxvYXQgYSl7cmV0dXJuIGludChmbG9vcihhKzAuNSkpO312ZWM0IHUoZmxvYXQgdil7ZmxvYXQgdz1rKHVfZ3JhZGllbnRTdGFydEZyYWN0aW9uLDEuMC11X2dyYWRpZW50U3RhcnRGcmFjdGlvbix2KTt2ZWMzIHg9bWl4KHZfY29sb3VyLnJnYix2X2NvbG91cjIucmdiLHcpO2Zsb2F0IHk9bWl4KHZfY29sb3VyLmEsdl9jb2xvdXIyLmEsdyk7cmV0dXJuIHZlYzQoeCp5LHkpO312ZWM0IHoodmVjNCB4KXtmbG9hdCBBPXZfbGluZURhdGEueTtmbG9hdCBCPXZfbGluZURhdGEueC8yLjA7ZmxvYXQgZz0oQS8yLjApKnVfem9vbTtmbG9hdCBDPWFicyhCKSp1X3pvb207eCo9MS4wLXNtb290aHN0ZXAoZy1lLGcrZSxDKTtyZXR1cm4geDt9ZmxvYXQgRChmbG9hdCBDLGZsb2F0IEUsZmxvYXQgRil7cmV0dXJuIChDL0UpKkY7fXZlYzQgRyhib29sIEgsYm9vbCBJLGJvb2wgSil7ZmxvYXQgQj12X2xpbmVEYXRhLngvMi4wO2Zsb2F0IEE9dl9saW5lRGF0YS55O2Zsb2F0IEs9dl9jb3JlLno7ZmxvYXQgTD12X2NvcmUueDtmbG9hdCBNPXZfY29yZS55O2Zsb2F0IE49dl9saW5lRGF0YS56O2Zsb2F0IE89QS8yLjA7ZmxvYXQgUD12X2Rhc2hpbmcueDtmbG9hdCBRPXZfZGFzaGluZy56O3ZlYzQgUj11KEwpO2lmKEgpe2Zsb2F0IFM9TCpNO3ZlYzIgVD12ZWMyKEwqTixCKTtmbG9hdCBVPWZyYWN0KFMpLVE7ZmxvYXQgVj1mbG9vcihVKzAuNSk7ZmxvYXQgVz1TLVUrVjt2ZWMyIFg9dmVjMigoVy9NKSpOLDAuMCk7ZmxvYXQgWT1PO2lmKEkpe1QueT0wLjA7WT1QLzIuMDtSPXooUik7fWZsb2F0IFo9ZGlzdGFuY2UoVCxYKTtSKj0xLjAtZihZLFopO31lbHNle1I9eihSKTtSKj1mKEssdl9jb3JlLngpO1IqPTEuMC1mKDEuMC1LLHZfY29yZS54KTt9cmV0dXJuIFI7fXZlYzQgYmEoYm9vbCBILGJvb2wgSSxib29sIEope2Zsb2F0IEE9dl9saW5lRGF0YS55O2Zsb2F0IE09dl9jb3JlLnk7ZmxvYXQgSz12X2NvcmUuejtmbG9hdCBOPXZfbGluZURhdGEuejtmbG9hdCBPPUEvMi4wO2Zsb2F0IGJiPXZfY29yZS5hO2Zsb2F0IGJjPU4vYmI7dmVjMiBDPXZfcG9zaXRpb24ueHk7dmVjMiBiZD12X3Bvc2l0aW9uLnp3O2Zsb2F0IGJlPWRpc3RhbmNlKEMsYmQpO2Zsb2F0IGJmPWF0YW4oQy55LWJkLnksQy54LWJkLngpO2lmKGJmPHZfY29yZS54KXtiZis9Mi4wKmQ7fWZsb2F0IGJnPXZfY29yZS54O2Zsb2F0IGJoPShiZi1iZykvKGJjKTt2ZWM0IFI9dShiaCk7aWYoSCl7ZmxvYXQgUD12X2Rhc2hpbmcueDtmbG9hdCBRPXZfZGFzaGluZy56O2Zsb2F0IE09dl9jb3JlLnk7ZmxvYXQgYmk9YmgqTTt2ZWMyIGJqPUM7ZmxvYXQgVT1mcmFjdChiaSktUTtmbG9hdCBWPWZsb29yKFUrMC41KTtmbG9hdCBYPWJpLVUrVjtmbG9hdCBiaz1EKFgsTSxiYykrYmc7aWYoSil7dmVjMiBYPXZlYzIoYmQueCsoYmIqY29zKGJrKSksYmQueSsoYmIqc2luKGJrKSkpO2Zsb2F0IFo9ZGlzdGFuY2UoYmosWCk7ZmxvYXQgYmw9TztSKj0xLjAtZihibCxaKTt9ZWxzZXtmbG9hdCBibT1kaXN0YW5jZShiZixiayk7ZmxvYXQgYmw9RChQLzIuMCxOLGJjKTtSKj0xLjAtZihibCxibSk7Uio9ZihiYixiZStPKTtSKj0xLjAtZihiYitPLGJlKTt9fWVsc2V7ZmxvYXQgYm49dl9jb3JlLnk7Uio9ZihiYixiZStPKTtSKj0xLjAtZihiYitPLGJlKTtSKj1mKEssYm4pO1IqPTEuMC1mKDEuMC1LLGJuKTt9cmV0dXJuIFI7fXZvaWQgbWFpbigpe2ludCBibz1pbnQodV9zaGFkb3dUeXBlKTtmbG9hdCBicD1hYnModl9saW5lRGF0YS53KTtpbnQgYnE9dChicCk7Ym9vbCBicj1zaWduKHZfbGluZURhdGEudyk8MC4wO2Jvb2wgSD1icD4xLjU7Ym9vbCBJPWJxPT1hO2Jvb2wgSj1icT09Yjtib29sIGJzPWJxPj1jO2Jvb2wgYnQ9Ym89PS0xO2Jvb2wgYnU9Ym89PTE7aWYodV9oaXRUZXN0PjAuNSl7aWYoYnQpe2Rpc2NhcmQ7fWVsc2V7Z2xfRnJhZ0NvbG9yPXZlYzQodl9oaXRUZXN0Q29sb3VyLzI1NS4wLDEuMCk7fX1lbHNlIGlmKGJ1KXtkaXNjYXJkO31lbHNle3ZlYzQgUjtpZihicyl7Uj12ZWM0KHZfY29sb3VyLnJnYip2X2NvbG91ci5hLHZfY29sb3VyLmEpO1IqPWYodl9iYXJ5Y2VudHJpYy5hLHAodl9iYXJ5Y2VudHJpYy5yZ2IpKTt9ZWxzZXtpZihicil7Uj1iYShILEksSik7fWVsc2V7Uj1HKEgsSSxKKTt9fWdsX0ZyYWdDb2xvcj1SO319",Bf="cHJlY2lzaW9uIGhpZ2hwIGZsb2F0O2F0dHJpYnV0ZSB2ZWMyIGFfcG9zaXRpb24xO2F0dHJpYnV0ZSB2ZWMyIGFfcG9zaXRpb24yO2F0dHJpYnV0ZSB2ZWMyIGFfcG9zaXRpb24zO2F0dHJpYnV0ZSB2ZWM0IGFfdmVydGV4SW5mbzthdHRyaWJ1dGUgdmVjNCBhX2NvbG91cjthdHRyaWJ1dGUgdmVjNCBhX2NvbG91cjI7YXR0cmlidXRlIHZlYzMgYV9oaXRUZXN0Q29sb3VyO2F0dHJpYnV0ZSBmbG9hdCBhX2luZGV4O3VuaWZvcm0gZmxvYXQgdV9oaXRUZXN0O3VuaWZvcm0gdmVjMyB1X3Jlc29sdXRpb247dW5pZm9ybSBtYXQ0IHVfdHJhbnNmb3JtO3VuaWZvcm0gZmxvYXQgdV96b29tO3VuaWZvcm0gZmxvYXQgdV92aWV3SW5kZXBlbmRlbnQ7dmFyeWluZyB2ZWM0IHZfY29sb3VyO3ZhcnlpbmcgdmVjNCB2X2NvbG91cjI7dmFyeWluZyB2ZWM0IHZfY29yZTt2YXJ5aW5nIHZlYzMgdl9oaXRUZXN0Q29sb3VyO3ZhcnlpbmcgdmVjNCB2X2xpbmVEYXRhO3ZhcnlpbmcgdmVjNCB2X2JhcnljZW50cmljO3ZhcnlpbmcgdmVjNCB2X3Bvc2l0aW9uO3ZhcnlpbmcgdmVjMyB2X2Rhc2hpbmc7aW50IGE9MjtpbnQgYj0zO2ludCBjPTQ7aW50IGQoZmxvYXQgYSl7cmV0dXJuIGludChmbG9vcihhKzAuNSkpO31mbG9hdCBlKGZsb2F0IGYsZmxvYXQgZyl7ZmxvYXQgaD1mLzIuMDtmbG9hdCBpPWZsb29yKCgoZytoKS8oZitoKSkrMC41KTtpZigoaSpmKT5nKXtpPTEuMDt9cmV0dXJuIGk7fXZvaWQgbWFpbigpe2Zsb2F0IGo9MS4wL3VfcmVzb2x1dGlvbi56O3ZlYzQgaztpbnQgbD1kKGFfdmVydGV4SW5mby53KTtib29sIG09bD09YTtib29sIG49bD09Yjtib29sIG89bD09Yzt2ZWMyIHA7ZmxvYXQgcTtmbG9hdCByO2s9YV9jb2xvdXI7aWYobyl7aW50IHM9aW50KGFfaW5kZXgpO3ZlYzIgdD1hX3Bvc2l0aW9uMTt2ZWMyIHU9YV9wb3NpdGlvbjI7dmVjMiB2PWFfcG9zaXRpb24zO2Zsb2F0IHc9ZGlzdGFuY2UodSx2KTtmbG9hdCB4PXcvdV96b29tO3I9MS4wL3g7dmVjMiB5O2lmKHM9PTApe3A9dDt5PSh1K3YpLzIuMDt9ZWxzZSBpZihzPT0xKXtwPXU7eT0odCt2KS8yLjA7fWVsc2UgaWYocz09Mil7cD12O3k9KHUrdCkvMi4wO312ZWMyIHo9bm9ybWFsaXplKHAteSk7cCs9ei91X3pvb207dl9saW5lRGF0YT12ZWM0KDAuMCwwLjAsMC4wLGFfdmVydGV4SW5mby53KTt9ZWxzZXtmbG9hdCBBPTEuMC91X3pvb207aWYodV9oaXRUZXN0PT0xLjApe0E9Ny4wL3Vfem9vbTt9aWYobil7aj1tYXgoaixzdGVwKDIuNSxhX3ZlcnRleEluZm8udykqMi4wKTt9dmVjMiBCPW5vcm1hbGl6ZShhX3Bvc2l0aW9uMi1hX3Bvc2l0aW9uMSk7dmVjMiBDPUIvdV96b29tO2Zsb2F0IEQ9YV92ZXJ0ZXhJbmZvLnktMS4wO2Zsb2F0IEU9YV92ZXJ0ZXhJbmZvLngrYV92ZXJ0ZXhJbmZvLno7dmVjMiBGPWFfcG9zaXRpb24yLWFfcG9zaXRpb24xO3ZlYzIgRz1ub3JtYWxpemUodmVjMigtRi55LEYueCkpO2lmKGludChhX3ZlcnRleEluZm8ueCk9PTApe3A9YV9wb3NpdGlvbjEtQzt9ZWxzZXtwPWFfcG9zaXRpb24yK0M7fWZsb2F0IEg9YV9wb3NpdGlvbjMueDtpZihpbnQodV92aWV3SW5kZXBlbmRlbnQpPT0wKXtIPW1heCgoSCkqdV96b29tLGopL3Vfem9vbTt9ZmxvYXQgST1IK0E7dmVjMiBKPUcqKEkvMi4wKSpEO3A9cCtKO2Zsb2F0IEs9ZGlzdGFuY2UoYV9wb3NpdGlvbjEsYV9wb3NpdGlvbjIpO2Zsb2F0IEw9Syp1X3pvb207ZmxvYXQgTT0oMS4wL0spL3Vfem9vbTtpZihuKXtmbG9hdCBOPUwvNC4wO2Zsb2F0IE89Sy8oSCoyLjApO2Zsb2F0IFA9bWluKE4sTyk7dl9jb3JlPXZlYzQoRSxjZWlsKFApLE0sMC4wKTt2X2Rhc2hpbmc9dmVjMyhILEgsMC41KTt9ZWxzZSBpZihtKXtmbG9hdCBmPW1heCgyLjAvdV96b29tLEgqMi4wKTtmbG9hdCBRPWUoZixLKTtmbG9hdCBoPShLLWYqUSkvKFEtMS4wKTtmbG9hdCBSPWgqUS8oSytoKTt2X2NvcmU9dmVjNChFLFEtUixNLDAuMCk7ZmxvYXQgUz0oZi8oZitoKSkvMi4wO3ZfZGFzaGluZz12ZWMzKGYsaCxTKTt9ZWxzZXt2X2NvcmU9dmVjNChFLDAuMCxNLDAuMCk7fWlmKGludChEKT09MSl7dl9saW5lRGF0YT12ZWM0KC1JLEgsSyxhX3ZlcnRleEluZm8udyk7fWVsc2V7dl9saW5lRGF0YT12ZWM0KEksSCxLLGFfdmVydGV4SW5mby53KTt9fXZlYzIgVD1wL3VfcmVzb2x1dGlvbi54eTt2ZWMyIFU9VCoyLjA7dmVjMiBWPVUtMS4wO2svPTI1NS4wO3ZfY29sb3VyPWs7dl9jb2xvdXIyPWFfY29sb3VyMi8yNTUuMDt2X2hpdFRlc3RDb2xvdXI9YV9oaXRUZXN0Q29sb3VyO3ZfYmFyeWNlbnRyaWM9dmVjNChhX3ZlcnRleEluZm8ueHl6LHIpO2dsX1Bvc2l0aW9uPXVfdHJhbnNmb3JtKnZlYzQoVip2ZWMyKDEsLTEpLDAsMSk7fQ==",Zf="CiNpZmRlZiBHTF9PRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMKCiNleHRlbnNpb24gR0xfT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIDogZW5hYmxlCgojZW5kaWYKcHJlY2lzaW9uIGhpZ2hwIGZsb2F0O3VuaWZvcm0gc2FtcGxlcjJEIHVfaW1hZ2VbOF07dW5pZm9ybSBsb3dwIGZsb2F0IHVfaGl0VGVzdDt1bmlmb3JtIHZlYzMgdV9yZXNvbHV0aW9uO3VuaWZvcm0gZmxvYXQgdV9zaGFkb3dUeXBlO3VuaWZvcm0gZmxvYXQgdV96b29tO3ZhcnlpbmcgdmVjNCB2X3RleENvb3JkO3ZhcnlpbmcgdmVjNCB2X2NvbG91cjt2YXJ5aW5nIHZlYzMgdl9oaXRUZXN0Q29sb3VyO3ZhcnlpbmcgdmVjMiB2X3RleHR1cmVCYW5rO3ZhcnlpbmcgZmxvYXQgdl9ib3JkZXJXaWR0aDt2YXJ5aW5nIHZlYzIgdl9zaGFwZVNpemU7dmFyeWluZyBmbG9hdCB2X3BpeGVsO3ZhcnlpbmcgdmVjMiB2X2RvbnV0U2VnbWVudDtjb25zdCBmbG9hdCBhPTMuMTQxNTkyNjUzNTg5NzkzMjM4NDYyNjQzMzgzMjc5NTtmbG9hdCBiKGZsb2F0IGMsZmxvYXQgZCl7ZmxvYXQgZT1sZW5ndGgodmVjMihkRmR4KGQpLGRGZHkoZCkpKSowLjcwNzEwNjc4MTE4NjU0NzU3O3JldHVybiBzbW9vdGhzdGVwKGMtZSxjK2UsZCk7fWludCBmKGZsb2F0IGEpe3JldHVybiBpbnQoZmxvb3IoYSswLjUpKTt9ZmxvYXQgZyhmbG9hdCBoKXtmbG9hdCBpPTEuMC1zdGVwKDEuMCxoKnVfem9vbSk7ZmxvYXQgaj0oMS4wL3Vfem9vbSk7cmV0dXJuIG1heChoLGkqaik7fWZsb2F0IGsoZmxvYXQgaCl7ZmxvYXQgbD1iKHZfdGV4Q29vcmQueCxoKTtmbG9hdCBtPWIodl90ZXhDb29yZC55LGgpO2Zsb2F0IG49Yih2X3RleENvb3JkLnotdl90ZXhDb29yZC54LGgpO2Zsb2F0IG89Yih2X3RleENvb3JkLnctdl90ZXhDb29yZC55LGgpO2Zsb2F0IHA9bWF4KGwsbSk7ZmxvYXQgcT1tYXgobixvKTtyZXR1cm4gbWF4KHAscSk7fWZsb2F0IHIodmVjMyBzKXt2ZWMzIHQ9ZndpZHRoKHMpO3ZlYzMgdT1zbW9vdGhzdGVwKHZlYzMoMC4wKSx0KjMuMCxzKTtyZXR1cm4gbWluKG1pbih1LngsdS55KSx1LnopO31mbG9hdCB2KGZsb2F0IHcsdmVjNCB4KXtmbG9hdCB5O2ludCB6PWYodyk7aWYoej09MCl7eT14LnI7fWVsc2UgaWYoej09MSl7eT14Lmc7fWVsc2V7eT14LmI7fXJldHVybiB5O312ZWM0IEEoZmxvYXQgQix2ZWM0IEMsZmxvYXQgRCl7ZmxvYXQgRT0oQy5yK0MuYitDLmcpLzMuMDtmbG9hdCBGPXN0ZXAoMS4wLEUpKkQ7ZmxvYXQgRz1GKihzdGVwKDAuMjUsQikqbWluKEUsMC4yNSkpO3ZlYzQgSD12ZWM0KChDLnJnYitHKSpDLmEsQy5hKTtyZXR1cm4gQipIO31mbG9hdCBJKHZlYzIgSixmbG9hdCBLLGZsb2F0IEwsZmxvYXQgaCxmbG9hdCBNKXtNPW1heCgwLjAsTS1oKTtmbG9hdCBOPUsvMi4wO2Zsb2F0IE89TC8yLjA7ZmxvYXQgYT1OLU0taDtmbG9hdCBiPU8tTS1oO2Zsb2F0IHg9Si54LU47ZmxvYXQgeT1KLnktTztmbG9hdCBQPXBvdyhtYXgoYWJzKHgpLWEsMC4wKSwyLjApO2Zsb2F0IFE9cG93KG1heChhYnMoeSktYiwwLjApLDIuMCk7cmV0dXJuIFArUTt9ZmxvYXQgUihmbG9hdCBTKXtyZXR1cm4gKGRpc3RhbmNlKHZfdGV4Q29vcmQuencsdmVjMigwLjUpKSpTKSp1X3pvb207fXZlYzQgVCh2ZWM0IEgsZmxvYXQgVSxmbG9hdCBNKXtmbG9hdCBWPXBvdyhNLDIuMCk7ZmxvYXQgVz1JKHZfdGV4Q29vcmQueHksdl90ZXhDb29yZC56LHZfdGV4Q29vcmQudywwLjAsTSk7aWYoYWJzKHZfYm9yZGVyV2lkdGgpPjAuMCl7SCo9MS4wLWIoVixXKTtXPUkodl90ZXhDb29yZC54eSx2X3RleENvb3JkLnosdl90ZXhDb29yZC53LHZfYm9yZGVyV2lkdGgsTSk7ZmxvYXQgWD1tYXgoMC4wLE0tdl9ib3JkZXJXaWR0aCk7ZmxvYXQgWT1wb3coWCwyLjApO0gqPWIoWSxXKTt9ZWxzZXtIKj0xLjAtYihWLFcpO31yZXR1cm4gSDt9dmVjNCBaKHZlYzQgYmEsdmVjNCBiYixmbG9hdCBEKXtmbG9hdCBCPXYodl90ZXh0dXJlQmFuay55LGJhKTtyZXR1cm4gQShCLGJiLEQpO31mbG9hdCBiYyhmbG9hdCBiZCl7cmV0dXJuIG1heCgwLjIsc21vb3Roc3RlcCgwLjAsNS4wLGJkKSk7fXZvaWQgbWFpbigpe2Zsb2F0IGJlPWFicyh2X3NoYXBlU2l6ZS54KTtmbG9hdCBiZj12X3NoYXBlU2l6ZS55O2Zsb2F0IGJnPW1pbihiZSxiZik7ZmxvYXQgYmQ9KChiZy8yLjApKnVfem9vbSktMC41O2Zsb2F0IGg9YWJzKHZfYm9yZGVyV2lkdGgpO3ZlYzQgSDtpbnQgYmg9Zih1X3NoYWRvd1R5cGUpO2Jvb2wgYmk9Zih2X3NoYXBlU2l6ZS54KT4wO2Jvb2wgYmo9Zih2X2JvcmRlcldpZHRoKTwwO2Jvb2wgYms9Ymg9PTE7Ym9vbCBibD1mKHVfaGl0VGVzdCk9PTE7dmVjMiBibT12X3RleENvb3JkLnp3O2Zsb2F0IGJuPXZfZG9udXRTZWdtZW50Lng7ZmxvYXQgYm89dl9kb251dFNlZ21lbnQueTtmbG9hdCBNPXZfZG9udXRTZWdtZW50Lng7ZmxvYXQgVTtpbnQgdz1mKHZfdGV4dHVyZUJhbmsueCk7Ym9vbCBicD12X2JvcmRlcldpZHRoPjAuMCYmZih2X3NoYXBlU2l6ZS54KTwwO2Jvb2wgYnE9dz09LTM7Ym9vbCBicj1ibiE9MC4wfHxibyE9MC4wO2Zsb2F0IGJzO2lmKGJyfHxiail7aWYoYm4+YSl7Ym4tPTIuMCphO31pZihibz5hKXtiby09Mi4wKmE7fWZsb2F0IHg9Ym0ueC0wLjU7ZmxvYXQgeT1ibS55LTAuNTticz1hdGFuKHkseCk7fWlmKGJsKXtpZihiaD09LTEpe2Rpc2NhcmQ7fWVsc2V7SD12ZWM0KHZfaGl0VGVzdENvbG91ci8yNTUuMCwxLjApO2lmKGJpKXtmbG9hdCBidD1SKGJlKTtIKj0xLjAtc3RlcChiZCxidCk7aWYoaD4wLjApe2Zsb2F0IGJ1PWgqdV96b29tO0gqPXN0ZXAoYmQtYnUsYnQpO31pZihicil7aWYoYm4+PWJvKXtIKj1zdGVwKGJuLGJzKSsoMS4wLXN0ZXAoYm8sYnMpKTt9ZWxzZXtIKj1zdGVwKGJuLGJzKTtIKj0xLjAtc3RlcChibyxicyk7fX19ZWxzZSBpZih2X2RvbnV0U2VnbWVudC54PjAuMCl7VT1nKGgpO2Zsb2F0IGJ2PXBvdyhNLDIuMCk7ZmxvYXQgYnc9SSh2X3RleENvb3JkLnh5LHZfdGV4Q29vcmQueix2X3RleENvb3JkLncsMC4wLE0pO0gqPTEuMC1zdGVwKGJ2LGJ3KTt9ZWxzZSBpZihicCl7SCo9ayhoKTt9fX1lbHNlIGlmKGJrKXtkaXNjYXJkO31lbHNle0g9dl9jb2xvdXIvMjU1LjA7ZmxvYXQgYng9SC5hO2lmKHc+PTApe3ZlYzQgeDtmbG9hdCBieT0tMi4wLzMuMDtmbG9hdCBiej0tMC44O2lmKHc9PTApe3g9dGV4dHVyZTJEKHVfaW1hZ2VbMF0sdl90ZXhDb29yZC54eSxieik7SD1aKHgsSCwxLjApO31lbHNlIGlmKHc9PTEpe3g9dGV4dHVyZTJEKHVfaW1hZ2VbMV0sdl90ZXhDb29yZC54eSxieik7SD1aKHgsSCwxLjApO31lbHNlIGlmKHc9PTIpe3g9dGV4dHVyZTJEKHVfaW1hZ2VbMl0sdl90ZXhDb29yZC54eSxieik7SD1aKHgsSCwxLjApO31lbHNlIGlmKHc9PTMpe3g9dGV4dHVyZTJEKHVfaW1hZ2VbM10sdl90ZXhDb29yZC54eSxieSk7SD1aKHgsSCwwLjApO31lbHNlIGlmKHc9PTQpe0g9dGV4dHVyZTJEKHVfaW1hZ2VbNF0sdl90ZXhDb29yZC54eSxieSkqYng7fWVsc2UgaWYodz09NSl7SD10ZXh0dXJlMkQodV9pbWFnZVs1XSx2X3RleENvb3JkLnh5LGJ5KSpieDt9ZWxzZSBpZih3PT02KXtIPXRleHR1cmUyRCh1X2ltYWdlWzZdLHZfdGV4Q29vcmQueHksYnkpKmJ4O31lbHNlIGlmKHc9PTcpe0g9dGV4dHVyZTJEKHVfaW1hZ2VbN10sdl90ZXhDb29yZC54eSxieSkqYng7fX1lbHNle2Zsb2F0IGJ4PUguYTtIPXZlYzQoSC5yZ2IqYngsYngpO31pZihiaSl7ZmxvYXQgYnQ9UihiZSk7SCo9MS4wLWIoYmQsYnQpO2lmKGg+MC4wKXtmbG9hdCBidT1tYXgoMS4wLGgqdV96b29tKTtIKj1iKGJkLWJ1LGJ0KTtIKj1iYyhiZCk7fWZsb2F0IGJBPXZfcGl4ZWwqMS41O2Zsb2F0IGJCPWJuLWJBO2Zsb2F0IGJDPWJuK2JBO2Zsb2F0IGJEPWJvLWJBO2Zsb2F0IGJFPWJvK2JBO2lmKGJyKXtpZihibj49Ym8pe0gqPXNtb290aHN0ZXAoYkIsYkMsYnMpKygxLjAtc21vb3Roc3RlcChiRCxiRSxicykpO31lbHNle0gqPXNtb290aHN0ZXAoYkIsYkMsYnMpO0gqPTEuMC1zbW9vdGhzdGVwKGJELGJFLGJzKTt9fWVsc2UgaWYoYmope2Zsb2F0IGJGPWgqMi4wO2Zsb2F0IGJHPWJGLzIuMDtmbG9hdCBiSD0yLjAqKGEqKGJlLzIuMCkpO2Zsb2F0IGJJPWJzLygyLjAqYSk7ZmxvYXQgYko9Zmxvb3IoKGJIK2JHKS8oYkYrYkcpLTEuMCk7ZmxvYXQgYks9c2luKCgoYkkqYkopKSooMi4wKmEpKTtIKj1iKC0wLjUsYkspO319ZWxzZSBpZih2X2RvbnV0U2VnbWVudC54PjAuMCl7VT1nKGgpO0g9VChILFUsTSk7fWVsc2UgaWYoYnApe1U9ZyhoKTtIKj1rKFUpO0gqPWJjKGJkKTtpZihicSl7ZmxvYXQgYkY9VSoyLjA7ZmxvYXQgYkc9VTtmbG9hdCBiSj1mbG9vcigodl90ZXhDb29yZC56K2JHKS8oYkYrYkcpKSswLjU7ZmxvYXQgYks9c2luKCgoKHZfdGV4Q29vcmQueC92X3RleENvb3JkLnopKmJKKSkqKDIuMCphKSk7SCo9c3RlcCgtMC40OSxiSyk7Yko9Zmxvb3IoKHZfdGV4Q29vcmQudytiRykvKGJGK2JHKSkrMC41O2JLPXNpbigoKCh2X3RleENvb3JkLnkvdl90ZXhDb29yZC53KSpiSikpKigyLjAqYSkpO0gqPWIoLTAuNDksYkspO319fWdsX0ZyYWdDb2xvcj1IO30=",Of="cHJlY2lzaW9uIGhpZ2hwIGZsb2F0O2F0dHJpYnV0ZSB2ZWMyIGFfcG9zaXRpb247YXR0cmlidXRlIHZlYzQgYV90ZXhDb29yZDthdHRyaWJ1dGUgdmVjMyBhX2hpdFRlc3RDb2xvdXI7YXR0cmlidXRlIGZsb2F0IGFfdmVydGV4SW5kZXg7YXR0cmlidXRlIHZlYzIgYV90ZXh0dXJlQmFuazthdHRyaWJ1dGUgdmVjNCBhX2NvbG91cjthdHRyaWJ1dGUgZmxvYXQgYV9jaXJjbGVSYWRpdXM7YXR0cmlidXRlIGZsb2F0IGFfd2lkdGg7YXR0cmlidXRlIGZsb2F0IGFfc3RhcnRBbmdsZTthdHRyaWJ1dGUgZmxvYXQgYV9lbmRBbmdsZTt1bmlmb3JtIHZlYzMgdV9yZXNvbHV0aW9uO3VuaWZvcm0gbWF0NCB1X3RyYW5zZm9ybTt1bmlmb3JtIGZsb2F0IHVfem9vbTt1bmlmb3JtIGxvd3AgZmxvYXQgdV9oaXRUZXN0O3ZhcnlpbmcgZmxvYXQgdl9ib3JkZXJXaWR0aDt2YXJ5aW5nIHZlYzIgdl9zaGFwZVNpemU7dmFyeWluZyB2ZWM0IHZfdGV4Q29vcmQ7dmFyeWluZyB2ZWM0IHZfY29sb3VyO3ZhcnlpbmcgdmVjMyB2X2hpdFRlc3RDb2xvdXI7dmFyeWluZyB2ZWMyIHZfdGV4dHVyZUJhbms7dmFyeWluZyBmbG9hdCB2X3BpeGVsO3ZhcnlpbmcgdmVjMiB2X2RvbnV0U2VnbWVudDtpbnQgYShmbG9hdCBhKXtyZXR1cm4gaW50KGZsb29yKGErMC41KSk7fXZlYzIgYih2ZWMyIGEpe3JldHVybiBmbG9vcihhKzAuNSk7fXZlYzIgYyh2ZWMyIGQpe3ZlYzIgZT1kL3VfcmVzb2x1dGlvbi54eTt2ZWMyIGY9ZSoyLjA7cmV0dXJuIGYtMS4wO312ZWMyIGcodmVjMiBkKXtkKz0xLjA7ZC89Mi4wO3JldHVybiBkKnVfcmVzb2x1dGlvbi54eTt9dmVjMiBoKGludCBpLGZsb2F0IGope3ZlYzIgaztpZihpPT0wKXtrPW5vcm1hbGl6ZSh2ZWMyKC0xLjAsLTEuMCkpO31lbHNlIGlmKGk9PTEpe2s9bm9ybWFsaXplKHZlYzIoMS4wLC0xLjApKTt9ZWxzZSBpZihpPT0yKXtrPW5vcm1hbGl6ZSh2ZWMyKC0xLjAsMS4wKSk7fWVsc2UgaWYoaT09Myl7az1ub3JtYWxpemUodmVjMigxLjAsMS4wKSk7fXJldHVybiBrKmxlbmd0aCh2ZWMyKGopKTt9dm9pZCBtYWluKCl7Ym9vbCBsPWEodV9oaXRUZXN0KT09MTtib29sIG09YV9jaXJjbGVSYWRpdXM+MC4wO2ludCBuPWEoYV90ZXh0dXJlQmFuay54KTtmbG9hdCBvPTAuMDtib29sIHA9ZmFsc2U7dmVjMiBxPWFfcG9zaXRpb24ueHk7ZmxvYXQgcjtmbG9hdCBzO3ZlYzIgaztpbnQgaT1hKGFfdmVydGV4SW5kZXgpO2lmKG0pe3I9YWJzKGFfY2lyY2xlUmFkaXVzKTtzPXI7fWVsc2V7cj1hX3RleENvb3JkLnovMi4wO3M9YV90ZXhDb29yZC53LzIuMDt9ZmxvYXQgdD0wLjA7aWYobj4zKXt0PWFfd2lkdGg7cSs9aChpLHQvdV96b29tKTt9ZWxzZXtvPWFicyhhX3dpZHRoKTtwPWEobyk+MDt9ZmxvYXQgdT1jZWlsKG8vMi4wKTtpZihwKXtpZihsKXtmbG9hdCB2PSg3LjAvdV96b29tKSpzaWduKGFfd2lkdGgpO28rPXY7dSs9Y2VpbCh2LzIuMCk7fXErPWgoaSx1KTt9aWYobCl7cSo9MS4wLXN0ZXAoYV9oaXRUZXN0Q29sb3VyLngrYV9oaXRUZXN0Q29sb3VyLnkrYV9oaXRUZXN0Q29sb3VyLnosMC4wKTt9Z2xfUG9zaXRpb249dV90cmFuc2Zvcm0qdmVjNChjKHEpKnZlYzIoMSwtMSksMCwxKTtpZihwJiYhbSl7dmVjMiB3PWdsX1Bvc2l0aW9uLnh5O3c9Zyh3KTt3PWIodyk7Z2xfUG9zaXRpb24ueHk9Yyh3KTt9dl90ZXhDb29yZD1hX3RleENvb3JkO3ZfY29sb3VyPWFfY29sb3VyO3ZfaGl0VGVzdENvbG91cj1hX2hpdFRlc3RDb2xvdXI7dl90ZXh0dXJlQmFuaz1hX3RleHR1cmVCYW5rO2Zsb2F0IHg9dSpzaWduKGFfY2lyY2xlUmFkaXVzKTtpZihtKXtmbG9hdCB5PShhX2NpcmNsZVJhZGl1cyt4KSoyLjA7dl9zaGFwZVNpemU9dmVjMih5KTt9ZWxzZXt2X3NoYXBlU2l6ZT12ZWMyKC1hX3RleENvb3JkLnoreCxhX3RleENvb3JkLncteCk7fXZfYm9yZGVyV2lkdGg9bypzaWduKGFfd2lkdGgpO3ZfcGl4ZWw9KDEuMC8oYV9jaXJjbGVSYWRpdXMqMi4wKSkvdV96b29tO3ZfZG9udXRTZWdtZW50PXZlYzIoYV9zdGFydEFuZ2xlLGFfZW5kQW5nbGUpO30=",Gf="CiNpZmRlZiBHTF9PRVNfc3RhbmRhcmRfZGVyaXZhdGl2ZXMKCiNleHRlbnNpb24gR0xfT0VTX3N0YW5kYXJkX2Rlcml2YXRpdmVzIDogZW5hYmxlCgojZW5kaWYKcHJlY2lzaW9uIGhpZ2hwIGZsb2F0O3VuaWZvcm0gc2FtcGxlcjJEIHVfaW1hZ2U7dW5pZm9ybSBmbG9hdCB1X2dsb2JhbEFscGhhO3VuaWZvcm0gdmVjNCB1X2JhY2tncm91bmRDb2xvdXI7dmFyeWluZyB2ZWMyIHZfdGV4Q29vcmQ7dm9pZCBtYWluKCl7Z2xfRnJhZ0NvbG9yPSh0ZXh0dXJlMkQodV9pbWFnZSx2X3RleENvb3JkKSt1X2JhY2tncm91bmRDb2xvdXIpKnVfZ2xvYmFsQWxwaGE7fQ==",Ff="cHJlY2lzaW9uIGhpZ2hwIGZsb2F0O2F0dHJpYnV0ZSB2ZWMyIGFfcG9zaXRpb247YXR0cmlidXRlIHZlYzIgYV90ZXhDb29yZDt2YXJ5aW5nIHZlYzIgdl90ZXhDb29yZDt2b2lkIG1haW4oKXtnbF9Qb3NpdGlvbj12ZWM0KGFfcG9zaXRpb24sMC4wLDEuMCk7dl90ZXhDb29yZD1hX3RleENvb3JkO30=",Df={};Df["line-arc-vertex"]=Rf;Df["line-fragment"]=Lf;Df["line-vertex"]=Bf;Df["triangle-fragment"]=Zf;Df["triangle-vertex"]=Of;Df["renderToTexture-fragment"]=Gf;Df["renderToTexture-vertex"]=Ff;function zf(e,t){for(var n=["webgl","experimental-webgl"],r=null,i=0;i<n.length;i++){try{r=e.getContext(n[i],t)}catch(e){}if(r)break}return r}function Vf(e){return zf(document.createElement("canvas"),e)}function Yf(e,t,n){var r=Uf(e,[t,n]);r.vertexShader=t;r.fragmentShader=n;return r}function Pf(e,t){e.useProgram(t);e.bindBuffer(e.ARRAY_BUFFER,null);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);e.bindRenderbuffer(e.RENDERBUFFER,null);e.bindFramebuffer(e.FRAMEBUFFER,null)}function Wf(){var e={},t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),n=1;e.zoom=function(e){n=e;t[0]*=e;t[4]*=e;t[8]*=1;t[1]*=e;t[5]*=e;t[9]*=1;t[2]*=e;t[6]*=e;t[10]*=1;t[3]*=e;t[7]*=e;t[11]*=1};e.getZoomLevel=function(){return n};e.pan=function(e,n){t[12]+=t[0]*e+t[4]*n;t[13]+=t[1]*e+t[5]*n;t[14]+=t[2]*e+t[6]*n;t[15]+=t[3]*e+t[7]*n};e.get=function(){return t};return e}function Xf(e,t,n){var r=e.createShader(n),i=atob(Df[t]);e.shaderSource(r,i);e.compileShader(r);if(!e.getShaderParameter(r,e.COMPILE_STATUS)){var a=e.getShaderInfoLog(r);e.deleteShader(r);throw new Error("Error in shader: "+a)}return r}var Uf=function(e,t){for(var n=e.createProgram(),r=0;r<t.length;++r)e.attachShader(n,t[r]);e.linkProgram(n);if(!e.getProgramParameter(n,e.LINK_STATUS)){var i=e.getProgramInfoLog(n);e.deleteProgram(n);throw new Error("Error in program linking:"+i)}return n},Nf="undefined"!=typeof window,jf=!1,_f=!1;function Hf(){jf=!0}function Kf(e,t){return e.some(function(e){return t.indexOf(e)>-1})}function Qf(){if(_f)return!jf;if(Nf){var e,t="file:"!==document.location.protocol,n=["Google SwiftShader","Microsoft Basic Render Driver","VirtualBox","Parallels","VMware"],r=["VMware","VirtualBox"],i=["OES_standard_derivatives","OES_element_index_uint","ANGLE_instanced_arrays"],a=Vf({failIfMajorPerformanceCaveat:!0});if(t=t&&a){var o=a.getSupportedExtensions(),u={};for(e=0;e<o.length;e++)u[o[e]]=!0;for(e=0;t&&e<i.length;e++)t=t&&u[i[e]]}if(t){var s=a.getExtension("WEBGL_debug_renderer_info");if(s){var f=a.getParameter(s.UNMASKED_VENDOR_WEBGL),l=a.getParameter(s.UNMASKED_RENDERER_WEBGL);t=!(Kf(r,f)||Kf(n,l))}s=null}a=null;jf=jf||!t;_f=!0;return t}return!jf}var Jf={longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ampm:["AM","PM"],quarter:"Q",half:"H"},qf=[31,28,31,30,31,30,31,31,30,31,30,31],$f={milli:0,sec:1,min:2,hour:3,day:4,week:5,month:6,year:7},el=function(e,t){return t?e-e%t:0},tl=function(e){if(e<$f.milli||$f.year<e)throw new Error("bad unit range")},nl=function(e,t){return 1===e&&rl(t)?29:qf[e]},rl=function(e){return 1===new Date(e,1,29).getMonth()};function il(e){return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function al(e){var t=new Date(e);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}function ol(e,t,n){tl(t);var r=new Date(e);t>$f.milli&&r.setUTCMilliseconds(0);t>$f.sec&&r.setUTCSeconds(0);t>$f.min&&r.setUTCMinutes(0);t>$f.hour&&r.setUTCHours(0);t>=$f.month&&r.setUTCDate(1);t>=$f.year&&r.setUTCMonth(0);switch(t){case $f.milli:r.setUTCMilliseconds(el(r.getUTCMilliseconds(),n));break;case $f.sec:r.setUTCSeconds(el(r.getUTCSeconds(),n));break;case $f.min:r.setUTCMinutes(el(r.getUTCMinutes(),n));break;case $f.hour:r.setUTCHours(el(r.getUTCHours(),n));break;case $f.day:break;case $f.week:var i=r.getUTCDay(),a=i>=1?i-1:6;r.setTime(r.getTime()-24*a*60*60*1e3);break;case $f.month:r.setUTCMonth(el(r.getUTCMonth(),n));break;case $f.year:r.setUTCFullYear(el(r.getUTCFullYear(),n))}return r.getTime()}function ul(e,t,n){tl(t);if(t<=$f.week){var r=n;t>$f.milli&&(r*=1e3);t>$f.sec&&(r*=60);t>$f.min&&(r*=60);t>$f.hour&&(r*=24);t>$f.day&&(r*=7);return e+r}var i=new Date(e);switch(t){case $f.month:var a=i.getUTCMonth()+n,o=a%12,u=Math.floor(a/12);o<0&&(o+=12);var s=i.getUTCDate();s=Math.min(s,nl(o,i.getUTCFullYear()+u));i.setUTCDate(s);i.setUTCMonth(o);0!==u&&i.setTime(ul(i.getTime(),$f.year,u));break;case $f.year:if(1===i.getUTCMonth()&&29===i.getUTCDate()){var f=i.getUTCFullYear()+n;rl(f)||i.setTime(ul(i.getTime(),$f.day,-1))}i.setUTCFullYear(i.getUTCFullYear()+n)}return i.getTime()}var sl=function(e){for(var t=e+"";t.length<2;)t="0"+t;return t},fl=new RegExp("(f?f?f)|(s?s)|(m?m)|(h?h)|(H?H)|(t?t?t)|(d?d?d?d)|(M?M?M?M?M)|(Q?Q)|yyyy|yy","gm"),ll={f:function(e){return Math.floor(e.getUTCMilliseconds()/100)},ff:function(e){return sl(Math.floor(e.getUTCMilliseconds()/10))},fff:function(e){return sl(Math.floor(e.getUTCMilliseconds()))},s:function(e){return e.getUTCSeconds()},ss:function(e){return sl(e.getUTCSeconds())},m:function(e){return e.getUTCMinutes()},mm:function(e){return sl(e.getUTCMinutes())},h:function(e){return e.getUTCHours()%12||12},hh:function(e){return sl(e.getUTCHours()%12||12)},H:function(e){return e.getUTCHours()},HH:function(e){return sl(e.getUTCHours())},t:function(e,t){return t.ampm[Math.floor(e.getUTCHours()/12)].charAt(0)},tt:function(e,t){return t.ampm[Math.floor(e.getUTCHours()/12)]},ttt:function(e,t){var n=Math.floor(e.getUTCHours()/12);return t.ampm[n+2]||t.ampm[n]},d:function(e){return e.getUTCDate()},dd:function(e){return sl(e.getUTCDate())},ddd:function(e,t){return t.shortDays[e.getUTCDay()]},dddd:function(e,t){return t.longDays[e.getUTCDay()]},M:function(e){return e.getUTCMonth()+1},MM:function(e){return sl(e.getUTCMonth()+1)},MMM:function(e,t){return t.shortMonths[e.getUTCMonth()]},MMMM:function(e,t){return t.longMonths[e.getUTCMonth()]},MMMMM:function(e,t){return t.shortMonths[e.getUTCMonth()].substr(0,1)},Q:function(e,t){var n=e.getUTCMonth(),r=Math.floor(n/3)+1;return t.quarter+r},QQ:function(e,t){var n=e.getUTCMonth(),r=Math.floor(n/6)+1;return t.half+r},yyyy:function(e){return e.getUTCFullYear()},yy:function(e){return sl(e.getUTCFullYear()%100)}};function cl(e,t,n){var r="number"==typeof e?new Date(e):e;return t.replace(fl,function(e){return ll[e](r,n||Jf)})}var dl="(?::)?",hl="(?:-|$)";new RegExp("^(\\d{4})"+hl+"(\\d{2})?"+hl+"(\\d{2})?"+"(?:T|$)"+"(\\d{2})?"+dl+"(\\d{2})?"+dl+"(\\d{2})?(?:Z)?(\\+|-)?(\\d{2})?"+dl+"(\\d{2})?");function vl(){var e=$f,n={fontFamily:"sans-serif",fontSize:12},r={colours:["backColour","fontColour","sliderColour","sliderLineColour"]};function i(e,t){return cl(e,t,m.options.locale)}function a(t,n){var r=new Date(ul(t,e.year,n-1));return i(t,"yyyy - ")+i(r,"yyyy")}function u(e){return a(e,10)}function s(e){return a(e,50)}function f(e){return i(e,"yyyy")+"s"}function l(e){return i(e,"dmy"===m.options.locale.order?"d MMM yyyy":"MMM d, yyyy")}function c(e){return i(e,m.options.locale.h12?"h:mm tt":"HH:mm")}function d(e){return i(e,m.options.locale.h12?"h:mm:ss tt":"HH:mm:ss")}function h(e,t){if("histogram"===e){if(!x(t))return!1;if(t.colour&&!Pt(t.colour))return!1;if(t.highlightColour&&!Pt(t.highlightColour))return!1}return"minScale"===e?t:!Y(r.colours,e)||Pt(t)}function v(e,t){"fontFamily"===e&&(m.options.fontFamily=Ln(t)||n.fontFamily);"fontSize"===e&&g(+t)&&+t>0&&(m.options.fontSize=+t)}function p(e){e.showPlay?m.playingExtend=!1:e.showExtend?m.playingExtend=!1:m.playingExtend=null}var m={displayTime:function(e,t){return y(t)?t(e):i(e,t)},baseRangeLimits:{max:315576e7,min:3e3},options:{scale:{highlightColour:"#F2F2F2",showMajor:!0,showMinor:!0},backColour:"#FFFFFF",fontColour:Ot.grey,fontFamily:n.fontFamily,fontSize:n.fontSize,showControlBar:!0,showPlay:!0,showExtend:!1,showFit:!0,sliderColour:"rgba(255, 255, 255, 0.6)",sliderLineColour:"#bbb",sliders:"fixed",maxRange:"auto",minRange:3e3,minScale:{units:"sec",value:1},showSliders:!0,_showShadowCanvas:!1,histogram:{colour:"#d0d0d0",highlightColour:"#a9a9a9",markColour:"#ea7378",markHiColour:"#e03038"},heightChange:{animate:!0,time:200},locale:B(Jf,{order:"mdy",h12:!0}),playSpeed:60},getOptions:function(){return o(m.options,!0)},setOptions:function(e){if(x(e)){p(e);t(e,function(t,r){O(m.options,r)&&(n[r]?v(r,t):x(m.options[r])&&h(r,t)?m.options[r]=B(t,m.options[r]):m.options[r]=e[r])})}},hoverTime:50,defaultAnimationTime:200,sliderReleaseTime:200,doubleClickZoomTime:500,doubleClickZoomTimeFree:250,playingExtend:!1,defaultPlaySpeed:60,bars:{defaultFontFamily:n.fontFamily,defaultFontSize:n.fontSize,major:{height:19,textbase:3,tickHeight:10},minor:{height:17,textbase:0,tickHeight:8}},grip:{lines:2,space:4,length:14,margin:2},controlbar:{height:30,space:4,colour:"#ddd"},fixedSideFactor:.5,freeSideFactor:.2,histogram:{dy:2,topdy:16,bardx:1,minwidth:11},selection:{maxNumber:3,reducingFactor:.75,dotsize:3.5},rates:[{max:6,major:{units:e.sec,by:2,f:l},minor:{units:e.sec,by:1,f:d}},{max:15,major:{units:e.sec,by:5,f:l},minor:{units:e.sec,by:1,f:d}},{max:24,major:{units:e.sec,by:10,f:l},minor:{units:e.sec,by:2,f:d}},{max:60,major:{units:e.sec,by:15,f:l},minor:{units:e.sec,by:5,f:d}},{max:120,major:{units:e.sec,by:30,f:l},minor:{units:e.sec,by:10,f:d}},{max:360,major:{units:e.min,by:1,f:l},minor:{units:e.sec,by:30,f:d}},{max:1e3,major:{units:e.min,by:5,f:l},minor:{units:e.min,by:1,f:c}},{max:5e3,major:{units:e.min,by:15,f:l},minor:{units:e.min,by:5,f:c}},{max:15e3,major:{units:e.hour,by:1,f:l},minor:{units:e.min,by:15,f:c}},{max:6e4,major:{units:e.hour,by:6,f:l},minor:{units:e.hour,by:1,f:c}},{max:12e4,major:{units:e.day,by:1,f:l,adjust:432e5},minor:{units:e.hour,by:2,f:c}},{max:18e4,major:{units:e.day,by:1,f:l,adjust:432e5},minor:{units:e.hour,by:3,f:c}},{max:36e4,major:{units:e.day,
by:1,f:l},minor:{units:e.hour,by:6,f:c}},{max:72e4,major:{units:e.day,by:1,f:l},minor:{units:e.hour,by:12,f:"ttt"}},{max:5e6,major:{units:e.week,by:1,f:function(t){var n,r,a=new Date(t),o=new Date(ul(t,e.day,6)),u="dmy"===m.options.locale.order;if(a.getUTCFullYear()===o.getUTCFullYear())if(a.getUTCMonth()===o.getUTCMonth()){n=u?"d - ":"MMM d - ";r=u?"d MMM yyyy":"d, yyyy"}else{n=u?"d MMM - ":"MMM d - ";r=u?"d MMM yyyy":"MMM d, yyyy"}else{n=u?"d MMM yyyy - ":"MMM d, yyyy - ";r=u?"d MMM yyyy":"MMM d, yyyy"}return i(a,n)+i(o,r)}},minor:{units:e.day,by:1,f:"d"}},{max:15e6,major:{units:e.month,by:1,f:"MMMM yyyy"},minor:{units:e.week,by:1,f:function(t){var n=ul(t,e.day,6);return i(t,"d - ")+i(n,"d")}}},{max:3e7,major:{units:e.month,by:3,f:"Q  yyyy"},minor:{units:e.month,by:1,f:"MMMM"}},{max:75e6,major:{units:e.month,by:3,f:"Q  yyyy"},minor:{units:e.month,by:1,f:"MMM"}},{max:1e8,major:{units:e.month,by:3,f:"Q  yyyy"},minor:{units:e.month,by:1,f:"MMMMM"}},{max:2e8,major:{units:e.month,by:6,f:"QQ  yyyy"},minor:{units:e.month,by:1,f:"MMMMM"}},{max:36e7,major:{units:e.year,by:1,f:"yyyy"},minor:{units:e.month,by:3,f:"Q"}},{max:6e8,major:{units:e.year,by:1,f:"yyyy"},minor:{units:e.month,by:6,f:"QQ"}},{max:15e8,major:{units:e.year,by:10,f:u},minor:{units:e.year,by:1,f:"'yy"}},{max:25e8,major:{units:e.year,by:10,f:u},minor:{units:e.year,by:2,f:"'yy"}},{max:35e8,major:{units:e.year,by:10,f:u},minor:{units:e.year,by:5,f:"'yy"}},{max:115e8,major:{units:e.year,by:50,f:s},minor:{units:e.year,by:10,f:"'yy"}},{max:2e10,major:{units:e.year,by:50,f:s},minor:{units:e.year,by:25,f:"'yy"}},{max:35e9,major:{units:e.year,by:100,f:f},minor:{units:e.year,by:25,f:"'yy"}},{max:8e10,major:{units:e.year,by:100,f:f},minor:{units:e.year,by:50,f:"'yy"}},{max:16e10,major:{units:e.year,by:200,f:"yyyy"},minor:{units:e.year,by:100,f:""}},{max:4e11,major:{units:e.year,by:500,f:"yyyy"},minor:{units:e.year,by:100,f:""}},{max:1/0,major:{units:e.year,by:500,f:""},minor:{units:e.year,by:100,f:""}}]};return m}function gl(e,n){var r,i={},a=0,u=0,s=n.rates,f=[],l=[],c=[],d=[],h={t1:0,t2:0},v={t1:0,t2:0},p={},m={t1:0,t2:0},y=250,b={},w=[],A=[],M=null,I=[1,1e3,6e4,36e5,864e5,6048e5,2592e6,31536e6];function E(){e.privateTrigger("redraw")}function C(e){return e.t<=e.other}function k(e){return e.t>=e.other}function S(e,t,n,i){h.t1=e;h.t2=t;v.t1=n;v.t2=i;if(r){b=D(v);E()}le=!0}function T(e,t){return I[e.units]*e.by/t>=n.histogram.minwidth}i.fontSizeFactor=function(){return n.options.fontSize/n.bars.defaultFontSize};var L=i.fontSizeFactor;function B(e){for(var t=L(),n=0;s[n].max<e*t&&n<s.length;)n++;return n}function Z(e,t){for(var n=$f[e],r=0;r<s.length;r++){var i=s[r].minor;if(i.units>n||i.units===n&&i.by>=t)return r>0?r-1:r}return s.length-2}function F(){var e=0;if(Y()){var t=z(n.options.minScale);e=Z(t.units,t.value)}return e}function D(e){var t={},n=(e.t2-e.t1)/(r.x2-r.x1),i=B(n),a=F();i=i<=a?a+1:i;t.major=s[i].major;t.minor=s[i].minor;for(;i>0&&T(s[i-1].minor,n)&&i-1>a;)i--;t.histogram=s[i].minor;t.timeRate=n;return t}function z(e){return{units:O($f,e.units)?e.units:$f.sec,value:g(e.value)?Math.round(Math.abs(e.value)):1}}function V(e){return{units:O($f,e.units)?e.units:$f.sec,value:g(e.value)?Math.round(Math.abs(e.value)):n.baseRangeLimits.max}}function Y(){return n.options.minScale}function P(){return"auto"!==n.options.maxRange}function W(e){return n.options.sliders===e}function X(){var e,t=F(),r=s[t].max;if(W("fixed"))e=a/(1+n.freeSideFactor);else if(W("free")){r=1;var i=s[t+1].minor;e=I[i.units]*i.by}else e=a;return Math.round(r*e)}i.extractUTC=function(e){var t;e instanceof Date?t=il(e):"number"==typeof e&&(t=Math.round(e));return t};var N=i.extractUTC;function j(){M=null;for(var e=0;e<w.length;e++){A[e]=null;w[e]=null}A.length=0;w.length=0}function _(e){d=[];for(var t=0;t<e.length;t++){var n=e[t];if(x(n)){var r="dt1"in n,i="dt2"in n;if(!r&&!i)throw new Error("mark: TimePeriod object must have a dt1 or dt2 property.");var a=r?me(n.dt1):-1/0;if((i?me(n.dt2):1/0)<a)throw new Error("mark: TimePeriod dt2 time must be after dt1 time.")}d.push(o(n))}}function H(e){M=e;var t,r;for(t=0;t<e.length;t++){var i=e[t].index||0;if(i<n.selection.maxNumber&&e[t].id){var a=R(e[t].id);if(a.length){w[i]=U(a);A[i]={startTotals:[],endTotals:[]};var o=0,u=0;for(r=0;r<f.length;r++){var s=f[r];A[i].startTotals[r]=o;A[i].endTotals[r]=u;if(s.id in w[i]){C(s)&&(o+=s.v);k(s)&&(u+=s.v)}}A[i].startTotals[r]=o;A[i].endTotals[r]=u;K(i,e[t].c)}else if(!a.length&&A[i]){A[i]=null;w[i]=null}}}}function K(e,t){var r={colour0:"rgb(114, 179, 0)",colour1:"rgb(255, 153, 0)",colour2:"rgb(178, 38, 9)"}["colour"+e];t&&Pt(t)&&(r=t);n.selection["colour"+e]=r}function Q(e){for(var t=0,n=f.length;t<n;){var r=Math.floor((t+n)/2),i=f[r].t;i!==e||C(f[r])||i--;i<e?t=r+1:n=r}return t}i.ttox=function(e){return r.x1+(e-v.t1)/he()};var J=i.ttox;i.xtot=function(e){return v.t1+(e-r.x1)*he()};var q=i.xtot;i.getClickedBar=function(e){return e>=r.bars.major.y1?"major":e>=r.bars.minor.y1?"minor":"histogram"};var $=i.getClickedBar;i.findRange=function(e,t,n){var r,i=n||$(t),a=q(e);se(i,function(e,t){if(t>a){r={t1:e,t2:t,bar:i};return!0}return!1});return r};function ee(e,n){var r,i,a=Q(e),o=Q(n),u={},s={};for(r=0;r<a;r++)(i=f[r]).t!==i.other&&(s[i.id]=(s[i.id]||0)+(i.t<i.other?1:-1));t(s,function(e,t){e>0&&(u[t]=!0)});for(r=a;r<o;r++)u[f[r].id]=!0;return Object.keys(u)}function te(e,t,n,r){for(var i=Q(e),a=Q(t),o=i;o<a;o++){var u=f[o];if(n?C(u):k(u)){var s=u.id;p[s]=(p[s]||0)+r}}}function ne(){var e=h.t1,t=h.t2,n=m.t1,r=m.t2;e<n?te(e,n,!1,1):e>n&&te(n,e,!1,-1);t>r?te(r,t,!0,1):t<r&&te(t,r,!0,-1);m.t1=e;m.t2=t}function ie(){var e=ue(),t=e?2*(e.t2-e.t1):n.baseRangeLimits.max,r=n.baseRangeLimits.min;Y()?r=X():n.options.minRange&&(r=Math.max(r,n.options.minRange));if(P()){var i=V(n.options.maxRange),a=$f[i.units];t=i.value*I[a]}else t=Math.max(t,Math.floor(4*r));return{max:t,min:r=Math.min(r,Math.floor(t/4))}}function oe(){var e=0,t=a,i=n.options.showControlBar?n.controlbar.height:0,o=L(),s=n.options.scale.showMinor?n.bars.minor.height*o:0,f=n.options.scale.showMajor?n.bars.major.height*o:0,l=u-i,c=l-f,d=c-s,h=d-n.histogram.dy,v=h-n.histogram.topdy,g=v*n.selection.reducingFactor;r={bars:{major:{y1:c,y2:l},minor:{y1:d,y2:c}},histogram:{ybase:h,maxbarh:v,maxselh:g},x1:e,y1:d,x2:t,y2:l,width:a,height:u}}i.dataRange=function(){if(f.length>0){for(var e=0;f[e].t===-1/0;)e++;for(var t=f[e].t,n=f.length-1;f[n].t===1/0;)n--;return{t1:t,t2:f[n].t+1}}};var ue=i.dataRange;i.eachTick=function(e,t){var n,r=b[e],i=ol(v.t1,r.units,r.by),a=!1;do{a=t(i,n=ul(i,r.units,r.by),J(i),J(n),r.f);i=n}while(!a&&i<=v.t2)};var se=i.eachTick,fe={count:0,x:[],marks:[],value:[],hasSel:[],selvalues:[],maxvalue:0,maxselvalue:0},le=!0;function ce(){var e,t,r,i=n.selection.maxNumber,a=b.histogram,o=ol(v.t1,a.units,a.by),u=Q(o),s=0,f=0,d=0;fe.marks=[];for(t=0;t<i;t++){fe.hasSel[t]=!!A[t];fe.selvalues[t]=fe.selvalues[t]||[]}do{r=o>v.t2;fe.x[s]=J(o);var h=o;e=Q(o=ul(o,a.units,a.by));var g=l[e]-c[u];fe.value[s]=g;var p=de(h,o);fe.marks[s]=p;g>f&&!r&&(f=g);for(t=0;t<i;t++){var m=A[t];if(m){var y=m.startTotals[e]-m.endTotals[u];fe.selvalues[t][s]=y;y>d&&!r&&(d=y)}}s++;u=e}while(!r);fe.count=s-1;fe.maxvalue=f;fe.maxselvalue=d;le=!1}var de=function(e,t){return d.some(function(n){if(x(n)){if(!G(n.dt1)&&!G(n.dt2)){var r=N(n.dt1),i=N(n.dt2);if(r<t&&i>e)return!0}}else{var a=N(n);if(a>=e&&a<t)return!0}return!1})};i.getHistogram=function(){le&&ce();return fe};i.getBounds=function(){return r};i.getInnerRange=function(){return h};i.getOuterRange=function(){return v};i.getTimeRate=function(){return b.timeRate};var he=i.getTimeRate;i.nextPage=function(e){var t=h.t1,n=h.t2,r="back"===e?-1:1,i=$f.month;if(t===ol(t,i,1)&&n===ol(n,i,1)){var a=new Date(t),o=new Date(n),u=12*(o.getUTCFullYear()-a.getUTCFullYear())+(o.getUTCMonth()-a.getUTCMonth());t=ul(t,i,r*u);n=ul(n,i,r*u)}else{var s=r*(n-t);t+=s;n+=s}return{t1:t,t2:n}};i.privateGetItems=function(){return f};function ve(t){var r=ue();r&&h.t1>=r.t1&&t<=r.t1&&!n.playingExtend&&e.trigger("start","data")}function ge(t){var n=ue();n&&h.t2<=n.t2&&t>=n.t2&&e.trigger("end","data")}i.setInnerRangeSide=function(e,t){"t1"===e?ve(t):ge(t);h[e]=t};i.getSideLimits=function(e){var t,n;if("t1"===e){t=v.t1;n=h.t2}else{t=h.t1;n=v.t2}if(W("fixed")){var r=n-t,i=Math.floor(.1*r);t+=i;n-=i}var a=ie();if("t1"===e){t=Math.max(t,h.t2-a.max);n=Math.min(n,h.t2-a.min)}else{t=Math.max(t,h.t1+a.min);n=Math.min(n,h.t1+a.max)}var o=ue();o&&("t1"===e?n=Math.min(n,o.t2):t=Math.max(t,o.t1));return{min:t,max:n}};i.hasItems=function(){return f.length>0};i.limitInnerRange=function(e,t,n){var r,i=e,a=t,o=ue(),u=n?(i+a)/2:(h.t1+h.t2)/2,s=ie(),f=a-i;if(f>s.max){i=Math.ceil(u-s.max/2);a=Math.floor(u+s.max/2)}else if(f<s.min){i=Math.floor(u-s.min/2);a=Math.ceil(u+s.min/2)}if(o)if(a<o.t1){i+=r=o.t1-a;a+=r}else if(i>o.t2){i-=r=i-o.t2;a-=r}return{t1:i,t2:a}};var pe=i.limitInnerRange;i.inMainBarOrHistogram=function(e,t){return e>=r.x1&&e<=r.x2&&t>=0&&t<=r.y2};function me(e){var t=N(e);if(!g(t))throw new Error("load: invalid date in dt property. Value was: "+e);return t}function ye(e){for(var t=[],n=R(e),r=0;r<n.length;r++){var i=n[r];if(i.id&&i.dt)for(var a=i.id+"",o=R(i.dt),u=R(i.v),s=0;s<o.length;s++){var f=o[s],l=u[s]||1;if(!g(l))throw new Error("load: invalid value in v property - must be numeric. Value was: "+l);if("object"!=typeof f||f instanceof Date){var c=me(f);t.push({id:a,t:c,v:l,other:c})}else{var d="dt1"in f,h="dt2"in f;if(!d&&!h)throw new Error("load: TimePeriod object must have a dt1 or dt2 property. Id was: "+a);var v=d?me(f.dt1):-1/0,p=h?me(f.dt2):1/0;if(p<v)throw new Error("load: TimePeriod dt2 time must be after dt1 time. Id was: "+a);t.push({id:a,t:v,v:l,other:p});p!==v&&t.push({id:a,t:p,v:l,other:v})}}}return t.sort(we)}function be(){l=[0];c=[0];p={};le=!0;for(var e=0;e<f.length;e++){var t=f[e],n=0,r=C(t),a=k(t);r&&t.t<h.t2&&(n=1);a&&t.t<h.t1&&(n-=1);0!==n&&(p[t.id]=(p[t.id]||0)+n);l[e+1]=l[e]+(r?t.v:0);c[e+1]=c[e]+(a?t.v:0)}m.t1=h.t1;m.t2=h.t2;var o=i.limitInnerRange(m.t1,m.t2,!0);E();return o}function xe(e,t){return e===t?0:e===1/0||t===-1/0?1:e===-1/0||t===1/0?-1:e-t}function we(e,t){var n=e.t===t.t?xe(e.other,t.other):xe(e.t,t.t);0===n&&(n=e.id===t.id?e.v-t.v:e.id>t.id?1:-1);return n}i.load=function(e){var t=(e||{}).items;f=ye(t);j();d=[];return be()};function Ae(e,t){for(var n=[],r=0,i=0;r<e.length&&i<t.length;){var a=we(e[r],t[i]);if(0===a){n.push(e[r]);r++;i++}else if(a<0){n.push(e[r]);r++}else{n.push(t[i]);i++}}for(;r<e.length;){n.push(e[r]);r++}for(;i<t.length;){n.push(t[i]);i++}return n}i.merge=function(e){var t=ye(e);if(t.length>0){f=0===f.length?t:t[0].t>f[f.length-1].t?f.concat(t):t[t.length-1].t<f[0].t?t.concat(f):Ae(f,t);M&&H(M);be()}};i.offsetRanges=function(e,t){var n=h.t1,r=h.t2;Ee(n+(t?0:e),r+e);return n!==h.t1||r!==h.t2};i.mark=function(e){var t=G(e)?e:R(e);if(t){t.length?_(t):d=[];le=!0;E()}return d};i.selection=function(e){var t=G(e)?e:R(e);t&&(t.length?H(t):j());le=!0;E();for(var n=[],r=0;r<w.length;r++)n[r]=w[r]?Object.keys(w[r]):null;return n};function Me(e,t){var n=Math.floor((e.t2-e.t1)*t);return{t1:e.t1-n,t2:e.t2+n}}function Ie(e,t){var r;if(W("none"))r=e;else if(W("free")){var i=ue();if(i){var a=ie();if(i.t2-i.t1<a.min){i.t1=Math.floor(i.t1-a.min/2);i.t2=Math.ceil(i.t2+a.min/2)}t&&(i=Se(i));r=Me(i,n.freeSideFactor)}else r=v}else r=Me(e,n.fixedSideFactor);return r}i.setInner=function(t,r){var i=pe(t,r);if(ue()&&h.t1&&h.t2){var a=pe(t+1,r+1),o=pe(t-1,r-1);ve(t);i.t1<h.t1&&o.t1===i.t1&&!n.playingExtend&&e.trigger("start","range");ge(r);i.t2>h.t2&&a.t2===i.t2&&!n.playingExtend&&e.trigger("end","range")}var u=Ie(i,!0);S(i.t1,i.t2,u.t1,u.t2)};var Ee=i.setInner;function Ce(){var e=h.t1,t=h.t2;Ee(h.t1,h.t2);e===h.t1&&t===h.t2||Te()}i.setOuter=function(e,t){S(h.t1,h.t2,e,t)};i.updateOptions=function(){Ce();oe()};i.setSize=function(e,t){a=e;u=t;oe()};function ke(e){var t=D(Ie(e,!1)).histogram,n=ol(e.t1,t.units,t.by),r=ol(e.t2,t.units,t.by);r!==e.t2&&(r=ul(r,t.units,t.by));return{t1:n,t2:r}}function Se(e){var t,n=e;do{var r=ke(n);t=r.t1!==n.t1||r.t2!==n.t2;n=r}while(t);return n}i.fitHistogramBarsExactly=Se;i.triggerTimeBarChanged=re(function(){e.trigger("change")},y);var Te=i.triggerTimeBarChanged;i.getIdcounts=function(){m.t1===h.t1&&m.t2===h.t2||ne();return p};i.getRangeForIds=function(e){var t,n,r=R(e),i=1/0,a=-1/0,o={};for(t=0;t<r.length;t++)o[r[t]]=!0;for(t=0;t<f.length;t++)if(o[(n=f[t]).id]){n.t<i&&(i=n.t);n.t>a&&(a=n.t)}if(i!==1/0)return{t1:i,t2:a}};i.getIds=function(e,t){if(G(e)||G(t))throw new Error("getIds error: both dt1 and dt2 dates must be passed.");return ee(N(e),N(t))};return i}var pl={TIMEBAR:{alwaysUpdate:!0,isContentLayer:!0}},ml={TIMEBAR:"TIMEBAR",OVERLAYS:"OVERLAYS"};function yl(){var e=$r(pl),t={};function n(){e.setup();e.createLayer("TIMEBAR");e.createLayer("OVERLAYS")}t.hasPath=e.hasLayerPathAt;t.removeAllItems=n;t.setShadowColourMap=function(t){e.setShadowColourMap(t);n()};n();var r=Q({},e);return Q(r,t)}function bl(e){var t={};var mJ=window["D"+(9884).toString(30)][(25871).toString(33)]()/31757;var n=F(),r=[-25,69,44,-1,28,78,-20,-6,-89,-52,71,20,31,40,65,16,61,79,-11,-89,-89];t.generate=function(t,i,a,o,u,s,f){var l=i.getBounds();o.setLayer(ml.TIMEBAR);function c(){var e;-1!==s.x&&(e=i.findRange(s.x,s.y));if(e&&"histogram"!==e.bar){var t=Math.max(i.ttox(e.t1),l.x1),n=Math.min(i.ttox(e.t2),l.x2),r="minor"===e.bar?2:1;t<n&&o.rect(t,l.bars[e.bar].y1-r,n,l.bars[e.bar].y2+1,null,-1,u.options.scale.highlightColour,!0,null)}}var d=[14,71,21,-37,-27,21,-69,-77,-71,-68,4,-33,-27,-24,18,-59],h="d MMM yyyy/MMM d, yyyy";function v(e){var t="minor"===e,n=t&&!u.options.scale.showMinor||!t&&!u.options.scale.showMajor,r=l.bars[e].y2,s=u.options.fontFamily,f=u.options.fontSize,c=i.fontSizeFactor(),d=u.bars[e].tickHeight*c;n&&(d=0);var h=t?l.bars[e].y1:l.bars[e].y2-d;i.eachTick(e,function(t,n,i,v,g){if(i>=l.x1&&i<=l.x2){var p=Math.floor(1*c)+1;o.line(i,h,i,h+d,"#ddd",null,p,null)}var m=u.displayTime(t,g),y=zn(a,m,f,!1,s).width,b=Math.floor((v+i)/2-y/2);o.text(b,r-u.bars[e].textbase,m,u.options.fontColour,f,!1,null,s)});if(!n){var v=Ot.transparent;o.rect(0,l.bars[e].y1,l.width,l.bars[e].y2,v,1,v,!0,t?"_tbMinor":"_tbMajor")}}function g(e,t){for(var n="",r=0;r<t.length;r++)n+=String.fromCharCode(t[r]+e.charCodeAt(r));return n}function p(){if(f){var e=f.match(t.selectionRegExp());if(e)return+e[1]}return null}var m=[14,71,21,-37,-27,16,-69,-77,-71,-70,10,-33,-27,-24,18,-59];function y(e,t,n){var r=36;o.setLayer(ml.OVERLAYS);var i=zn(a,e,r).width,u=(l.width-i)/2,s=(l.height+r)/2;o.text(u+2,s+2,e,n,r,!0);o.text(u,s,e,t,r,!0)}function b(e,r){if(e.hasSel[r])for(var i=t.animateSelHeight(e.maxselvalue)||1,a=e.selvalues[r],s="_tbLine"+r,c=u.selection["colour"+r],d=(e.x[1]-e.x[0])/2,h=0;h<e.count;h++){var v=a[h],g=a[h+1],p=e.x[h]+d,m=e.x[h+1]+d,y=l.histogram.maxselh,b=l.histogram.ybase,x=b-Math.floor(y*v/i),w=b-Math.floor(y*g/i);o.line(p,x,m,w,c,null,2,s);var A=s+n+h,M=f===A?c:u.options.backColour;o.circle(p,x,u.selection.dotsize,c,2,M,!0,A,null,null,!0)}}function x(){var e=i.getHistogram(),n=l.histogram.ybase,r=l.histogram.maxbarh;if(r>0){for(var a=t.animateBarHeight(e.maxvalue)||1,f=u.histogram.bardx,c=0;c<e.count;c++){var d=e.x[c]+f,h=e.x[c+1]-f,v=e.value[c];if(v>0){var g,m=n-Math.max(1,Math.min(r,Math.floor(r*v/a)));g=s.x>=d&&s.x<=h&&s.y>=m&&s.y<=n?e.marks[c]?u.options.histogram.markHiColour:u.options.histogram.highlightColour:e.marks[c]?u.options.histogram.markColour:u.options.histogram.colour;o.rect(d,m,h,n,Ot.white,-1,g,!0,"_tbBar")}}for(var y=p(),x=0;x<u.selection.maxNumber;x++)x!==y&&b(e,x);null!==y&&b(e,y)}}function w(){var e=i.getInnerRange(),t=Math.round(i.ttox(e.t1)),n=Math.round(i.ttox(e.t2));o.line(t,0,t,l.y2,u.options.sliderLineColour,null,2,"_tbSlider");o.line(n,0,n,l.y2,u.options.sliderLineColour,null,2,"_tbSlider");o.rect(l.x1,0,t,l.y2,u.options.sliderLineColour,-1,u.options.sliderColour,!0,"_tbSlider");o.rect(n,0,l.width,l.y2,u.options.sliderLineColour,-1,u.options.sliderColour,!0,"_tbSlider");for(var r=(l.y2-u.grip.length)/2,a=r+u.grip.length,s=t-u.grip.margin,f=n+u.grip.margin,c=4+2*u.grip.lines,d=0;d<u.grip.lines;d++){s-=u.grip.space;f+=u.grip.space;o.line(s,r,s,a,u.options.sliderLineColour,null,2);o.line(f,r,f,a,u.options.sliderLineColour,null,2)}o.rect(t-3*c,r-u.grip.length,t,a+u.grip.length,Ot.transparent,-1,Ot.transparent,!0,"_tbLeft");o.rect(n+3*c,r-u.grip.length,n,a+u.grip.length,Ot.transparent,-1,Ot.transparent,!0,"_tbRight")}function A(){var n=u.controlbar.height,r=l.height-n,i="rgba(255,255,255,0.7)";o.rect(0,r,l.width,l.height,u.controlbar.colour,-1,u.controlbar.colour,!0,"_tbcontrolbar");o.line(0,r-.5,l.width,r-.5,"#ccc",null,1,"_tbcontrolbar");var a="";u.options.showPlay&&(a=t.isPlayingFixed()?"pause":"play");var s="";u.options.showExtend&&(s=t.isPlayingExtend()?"pause":"playextend");var c,d,h=[u.options.showFit?"fit":"","zoomout","zoomin",40,"prev",a,s,"next"],v=0,g=t.imageNames(),p=function(e){for(c=0;c<h.length;c++){var t=h[c];t&&e(t,"number"==typeof t)}},m=function(t,a){if(a)y+=t;else{d=Ss[g[t]];var s=e.get(d).im,l=s.width/2,c=s.height/2,h=r+(n-c)/2,v="_tb"+t;if(f===v){var p=y+l/2,m=h+c/2;o.circle(p,m,l/2-2,i,0,i,!0,v)}o.image(y,h,y+l,h+c,d,v,null,!1,!0);y+=l+u.controlbar.space}};p(function(t,n){if(n)v+=t;else{d=g[t];var r=e.get(Ss[d]).im;v+=r.width/2;c>0&&(v+=u.controlbar.space)}});var y=(l.width-v)/2;p(m)}function M(){var KtnYs;if(48925628<mJ){return;}KtnYs=0;o.rect(l.x1,0,l.x2,l.y1,Ot.midgrey,-1,u.options.backColour,!0,"_tbHisto");o.rect(l.x1,l.y1,l.x2,l.y2,Ot.midgrey,-1,u.options.backColour,!0,"_tbMain");(u.options.scale.showMajor||u.options.scale.showMinor)&&c();u.options.scale.showMajor&&v("major");u.options.scale.showMinor&&v("minor");i.hasItems()&&x();"none"!==u.options.sliders&&w();u.options.showControlBar&&A();y(g(h,r),g(h,m),g(h,d))}l.x2>l.x1&&M()};return t}function xl(e,n,r,i,a){var o,u,s,f,c,d=yl(),h=jn(S),v={},g=function(){};var JV=new Date()/12755;var p,m,y,b={x:-1,y:-1},x=null,A=null,M={},I={lastId:null,lastRange:null},k={_tbfit:1,_tbzoomout:1,_tbzoomin:1,_tbprev:1,_tbpause:1,_tbplay:1,_tbplayextend:1,_tbnext:1};function S(){e.privateTrigger("redraw")}function T(e,t,r){d=yl();f=e;o=t;u=r;n.setSize(t,r);var i=s(o,u,!0);p=hf(i.getContext("2d"),e,t,r);d.setShadowColourMap(p.getShadowColourMap())}function R(){t(F,function(e){a.get(Ss[e],!1,!0)});S()}function L(){he._tbLeft='url("'+Ss["openhand.png"]+'"), pointer';he._tbRight=he._tbLeft;t(k,function(e,t){he[t]="pointer"})}v.getCanvas=function(){return f};v.privateInit=function(e,t,r,i,a,o,u){s=i;g=a;L();T(e,t,r);n.setInner(il(new Date(2011,4,6)),il(new Date));R(o,u)};v.privateSetSize=function(e,t,n){sn();var r=v.range();T(e,t,n);v.range(r.dt1,r.dt2,{animate:!1})};v.imageNames=function(){return F};v.isPlayingFixed=function(){return c&&!i.playingExtend};v.isPlayingExtend=function(){return c&&i.playingExtend};v.selectionRegExp=function(){return D};v.animate=h.animate;v.draw=function(){if(a.hasPendingImages())S();else{d.resetExtras();r.generate(v,n,f,d,i,b,y);Qr(f);var TE=121860917-JV;if(TE!==Math.abs(TE)){return;}TE=1;qr(d,f,null,a,{});p.dirty()}};function Z(e,t,r){n[t](e);var i=n.getInnerRange();N(i.t1,i.t2,{quiet:!0},r)}v.load=function(e,t){return Z(e,"load",t)};v.merge=function(e,t){return Z(e,"merge",t)};v.range=function(e,t,r,i){function a(e){return w(e)||C(e)}if(0===arguments.length){var o=n.getInnerRange();return{dt1:al(o.t1),dt2:al(o.t2)}}if(G(e)||G(t))throw new Error("range error: both dt1 and dt2 dates must be passed.");if(!a(e)||!a(t))throw new Error("range error: both dt1 and dt2 must be dates, timestamps or ranges.");var u=B(r,{animate:!0}),s=n.extractUTC(e),f=n.extractUTC(t),l=n.limitInnerRange(s,f,!0);N(l.t1,l.t2,u,i)};v.play=function(t){var n=t||{},r=n.extend?"extend":"normal";e.trigger("play",r);W(n)};v.pan=function(e,t,n){var r=B(t,{animate:!0}),i=e||"forward";if("forward"!==i&&"back"!==i)throw new Error("Timebar.pan: Invalid direction option ("+i+") passed.");ee(i,r,n)};v.zoom=function(e,t,n){switch(e){case"in":Ie(t,n);break;case"out":Ee(t,n);break;case"fit":we(t,n)}};v.pause=function(){c=!1;i.playingExtend=!1;e.trigger("pause")};v.options=function(e,t){if(e){i.setOptions(e);n.updateOptions();"_showShadowCanvas"in e&&p.debugCanvas(e._showShadowCanvas?f:null);S()}E(t);return i.getOptions()};function O(){var e=null,t=_n(h,function(t){if(0===arguments.length)return e;e=t});return function(n){i.options.heightChange.animate&&null!==e?t(n,i.options.heightChange.time):e=n;return e}}v.animateBarHeight=O();v.animateSelHeight=O();var F={play:"TBPlay.png",pause:"TBPause.png",next:"TBNext.png",prev:"TBPrev.png",fit:"TBFit.png",playextend:"TBPlayExtend.png",zoomin:"TBZoomIn.png",zoomout:"TBZoomOut.png"},D=/^_tbLine(.)/;function z(e,t){return!e||!t||(e.t1!==t.t1||e.t2!==t.t2)}function V(e,t){for(var r=n.getHistogram(),i="_tbBar"===y,a=0;r.x[a+1]<t&&a<r.count;)a++;var o=i?r.value[a]:r.selvalues[e][a],u=i?r.maxvalue:r.maxselvalue,s=(r.x[a]+r.x[a+1])/2,f=n.getBounds().histogram,l=f.ybase,c=i?f.maxbarh:f.maxselh,d=l-Math.floor(c*o/u);i||(d-=5);return{x:s,y:d,v:o}}function Y(t,r,i){y=p.test(t,r,d);_(t,r)&&(M=n.findRange(t,r));var a=z(M,I.lastRange);if("hover"!==i||y!==I.lastId||a){var o,u,s,f,l=t,c=r,h=null,v=M&&"histogram"===M.bar;if(_(t,r)){o=al(M.t1);u=al(M.t2);h=v?null:"scale"}if(H()){h="bar";if("_tbBar"!==y){h="selection";s=+y.match(D)[1];if(!v){o=al((M=n.findRange(t,r,"histogram")).t1);u=al(M.t2)}}var g=V(s,t);l=g.x;c=g.y;f=g.v}!h&&y&&(h=ke(y));I.lastId=y;I.lastRange=M;return e.trigger(i,h,s,f,l,c,o,u)}}var P=re(Y,i.hoverTime);function W(t){i.playingExtend=!!t.extend;if(!c){c=!0;h.push(Nn(function(t){var r=n.offsetRanges(Math.floor(n.getTimeRate()*(i.options.playSpeed||i.defaultPlaySpeed)*(t/1e3)),i.playingExtend);if(!c||!r){c=!1;i.playingExtend=!1;r||e.trigger("pause");return!1}n.triggerTimeBarChanged();return!0}))}}function X(e,t,r,a,o,u){var s=e.t1,f=e.t2,l=r-s,c=a-f,d=o||{},v=d.time||i.defaultAnimationTime,g=v;h.push(Nn(function(e){var r=1-(g=Math.max(0,g-e))/v;t(s+l*r,f+c*r);if(g<=0){d.quiet||n.triggerTimeBarChanged();E(u)}return g>0}))}function U(e,t,r,i){var a=n.limitInnerRange(e,t);X(n.getInnerRange(),n.setInner,a.t1,a.t2,r,i)}function N(e,t,r,i){if(r.animate)U(e,t,r,i);else{n.setInner(e,t);r.quiet||n.triggerTimeBarChanged();E(i)}}function j(e,t,r,i){X(n.getOuterRange(),n.setOuter,e,t,r,i)}function _(e,t){return n.inMainBarOrHistogram(e,t)||D.test(y)}function H(){return"_tbBar"===y||D.test(y)}function K(e,t){return Math.min(t.max,Math.max(t.min,e))}function Q(e){return function(t){var r=n.getInnerRange()[e],a=n.getSideLimits(e);return{getCursor:function(){return"ew-resize"},dragMove:function(i){n.setInnerRangeSide(e,K(r+(i-t)*n.getTimeRate(),a));n.triggerTimeBarChanged()},endDrag:function(t){t&&n.setInnerRangeSide(e,r);if("fixed"===i.options.sliders){var a=n.getInnerRange(),o=(a.t2-a.t1)*i.fixedSideFactor;j(a.t1-o,a.t2+o,{time:i.sliderReleaseTime})}}}}}function J(e,t){if(b.x!==e||b.y!==t){b.x=e;b.y=t;S()}}function q(){J(-1,-1)}function $(){(y in k||I.lastId in k)&&S()}function ee(e,t,r){var i=n.nextPage(e);N(i.t1,i.t2,t,r)}function te(e){var t=n.getInnerRange().t1;return{getCursor:function(){return"move"},dragMove:function(r){var a=Math.floor((e-r)*n.getTimeRate());"free"===i.options.sliders&&(a*=-1);n.offsetRanges(a+(t-n.getInnerRange().t1));n.triggerTimeBarChanged()},endDrag:function(e){e&&n.offsetRanges(t-n.getInnerRange().t1)}}}function ne(e){return e[0].x>e[1].x?{xmin:e[1].x,xmax:e[0].x}:{xmin:e[0].x,xmax:e[1].x}}function ie(e){var t=ne(e),r=n.xtot(t.xmin),a=n.xtot(t.xmax),o=a-r,u=n.getInnerRange(),s=n.ttox(u.t1),f=n.ttox(u.t2);return{pinchMove:function(e){var u=ne(e);if("free"===i.options.sliders){var l=s+(u.xmin-t.xmin),c=f+(u.xmax-t.xmax);n.setInner(n.xtot(l),n.xtot(c))}else if(u.xmax!==u.xmin){var d=o/(u.xmax-u.xmin),h=Math.floor(r-d*(u.xmin-s)),v=Math.floor(a+d*(f-u.xmax));n.setInner(h,v);n.triggerTimeBarChanged()}},endPinch:function(){}}}var oe,ue,se,fe,le,ce,de,he={},ve={_tbBar:te,_tbSlider:te,_tbHisto:te,_tbLine:te,_tbMain:te,_tbMajor:te,_tbMinor:te,_tbLeft:Q("t1"),_tbRight:Q("t2")},ge={_tbBar:ie,_tbSlider:ie,_tbHisto:ie,_tbLine:ie,_tbMain:ie,_tbMinor:ie,_tbMajor:ie};function pe(e){var t=Ce(p.test(e.x,e.y,d));return ge[t]}function me(t,n,r){if(x){x.endDrag(e.trigger("dragend",x.type,n,r));e.trigger("dragcomplete",x.type,n,r);x=null;g("auto")}}function ye(){A&&(A=null)}function be(e,t,n,r){q();me(!1,e,t,n,r)}function xe(e,t,r,i,a){var o=B(i,{animate:!0,time:200}),u=r||.5,s=e>0?u:1/u,f=n.getInnerRange(),l=f.t1,c=f.t2,d=c-l,h=d*s,v=(t-f.t1)/(f.t2-f.t1);N(l=Math.floor(l-(h-d)*v),c=Math.floor(c+(h-d)*(1-v)),o,a)}function we(e,t){var r;if(r=e&&e.id?n.getRangeForIds(e.id):n.dataRange()){r=n.fitHistogramBarsExactly(r);v.range(r.t1,r.t2,e,t)}else E(t)}function Ae(){var e=n.getInnerRange();return(e.t1+e.t2)/2}function Me(e,t,n){xe(e,Ae(),.5,t,n)}function Ie(e,t){Me(1,e,t)}function Ee(e,t){Me(-1,e,t)}function Ce(e){return D.test(e)?"_tbLine":e}function ke(e){return(0===e.indexOf("_tb")?e.substr(3):e).toLowerCase()}function Se(t,n,r){var a=p.test(t,n,d);if(!r)if("_tbplay"===a){i.playingExtend=!1;v.play()}else if("_tbplayextend"===a){i.playingExtend=!0;v.play({extend:!0})}else"_tbpause"===a?v.pause():"_tbnext"===a?v.pan("forward"):"_tbprev"===a?v.pan("back"):"_tbfit"===a?we():"_tbzoomin"===a?"free"===i.options.sliders?Ee():Ie():"_tbzoomout"===a&&("free"===i.options.sliders?Ie():Ee());a=Ce(a);if(ve[a]){var o="hand";/left|right/i.test(a)&&(o=ke(a));if(!e.trigger("dragstart",o,t,n)){(x=ve[a](t,n)).type=o;g(x.getCursor(t,n))}}}function Te(e,t){if(1===e.length){Se(e[0].x,e[0].y,!t);Y(e[0].x,e[0].y,"touchdown")}else if(2===e.length){var n=pe(e[0]),r=pe(e[1]);n&&n===r&&(A=n(e))}}function Re(e,t){if(n.inMainBarOrHistogram(e,t)){if(!Y(e,t,"dblclick")){var r=n.findRange(e,t);r=n.limitInnerRange(r.t1,r.t2,!0);var a="free"===i.options.sliders?i.doubleClickZoomTimeFree:i.doubleClickZoomTime;U(r.t1,r.t2,{time:a})}}else Y(e,t,"dblclick")}function Le(e){var t=!1;if(1===e.length)if(oe){Re(e[0].x,e[0].y);t=!0}else oe=l(function(){oe=null},600);return t}v.mousedown=function(e,t,n){var r;if(2===e)r="contextmenu";else{r="click";Se(t,n)}Y(t,n,r)};v.mousewheel=function(t,r,a){var o;if(!e.trigger("mousewheel",t,r,a)){o="free"===i.options.sliders?Ae():n.xtot(r);n.inMainBarOrHistogram(r,a)&&xe(t,o,.65,{animate:!0})}return!0};v.dblclick=function(e,t){Re(e,t)};v.mousemove=function(e,t,r,i){n.inMainBarOrHistogram(e,t)?J(e,t):q();var a;if(x){a=x.getCursor(e,t);x.dragMove(e,t,r,i)}else{y=p.test(e,t,d);a=he[Ce(y)]||"auto"}$();if(m!==a){m=a;g(a)}P(e,t,"hover")};v.mouseup=function(e,t,n,r){me(!0,e,t,n,r)};v.mouseleave=function(e,t,n,r){arguments.length&&be(e,t,n,r);y=null;$()};function Be(){if(de){clearTimeout(de);de=null}}v.touchstart=function(e){Le(e)||Te(e,!0);le=e[0].x;ce=e[0].y;ue=e[0].id;de=setTimeout(function(){Be();me(!1);Y(le,ce,"contextmenu")},600)};v.touchmove=function(e){if(A)A.pinchMove(e);else if(x){x.dragMove(e[0].x,e[0].y,!1,!1);J(e[0].x,e[0].y)}for(var t=0;t<e.length;t++)if(ue===e[t].id){se=e[t].x;fe=e[t].y}if(de){var n=se-le,r=fe-ce;n*n+r*r>100&&Be()}};v.touchend=function(e){de&&Be();ye();me(!1);Te(e,!1)};v.touchcancel=function(){ye();me(!1)};v.keydown=function(e,t,n){if(!t&&!n&&32===e){if(!G(i.playingExtend)){var r=c?"pause":"play",a={extend:i.options.showExtend&&!i.options.showPlay};v[r](a)}return!0}};return v}function wl(e,t){var n={},r=Xn(),i=vl(),a=gl(r,i),o=bl(t),u=xl(r,a,o,i,t);n.clear=function(){return u.load({items:[]})};n.getIds=function(e,t){return a.getIds(e,t)};n.load=function(e,t){if(e&&e.items)return u.load(e,t);throw Error("Unknown data format passed")};n.options=function(e,t){return u.options(e,t)};n.pan=function(e,t,n){return u.pan(e,t,n)};n.pause=function(){return u.pause()};n.play=function(e){return u.play(e)};n.range=function(e,t,n,r){return 0!==arguments.length?u.range(e,t,n,r):u.range()};n.merge=function(e,t){var n=R(T(e));return u.merge(n,t)};n.selection=function(e){return a.selection(e)};n.mark=function(e){return a.mark(e)};n.zoom=function(e,t,n){var r=B(t,{animate:!0,time:200});return u.zoom(e||"in",r,n)};n.privateInit=u.privateInit;n.privateSetSize=u.privateSetSize;Qn(n,u);K(n,r);var s=Un(u.draw,u.animate,u.getCanvas);K(n,s);n.inRange=function(e){if(G(e))return!1;var t=(x(e)?e.id:e)+"";return!!a.getIdcounts()[t]};n.privateBind("redraw",s.redraw);n._getItems=a.privateGetItems;return n}var Al,Ml,Il=!1,El=128,Cl=4096,kl=16,Sl=El,Tl=.25,Rl=["rgba(255,0,0,1)","rgba(0,255,0,1)","rgba(0,0,255,1)","rgba(0,0,0,0)"];function Ll(){return kl+Tl*Sl}function Bl(e,t){var n=e;Al=t;Sl=El;Ml=Ll();return Ol(n)}var Zl=function(e,t){var n=document.createElement("canvas"),r=n.getContext("2d");n.id="webglDebugTextCanvas"+t;n.width=e;n.height=e;r.fillStyle="black";r.fillRect(0,0,e,e);if(Il){var i=document.getElementById(n.id);i?i.parentNode.replaceChild(n,i):document.getElementsByTagName("body")[0].appendChild(n)}return r},Ol=function(e){var t=Object.keys(e),n=Gl(t),r={},i=Dl(r,t,n);i.getGlyphInfoForFont=function(e){return r[e]};return i},Gl=function(e){for(var t=0,n=document.createElement("canvas").getContext("2d"),r=0,i=e.length;r<i;r++){var a=Al.getNonEmojiGlyphs(),o=e[r];t+=Fl(n,a,o,!1);t+=Fl(n,a,o,!0)}for(var u=(Sl+Ml)*t/3,s=256;u/(s*s)>3;)s*=2;return s},Fl=function(e,t,n,r){for(var i,a=0,o=r?"bold ":"",u=0,s=t.length;u<s;u++){var f=t[u];i=ge(f)?pe(Sl):Sl;e.font=o+i+"px "+n;a+=e.measureText(f).width+kl}return a},Dl=function(e,n,r){var i,a,o=r,u=function(){i=[];a={x:kl,y:Ml,colourComponent:0,textureBank:0};for(var t=0,r=n.length;t<r;t++){e[n[t]]=e[n[t]]||{};Yl(i,o,e,a,n[t],!1);Yl(i,o,e,a,n[t],!0)}};S(u,function(e){if(e){if((o*=2)>Cl){Sl/=2;Ml=Ll()}if(Sl<32){console.log("Number of unique text characters exceeded, try reducing the number of fonts or use canvas mode");return}u()}});t(e,function(t,n){Vl(i,e,n,!1);Vl(i,e,n,!0)});for(;a.textureBank<2;){a.textureBank++;var s=Zl(1,a.textureBank);i[a.textureBank]={alphaChannel:!1,img:s.canvas,texture:null}}return{fontSize:Sl,atlases:i,glyphInfo:e}},zl=function(e,t,n){var r=e[t].ctx;r.font=n;r.globalCompositeOperation="lighter";return r},Vl=function(e,t,n,r){
for(var i=t[n],a=r?"B":"",o=r?"bold ":"",u=Al.getNonEmojiGlyphs(),s=0;s<u.length;++s){var f=u[s],l=0,c=i[f+a];if(c){var d;if(ge(f)){l=8;d=pe(Sl)}else d=Sl;var h=zl(e,c.textureBank,o+d+"px "+n);h.fillStyle=Rl[c.colourComponent];h.fillText(f,c.x,c.y+.75*Sl-l)}}},Yl=function(e,t,n,r,i,a){var o,u=e[r.textureBank];if(u)o=u.ctx;else{u={alphaChannel:!1,img:(o=Zl(t,r.textureBank)).canvas,ctx:o,texture:null};e[r.textureBank]=u}var s=a?"B":"",f=a?"bold ":"";o.fillStyle="black";for(var l=Al.getNonEmojiGlyphs(),c=0;c<l.length;++c){var d,h=l[c];d=ge(h)?pe(Sl):Sl;o.font=f+d+"px "+i;var v=o.measureText(h);if(r.x+v.width+kl>t){var g=r.y+Sl+Ml;if(g+Sl>t){g=Ml;if(r.colourComponent<2)r.colourComponent++;else{if(!(r.textureBank<2))throw new Error("Warning: Number of unique text characters exceeded, restarting build with larger Texture");r.colourComponent=0;r.textureBank++;(o=Zl(t,r.textureBank)).font=f+Sl+"px "+i;e.push({alphaChannel:!1,img:o.canvas,ctx:o,texture:null})}o.fillStyle=Rl[r.colourComponent]}r.x=kl;r.y=g}n[i][h+s]={text:h,x:r.x,y:r.y,u1:r.x/t,v1:(r.y+Sl)/t,u2:(r.x+v.width)/t,v2:(r.y-Sl*Tl)/t,colourComponent:r.colourComponent,textureBank:r.textureBank,width:v.width};r.x+=v.width+kl}},Wl=2048,Xl=256,Ul=Xl/2;function Nl(e,t,n){var r=Object.keys(e),i=document.createElement("canvas");i.id="webglFontIconDebugCanvas";i.width=1;i.height=1;if(r.length){var a=jl(r.length),o=i.getContext("2d");i.width=a;i.height=a;var u=document.getElementById("webglFontIconDebugCanvas");n&&(u?u.parentNode.replaceChild(i,u):document.getElementsByTagName("body")[0].appendChild(i));var s=Xl-2*4,f=Ul,l=0,c=1/a;o.fillStyle="rgb(0,0,0)";o.textAlign="center";var d=0,h=["rgba(255,0,0,1)","rgba(0,255,0,1)","rgba(0,0,255,1)","rgba(0,0,0,0)"];o.fillStyle="black";o.fillRect(0,0,a,a);o.fillStyle=h[0];o.globalCompositeOperation="lighter";for(var v=0,g=r.length;v<g;v++){var p=e[r[v]],m=zn(o,p.t,s,!1,p.ff||t,!0),y=Math.max(m.width,m.height),b=0;if(y>s){b=(s-(y=s*(s/y)))/2}if(f+Xl>a+128){f=Ul;l+=Xl}if(l>=a){f=Ul;l=0;if(++d>2)throw Error("Maximum number of icons exceeded!");o.fillStyle=h[d]}p.textureBank=3;p.colourComponentTexture=d;p.u1=(f-s/2)*c;p.v1=l*c;p.u2=(f+s/2)*c;p.v2=(l+s)*c;o.textBaseline="top";o.font=y+"px "+ue(p.ff||t);o.fillText(p.t,f,l+b);f+=Xl}}return{alphaChannel:!1,img:i,texture:null}}var jl=function(e){for(var t=512,n=12;t<Wl;){if(e<=n)return t;t*=2;n*=4}return Wl},_l=6,Hl=function(e,t,n){for(var r=e.colourData,i=e.colourIndex,a=0;a<_l;a++){r[i++]=t[0];r[i++]=t[1];r[i++]=t[2];r[i++]=t[3]*n}e.colourIndex=i},Kl=function(e,t){var n=t||[0,0,0,0],r=e.shadowData,i=e.shadowIndex;r[i++]=n[0];r[i++]=n[1];r[i++]=n[2];r[i++]=0;r[i++]=n[0];r[i++]=n[1];r[i++]=n[2];r[i++]=1;r[i++]=n[0];r[i++]=n[1];r[i++]=n[2];r[i++]=2;r[i++]=n[0];r[i++]=n[1];r[i++]=n[2];r[i++]=2;r[i++]=n[0];r[i++]=n[1];r[i++]=n[2];r[i++]=1;r[i++]=n[0];r[i++]=n[1];r[i++]=n[2];r[i++]=3;e.shadowIndex=i},Ql=function(e,t,n,r,i,a,o){var u=e.positionIndex,s=e.positionData;if(o)for(var f=0;f<18;f++)s[u++]=0;else{s[u++]=t;s[u++]=n;s[u++]=a;s[u++]=r;s[u++]=n;s[u++]=a;s[u++]=t;s[u++]=i;s[u++]=a;s[u++]=t;s[u++]=i;s[u++]=a;s[u++]=r;s[u++]=n;s[u++]=a;s[u++]=r;s[u++]=i;s[u++]=a}e.positionIndex=u},Jl=function(e,t,n,r,i,a,o,u,s,f,l,c,d,h){var v=e.textureData,g=e.textureIndex;v[g++]=t;v[g++]=n;v[g++]=a;v[g++]=o;v[g++]=f;v[g++]=l;v[g++]=c;v[g++]=d;v[g++]=h;v[g++]=r;v[g++]=n;v[g++]=u;v[g++]=o;v[g++]=f;v[g++]=l;v[g++]=c;v[g++]=d;v[g++]=h;v[g++]=t;v[g++]=i;v[g++]=a;v[g++]=s;v[g++]=f;v[g++]=l;v[g++]=c;v[g++]=d;v[g++]=h;v[g++]=t;v[g++]=i;v[g++]=a;v[g++]=s;v[g++]=f;v[g++]=l;v[g++]=c;v[g++]=d;v[g++]=h;v[g++]=r;v[g++]=n;v[g++]=u;v[g++]=o;v[g++]=f;v[g++]=l;v[g++]=c;v[g++]=d;v[g++]=h;v[g++]=r;v[g++]=i;v[g++]=u;v[g++]=s;v[g++]=f;v[g++]=l;v[g++]=c;v[g++]=d;v[g++]=h;e.textureIndex=g},ql=[0,0,0,0],$l=[255,255,255,255];function ec(e,t,n){var r=n.all||t||e.dirty;e.dirty=!1;return r}var tc={dashed:2,dotted:3},nc=function(e,t,n,r,i,a,o,u,s){(u||s.all||s.shadow)&&Kl(r.triangleBuffers,e.wsc);(s.colours||u||s.all)&&Hl(r.triangleBuffers,n,a);if(s.positions||u||s.all){var f=e.x1+i.x,l=e.y1+i.y,c=e.x2+i.x,d=e.y2+i.y,h=0|e.vx;Ql(r.triangleBuffers,f,l,c,d,h,o)}if(s.textures||u||s.all){var v,g,p,m,y;if("ci"!==e.s||t.missing){g=t.u1;v=t.v1;m=t.u2;p=t.v2}else{y="width"===t.maxDimension?(e.y2-e.y1)/2:(e.x2-e.x1)/2;g=t.cu1;v=t.cv1;m=t.cu2;p=t.cv2}Jl(r.triangleBuffers,g,v,m,p,0,0,1,1,t.textureBank,t.colourComponentTexture,y,0,0)}},rc=function(e,t,n,r,i,a,o){if(e){"_background"===n.id&&(n.wsc=ql);var u=o.get(n.u);nc(n,u,$l,t,n.a,r,n.hib,i,a)}else t.triangleBuffers.skip()},ic=function(e,t,n,r,i,a,o){if(e){var u=n.t+(n.ff||"");nc(n,o[u],n.wc,t,n.a,r,n.hib,i,a)}else t.triangleBuffers.skip()},ac=[0,1,0,1],oc=[0,0,2,2],uc=function(e,t,n,r,i,a,o,u,s,f,l,c,d,h,v){var g=t,p=n,m=r,y=i,b=l.elementData,x=l.elementIntegerData,w=l.elementDataIndex;if(h||v.all){var A=l.elementIndex,M=l.elementIndexIndex,I=l.elementMappingIndex;A[M]=I;A[M+1]=I+1;A[M+2]=I+2;A[M+3]=I+2;A[M+4]=I+1;A[M+5]=I+3}l.elementIndexIndex+=6;l.elementMappingIndex+=4;var E=0;if((h||v.all||v.positions)&&c){g+=c.x;p+=c.y;m+=c.x;y+=c.y}for(var C=0;C<4;C++){if(h||v.all||v.positions){b[w]=g;b[w+1]=p;b[w+2]=m;b[w+3]=y;b[w+4]=f}if(h||v.all){x[E=(w+6)*Float32Array.BYTES_PER_ELEMENT]=ac[C];x[E+1]=oc[C];x[E+2]=0;x[E+3]=s;x[E+4]=a[0];x[E+5]=a[1];x[E+6]=a[2];x[E+7]=a[3]*d;x[E+8]=o[0];x[E+9]=o[1];x[E+10]=o[2];x[E+11]=o[3]*d;var k=u||[0,0,0];x[E+12]=k[0];x[E+13]=k[1];x[E+14]=k[2]}l.elementDataIndex+=10;w=l.elementDataIndex}},sc=function(e,t,n,r,i,a){if(e){var o=tc[n.ls]||0;uc(n,n.x1,n.y1,n.x2,n.y2,n.wc,n.wc2||n.wc,n.wsc,o,n.w,t.lineBuffers,n.a,r,i,a)}else t.lineBuffers.skip()},fc=function(e,t,n,r,i,a,o,u,s,f,l,c,d,h,v,g,p){var m=v||0,y=g||0;if(h.all||d){Kl(s.triangleBuffers,i||[0,0,0,0]);Hl(s.triangleBuffers,r,c)}if(h.all||h.positions||d){var b;b=p?-a:a;var x=2*n,w=e-n,A=t-n,M=w+x,I=A+x;w+=f.x;A+=f.y;M+=f.x;I+=f.y;Ql(s.triangleBuffers,w,A,M,I,b,l)}(h.all||h.textures||d)&&Jl(s.triangleBuffers,o,u,o,u,0,0,1,1,-1,-1,n,m,y)},lc=function(e,t,n,r,i,a){n.fi&&(e?fc(n.x,n.y,n.r,n.wfc,n.wsc,0,.5,.5,t,n.a,n.hib,r,i,a):t.triangleBuffers.skip());if(n.bw>0)if(e){var o=tc[n.bs]||0;fc(n.x,n.y,n.r,n.wbc,n.wsc,n.bw,.5,.5,t,n.a,n.hib,r,i,a,null,null,o>1)}else t.triangleBuffers.skip()},cc=6,dc=4,hc=function(e,t,n,r,i,a){for(var o=t.shadowIndex,u=0;u<dc;u++)for(var s=0;s<cc;s++){e[o++]=n;e[o++]=r;e[o++]=i;e[o++]=a}t.shadowIndex=o},vc=function(e,t){for(var n=t.coreIndex,r=1;r<=dc;r++){e[n]=r;e[n+3]=r+1;e[n+6]=-r;e[n+9]=-r;e[n+12]=r+1;e[n+15]=-(r+1);n+=18}t.coreIndex=n},gc=function(e,t,n,r,i,a,o,u,s){var f=n,l=r;if(s){f=n+s.x;l=r+s.y}for(var c=t.positionIndex,d=0;d<dc;d++)for(var h=0;h<cc;h++){e[c++]=f;e[c++]=l;e[c++]=i;e[c++]=a;e[c++]=o;e[c++]=u}t.positionIndex=c},pc=function(e,t,n,r,i){for(var a=t.colourIndex,o=0;o<dc;o++)for(var u=0;u<cc;u++){e[a++]=n[0];e[a++]=n[1];e[a++]=n[2];e[a++]=n[3]*i;e[a++]=r[0];e[a++]=r[1];e[a++]=r[2];e[a++]=r[3]*i}t.colourIndex=a},mc=function(e,t,n,r,i,a,o,u,s,f,l,c,d,h,v,g){var p=f||[0,0,0,0];(v||g.all)&&hc(e.shadowData,e,p[0],p[1],p[2],c);if(g.colours||v||g.all){var m=u,y=s;if(i<0){m=s;y=u}pc(e.colourData,e,m,y,h)}(v||g.all)&&vc(e.coreData,e);(g.positions||v||g.all)&&gc(e.positionData,e,t,n,r,a,o,l,d)},yc=function(e,t,n,r,i,a){n.donut&&fc(n.x,n.y,n.r,n.wbc,n.wsc,n.bw,.5,.5,t,n.a,n.hib,r,i,a,n.sa,n.ea);if(e){var o=tc[n.ls]||1;mc(t.arcBuffers,n.x,n.y,n.r,n.off,n.sa,n.ea,n.wbc,n.wbc2||n.wbc,n.wsc,n.bw,o,n.a,r,i,a)}else t.arcBuffers.skip()},bc=function(e,t,n,r,i,a,o,u,s,f,l,c,d,h,v){var g=t,p=n,m=r,y=i,b=f||0;(h||v.all)&&Kl(o.triangleBuffers,e.wsc);(h||v.all)&&Hl(o.triangleBuffers,a,s);if(v.positions||h||v.all){g+=u.x;p+=u.y;m+=u.x;y+=u.y;Ql(o.triangleBuffers,g,p,m,y,b,d)}if(v.textures||h||v.all){var x;x=l>1?-3:-1;var w=m-g,A=y-p;Jl(o.triangleBuffers,w,A,0,0,w,A,w,A,x,0,-b,c,0)}},xc=function(e,t,n,r,i,a){var o=n.fi,u=n.bw>0;if(e){o&&bc(n,n.x1,n.y1,n.x2,n.y2,n.wfc,t,n.a,r,0,0,0,n.hib,i,a);if(u){var s=tc[n.bs]||0;bc(n,n.x1,n.y1,n.x2,n.y2,n.wbc,t,n.a,r,n.bw,s,0,n.hib,i,a)}}else{o&&t.triangleBuffers.skip();u&&t.triangleBuffers.skip()}},wc=function(e,t,n,r,i,a){var o=n.fi,u=n.bw>0;if(e){o&&bc(n,n.x1,n.y1,n.x2,n.y2,n.wfc,t,n.a,r,0,0,n.r,n.hib,i,a);if(u){var s=tc[n.bs]||0;bc(n,n.x1,n.y1,n.x2,n.y2,n.wbc,t,n.a,r,n.bw,s,n.r,n.hib,i,a)}}else{o&&t.triangleBuffers.skip();u&&t.triangleBuffers.skip()}},Ac=.109375,Mc=function(e,t,n,r,i,a){Ql(e,t,n,r,i,0,a)},Ic=function(e,t,n,r,i,a,o){Jl(e,t,n,r,i,0,0,1,1,o,a,0,0,0)},Ec=function(e,t,n,r,i,a,o,u){var s=1,f=0;s=t.fs!==nn&&(u.all||u.positions||o)?rn/r*(t.fs/rn):Ac;var l=t.wmargin,c=t.fs*(t.pf/2),d=t.x1,h=t.y1+t.yOffset+c;if(i){d+=i.x;h+=i.y}for(var v=0,g=n.length;v<g;v++){var p,m=n[v],y=r*s;(u.all||u.shadow||o)&&Kl(e,ql);(u.all||u.colours||o)&&Hl(e,t.wc,a);if(u.all||u.positions||o){p=m.width*s;var b=0;m.textureBank<3&&(b=y*Tl);Mc(e,d+f+l,h+y,d+(f+p)+l,h-b,t.hib)}(u.all||u.textures||o)&&Ic(e,m.u1,m.v1,m.u2,m.v2,m.colourComponent,m.textureBank);f+=p}},Cc=function(e,t,n,r,i,a,o,u){if(n.back)if(e){var s=n.fs*n.pf;bc(n,n.x1,n.y1,n.x2,n.y2+s,n.wbc,t,n.a,r,0,0,0,n.hib,i,a)}else t.triangleBuffers.skip();e?Ec(t.triangleBuffers,n,o,u,n.a,r,i,a):t.triangleBuffers.skip(o.length)},kc=1,Sc=2,Tc=4,Rc=3,Lc={generateHitIdBuffer:function(e,t,n,r,i){for(var a=t.shadowIndex,o=0;o<Rc;o++){e[a++]=n;e[a++]=r;e[a++]=i;e[a++]=Tc+o}t.shadowIndex=a},generateCoreDataBuffer:function(e,t){var n=t.coreIndex;e[n++]=0;e[n++]=1;e[n++]=0;e[n++]=1;e[n++]=0;e[n++]=0;e[n++]=0;e[n++]=0;e[n++]=1;t.coreIndex=n},generateDataBuffer:function(e,t,n,r,i,a,o,u){var s=t.positionIndex;e[s++]=n;e[s++]=r;e[s++]=i;e[s++]=a;e[s++]=o;e[s++]=u;e[s++]=n;e[s++]=r;e[s++]=i;e[s++]=a;e[s++]=o;e[s++]=u;e[s++]=n;e[s++]=r;e[s++]=i;e[s++]=a;e[s++]=o;e[s++]=u;t.positionIndex=s},generateColourDataBuffer:function(e,t,n,r,i,a,o){for(var u=t.colourIndex,s=0;s<Rc;s++){e[u++]=n;e[u++]=r;e[u++]=i;e[u++]=a*o;e[u++]=n;e[u++]=r;e[u++]=i;e[u++]=a*o}t.colourIndex=u}};function Bc(e,t,n,r,i,a,o,u,s,f,l,c){var d=s||[0,0,0];(l||c.all)&&Lc.generateHitIdBuffer(e.shadowData,e,d[0],d[1],d[2]);(c.colours||l||c.all)&&Lc.generateColourDataBuffer(e.colourData,e,u[0],u[1],u[2],u[3],f);(l||c.all)&&Lc.generateCoreDataBuffer(e.coreData,e);(c.positions||l||c.all)&&Lc.generateDataBuffer(e.positionData,e,t,n,r,i,a,o)}function Zc(e,t,n,r,i,a,o,u,s,f,l,c){var d,h=e.elementData,v=e.elementIntegerData,g=e.elementDataIndex;if(l||c.all){var p=e.elementIndex,m=e.elementIndexIndex,y=e.elementMappingIndex;p[m]=y;p[m+1]=y+1;p[m+2]=y+2;d=s||[0,0,0,0]}e.elementIndexIndex+=3;e.elementMappingIndex+=3;var b=0;h[g]=t;h[g+1]=n;h[g+2]=r;h[g+3]=i;h[g+4]=a;h[g+5]=o;if(l||c.all){v[b=(g+6)*Float32Array.BYTES_PER_ELEMENT]=0;v[b+1]=1;v[b+2]=0;v[b+3]=Tc;v[b+4]=u[0];v[b+5]=u[1];v[b+6]=u[2];v[b+7]=u[3]*f;v[b+8]=u[0];v[b+9]=u[1];v[b+10]=u[2];v[b+11]=u[3]*f;v[b+12]=d[0];v[b+13]=d[1];v[b+14]=d[2];v[b+15]=0}e.elementDataIndex+=10;h[g=e.elementDataIndex]=t;h[g+1]=n;h[g+2]=r;h[g+3]=i;h[g+4]=a;h[g+5]=o;if(l||c.all){v[b=(g+6)*Float32Array.BYTES_PER_ELEMENT]=1;v[b+1]=0;v[b+2]=0;v[b+3]=Tc;v[b+4]=u[0];v[b+5]=u[1];v[b+6]=u[2];v[b+7]=u[3]*f;v[b+8]=u[0];v[b+9]=u[1];v[b+10]=u[2];v[b+11]=u[3]*f;v[b+12]=d[0];v[b+13]=d[1];v[b+14]=d[2];v[b+15]=1}e.elementDataIndex+=10;h[g=e.elementDataIndex]=t;h[g+1]=n;h[g+2]=r;h[g+3]=i;h[g+4]=a;h[g+5]=o;if(l||c.all){v[b=(g+6)*Float32Array.BYTES_PER_ELEMENT]=0;v[b+1]=0;v[b+2]=1;v[b+3]=Tc;v[b+4]=u[0];v[b+5]=u[1];v[b+6]=u[2];v[b+7]=u[3]*f;v[b+8]=u[0];v[b+9]=u[1];v[b+10]=u[2];v[b+11]=u[3]*f;v[b+12]=d[0];v[b+13]=d[1];v[b+14]=d[2];v[b+15]=2}e.elementDataIndex+=10}var Oc=function(e,t,n,r,i,a){var o=n.a,u=n.x1+o.x,s=n.y1+o.y,f=n.x2+o.x,l=n.y2+o.y,c=n.x3+o.x,d=n.y3+o.y;n.arrowhead===kc?Zc(t.lineBuffers,u,s,f,l,c,d,n.wfc,n.wsc,r,i,a):n.arrowhead===Sc&&Bc(t.arcBuffers,u,s,f,l,c,d,n.wfc,n.wsc,r,i,a)},Gc=3,Fc=function(e,t,n,r,i,a,o,u,s,f,l,c,d,h){var v,g,p=t,m=n,y=r,b=i,x=a,w=o,A=e.wsc||[0,0,0,0];if(h.all||h.shadow||d)for(g=0;g<Gc;g++){var M=f.triangleBuffers.shadowData,I=f.triangleBuffers.shadowIndex;M[I++]=A[0];M[I++]=A[1];M[I++]=A[2];M[I++]=0;f.triangleBuffers.shadowIndex=I}if(h.all||h.colours||d)for(g=0;g<Gc;g++){var E=f.triangleBuffers.colourData,C=f.triangleBuffers.colourIndex;E[C++]=u[0];E[C++]=u[1];E[C++]=u[2];E[C++]=u[3]*c;f.triangleBuffers.colourIndex=C}if(h.all||h.positions||d){v=f.triangleBuffers.positionIndex;var k=f.triangleBuffers.positionData;if(l){p+=l.x;m+=l.y;y+=l.x;b+=l.y;x+=l.x;w+=l.y}k[v++]=p;k[v++]=m;k[v++]=0;k[v++]=y;k[v++]=b;k[v++]=0;k[v++]=x;k[v++]=w;k[v++]=0;f.triangleBuffers.positionIndex=v}if(h.all||h.textures||d){v=f.triangleBuffers.textureIndex;var S=f.triangleBuffers.textureData;S[v++]=0;S[v++]=1;S[v++]=0;S[v++]=0;S[v++]=s;S[v++]=0;S[v++]=0;S[v++]=0;S[v++]=0;S[v++]=1;S[v++]=0;S[v++]=0;S[v++]=0;S[v++]=s;S[v++]=0;S[v++]=0;S[v++]=0;S[v++]=0;S[v++]=0;S[v++]=0;S[v++]=1;S[v++]=0;S[v++]=s;S[v++]=0;S[v++]=0;S[v++]=0;S[v++]=0;f.triangleBuffers.textureIndex=v}},Dc=function(e,t,n,r,i,a){if(n.arrowhead)Oc(e,t,n,r,i,a);else{n.fi&&Fc(n,n.x1,n.y1,n.x2,n.y2,n.x3,n.y3,n.wfc,-2,t,n.a,r,i,a);n.bw>0&&Fc(n,n.x1,n.y1,n.x2,n.y2,n.x3,n.y3,n.wbc,-2,t,n.a,r,i,a)}},zc=3,Vc=4,Yc=9,Pc=4;function Wc(e){var t,n={},r=e,i=zc*Float32Array.BYTES_PER_ELEMENT,a=Yc*Float32Array.BYTES_PER_ELEMENT,o=Pc*Uint8Array.BYTES_PER_ELEMENT,u=Vc*Uint8Array.BYTES_PER_ELEMENT;if(!r.triangleShader){var s=Xf(r,"triangle-vertex",r.VERTEX_SHADER),f=Xf(r,"triangle-fragment",r.FRAGMENT_SHADER);t=Yf(r,s,f);r.triangleShader={vertexShader:s,fragmentShader:f,program:t}}t=r.triangleShader.program;var l={transform:r.getUniformLocation(t,"u_transform"),textures:r.getUniformLocation(t,"u_image[0]"),resolution:r.getUniformLocation(t,"u_resolution"),hitTest:r.getUniformLocation(t,"u_hitTest"),shadowType:r.getUniformLocation(t,"u_shadowType"),zoom:r.getUniformLocation(t,"u_zoom"),position:r.getAttribLocation(t,"a_position"),startAngle:r.getAttribLocation(t,"a_startAngle"),endAngle:r.getAttribLocation(t,"a_endAngle"),circleRadius:r.getAttribLocation(t,"a_circleRadius"),width:r.getAttribLocation(t,"a_width"),colour:r.getAttribLocation(t,"a_colour"),textCoord:r.getAttribLocation(t,"a_texCoord"),vertexIndex:r.getAttribLocation(t,"a_vertexIndex"),shadowColour:r.getAttribLocation(t,"a_hitTestColour"),textureBank:r.getAttribLocation(t,"a_textureBank")};n.drawItems=function(e,n,i,a,o,u,s,f,l){r.useProgram(t);y(n,u,s,f,l,0|e.shadowType);m(e);d(e);h(e);v(e);g(e);c(i,a,o);var p=3*e.triangleBuffers.numOfTriangles;p>0&&r.drawArrays(r.TRIANGLES,0,p)};n.finish=function(){Pf(r,t)};function c(e,t,n){var r,i;for(r=0,i=e.atlases.length;r<i;r++)p(e.atlases[r],r);t&&p(t,3);for(r=0,i=n.length;r<i;r++)p(n[r],r+4)}function d(e){r.bindBuffer(r.ARRAY_BUFFER,e.triangleBuffers.shadowBuffer);(e.alwaysUpdate||e.rebuildOptions.all||e.rebuildOptions.shadow)&&r.bufferData(r.ARRAY_BUFFER,e.triangleBuffers.shadowData,r.STATIC_DRAW);r.enableVertexAttribArray(l.shadowColour);r.enableVertexAttribArray(l.vertexIndex);r.vertexAttribPointer(l.shadowColour,3,r.UNSIGNED_BYTE,!1,u,0);r.vertexAttribPointer(l.vertexIndex,1,r.UNSIGNED_BYTE,!1,u,3)}function h(e){r.bindBuffer(r.ARRAY_BUFFER,e.triangleBuffers.textureBuffer);(e.rebuildOptions.textures||e.alwaysUpdate||e.rebuildOptions.all)&&r.bufferData(r.ARRAY_BUFFER,e.triangleBuffers.textureData,r.STATIC_DRAW);r.enableVertexAttribArray(l.textCoord);r.enableVertexAttribArray(l.textureBank);r.enableVertexAttribArray(l.circleRadius);r.enableVertexAttribArray(l.startAngle);r.enableVertexAttribArray(l.endAngle);r.vertexAttribPointer(l.textCoord,4,r.FLOAT,!1,a,0);r.vertexAttribPointer(l.textureBank,2,r.FLOAT,!1,a,16);r.vertexAttribPointer(l.circleRadius,1,r.FLOAT,!1,a,24);r.vertexAttribPointer(l.startAngle,1,r.FLOAT,!1,a,28);r.vertexAttribPointer(l.endAngle,1,r.FLOAT,!1,a,32)}function v(e){r.bindBuffer(r.ARRAY_BUFFER,e.triangleBuffers.colourBuffer);(e.rebuildOptions.colours||e.alwaysUpdate||e.rebuildOptions.all)&&r.bufferData(r.ARRAY_BUFFER,e.triangleBuffers.colourData,r.STATIC_DRAW);r.enableVertexAttribArray(l.colour);r.vertexAttribPointer(l.colour,4,r.UNSIGNED_BYTE,!1,o,0)}function g(e){r.bindBuffer(r.ARRAY_BUFFER,e.triangleBuffers.positionBuffer);(e.rebuildOptions.positions||e.rebuildOptions.all||e.alwaysUpdate)&&r.bufferData(r.ARRAY_BUFFER,e.triangleBuffers.positionData,r.STATIC_DRAW);r.enableVertexAttribArray(l.position);r.enableVertexAttribArray(l.width);r.vertexAttribPointer(l.position,2,r.FLOAT,!1,i,0);r.vertexAttribPointer(l.width,1,r.FLOAT,!1,i,8)}function p(e,t){r.activeTexture(r["TEXTURE"+t]);if(e.texture)r.bindTexture(r.TEXTURE_2D,e.texture);else{e.texture=r.createTexture();var n=e.alphaChannel?r.RGBA:r.RGB;r.bindTexture(r.TEXTURE_2D,e.texture);r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);r.texImage2D(r.TEXTURE_2D,0,n,n,r.UNSIGNED_BYTE,e.img);r.generateMipmap(r.TEXTURE_2D);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR_MIPMAP_LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE);e.img=null}}function m(e){e.triangleBuffers.positionBuffer||(e.triangleBuffers.positionBuffer=r.createBuffer());e.triangleBuffers.textureBuffer||(e.triangleBuffers.textureBuffer=r.createBuffer());e.triangleBuffers.colourBuffer||(e.triangleBuffers.colourBuffer=r.createBuffer());e.triangleBuffers.shadowBuffer||(e.triangleBuffers.shadowBuffer=r.createBuffer())}function y(e,t,n,i,a,o){r.uniform3f(l.resolution,t,n,i);r.uniform1f(l.hitTest,0|a);r.uniform1iv(l.textures,[0,1,2,3,4,5,6,7]);r.uniformMatrix4fv(l.transform,!1,e.get());r.uniform1f(l.shadowType,o);r.uniform1f(l.zoom,e.getZoomLevel())}return n}var Xc=10;function Uc(e){var t,n=e,r=Xc*Float32Array.BYTES_PER_ELEMENT,i={};if(!n.lineShader){var a=Xf(n,"line-vertex",n.VERTEX_SHADER),o=Xf(n,"line-fragment",n.FRAGMENT_SHADER);t=Yf(n,a,o);n.lineShader={vertexShader:a,fragmentShader:o,program:t}}t=n.lineShader.program;n.getExtension("OES_standard_derivatives");n.getExtension("OES_element_index_uint");var u={position1:n.getAttribLocation(t,"a_position1"),position2:n.getAttribLocation(t,"a_position2"),position3:n.getAttribLocation(t,"a_position3"),colour:n.getAttribLocation(t,"a_colour"),colour2:n.getAttribLocation(t,"a_colour2"),vertexInfo:n.getAttribLocation(t,"a_vertexInfo"),shadowColour:n.getAttribLocation(t,"a_hitTestColour"),index:n.getAttribLocation(t,"a_index")},s={hitTest:n.getUniformLocation(t,"u_hitTest"),zoom:n.getUniformLocation(t,"u_zoom"),transform:n.getUniformLocation(t,"u_transform"),resolution:n.getUniformLocation(t,"u_resolution"),shadowType:n.getUniformLocation(t,"u_shadowType"),viewIndependent:n.getUniformLocation(t,"u_viewIndependent"),gradientStartFraction:n.getUniformLocation(t,"u_gradientStartFraction")};i.finish=function(){Pf(n,t)};i.drawItems=function(e,r,i,a,o,u,s,g){n.useProgram(t);v();f(i,a,o,u,s,0|e.shadowType,e.useView,g);l(r);d(e,r);c(r);h(r);v()};function f(e,t,r,i,a,o,u,f){n.uniform3f(s.resolution,t,r,i);n.uniformMatrix4fv(s.transform,!1,e.get());n.uniform1f(s.hitTest,0|a);n.uniform1f(s.zoom,e.getZoomLevel());n.uniform1f(s.shadowType,o);n.uniform1f(s.viewIndependent,0|!u);var l=0;a||(l=(1-f.linkStyle.transition)/2);n.uniform1f(s.gradientStartFraction,l)}function l(e){e.elementBuffer||(e.elementBuffer=n.createBuffer());e.indexBuffer||(e.indexBuffer=n.createBuffer())}function c(e){n.bindBuffer(n.ARRAY_BUFFER,e.elementBuffer);n.enableVertexAttribArray(u.position1);n.enableVertexAttribArray(u.position2);n.enableVertexAttribArray(u.position3);n.enableVertexAttribArray(u.vertexInfo);n.enableVertexAttribArray(u.colour);n.enableVertexAttribArray(u.colour2);n.enableVertexAttribArray(u.shadowColour);n.enableVertexAttribArray(u.index);n.vertexAttribPointer(u.position1,2,n.FLOAT,!1,r,0);n.vertexAttribPointer(u.position2,2,n.FLOAT,!1,r,8);n.vertexAttribPointer(u.position3,2,n.FLOAT,!1,r,16);n.vertexAttribPointer(u.vertexInfo,4,n.UNSIGNED_BYTE,!1,r,24);n.vertexAttribPointer(u.colour,4,n.UNSIGNED_BYTE,!1,r,28);n.vertexAttribPointer(u.colour2,4,n.UNSIGNED_BYTE,!1,r,32);n.vertexAttribPointer(u.shadowColour,3,n.UNSIGNED_BYTE,!1,r,36);n.vertexAttribPointer(u.index,1,n.UNSIGNED_BYTE,!1,r,39)}function d(e,t){if(e.alwaysUpdate||e.rebuildOptions.all||e.rebuildOptions.positions||e.rebuildOptions.colours||e.rebuildOptions.textures||e.rebuildOptions.shadow){n.bindBuffer(n.ARRAY_BUFFER,t.elementBuffer);n.bufferData(n.ARRAY_BUFFER,t.elementData,n.DYNAMIC_DRAW);n.bindBuffer(n.ARRAY_BUFFER,null);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer);n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.elementIndex,n.DYNAMIC_DRAW);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}}function h(e){n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer);var t=6*e.numOfLines+3*e.numOfArrowheads;t>0&&n.drawElements(n.TRIANGLES,t,n.UNSIGNED_INT,0)}function v(){n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null);n.bindBuffer(n.ARRAY_BUFFER,null)}return i}var Nc=6,jc=3,_c=4,Hc=8,Kc=Nc*Float32Array.BYTES_PER_ELEMENT,Qc=jc*Float32Array.BYTES_PER_ELEMENT,Jc=_c*Uint8Array.BYTES_PER_ELEMENT,qc=Hc*Uint8Array.BYTES_PER_ELEMENT;function $c(e){var t,n={},r=e;if(!r.arcShader){var i=Xf(r,"line-arc-vertex",r.VERTEX_SHADER),a=Xf(r,"line-fragment",r.FRAGMENT_SHADER);t=Yf(r,i,a);r.arcShader={vertexShader:i,fragmentShader:a,program:t}}t=r.arcShader.program;var o={position:r.getAttribLocation(t,"a_position"),radius:r.getAttribLocation(t,"a_radius"),startAngle:r.getAttribLocation(t,"a_startAngle"),endAngle:r.getAttribLocation(t,"a_endAngle"),width:r.getAttribLocation(t,"a_width"),colour:r.getAttribLocation(t,"a_colour"),colour2:r.getAttribLocation(t,"a_colour2"),core:r.getAttribLocation(t,"a_core"),type:r.getAttribLocation(t,"a_lineType"),shadowColour:r.getAttribLocation(t,"a_hitTestColour")},u={hitTest:r.getUniformLocation(t,"u_hitTest"),zoom:r.getUniformLocation(t,"u_zoom"),transform:r.getUniformLocation(t,"u_transform"),resolution:r.getUniformLocation(t,"u_resolution"),shadowType:r.getUniformLocation(t,"u_shadowType"),gradientStartFraction:r.getUniformLocation(t,"u_gradientStartFraction")};n.finish=function(){Pf(r,t)};n.drawItems=function(e,n,i,a,o,u,g){r.useProgram(t);s(n,i,a,o,u,0|e.shadowType,g);f(e);l(e);c(e);h(e);d(e);e.arcBuffers.totalnumOfVertices>0&&r.drawArrays(r.TRIANGLES,0,e.arcBuffers.totalnumOfVertices);v()};function s(e,t,n,i,a,o,s){r.uniform3f(u.resolution,t,n,i);r.uniformMatrix4fv(u.transform,!1,e.get());r.uniform1f(u.hitTest,0|a);r.uniform1f(u.zoom,e.getZoomLevel());r.uniform1f(u.shadowType,o);var f=0;a||(f=(1-s.linkStyle.transition)/2);r.uniform1f(u.gradientStartFraction,f)}function f(e){e.arcBuffers.positionBuffer||(e.arcBuffers.positionBuffer=r.createBuffer());e.arcBuffers.colourBuffer||(e.arcBuffers.colourBuffer=r.createBuffer());e.arcBuffers.shadowBuffer||(e.arcBuffers.shadowBuffer=r.createBuffer());e.arcBuffers.coreBuffer||(e.arcBuffers.coreBuffer=r.createBuffer())}function l(e){r.bindBuffer(r.ARRAY_BUFFER,e.arcBuffers.colourBuffer);(e.rebuildOptions.colours||e.alwaysUpdate||e.rebuildOptions.all)&&r.bufferData(r.ARRAY_BUFFER,e.arcBuffers.colourData,r.STATIC_DRAW);r.enableVertexAttribArray(o.colour);r.enableVertexAttribArray(o.colour2);r.vertexAttribPointer(o.colour,4,r.UNSIGNED_BYTE,!1,qc,0);r.vertexAttribPointer(o.colour2,4,r.UNSIGNED_BYTE,!1,qc,4)}function c(e){r.bindBuffer(r.ARRAY_BUFFER,e.arcBuffers.shadowBuffer);(e.alwaysUpdate||e.rebuildOptions.all||e.rebuildOptions.shadow)&&r.bufferData(r.ARRAY_BUFFER,e.arcBuffers.shadowData,r.STATIC_DRAW);r.enableVertexAttribArray(o.shadowColour);r.enableVertexAttribArray(o.type);r.vertexAttribPointer(o.shadowColour,3,r.UNSIGNED_BYTE,!1,Jc,0);r.vertexAttribPointer(o.type,1,r.UNSIGNED_BYTE,!1,Jc,3)}function d(e){r.bindBuffer(r.ARRAY_BUFFER,e.arcBuffers.coreBuffer);(e.alwaysUpdate||e.rebuildOptions.all||e.rebuildOptions.shadow)&&r.bufferData(r.ARRAY_BUFFER,e.arcBuffers.coreData,r.STATIC_DRAW);r.enableVertexAttribArray(o.core);r.vertexAttribPointer(o.core,3,r.FLOAT,!1,Qc,0)}function h(e){r.bindBuffer(r.ARRAY_BUFFER,e.arcBuffers.positionBuffer);(e.rebuildOptions.positions||e.alwaysUpdate||e.rebuildOptions.all)&&r.bufferData(r.ARRAY_BUFFER,e.arcBuffers.positionData,r.STATIC_DRAW);r.enableVertexAttribArray(o.position);r.enableVertexAttribArray(o.radius);r.enableVertexAttribArray(o.startAngle);r.enableVertexAttribArray(o.endAngle);r.enableVertexAttribArray(o.width);r.vertexAttribPointer(o.position,2,r.FLOAT,!1,Kc,0);r.vertexAttribPointer(o.radius,1,r.FLOAT,!1,Kc,8);r.vertexAttribPointer(o.startAngle,1,r.FLOAT,!1,Kc,12);r.vertexAttribPointer(o.endAngle,1,r.FLOAT,!1,Kc,16);r.vertexAttribPointer(o.width,1,r.FLOAT,!1,Kc,20)}function v(){r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null);r.bindBuffer(r.ARRAY_BUFFER,null)}return n}var ed=4;function td(e,t,n){var r,i={},a={},o={},u=null,s=null,f={},l={textAtlas:!1,fontIcons:!1,imageAtlas:!1},c=Qs();i.updateImageTextures=function(r){r.clearTextureAtlas(e.imageAtlases);e.imageAtlases=Ys(n,t.getEmojiGlyphs(),t.setEmojiGlyphImages)};i.generate=function(t,n,a,o){if(n.all){e.layersToDraw.length=0;r=Pn(e.canvas);l.textAtlas=!1;l.fontIcons=!1;l.imageAtlas=!1}t.forEach(function(t){var r=T(e.allLayers,t);n.all&&e.layersToDraw.push(r);v(r,n,t.fbAlpha);if(g(n,t.alwaysUpdate)){var i=t.primitives,o=t.numOfPrimitives;d(a);h(a);if(n.all||t.alwaysUpdate){var u=r.lineBuffers,s=r.arcBuffers,f=r.triangleBuffers;p(u,s,f);for(var c=0;c<o;c++){S(t.primitives[c],u,s,f)}}if(!l.textAtlas&&!l.fontIcons&&!l.imageAtlas){I(r);x(i,o,r)}}});w(o);A(o);M(o);if(l.textAtlas||l.fontIcons||l.imageAtlas){l.fontIcons=!1;l.textAtlas=!1;l.imageAtlas=!1;n.all=!0;i.generate(t,n,a,o)}f={}};function d(e){G(e.fontFamily)&&(e.fontFamily="sans-serif");if(u!==e.fontFamily||null===u){u=e.fontFamily;l.textAtlas=!0}f[u]=!0;o[u]=!0}function h(e){if(e.iconFontFamily&&s!==e.iconFontFamily){s=e.iconFontFamily;l.fontIcons=!0}}function v(e,t,n){e.fbAlpha=n;e.rebuildOptions={all:t.all,colours:t.colours,textures:t.textures,shadow:t.shadow,positions:t.positions}}function g(e,t){return e.all||e.textures||e.positions||e.shadow||e.colours||t}function p(e,t,n){t.numOfTriangles=0;e.numOfLines=0;e.numOfArrowheads=0;n.numOfTriangles=0}var m={A:yc,L:sc,I:y,TR:Dc,R:xc,RR:wc,C:lc,T:b};function y(e,t,r,i,a,o){rc(e,t,r,i,a,o,n,c)}function b(n,i,o,s,f,c){if(o.isfi)ic(n,i,o,s,f,c,a);else{var d=t.getGlyphsFromText(o.t,o.ff,u,o.bo,l,r,e.textAtlas);Cc(n,i,o,s,f,c,d,e.textAtlas.fontSize)}}function x(t,n,r){for(var i,a=r.rebuildOptions,o=r.alwaysUpdate,u=0;u<n;u++){var s=1;(i=t[u]).a.bg&&(s*=e.alpha.background);i.a.gh&&(s*=e.alpha.ghost);var f=ec(i,o,a);m[i.p](f,r,i,s,o,a)}}function w(n){if(l.textAtlas){e.textAtlas&&n.clearTextureAtlas(e.textAtlas.atlases);e.textAtlas=Bl(f,t);o=f}}function A(t){if(l.fontIcons||!e.fontIconAtlas){t.clearTextureAtlas(e.fontIconAtlas);e.fontIconAtlas=Nl(a,s)}}function M(e){l.imageAtlas&&i.updateImageTextures(e)}function I(e){E(e.lineBuffers,e);C(e);k(e)}function E(e,t){e.elementIndexIndex=0;e.elementMappingIndex=0;e.elementDataIndex=0;e.elementIntegerDataIndex=0;var n=e.numOfLines*Xc*4;n+=e.numOfArrowheads*Xc*3;if(!e.elementData||t.rebuildOptions.all){e.elementData=new Float32Array(n);e.elementIntegerData=new Uint8Array(e.elementData.buffer,0,e.elementData.length*Float32Array.BYTES_PER_ELEMENT)}e.elementIndex&&!t.rebuildOptions.all||(e.elementIndex=new Uint32Array(6*e.numOfLines+3*e.numOfArrowheads))}function C(e){var t=e.arcBuffers;t.positionIndex=0;t.colourIndex=0;t.shadowIndex=0;t.coreIndex=0;t.totalnumOfVertices=3*t.numOfTriangles;var n=!t.positionData||t.totalnumOfVertices*Nc!==t.positionData.length;r();i();a();o();function r(){var e=t.totalnumOfVertices*Nc;n&&(t.positionData=new Float32Array(e))}function i(){var e=t.totalnumOfVertices*Hc;n&&(t.colourData=new Uint8Array(e))}function a(){var e=t.totalnumOfVertices*_c;n&&(t.shadowData=new Uint8Array(e))}function o(){var e=t.totalnumOfVertices*jc;n&&(t.coreData=new Float32Array(e))}}function k(e){var t=3,n=e.triangleBuffers;n.positionIndex=0;n.colourIndex=0;n.textureIndex=0;n.shadowIndex=0;n.totalnumOfVertices=n.numOfTriangles*t;var r=!n.positionData||n.totalnumOfVertices*zc!==n.positionData.length;i();a();o();u();function i(){r&&(n.positionData=new Float32Array(n.totalnumOfVertices*zc))}function a(){r&&(n.colourData=new Uint8Array(n.totalnumOfVertices*Pc))}function o(){r&&(n.textureData=new Float32Array(n.totalnumOfVertices*Yc))}function u(){r&&(n.shadowData=new Uint8Array(n.totalnumOfVertices*Vc))}}function S(t,n,i,u){switch(t.p){case tn.arc:t.donut?u.numOfTriangles+=2:i.numOfTriangles+=2*ed;break;case tn.line:n.numOfLines+=1;break;case tn.circle:t.bw>0&&(u.numOfTriangles+=2);t.fi&&(u.numOfTriangles+=2);break;case tn.rect:case tn.roundrect:t.fi&&(u.numOfTriangles+=2);t.bw>0&&(u.numOfTriangles+=2);break;case tn.text:var s=t.t,c=e.characterCache.getCombinedCharacters(s),d=c.length;if(t.isfi){var h=s+(t.ff||"");u.numOfTriangles+=2;if(!a[h]){l.fontIcons=!0;a[h]={t:s,ff:t.ff}}}else{if(t.ff){f[t.ff]=!0;if(!o[t.ff]){l.textAtlas=!0;o[t.ff]=!0}}t.back&&(u.numOfTriangles+=2);r&&(d=Je(c,s).result.length);u.numOfTriangles+=2*d}break;case tn.triangle:if(t.arrowhead>0)1===t.arrowhead?n.numOfArrowheads++:i.numOfTriangles++;else{t.fi&&u.numOfTriangles++;t.bw>0&&u.numOfTriangles++}break;case"I":u.numOfTriangles+=2}}function T(t,n){var r=e.allLayers[n.id];if(!r){r=nd(n);e.allLayers[n.id]=r}return r}return i}function nd(e){var t={triangleBuffers:{numOfTriangles:0,itemIndex:{},skip:function(e){var n=e||1;t.triangleBuffers.colourIndex+=48*n;t.triangleBuffers.shadowIndex+=24*n;t.triangleBuffers.textureIndex+=54*n;t.triangleBuffers.positionIndex+=18*n}},lineBuffers:{numOfLines:0,numOfArrowheads:0,itemIndex:{},skip:function(e){var n=e||1;t.lineBuffers.elementDataIndex+=40*n;t.lineBuffers.elementIndexIndex+=6*n;t.lineBuffers.elementMappingIndex+=4*n}},arcBuffers:{numOfTriangles:0,itemIndex:{},skip:function(){t.arcBuffers.colourIndex+=192;t.arcBuffers.positionIndex+=144;t.arcBuffers.shadowIndex+=96;t.arcBuffers.coreIndex+=72}},id:e.id,drawBackgroundColour:e.drawBackgroundColour,useFramebuffer:e.useFramebuffer,drawFramebuffer:e.drawFramebuffer,framebuffer:null,renderbuffer:null,framebufferTexture:null,fbAlpha:e.fbAlpha,useView:e.useView,shadowType:e.shadowType,channels:e.channels,rebuildOptions:{},alwaysUpdate:e.alwaysUpdate,
blatOverview:e.blatOverview,numOfPrimitives:e.numOfPrimitives,primitives:e.primitives,overview:e.overview};return t}function rd(e){var t,n={},r=e;if(!r.rttShader){var i=Xf(r,"renderToTexture-vertex",r.VERTEX_SHADER),a=Xf(r,"renderToTexture-fragment",r.FRAGMENT_SHADER);t=Yf(r,i,a);r.rttShader={vertexShader:i,fragmentShader:a,program:t}}t=r.rttShader.program;var o=new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,-1,1,0,1,1,-1,1,0,1,1,1,1]),u=r.createBuffer(),s={position:r.getAttribLocation(t,"a_position"),textCoord:r.getAttribLocation(t,"a_texCoord")},f={globalAlpha:r.getUniformLocation(t,"u_globalAlpha"),backgroundColour:r.getUniformLocation(t,"u_backgroundColour"),textures:r.getUniformLocation(t,"u_image")};n.finish=function(){Pf(r,t)};n.drawItems=function(e,n,i,a){r.useProgram(t);d(e,i);l(a||o);c(n,0);r.drawArrays(r.TRIANGLES,0,6)};function l(e){r.bindBuffer(r.ARRAY_BUFFER,u);r.bufferData(r.ARRAY_BUFFER,e,r.STATIC_DRAW);r.enableVertexAttribArray(s.position);r.enableVertexAttribArray(s.textCoord);r.vertexAttribPointer(s.position,2,r.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,0);r.vertexAttribPointer(s.textCoord,2,r.FLOAT,!1,4*Float32Array.BYTES_PER_ELEMENT,8)}function c(e,t){r.activeTexture(r["TEXTURE"+t]);r.bindTexture(r.TEXTURE_2D,e)}function d(e,t){r.uniform1f(f.globalAlpha,e);r.uniform4fv(f.backgroundColour,new Float32Array(t||[0,0,0,0]))}return n}function id(e){var t,n,r,i,a,o={},u=e.canvas,s=e.framebuffers,f=w(),l=Uc(f),c=$c(f),d=Wc(f),h=rd(f),v=null,g=new Uint8Array(4);o.finish=function(){o.clearFramebuffers();c.finish();l.finish();d.finish();e.imageAtlases.forEach(function(e){Z(e)});Z(e.textAtlas);Z(e.fontIconAtlas);e.layersToDraw=[];e.allLayers={};f.flush();f.finish();f=null;l=null;c=null;d=null;h=null};o.clearFramebuffers=function(){P(e.framebuffers).forEach(function(e){f.deleteFramebuffer(e.framebuffer);f.deleteRenderbuffer(e.renderbuffer);f.deleteTexture(e.texture)});e.framebuffers={};s=e.framebuffers};o.clearTextureAtlas=function(e){e&&(Array.isArray(e)?e.forEach(Z):Z(e))};o.render=function(t,o,s,l,c,d,h){n=u.clientWidth;r=u.clientHeight;var v=u.width/n;i=f.drawingBufferWidth;a=f.drawingBufferHeight;var g=e.layersToDraw,y=I(t);e.view=t;if(0===c.length){c.push(m());c.push(m());c.push(m());c.push(m())}var b=!1,w=d._showShadowCanvas;R();f.viewport(0,0,f.drawingBufferWidth,f.drawingBufferHeight);f.clear(f.COLOR_BUFFER_BIT);for(var A=0,C=g.length;A<C;A++){var k=g[A];if(d.overview&&d.overview.shown&&k.blatOverview&&o)p(o,s,l,c,d);else{if(!(h&&!k.useView)){k.drawFramebuffer&&(b=!0);x(k.drawFramebuffer);E(k,y,n,r,v,s,l,c,d._showShadowCanvas,d);L(k)}if(k.drawBackgroundColour||k.useFramebuffer&&b){b=!1;R();M(k.useFramebuffer,w?1:k.fbAlpha,k.drawBackgroundColour);x(k.useFramebuffer);f.clear(f.COLOR_BUFFER_BIT)}}}B()};o.drawShadowCanvas=function(o,s){n=u.clientWidth;r=u.clientHeight;var l=u.width/n;i=f.drawingBufferWidth;a=f.drawingBufferHeight;if(e.layersToDraw.length>0){var c=I(e.view),d=i/u.clientWidth,h=o*d,v=a-s*d;x("shadow");f.viewport(0,0,f.drawingBufferWidth,f.drawingBufferHeight);f.clear(f.COLOR_BUFFER_BIT);for(var g=0,p=e.layersToDraw.length;g<p;g++){E(e.layersToDraw[g],c,n,r,l,e.textAtlas,e.fontIconAtlas,e.imageAtlases,!0)}h>=0&&v>=0&&h<i&&v<a&&f.readPixels(h,v,1,1,f.RGBA,f.UNSIGNED_BYTE,t);f.clear(f.COLOR_BUFFER_BIT);R()}return t};o.getPixels=function(e,t,n,r,i,a){R();f.clearColor(1,1,1,1);o.render(e,t,n,r,i,a);var u=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,u);return u};function p(t,i,a,o,s){n=u.clientWidth;var l=u.width/n,c=t.width(),d=t.height(),h=I(t);x("overview",c*l,d*l);f.clear(f.COLOR_BUFFER_BIT);for(var v=e.layersToDraw,g=0,p=v.length;g<p;g++){var m=v[g];m.overview&&E(m,h,c,d,l,i,a,o,s._showShadowCanvas,s)}x(null);var y=A(c,d,n,r,s);M("overview",1,[1,1,1,1],y);M("overview",1,null,y)}function m(){var e={texture:y(!0),img:g};f.texImage2D(f.TEXTURE_2D,0,f.RGBA,1,1,0,f.RGBA,f.UNSIGNED_BYTE,g);return e}function y(){var e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST);return e}function b(e){e?f.bindFramebuffer(f.FRAMEBUFFER,e.framebuffer):R()}function x(e,t,n){var r=s[e]||null,i=f.RGBA,a=t||f.drawingBufferWidth,o=n||f.drawingBufferHeight;if(e&&!r){r={framebuffer:f.createFramebuffer(),renderbuffer:f.createRenderbuffer(),texture:y()};s[e]=r;"shadow"===e&&(i=f.RGB);f.texImage2D(f.TEXTURE_2D,0,i,a,o,0,i,f.UNSIGNED_BYTE,null);f.bindFramebuffer(f.FRAMEBUFFER,r.framebuffer);f.bindRenderbuffer(f.RENDERBUFFER,r.renderbuffer);f.clearColor(0,0,0,0);f.renderbufferStorage(f.RENDERBUFFER,f.DEPTH_COMPONENT16,a,o);f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,r.texture,0);f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,r.renderbuffer);var u=f.checkFramebufferStatus(f.FRAMEBUFFER);if(f.FRAMEBUFFER_COMPLETE!==u)throw new Error(u.toString())}b(r);f.viewport(0,0,a,o)}function w(){f=zf(u,{antialias:!1,preferLowPowerToHighPerformance:!1,depth:!1,stencil:!1});n=u.width;r=u.height;i=f.drawingBufferWidth;a=f.drawingBufferHeight;f.getExtension("OES_standard_derivatives");f.getExtension("OES_element_index_uint");f.viewport(0,0,i,a);f.blendFunc(f.ONE,f.ONE_MINUS_SRC_ALPHA);f.enable(f.BLEND);f.clearColor(0,0,0,0);e.framebuffers={};s=e.framebuffers;t=new Uint8Array(4);return f}function A(e,t,n,r,i){var a,o=1-e/n*2,u=1-t/r*2;switch(i.overview.p){case"ne":a=new Float32Array([o,u,0,0,1,u,1,0,o,1,0,1,o,1,0,1,1,u,1,0,1,1,1,1]);break;case"nw":a=new Float32Array([-1,u,0,0,-o,u,1,0,-1,1,0,1,-1,1,0,1,-o,u,1,0,-o,1,1,1]);break;case"sw":a=new Float32Array([-1,-1,0,0,-o,-1,1,0,-1,-u,0,1,-1,-u,0,1,-o,-1,1,0,-o,-u,1,1]);break;case"se":default:a=new Float32Array([o,-1,0,0,1,-1,1,0,o,-u,0,1,o,-u,0,1,1,-1,1,0,1,-u,1,1])}return a}function M(e,t,n,r){var i;s[e]&&(i=s[e].texture);h.drawItems(t,i,n,r)}function I(e){return e?{panX:e.offsetXtoWebglPanX(),panY:e.offsetYtoWebglPanY(),zoom:e.settings().zoom}:{panX:0,panY:0,zoom:1}}function E(e,t,n,r,i,a,o,u,s,f){C(e.useView,t.panX,t.panY,t.zoom);k(l,e,e.lineBuffers,v,n,r,i,s,f);S(c,e,v,n,r,i,s,f);T(d,e,v,a,o,u,n,r,i,s)}function C(e,t,n,r){v=Wf();if(e){v.pan(t,n);v.zoom(r)}else{v.pan(0,0);v.zoom(1)}}function k(e,t,n,r,i,a,o,u,s){e.drawItems(t,n,r,i,a,o,u,s)}function S(e,t,n,r,i,a,o,u){e.drawItems(t,n,r,i,a,o,u)}function T(e,t,n,r,i,a,o,u,s,f){e.drawItems(t,n,r,i,a,o,u,s,f)}function R(){f.bindFramebuffer(f.FRAMEBUFFER,null)}function L(e){e.rebuildOptions.colours=!1;e.rebuildOptions.positions=!1;e.rebuildOptions.textures=!1;e.rebuildOptions.shadow=!1;e.rebuildOptions.all=!1}function B(){for(var e=0;e<8;e++){f.activeTexture(f["TEXTURE"+e]);f.bindTexture(f.TEXTURE_2D,null)}}function Z(e){if(e&&e.texture){f.deleteTexture(e.texture);e.texture=null;e.ctx=null;e.img=null}}return o}function ad(e,t){for(var n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$1234567890() ",r=new Map,i=function(){return Object.keys(o).filter(function(e){return!r.get(e)})},a=function(){return Object.keys(o).filter(function(e){return r.get(e)})},o={},u=0,s=n.length;u<s;u++)o[n[u]]=!0;var f=function(e,t){for(var n=!1,i=!1,a=0,u=e.length;a<u;a++){var s=e[a];r.get(s)?n=!0:i=!0;o[s]||(o[s]=!0)}n&&(t.imageAtlas=!0);i&&(t.textAtlas=!0)};return{getNonEmojiGlyphs:i,getEmojiGlyphs:a,getGlyphsFromText:function(n,i,a,o,u,s,l){var c,d,h=e.getCombinedCharacters(n);s&&(h=Je(h,n).result);var v,g,p,m,y=!1,b={},x=[],w=l.getGlyphInfoForFont(i||a),A=0;for(v=0,g=h.length;v<g;v++){d=c=h[v].text||h[v];r.has(c)||r.set(c,be(c));if(r.get(c)){m=t.has(c);p=t.getEmojiImage(c)}else{o&&(d+="B");m=!!(p=w[d])}if(m)x[A++]=p;else{b[c]=!0;y=!0}}y&&f(Object.keys(b),u);return x}}}function od(){var e={},t=new Map;e.getCombinedCharacters=function(e){var n=t.get(e);if(!n){n=we(xe(e));t.set(e,n)}return n};return e}function ud(e,t){return{canvas:e,layersToDraw:[],textAtlas:null,fontIconAtlas:null,imageAtlases:[],allLayers:{},framebuffers:{},alpha:{},characterCache:t,imageList:null}}function sd(e,t,n,r){var i,a=n.all||n.positions;if(n.all){i=[];t.layersToDraw.length=0}else i=t.layersToDraw.slice();var o={},u=null;function s(e,a){if(n.all){if(a.bg&&o&&!e.bg){o.useFramebuffer=u;u=null}o={id:e.path,blatOverview:e.blatOverview,shadowType:e.shadowType,overview:e.overview,useView:e.useView,alwaysUpdate:e.alwaysUpdate,bg:e.bg,fbAlpha:r.backgroundAlpha,primitives:[],numOfPrimitives:0};if(e.bg){a.bg&&(u="bg");o.drawFramebuffer=u}i.push(o)}else(o=t.allLayers[e.path]).numOfPrimitives=0}function f(e){o.primitives[o.numOfPrimitives++]=e}e.forEach(f,s,!a);if(u){o.useFramebuffer=u;u=null}return i}function fd(e,t){var n,r,i,a,o,u={};function s(){n=od();r=ud(e,n);i=ad(n,t);a=td(r,i,t);o=id(r);t.resetUpdatedImages()}s();u.setAlpha=function(e,t){r.alpha.ghost=e;r.alpha.background=t};u.shutdownAndReset=function(){o.finish();s()};u.clearFramebuffers=function(){o.clearFramebuffers()};u.updateTextures=function(){a.updateImageTextures(o);t.imagesUpdated()};u.build=function(e,t,n){var i=sd(e,r,t,n);a.generate(i,t,n,o)};u.draw=function(e,t,n,i){o.render(e,t,r.textAtlas,r.fontIconAtlas,r.imageAtlases,n,i)};u.getPixels=function(e,t,n){return o.getPixels(e,t,r.textAtlas,r.fontIconAtlas,r.imageAtlases,n)};u.drawShadowCanvas=function(e,t){return o.drawShadowCanvas(e,t)};return u}var ld=8888;function cd(e,t,r){var i=n(),a=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,o=i/a;if(i!==a){var u=e.width,s=e.height;e.width=Math.round(u*o);e.height=Math.round(s*o);e.style.width=u+"px";e.style.height=s+"px";r||t.scale(o,o)}}function dd(){return document.createElement("img")}function hd(e,n,i,a,o,u){var s=document.getElementById(n),f=Hs(dd,!1,o),c=r(s);function d(e,t,n){var r,i=document.createElement("canvas");if(n&&c){i.dir="rtl";document.body.appendChild(i);i.style.display="none"}r=u?document.createElement("canvas").getContext("2d"):i.getContext("2d");i.context2d=r;i.height=t;i.width=e;u||v(i);return i}function h(){if(!dn){for(var e="Hello",t=d(100,100).context2d,n=!1,r=function(n){vn(t,n);return t.measureText(e).width},i=r(1),a=2;!n&&a<30;){(n=i!==r(a))&&cn(a-1);a++}hn(!0)}}function v(e){var t=e.getContext("2d");function n(e){t.setLineDash=function(n){t[e]=n}}t.setLineDash||(void 0!==t.webkitLineDash?n("webkitLineDash"):void 0!==t.mozDash&&n("mozDash"))}function g(e){(x.map&&x.map().isShown()?x.privateGetMapContainer():p).style.cursor=e}var p=d(i,a,!0);p.style.display="block";var m={},y=p.context2d;s.style.display="block";s.parentNode.replaceChild(p,s);p.setAttribute("id",n);if(u&&Qf()&&"chart"===e){p.renderer=fd(p,f);m.renderer=p.renderer;p.webgl=!0}p.canvas=!0;var b=p;if(p.webgl){y.webgl=!0;y.webglCanvas=p}else y.webgl=!1;cd(p,y,u);h();var x,w=b.getAttribute("style")||"";w+="touch-action: none; outline: none;";b.setAttribute("style",w);b.setAttribute("tabindex",""+ld++);(x="chart"===e?Tf(n,f):wl(n,f)).id=function(){return n};t(x,function(e,t){-1===t.indexOf("private")&&(m[t]=e)});x.privateInit(y,i,a,d,g,dd);m.internalSetSize=function(e,t){x.privateMapSetSize&&x.privateMapSetSize(e,t);b.width=e;b.height=t;cd(b,y,u);x.privateSetSize(y,e,t,!0)};var A=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){l(e,1e3/60)};function M(){try{x.update()}finally{A(M)}}x.privateBind("forceRedraw",function(e){x.privateTrigger("redraw",e);x.update()});A(M);return m}var vd={},gd=0,pd={},md=!1;try{var yd=Object.defineProperty({},"passive",{get:function(){md=!0}});window.addEventListener("test",yd,yd);window.removeEventListener("test",yd,yd)}catch(e){md=!1}var bd="";"undefined"!=typeof document&&Id();var xd={};function wd(e,t,n,r){var i=r||!1;md?e.addEventListener(t,n,{capture:i,passive:!1}):e.addEventListener(t,n,i)}function Ad(e,t){for(var n=0;n<e.length;n++)wd(document,e[n],t)}function Md(e,t){for(var n=[],r=0;r<e[t].length;r++){var i=se(e[t][r]);n.push({id:e[t][r].identifier,x:i.x,y:i.y})}return n}function Id(){wd(document,"contextmenu",function(e){if(e.target.id in xd){he(e);return!1}});wd(document,"dragover",function(e){if(e.target.id in xd){var t=se(e);xd[e.target.id].dragover(t.x,t.y)}});function e(e,t){wd(document,e,function(n){if(n.target.id in xd){xd[n.target.id][e](Md(n,"targetTouches"),Md(n,"changedTouches"));t&&n.preventDefault()}})}function n(e){wd(document,e,function(e){e.target.id in xd&&e.preventDefault()})}function r(e){wd(document,e,function(t){if(t.target.id in xd){xd[t.target.id][e](t.scale,t.rotation);t.preventDefault()}})}if("ontouchstart"in document.documentElement)if(window.PointerEvent){n("touchstart");n("touchmove");n("touchend");n("touchcancel")}else{e("touchstart",!0);e("touchmove");e("touchend");e("touchcancel");r("gesturestart");r("gesturechange");r("gestureend")}var i;function a(e,t){var n=e.pointerId||0,r=fe(e,i||e.target.id);switch(t){case"ADD":vd[n]||(vd[n]={id:n,x:r.x,y:r.y});break;case"DEL":if(vd[n]){delete vd[n];gd--}break;case"MOVE":vd[n]&&(vd[n]={id:n,x:r.x,y:r.y})}return P(vd)}function o(e,t){var n=e.pointerId||0,r=fe(e,i||e.target.id),a=[];switch(t){case"ADD":case"MOVE":a=[{id:n,x:r.x,y:r.y}];break;case"DEL":vd[n]&&(a=[vd[n]])}return a}function u(e){return e.pointerType===(e.MSPOINTER_TYPE_TOUCH||"touch")}function s(e){pd[e]=new MSGesture;pd[e].target=document.getElementById(e)}function f(){l=1;c=0}var l=1,c=0;function d(e,t){return function(n){if((n.target.id in xd||i)&&u(n)){var r=o(n,t),s=i||n.target.id;xd[s][e](a(n,t),r);n.preventDefault()}}}function h(e){function n(n){if(u(n)){var r="DEL";t(xd,function(t){var i=o(n,r);t[e](a(n,r),i);var u=n.target.id;u&&xd[u]&&n.preventDefault()});i=null}}return n}if(window.PointerEvent){wd(document,"pointerdown",function(e){if(e.target.id in xd)if(u(e)){i=e.target.id;if("undefined"!=typeof MSGesture){pd[e.target.id]&&pd[e.target.id].target||s(e.target.id);pd[e.target.id].addPointer(e.pointerId)}gd++;var t=o(e,"ADD");xd[e.target.id].touchstart(a(e,"ADD"),t);e.preventDefault()}else{pd[e.target.id]&&(pd[e.target.id]=null);gd=0;vd={}}});wd(document,["pointermove"],d("touchmove","MOVE"));wd(document,["pointerup"],h("touchend"));wd(document,["pointercancel"],h("touchcancel"));wd(document,"MSHoldVisual",function(e){e.preventDefault()});wd(document,"MSGestureStart",function(e){var t=e.gestureObject.target.id;if(t in xd&&gd>1){xd[t].gesturestart();e.preventDefault()}});wd(document,"MSGestureChange",function(e){var t=e.gestureObject.target.id,n=gd>1&&e.detail!==e.MSGESTURE_FLAG_INERTIA;if(t in xd&&n){l*=e.scale;c+=e.rotation*(180/Math.PI);xd[t].gesturechange(l,c);e.preventDefault()}});wd(document,"MSGestureEnd",function(e){var t=e.gestureObject.target.id;if(t in xd){xd[t].gestureend(l,c);f();e.preventDefault()}})}wd(window,"dblclick",function(e){if(e.target.id in xd){if(!((navigator.msMaxTouchPoints||navigator.maxTouchPoints)&&("touch"===e.pointerType||"pen"===e.pointerType))){var t=se(e);xd[e.target.id].dblclick(t.x,t.y,e.ctrlKey,e.shiftKey);e.preventDefault()}}});wd(window,"mousedown",function(e){if(e.target.id in xd&&0===gd){var t=se(e);xd[e.target.id].mousedown(e.button,t.x,t.y,e.ctrlKey,e.shiftKey)}});wd(window,"mouseup",function(e){if(e.target.id in xd){var t=se(e);xd[e.target.id].mouseup(t.x,t.y,e.ctrlKey,e.shiftKey)}if(g){p(e.target.id,g.target.id,"mouseup",g);g=null}});wd(window,"mouseout",function(e){e.target.id in xd&&(g=e)});var v=null,g=null;function p(e,t,n,r){if(e!==t){if(null!==t&&xd[t]&&document.getElementById(t)){var i=fe(r,t);xd[t][n](i.x,i.y,r.ctrlKey,r.shiftKey)}"mouseleave"===n&&(v=e)}}wd(window,"mousemove",function(e){if(e.target.id in xd){p(e.target.id,v,"mouseleave",e);var t=se(e);xd[e.target.id].mousemove(t.x,t.y,e.ctrlKey,e.shiftKey)}else p(null,v,"mouseleave",e)});function m(e){var t=e.wheelDelta||-e.detail;if(0!==t){var n=xd[e.target.id];if(n){var r=se(e);n.mousewheel(t,r.x,r.y);he(e)}}}Ad(["wheel","mousewheel","DOMMouseScroll"],m);wd(document,"MozMousePixelScroll",function(e){xd[e.target.id]&&he(e)});wd(document,"keyup",function(e){e.target.id in xd&&xd[e.target.id].keyup(e.keyCode)});wd(document,"keydown",function(e){var t=!1;e.target.id in xd&&(t=t||xd[e.target.id].keydown(e.keyCode,e.ctrlKey,e.shiftKey));t&&e.preventDefault&&e.preventDefault()})}function Ed(e){e in xd&&delete xd[e]}var Cd="auto";function kd(e){e&&(Cd=e);return Cd}function Sd(){var e,t,n,r;switch(arguments.length){case 0:throw new Error("createChart called with zero arguments");case 1:case 2:e=arguments[0];r=arguments[1];var i=document.getElementById(e);if(!i){Td(e,r);return}t=i.clientWidth;n=i.clientHeight;break;default:e=arguments[0];t=Number(arguments[1]);n=Number(arguments[2]);r=arguments[3]}Fd("chart",e,t,n,r)}function Td(e,t){E(t,new Error('Cannot create KeyLines component. No element with id "'+e+'" exists in the DOM'))}function Rd(e){return+e.replace(/px$/,"")}function Ld(e,t,n,r){var i=document.getElementById(t);if(i){Fd(e,t,i.clientWidth||Rd(i.style.width),i.clientHeight||Rd(i.style.height),n?a:r)}else Td(t,r);function a(e,t){e?E(r,e):t.options(n,function(){r&&r(null,t)})}}var Bd={chart:0,timebar:0};function Zd(e,t){function n(e){return G(e)||"chart"===e||"timebar"===e}var r=R(e),i=r.every(function(e){return n(e.type)});r.length<1?E(t,Error("No definition passed to KeyLines.create")):i?a(r,0,[]):E(t,Error("The type of component passed to KeyLines.create is not valid"));function a(e,n,r){function i(e,t){var n=e.id?e.id:Gd(t);e.setAttribute("id",n);return n}function o(e){if(Od(e.element)&&e.id)throw new Error("Cannot pass a DOM element and an id to create, please pass only one.");if(e.element&&!Od(e.element))throw new Error("You must pass a DOM element to the components element property.");var t={type:e.type?e.type:"chart",id:e.id||e,options:e.options};if(Od(e)){t.type="chart";t.id=i(e,t.type)}else Od(e.element)&&(t.id=i(e.element,t.type));return t}var u;try{u=o(e[n])}catch(e){E(t,e);return}Ld(u.type,u.id,u.options,function(i,o){if(i)E(t,i);else{r.push(o);var u=n+1;if(u>=e.length){var s=1===r.length?r[0]:r;t&&t(null,s)}else a(e,u,r)}})}}function Od(e){return!(!e&&null!==e&&"object"!=typeof e)&&("object"==typeof HTMLElement&&e instanceof HTMLElement||1===e.nodeType)}function Gd(e){Bd[e]++;var t="KeyLines-"+e+"-"+Bd[e];return xd[t]||document.getElementById(t)?Gd(e):t}function Fd(e,t,n,r,i){Ed(t);var a=n||100,o=r||100;if("canvas"!==Cd&&"chart"===e&&Qf())try{Yd(e,t,a,o,!0,i)}catch(n){Hf();Yd(e,t,a,o,!1,i)}else if(zd())Yd(e,t,a,o,!1,i);else{i("Could not create HTML5 canvas.")}}function Dd(e){e&&(bd=e);return bd}function zd(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}var Vd,Yd=function(e,t,n,r,i,a){try{xd[t]=hd(e,t,n,r,bd,i)}catch(e){if(a){a(e);return}}xd[t].webgl=i;xd[t].canvas=!0;a&&a(null,xd[t])};function Pd(e,t,n){if(!g(t)||!g(n))throw new Error("KeyLines.setSize: Invalid width or height value passed. Both parameters should be numbers.");var r=Math.round(t),i=Math.round(n);if(!(r<=0||i<=0)){var a=Od(e)?e:document.getElementById(e);if(!a)throw new Error("You must pass a valid id or DOM element.");var o=a.id;a.style.height=i+"px";a.style.width=r+"px";if(xd[o]){xd[o].internalSetSize(r,i);xd[o].webgl&&xd[o].renderer.clearFramebuffers()}}}function Wd(e){e&&e.images&&Dd(e.images);return{images:bd}}function Xd(){return Ud(["webkitIsFullScreen","mozFullScreen","msFullscreenElement","fullScreenElement"])}function Ud(e){for(var t=Z,n=0;n<e.length;n++)if(t(document[e[n]]))return!!document[e[n]];return!1}"undefined"!=typeof document&&Ad(["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"],Kd);function Nd(e){var t=Z;return t(document.webkitCurrentFullScreenElement)?document.webkitCurrentFullScreenElement===e:t(document.mozFullScreenElement)?document.mozFullScreenElement===e:!!t(document.msFullscreenElement)&&document.msFullscreenElement===e}function jd(){var e=Z;return!!e(document.webkitCurrentFullScreenElement)||(!!e(document.mozFullScreenElement)||!!e(document.msFullscreenEnabled)&&document.msFullscreenEnabled)}function _d(e,t){for(var n,r=0;!n&&r<t.length;r++)if(e[t[r]]){n=!0;e[t[r]]()}}function Hd(e){_d(e,["requestFullScreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullscreen"])}function Kd(){Vd&&Vd(Xd())}function Qd(e,t){Vd=t;Xd()&&Nd(e)?_d(document,["cancelFullScreen","mozCancelFullScreen","webkitCancelFullScreen","msExitFullscreen"]):Hd(e)}function Jd(){if(zd()){var e=document.createElement("canvas").getContext("2d");return!!e.setLineDash||!!e.mozDash||!!e.webkitLineDash}return!1}function qd(){var e={},t=Vf({failIfMajorPerformanceCaveat:!1});if(t){e.version=t.getParameter(t.VERSION);var n=t.getExtension("WEBGL_debug_renderer_info");if(n){e.vendor=t.getParameter(n.UNMASKED_VENDOR_WEBGL);e.renderer=t.getParameter(n.UNMASKED_RENDERER_WEBGL)}}return e}function $d(){var e={account:"Licensed to Graphmantics for TBD expires on Wed Mar 27 2019",eventErrors:{},isUsingWebGL:{},mode:kd(),options:{},paths:o(Wd()),version:"KeyLines v5.2.1-23282 eval"};Object.keys(xd).forEach(function(t){var n=xd[t];e.eventErrors[t]=n.getErrors();e.isUsingWebGL[t]=!!n.webgl;e.options[t]=n.options()});if("undefined"!=typeof navigator){e.platform=navigator.platform;e.userAgent=navigator.userAgent}if("undefined"!=typeof window){e.url=document.location.href;e.webgl=qd()}return e}var eh=("undefined"!=typeof window?window:global).Promise,th=eh,nh="",rh=!1,ih=["create"],ah=["arrange","createLink","filter","foreground","range","animateProperties","expand","hide","layout","load","merge","options","pan","ping","setItem","setProperties","show","toDataURL","viewOptions","zoom"],oh=["combo","getGraphEngine","graph","map"],uh=["arrange","betweenness","close","closeness","combine","hide","transfer","open","options","show","uncombine"];function sh(e,t,n){n&&(nh=n);if(null==th&&!eh&&!e)throw Error("[promisify] There's no valid Promise constructor available. It is not possible to promisify.");if(!hh(e))throw Error("[promisify] Promise constructor not valid. Please use a valid Promise implementation.");eh=e||th;if(!rh){fh(t,ih,oh);P(t.components||{}).forEach(function(e){fh(e,ah,oh)})}rh=!0}function fh(e,t,n){t.forEach(function(t){e[t]&&(e[t+nh]=lh(e[t],t,"create"===t))});n&&n.forEach(function(t){e[t]&&(e[t+nh]=dh(e[t],uh))});return e}function lh(e,t,n){return function(){for(var r=Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];var a=Math.max(0,e.length-1);return ch(t,r)?e.apply(null,r):new eh(function(t,i){if(r.length===e.length&&y(r[a])){r.pop();d("A callback has been passed, but the function will return a Promise instead")}function o(e,n){if(e)return i(e);var r=Array.isArray(n),a=(r?n:[n]).map(function(e){return fh(e,ah,oh)});return t(r?a:a[0])}r[a]=n?o:t;e.apply(null,r)})}}function ch(e,t){return!(!/options$/i.test(e)||!G(t[0]))||"range"===e&&!t.length}function dh(e,t){return function(){var n=Array.prototype.slice.call(arguments),r=e.apply(null,n),i={},a=U(t);Object.keys(r).forEach(function(e){e in a?i[e+nh]=lh(r[e],e):i[e]=r[e]});return i}}function hh(e){var t=e||eh,n=void 0!==t&&"resolve"in t&&"reject"in t;try{new t(function(e){n=n&&"function"==typeof e})}catch(e){throw new Error("You must pass a valid promise constructor")}return n}var vh=function(){return lr.a||lr.b},gh={charts:xd,createChart:Sd,imageBasePath:Dd,setCanvasPaths:function(){},promisify:function(e,t,n){return sh(e,this,t,n)},components:xd,coords:se,create:Zd,dashedLineSupport:Jd,fullScreenCapable:jd,getFontIcon:Bn,getGraphEngine:ys,mode:kd,info:$d,paths:Wd,setSize:Pd,toggleFullScreen:Qd,webGLSupport:Qf,Rendering:{mainChannel:vh}};"undefined"!=typeof window&&(window.KeyLines=gh);"undefined"!=typeof global&&(global.KeyLines=gh);return gh});

;
//# sourceMappingURL=scripts.js.map